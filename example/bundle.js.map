{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap d9fa0ce0075d37910b41","webpack:///./example/app.js","webpack:///./~/css-loader/lib/css-base.js","webpack:///./~/style-loader/addStyles.js","webpack:///external \"React\"","webpack:///./lib/editor.js","webpack:///./example/app.css","webpack:///./~/medium-editor/dist/css/medium-editor.css","webpack:///./~/medium-editor/dist/css/themes/default.css","webpack:///./~/medium-editor/dist/js/medium-editor.js","webpack:///./example/app.css?e028","webpack:///./~/medium-editor/dist/css/medium-editor.css?d4c6","webpack:///./~/medium-editor/dist/css/themes/default.css?5edb"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","React","Editor","App","createClass","displayName","getInitialState","text","render","createElement","className","this","state","tag","onChange","handleChange","options","buttons","setState","document","getElementById","list","toString","result","i","length","item","push","join","mediaQuery","alreadyImportedModules","addStylesToDom","styles","domStyle","stylesInDom","refs","j","parts","addStyle","listToStyles","newStyles","css","media","sourceMap","part","createStyleElement","styleElement","head","getHeadElement","type","appendChild","createLinkElement","linkElement","rel","obj","update","remove","singleton","styleIndex","singletonCounter","singletonElement","applyToSingletonTag","bind","URL","createObjectURL","revokeObjectURL","Blob","btoa","updateLink","parentNode","removeChild","href","applyToTag","newObj","index","styleSheet","cssText","replaceText","cssNode","createTextNode","childNodes","insertBefore","setAttribute","firstChild","unescape","encodeURIComponent","JSON","stringify","blob","oldSrc","memoize","fn","memo","apply","arguments","isOldIE","test","window","navigator","userAgent","toLowerCase","getElementsByTagName","newList","mayRemove","textStore","replacement","filter","Boolean","MediumEditor","props","getDefaultProps","componentDidMount","_this","dom","getDOMNode","medium","subscribe","e","_updated","change","innerHTML","componentWillUnmount","destroy","componentWillReceiveProps","nextProps","contentEditable","dangerouslySetInnerHTML","__html","view","classListProp","protoProp","elemCtrProto","Element","objCtr","Object","strTrim","String","trim","replace","arrIndexOf","Array","indexOf","len","DOMEx","message","name","code","DOMException","checkTokenAndGetIndex","classList","token","ClassList","elem","trimmedClasses","getAttribute","classes","split","_updateClassName","classListProto","classListGetter","Error","contains","add","tokens","l","updated","splice","toggle","force","method","defineProperty","classListPropDesc","get","enumerable","configurable","ex","number","__defineGetter__","self","webkitURL","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","get_class","object","prototype","match","FakeBlobBuilder","data","FakeBlob","encoding","size","FBB_proto","FB_proto","FileReaderSync","FileException","file_ex_codes","file_ex_code","real_URL","real_create_object_URL","real_revoke_object_URL","atob","ArrayBuffer","Uint8Array","origin","fake","uri","uri_origin","uri_info","createElementNS","protocol","data_URI_header","decodeURIComponent","object_URL","substring","append","bb","str","buf","buf_len","fromCharCode","fr","readAsBinaryString","getBlob","slice","start","end","args","close","blobParts","builder","buffer","webkitSlice","getPrototypeOf","__proto__","content","root","factory","elements","init","Util","getProp","create","context","copyInto","overwrite","dest","prop","sources","source","hasOwnProperty","isIE","appName","RegExp","exec","isMac","platform","toUpperCase","keyCode","BACKSPACE","TAB","ENTER","ESCAPE","SPACE","DELETE","isMetaCtrlKey","event","metaKey","ctrlKey","isKey","keys","which","charCode","isArray","parentElements","extend","concat","defaults","derives","base","derived","Proto","origPrototype","constructor","findAdjacentTextNodeWithContent","rootNode","targetNode","ownerDocument","nextNode","pastTarget","nodeIterator","createNodeIterator","NodeFilter","SHOW_TEXT","nodeType","nodeValue","isDescendant","parent","child","checkEquality","node","isElement","now","Date","throttle","func","wait","THROTTLE_INTERVAL","timeout","previous","later","remaining","clearTimeout","setTimeout","traverseUp","current","testElementFunction","htmlEntities","insertHTMLCommand","doc","html","selection","range","el","fragment","lastNode","toReplace","queryCommandSupported","execCommand","ignore","defaultView","getSelection","getRangeAt","rangeCount","commonAncestorContainer","selectNode","deleteContents","createDocumentFragment","insertNode","cloneRange","setStartAfter","collapse","removeAllRanges","addRange","getSelectionRange","deprecated","Selection","getSelectionStart","getSelectionData","execFormatBlock","tagName","selectionData","setTargetBlank","anchorUrl","url","target","attributes","value","addClassToAnchors","buttonClass","isListItem","isBlockContainer","cleanListDOM","element","parentElement","unwrap","moveCursor","textContent","unwrapElement","splitOffDOMTree","leafNode","splitLeft","splitOnNode","createdNode","splitRight","appendLast","currParent","newParent","cloneNode","sibling","nextSibling","hasChildNodes","moveTextRangeIntoElement","startNode","endNode","newElement","findCommonRoot","temp","lastChild","rootChildren","afterLast","forEach","depthOfNode","inNode","theDepth","inNode1","inNode2","depth1","depth2","node1","node2","isElementAtBeginningOfBlock","textVal","isMediumEditorElement","previousSibling","nodeName","getBlockContainer","getFirstSelectableLeafNode","emptyElements","firstCell","querySelector","getFirstTextNode","textNode","ensureUrlHasProtocol","warn","undefined","console","oldName","newName","version","deprecatedMethod","cleanupAttrs","attrs","attr","removeAttribute","cleanupTags","tags","getClosestTag","nodes","replaceChild","setObject","pop","getObject","ButtonsData","bold","action","aria","tagNames","style","useQueryState","contentDefault","contentFA","key","italic","underline","strikethrough","superscript","subscript","image","quote","orderedlist","unorderedlist","pre","indent","outdent","justifyCenter","justifyFull","justifyLeft","justifyRight","header1","firstHeader","header2","secondHeader","removeFormat","editorDefaults","allowMultiParagraphSelection","buttonLabels","delay","diffLeft","diffTop","disableReturn","disableDoubleReturn","disableToolbar","disableEditing","autoLink","toolbarAlign","elementsContainer","imageDragging","standardizeSelectionStart","contentWindow","targetBlank","extensions","activeButtonClass","firstButtonClass","lastButtonClass","spellcheck","Extension","protoProps","Surrogate","checkState","queryCommandState","isActive","isAlreadyApplied","setActive","setInactive","getEditorElements","getEditorId","getEditorOption","option","helper","filterOnlyParentElements","FILTER_ACCEPT","FILTER_SKIP","findMatchingSelectionParent","getSelectionElement","importSelectionMoveCursorPastAnchor","selectionState","nodeInsideAnchorTagFunction","startContainer","startOffset","prevNode","currentNode","currentNodeIndex","setStart","getIndexRelativeToAdjacentEmptyBlocks","cursorContainer","cursorOffset","treeWalker","createTreeWalker","SHOW_ELEMENT","emptyBlocksCount","blockIsEmpty","selectionInContentEditableFalse","sawtrue","sawfalse","ce","getSelectionHtml","container","sel","cloneContents","getCaretOffsets","preCaretRange","postCaretRange","selectNodeContents","setEnd","endContainer","endOffset","left","right","rangeSelectsSingleNode","getSelectedParentElement","getSelectedElements","toRet","currNode","isCollapsed","containsNode","createRange","select","offset","anchorNode","Events","instance","events","customEvents","listeners","InputEventOnContenteditableSupported","attachDOMEvent","listener","useCapture","addEventListener","detachDOMEvent","indexOfListener","removeEventListener","n","detachAllDOMEvents","attachCustomEvent","setupListener","detachCustomEvent","indexOfCustomListener","detachAllCustomEvents","triggerCustomEvent","editable","detachExecCommand","attachToExecCommand","execCommandListener","execInfo","handleDocumentExecCommand","wrapExecCommand","unwrapExecCommand","wrapper","aCommandName","aShowDefaultUI","aValueArgument","orig","command","body","handleBodyMousedown","handleBodyClick","handleBodyFocus","contentCache","handleInput","keypressUpdateInput","handleDocumentSelectionChange","handleClick","handleBlur","handleKeypress","handleKeyup","handleKeydown","handleMouseover","handleDragging","handleDrop","handlePaste","focusElement","focus","updateFocus","eventObj","toFocus","toolbarEl","toolbar","getToolbarElement","anchorPreview","getExtensionByName","previewEl","getPreviewElement","hadFocus","getFocusedElement","lastMousedownTarget","some","externalEvent","updateInput","currentTarget","activeElement","DefaultButton","button","createButton","on","getButton","getAction","getAria","getTagNames","ariaLabel","evt","preventDefault","stopPropagation","execAction","knownState","queryState","styleVals","computedStyle","isMatch","getComputedStyle","getPropertyValue","val","AnchorExtension","AnchorDerived","hasForm","formSaveLabel","formCloseLabel","selectedParentElement","isDisplayed","showForm","getForm","form","createForm","getTemplate","template","anchorInputPlaceholder","anchorTarget","anchorInputCheckboxLabel","anchorButton","display","hideForm","getInput","linkValue","input","saveSelection","hideToolbarDefaultActions","setToolbarPosition","deactivate","getFormOpts","targetCheckbox","buttonCheckbox","opts","checkLinkFormat","checked","anchorButtonClass","doFormSave","completeFormSave","restoreSelection","createLink","checkSelection","re","doFormCancel","attachFormEvents","save","handleFormClick","handleTextboxKeyup","handleCloseClick","handleSaveClick","AnchorPreviewDeprecated","previewValueSelector","createPreview","attachToEditables","hidePreview","activeAnchor","showPreview","anchorEl","positionPreview","attachPreviewHandlers","halfOffsetWidth","defaultLeft","buttonHeight","offsetHeight","boundary","getBoundingClientRect","middleBoundary","offsetWidth","top","Math","round","bottom","pageYOffset","innerWidth","handleEditableMouseover","anchorExtension","selectElement","handleAnchorMouseout","anchorToPreview","off","instanceHandleAnchorMouseout","outerHTML","detachPreviewHandlers","handlePreviewMouseover","lastOver","getTime","hovering","handlePreviewMouseout","relatedTarget","updatePreview","durr","anchorPreviewHideDelay","clearInterval","intervalTimer","instanceHandlePreviewMouseover","instanceHandlePreviewMouseout","setInterval","FontSizeExtension","FontSizeDerived","fontSize","queryCommandValue","clearFontSize","handleSliderChange","hasAttribute","Button","charCodeAt","shiftKey","FormExtension","noop","AnchorForm","customClassOption","customClassOptionText","linkValidation","placeholderText","targetCheckboxText","AnchorPreview","hideDelay","AutoLink","WHITESPACE_CHARS","KNOWN_TLDS_FRAGMENT","LINK_REGEXP_TEXT","nodeIsNotInsideAnchorTag","KNOWN_TLDS_REGEXP","disableEventHandling","onKeypress","onBlur","blurEvent","performLinking","keyPressEvent","performLinkingTimeout","exportSelection","importSelection","error","contenteditable","paragraphs","querySelectorAll","documentModified","removeObsoleteAutoLinkSpans","performLinkingWithinElement","splitStartNodeIfNeeded","matchStartIndex","currentTextIndex","splitText","splitEndNodeIfNeeded","newNode","matchEndIndex","textIndexOfEndOfFarthestNode","endSplitPoint","spans","trimmedTextContent","charactersTrimmed","subtree","splitTextBeforeEnd","characterCount","lastChildNotExhausted","currentNodeValue","previousNode","matches","findLinkableText","linkCreated","matchIndex","findOrCreateMatchingTextNodes","linkRegExp","matchOk","matchEnd","shift","matchedNodes","startReached","textNodes","shouldNotLink","anchor","span","hrefWithProtocol","ImageDragging","handleDrag","dataTransfer","dropEffect","files","file","fileReader","FileReader","readAsDataURL","onload","img","src","FontSizeForm","PasteHandler","createReplacements","forcePlainText","cleanPastedHTML","cleanReplacements","cleanAttrs","cleanTags","pastedHTML","pastedPlain","dataFormatHTML","dataFormatPlain","clipboardData","getData","defaultPrevented","cleanPaste","elList","multiline","replacements","pasteHTML","workEl","fragmentBody","pasteBlock","cleanupSpans","filterCommonBlocks","filterLineBreak","isCommonBlock","previousElementSibling","removeWithParent","childElementCount","containerEl","newEl","isCEF","Placeholder","hideOnClick","initPlaceholders","attachEventHandlers","updatePlaceholder","showPlaceholder","hidePlaceholder","handleExternalInteraction","handleHidePlaceholderEvent","Toolbar","initThrottledMethods","createToolbar","staticToolbar","createToolbarButtons","commands","extension","li","btn","ul","getToolbarActionsElement","throttledPositionToolbar","positionToolbarIfShown","handleFocus","handleEditableClick","handleEditableKeyup","documentElement","handleDocumentMouseup","stickyToolbar","handleWindowScroll","handleWindowResize","hideTimeout","delayShowTimeout","hideToolbar","showToolbar","trigger","onShowToolbar","onHide","onHideToolbar","isToolbarDefaultActionsDisplayed","showToolbarDefaultActions","hideExtensionForms","multipleBlockElementsSelected","regexEmptyHTMLTags","regexBlockElements","selectionHTML","hasMultiParagraphs","modifySelection","selectionRange","adjacentNode","substr","newRange","preventSelectionUpdates","selectionElement","updateOnEmptySelection","showAndUpdateToolbar","setToolbarButtonStates","checkActiveButtons","manualStateChecks","updateExtensionState","positionStaticToolbar","positionToolbar","targetLeft","scrollTop","windowWidth","toolbarElement","containerRect","containerTop","containerCenter","width","toolbarHeight","toolbarWidth","ceil","extensionDefaults","paste","placeholder","handleDisabledEnterKeydown","handleTabKeydown","handleBlockDeleteKeydowns","isEmpty","isHeader","nextElementSibling","children","createElementsArray","selector","createContentEditable","setExtensionDefaults","initExtension","shouldAddDefaultAnchorPreview","shouldAdd","disableAnchorPreview","shouldAddDefaultPlaceholder","disablePlaceholders","shouldAddDefaultAutoLink","shouldAddDefaultImageDragging","textarea","div","uniqueId","attributesToClone","initElements","serialize","initToolbar","addToolbar","attachHandlers","initPlaceholder","defaultsBC","initAnchorPreview","initAnchorForm","initPasteHandler","initCommands","ext","buttonName","placeholderOpts","mergeOptions","deprecatedProperties","pair","execActionInternal","appendAction","statics","util","origElements","setup","unsubscribe","createEvent","elementid","callExtensions","funcName","stopSelectionUpdates","startSelectionUpdates","fullAction","exc","selectAllContents","selElement","focused","preSelectionRange","editableElementIndex","emptyBlocksIndex","inSelectionState","favorLaterSelectionAnchor","nextCharIndex","editableElement","charIndex","nodeStack","foundStart","stop","customEvent","initEvent","dispatchEvent","activate","major","minor","revision","parseInt","locals"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAE,WACAE,GAAAJ,EACAK,QAAA,EAUA,OANAP,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,QAAA,EAGAF,EAAAD,QAvBA,GAAAD,KAqCA,OATAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,YAGAV,EAAA,KDMM,SAASI,EAAQD,EAASH,GAE/B,YE9CDA,GAAQ,IACRA,EAAQ,IACRA,EAAQ,EAER,IAAIW,GAAQX,EAAQ,GAChBY,EAASZ,EAAQ,GAEjBa,EAAMF,EAAMG,aFiDbC,YAAa,MEhDdC,gBAAe,WACb,OAAQC,KAAM,4CAGhBC,OAAM,WACJ,MACEP,GAAAQ,cFkDC,OElDIC,UAAU,OACbT,EAAAQ,cFoDC,KACA,KACA,uBErDDR,EAAAQ,cFwDC,KACA,KACA,gBEzDDR,EAAAQ,cF4DC,MACA,KE7DKE,KAAKC,MAAML,MAEjBN,EAAAQ,cF+DC,KACA,KACA,yBEhEDR,EAAAQ,cAACP,GACCW,IAAI,MACJN,KAAMI,KAAKC,MAAML,KACjBO,SAAUH,KAAKI,aACfC,SAAUC,SAAU,OAAQ,SAAU,gBAExChB,EAAAQ,cFmEC,KACA,KACA,aEpEDR,EAAAQ,cAACP,GACCK,KAAMI,KAAKC,MAAML,KACjBO,SAAUH,KAAKI,iBAMvBA,aAAY,SAACR,GACXI,KAAKO,UAAUX,KAAMA,MAIzBN,GAAMO,OAAOP,EAAAQ,cAACN,EAAG,MAAIgB,SAASC,eAAe,SFyEvC,SAAS1B,EAAQD,GG5GvBC,EAAAD,QAAA,WACA,GAAA4B,KA0CA,OAvCAA,GAAAC,SAAA,WAEA,OADAC,MACAC,EAAA,EAAgBA,EAAAb,KAAAc,OAAiBD,IAAA,CACjC,GAAAE,GAAAf,KAAAa,EACAE,GAAA,GACAH,EAAAI,KAAA,UAAAD,EAAA,OAAwCA,EAAA,QAExCH,EAAAI,KAAAD,EAAA,IAGA,MAAAH,GAAAK,KAAA,KAIAP,EAAAG,EAAA,SAAAnC,EAAAwC,GACA,gBAAAxC,KACAA,IAAA,KAAAA,EAAA,KAEA,QADAyC,MACAN,EAAA,EAAgBA,EAAAb,KAAAc,OAAiBD,IAAA,CACjC,GAAA7B,GAAAgB,KAAAa,GAAA,EACA,iBAAA7B,KACAmC,EAAAnC,IAAA,GAEA,IAAA6B,EAAA,EAAYA,EAAAnC,EAAAoC,OAAoBD,IAAA,CAChC,GAAAE,GAAArC,EAAAmC,EAKA,iBAAAE,GAAA,IAAAI,EAAAJ,EAAA,MACAG,IAAAH,EAAA,GACAA,EAAA,GAAAG,EACKA,IACLH,EAAA,OAAAA,EAAA,aAAAG,EAAA,KAEAR,EAAAM,KAAAD,MAIAL,IHyHM,SAAS3B,EAAQD,EAASH,GIhHhC,QAAAyC,GAAAC,EAAAhB,GACA,OAAAQ,GAAA,EAAeA,EAAAQ,EAAAP,OAAmBD,IAAA,CAClC,GAAAE,GAAAM,EAAAR,GACAS,EAAAC,EAAAR,EAAA/B,GACA,IAAAsC,EAAA,CACAA,EAAAE,MACA,QAAAC,GAAA,EAAiBA,EAAAH,EAAAI,MAAAZ,OAA2BW,IAC5CH,EAAAI,MAAAD,GAAAV,EAAAW,MAAAD,GAEA,MAAQA,EAAAV,EAAAW,MAAAZ,OAAuBW,IAC/BH,EAAAI,MAAAV,KAAAW,EAAAZ,EAAAW,MAAAD,GAAApB,QAEG,CAEH,OADAqB,MACAD,EAAA,EAAiBA,EAAAV,EAAAW,MAAAZ,OAAuBW,IACxCC,EAAAV,KAAAW,EAAAZ,EAAAW,MAAAD,GAAApB,GAEAkB,GAAAR,EAAA/B,KAA2BA,GAAA+B,EAAA/B,GAAAwC,KAAA,EAAAE,WAK3B,QAAAE,GAAAlB,GAGA,OAFAW,MACAQ,KACAhB,EAAA,EAAeA,EAAAH,EAAAI,OAAiBD,IAAA,CAChC,GAAAE,GAAAL,EAAAG,GACA7B,EAAA+B,EAAA,GACAe,EAAAf,EAAA,GACAgB,EAAAhB,EAAA,GACAiB,EAAAjB,EAAA,GACAkB,GAAcH,MAAAC,QAAAC,YACdH,GAAA7C,GAGA6C,EAAA7C,GAAA0C,MAAAV,KAAAiB,GAFAZ,EAAAL,KAAAa,EAAA7C,IAAgCA,KAAA0C,OAAAO,KAIhC,MAAAZ,GAGA,QAAAa,KACA,GAAAC,GAAA3B,SAAAV,cAAA,SACAsC,EAAAC,GAGA,OAFAF,GAAAG,KAAA,WACAF,EAAAG,YAAAJ,GACAA,EAGA,QAAAK,KACA,GAAAC,GAAAjC,SAAAV,cAAA,QACAsC,EAAAC,GAGA,OAFAI,GAAAC,IAAA,aACAN,EAAAG,YAAAE,GACAA,EAGA,QAAAd,GAAAgB,EAAAtC,GACA,GAAA8B,GAAAS,EAAAC,CAEA,IAAAxC,EAAAyC,UAAA,CACA,GAAAC,GAAAC,GACAb,GAAAc,MAAAf,KACAU,EAAAM,EAAAC,KAAA,KAAAhB,EAAAY,GAAA,GACAF,EAAAK,EAAAC,KAAA,KAAAhB,EAAAY,GAAA,OACEJ,GAAAX,WACF,kBAAAoB,MACA,kBAAAA,KAAAC,iBACA,kBAAAD,KAAAE,iBACA,kBAAAC,OACA,kBAAAC,OACArB,EAAAK,IACAI,EAAAa,EAAAN,KAAA,KAAAhB,GACAU,EAAA,WACAV,EAAAuB,WAAAC,YAAAxB,GACAA,EAAAyB,MACAR,IAAAE,gBAAAnB,EAAAyB,SAGAzB,EAAAD,IACAU,EAAAiB,EAAAV,KAAA,KAAAhB,GACAU,EAAA,WACAV,EAAAuB,WAAAC,YAAAxB,IAMA,OAFAS,GAAAD,GAEA,SAAAmB,GACA,GAAAA,EAAA,CACA,GAAAA,EAAAhC,MAAAa,EAAAb,KAAAgC,EAAA/B,QAAAY,EAAAZ,OAAA+B,EAAA9B,YAAAW,EAAAX,UACA,MACAY,GAAAD,EAAAmB,OAEAjB,MAcA,QAAAK,GAAAf,EAAA4B,EAAAlB,EAAAF,GACA,GAAAb,GAAAe,EAAA,GAAAF,EAAAb,GAEA,IAAAK,EAAA6B,WACA7B,EAAA6B,WAAAC,QAAAC,EAAAH,EAAAjC,OACE,CACF,GAAAqC,GAAA3D,SAAA4D,eAAAtC,GACAuC,EAAAlC,EAAAkC,UACAA,GAAAN,IAAA5B,EAAAwB,YAAAU,EAAAN,IACAM,EAAAvD,OACAqB,EAAAmC,aAAAH,EAAAE,EAAAN,IAEA5B,EAAAI,YAAA4B,IAKA,QAAAN,GAAA1B,EAAAQ,GACA,GAAAb,GAAAa,EAAAb,IACAC,EAAAY,EAAAZ,KACAY,GAAAX,SAMA,IAJAD,GACAI,EAAAoC,aAAA,QAAAxC,GAGAI,EAAA6B,WACA7B,EAAA6B,WAAAC,QAAAnC,MACE,CACF,KAAAK,EAAAqC,YACArC,EAAAwB,YAAAxB,EAAAqC,WAEArC,GAAAI,YAAA/B,SAAA4D,eAAAtC,KAIA,QAAA2B,GAAAhB,EAAAE,GACA,GAAAb,GAAAa,EAAAb,IAEAE,GADAW,EAAAZ,MACAY,EAAAX,UAEAA,KAEAF,GAAA,uDAAuD0B,KAAAiB,SAAAC,mBAAAC,KAAAC,UAAA5C,MAAA,MAGvD,IAAA6C,GAAA,GAAAtB,OAAAzB,IAA6BQ,KAAA,aAE7BwC,EAAArC,EAAAmB,IAEAnB,GAAAmB,KAAAR,IAAAC,gBAAAwB,GAEAC,GACA1B,IAAAE,gBAAAwB,GArNA,GAAAvD,MACAwD,EAAA,SAAAC,GACA,GAAAC,EACA,mBAEA,MADA,mBAAAA,OAAAD,EAAAE,MAAAlF,KAAAmF,YACAF,IAGAG,EAAAL,EAAA,WACA,qBAAAM,KAAAC,OAAAC,UAAAC,UAAAC,iBAEApD,EAAA0C,EAAA,WACA,MAAAvE,UAAA4B,MAAA5B,SAAAkF,qBAAA,aAEAzC,EAAA,KACAD,EAAA,CAEAjE,GAAAD,QAAA,SAAA4B,EAAAL,GAKAA,QAGA,mBAAAA,GAAAyC,YAAAzC,EAAAyC,UAAAsC,IAEA,IAAA/D,GAAAO,EAAAlB,EAGA,OAFAU,GAAAC,EAAAhB,GAEA,SAAAsF,GAEA,OADAC,MACA/E,EAAA,EAAgBA,EAAAQ,EAAAP,OAAmBD,IAAA,CACnC,GAAAE,GAAAM,EAAAR,GACAS,EAAAC,EAAAR,EAAA/B,GACAsC,GAAAE,OACAoE,EAAA5E,KAAAM,GAEA,GAAAqE,EAAA,CACA,GAAA9D,GAAAD,EAAA+D,EACAvE,GAAAS,EAAAxB,GAEA,OAAAQ,GAAA,EAAgBA,EAAA+E,EAAA9E,OAAsBD,IAAA,CACtC,GAAAS,GAAAsE,EAAA/E,EACA,QAAAS,EAAAE,KAAA,CACA,OAAAC,GAAA,EAAkBA,EAAAH,EAAAI,MAAAZ,OAA2BW,IAC7CH,EAAAI,MAAAD,WACAF,GAAAD,EAAAtC,OAwGA,IAAAkF,GAAA,WACA,GAAA2B,KAEA,iBAAA9B,EAAA+B,GAEA,MADAD,GAAA9B,GAAA+B,EACAD,EAAAE,OAAAC,SAAA/E,KAAA,WJ0OM,SAASlC,EAAQD,GK1YvBC,EAAAD,QAAAQ,OLgZM,SAASP,EAAQD,EAASH,GAE/B,YMlZD,IAAIW,GAAQX,EAAQ,GAChBsH,EAAetH,EAAQ,EAE3BI,GAAOD,QAAUQ,EAAMG,aACrBC,YAAa,eAEbC,gBAAe,WACb,OACEC,KAAMI,KAAKkG,MAAMtG,OAIrBuG,gBAAe,WACb,OACEjG,IAAK,QAITkG,kBAAiB,WNqZd,GAAIC,GAAQrG,KMpZTsG,EAAMtG,KAAKuG,YACfvG,MAAKwG,OAAS,GAAIP,GAAaK,EAAKtG,KAAKkG,MAAM7F,SAC/CL,KAAKwG,OAAOC,UAAU,gBAAiB,SAACC,GACtCL,EAAKM,UAAW,EAChBN,EAAKO,OAAON,EAAIO,cAIpBC,qBAAoB,WAClB9G,KAAKwG,OAAOO,WAGdC,0BAAyB,SAACC,GACrBA,EAAUrH,OAASI,KAAKC,MAAML,MAASI,KAAK2G,UAC7C3G,KAAKO,UAAUX,KAAMqH,EAAUrH,OAG9BI,KAAK2G,WAAU3G,KAAK2G,UAAW,IAGpC9G,OAAM,WACJ,MAAOP,GAAMQ,cAAcE,KAAKkG,MAAMhG,KACpCH,UAAWC,KAAKkG,MAAMnG,UACtBmH,iBAAiB,EACjBC,yBAA0BC,OAAQpH,KAAKC,MAAML,SAIjDgH,OAAM,SAAChH,GACFI,KAAKkG,MAAM/F,UAAUH,KAAKkG,MAAM/F,SAASP,ON4Z1C,SAASb,EAAQD,EAASH,GO5chCG,EAAAC,EAAAD,QAAAH,EAAA,KACAG,EAAAkC,MAAAjC,EAAAC,GAAA,kLAAyM,MPkdnM,SAASD,EAAQD,EAASH,GQndhCG,EAAAC,EAAAD,QAAAH,EAAA,KACAG,EAAAkC,MAAAjC,EAAAC,GAAA,itIAA4uI,MRydtuI,SAASD,EAAQD,EAASH,GS1dhCG,EAAAC,EAAAD,QAAAH,EAAA,KACAG,EAAAkC,MAAAjC,EAAAC,GAAA,kuDAAyvD,MTgenvD,SAASD,EAAQD,EAASH;AU5dhC,aAAA6B,UAAAV,cAAA,OACA,SAAAuH,GAEA,YAEA,eAAAA,GAAA,CAEA,GACAC,GAAA,YACAC,EAAA,YACAC,EAAAH,EAAAI,QAAAF,GACAG,EAAAC,OACAC,EAAAC,OAAAN,GAAAO,MAAA,WACA,MAAA9H,MAAA+H,QAAA,kBAEAC,EAAAC,MAAAV,GAAAW,SAAA,SAAAnH,GAKA,IAJA,GACAF,GAAA,EACAsH,EAAAnI,KAAAc,OAEYqH,EAAAtH,EAASA,IACrB,GAAAA,IAAAb,YAAAa,KAAAE,EACA,MAAAF,EAGA,WAGAuH,EAAA,SAAA9F,EAAA+F,GACArI,KAAAsI,KAAAhG,EACAtC,KAAAuI,KAAAC,aAAAlG,GACAtC,KAAAqI,WAEAI,EAAA,SAAAC,EAAAC,GACA,QAAAA,EACA,SAAAP,GACA,aACA,6CAGA,SAAA/C,KAAAsD,GACA,SAAAP,GACA,wBACA,uCAGA,OAAAJ,GAAA9I,KAAAwJ,EAAAC,IAEAC,EAAA,SAAAC,GAOA,IANA,GACAC,GAAAlB,EAAA1I,KAAA2J,EAAAE,aAAA,cACAC,EAAAF,IAAAG,MAAA,UACApI,EAAA,EACAsH,EAAAa,EAAAlI,OAEYqH,EAAAtH,EAASA,IACrBb,KAAAgB,KAAAgI,EAAAnI,GAEAb,MAAAkJ,iBAAA,WACAL,EAAAtE,aAAA,QAAAvE,KAAAW,cAGAwI,EAAAP,EAAArB,MACA6B,EAAA,WACA,UAAAR,GAAA5I,MAmFA,IA9EAoI,EAAAb,GAAA8B,MAAA9B,GACA4B,EAAApI,KAAA,SAAAF,GACA,MAAAb,MAAAa,IAAA,MAEAsI,EAAAG,SAAA,SAAAX,GAEA,MADAA,IAAA,GACA,KAAAF,EAAAzI,KAAA2I,IAEAQ,EAAAI,IAAA,WACA,GAIAZ,GAHAa,EAAArE,UACAtE,EAAA,EACA4I,EAAAD,EAAA1I,OAEA4I,GAAA,CAEA,GACAf,GAAAa,EAAA3I,GAAA,GACA,KAAA4H,EAAAzI,KAAA2I,KACA3I,KAAAgB,KAAA2H,GACAe,GAAA,WAGA7I,EAAA4I,EAEAC,IACA1J,KAAAkJ,oBAGAC,EAAAtG,OAAA,WACA,GAIA8F,GAEA5E,EALAyF,EAAArE,UACAtE,EAAA,EACA4I,EAAAD,EAAA1I,OAEA4I,GAAA,CAGA,GAGA,KAFAf,EAAAa,EAAA3I,GAAA,GACAkD,EAAA0E,EAAAzI,KAAA2I,GACA,KAAA5E,GACA/D,KAAA2J,OAAA5F,EAAA,GACA2F,GAAA,EACA3F,EAAA0E,EAAAzI,KAAA2I,WAGA9H,EAAA4I,EAEAC,IACA1J,KAAAkJ,oBAGAC,EAAAS,OAAA,SAAAjB,EAAAkB,GACAlB,GAAA,EAEA,IACA/H,GAAAZ,KAAAsJ,SAAAX,GACAmB,EAAAlJ,EACAiJ,KAAA,YAEAA,KAAA,QAOA,OAJAC,IACA9J,KAAA8J,GAAAnB,GAGAkB,KAAA,GAAAA,KAAA,EACAA,GAEAjJ,GAGAuI,EAAAxI,SAAA,WACA,MAAAX,MAAAiB,KAAA,MAGAyG,EAAAqC,eAAA,CACA,GAAAC,IACAC,IAAAb,EACAc,YAAA,EACAC,cAAA,EAEA,KACAzC,EAAAqC,eAAAvC,EAAAF,EAAA0C,GACK,MAAAI,GACL,cAAAA,EAAAC,SACAL,EAAAE,YAAA,EACAxC,EAAAqC,eAAAvC,EAAAF,EAAA0C,SAGGtC,GAAAH,GAAA+C,kBACH9C,EAAA8C,iBAAAhD,EAAA8B,KAGGmB;AAmBH,SAAAlD,GACA,YAIA,IAFAA,EAAAjE,IAAAiE,EAAAjE,KAAAiE,EAAAmD,UAEAnD,EAAA9D,MAAA8D,EAAAjE,IACA,IAEA,WADA,IAAAG,MAEK,MAAAmD,IAKL,GAAA+D,GAAApD,EAAAoD,aAAApD,EAAAqD,mBAAArD,EAAAsD,gBAAA,SAAAtD,GACA,GACAuD,GAAA,SAAAC,GACA,MAAAlD,QAAAmD,UAAAnK,SAAAzB,KAAA2L,GAAAE,MAAA,0BAEAC,EAAA,WACAhL,KAAAiL,SAEAC,EAAA,SAAAD,EAAA3I,EAAA6I,GACAnL,KAAAiL,OACAjL,KAAAoL,KAAAH,EAAAnK,OACAd,KAAAsC,OACAtC,KAAAmL,YAEAE,EAAAL,EAAAF,UACAQ,EAAAJ,EAAAJ,UACAS,EAAAlE,EAAAkE,eACAC,EAAA,SAAAlJ,GACAtC,KAAAuI,KAAAvI,UAAAsI,KAAAhG,IAEAmJ,EAAA,8HAGAxC,MAAA,KACAyC,EAAAD,EAAA3K,OACA6K,EAAAtE,EAAAjE,KAAAiE,EAAAmD,WAAAnD,EACAuE,EAAAD,EAAAtI,gBACAwI,EAAAF,EAAArI,gBACAF,EAAAuI,EACAnI,EAAA6D,EAAA7D,KACAsI,EAAAzE,EAAAyE,KAEAC,EAAA1E,EAAA0E,YACAC,EAAA3E,EAAA2E,WAEAC,EAAA,wCAGA,KADAf,EAAAgB,KAAAZ,EAAAY,MAAA,EACAR,KACAF,EAAAV,UAAAW,EAAAC,MAAA,CAkHA,OA/GAC,GAAAtI,kBACAD,EAAAiE,EAAAjE,IAAA,SAAA+I,GACA,GAEAC,GADAC,EAAA7L,SAAA8L,gBAAA,mCAYA,OATAD,GAAAzI,KAAAuI,EACA,UAAAE,KACA,UAAAA,EAAAE,SAAA9G,cACA4G,EAAAJ,OAAA,MAEAG,EAAAD,EAAApB,MAAAkB,GACAI,EAAAJ,OAAAG,KAAA,KAGAC,IAGAjJ,EAAAC,gBAAA,SAAAwB,GACA,GAEA2H,GADAlK,EAAAuC,EAAAvC,IAMA,OAHA,QAAAA,IACAA,EAAA,4BAEAuC,YAAAqG,IACAsB,EAAA,QAAAlK,EACA,WAAAuC,EAAAsG,SACAqB,EAAA,WAAqC3H,EAAAoG,KAC5B,QAAApG,EAAAsG,SACTqB,EAAA,IAAAC,mBAAA5H,EAAAoG,MACSzH,EACTgJ,EAAA,WAAqChJ,EAAAqB,EAAAoG,MAErCuB,EAAA,IAAA9H,mBAAAG,EAAAoG,OAEOW,EACPA,EAAA1M,KAAAyM,EAAA9G,GADO,QAIPzB,EAAAE,gBAAA,SAAAoJ,GACA,UAAAA,EAAAC,UAAA,MAAAd,GACAA,EAAA3M,KAAAyM,EAAAe,IAGArB,EAAAuB,OAAA,SAAA3B,GACA,GAAA4B,GAAA7M,KAAAiL,IAEA,IAAAe,IAAAf,YAAAc,IAAAd,YAAAe,IAAA,CAOA,IANA,GACAc,GAAA,GACAC,EAAA,GAAAf,GAAAf,GACApK,EAAA,EACAmM,EAAAD,EAAAjM,OAEckM,EAAAnM,EAAaA,IAC3BiM,GAAAjF,OAAAoF,aAAAF,EAAAlM,GAEAgM,GAAA7L,KAAA8L,OACO,aAAAlC,EAAAK,IAAA,SAAAL,EAAAK,GAAA,CACP,IAAAM,EAKA,SAAAC,GAAA,mBAJA,IAAA0B,GAAA,GAAA3B,EACAsB,GAAA7L,KAAAkM,EAAAC,mBAAAlC,QAKOA,aAAAC,GACP,WAAAD,EAAAE,UAAAW,EACAe,EAAA7L,KAAA8K,EAAAb,SACS,QAAAA,EAAAE,SACT0B,EAAA7L,KAAAyL,mBAAAxB,SACS,QAAAA,EAAAE,UACT0B,EAAA7L,KAAAiK,SAGA,gBAAAA,KACAA,GAAA,IAGA4B,EAAA7L,KAAAyD,SAAAC,mBAAAuG,OAGAI,EAAA+B,QAAA,SAAA9K,GAIA,MAHA6C,WAAArE,SACAwB,EAAA,MAEA,GAAA4I,GAAAlL,KAAAiL,KAAAhK,KAAA,IAAAqB,EAAA,QAEA+I,EAAA1K,SAAA,WACA,8BAEA2K,EAAA+B,MAAA,SAAAC,EAAAC,EAAAjL,GACA,GAAAkL,GAAArI,UAAArE,MAIA,OAHA,GAAA0M,IACAlL,EAAA,MAEA,GAAA4I,GACAlL,KAAAiL,KAAAoC,MAAAC,EAAAE,EAAA,EAAAD,EAAAvN,KAAAiL,KAAAnK,QACAwB,EACAtC,KAAAmL,WAGAG,EAAA3K,SAAA,WACA,uBAEA2K,EAAAmC,MAAA,WACAzN,KAAAoL,KAAA,QACApL,MAAAiL,MAEAD,GACG3D,EAEHA,GAAA9D,KAAA,SAAAmK,EAAArN,GACA,GAAAiC,GAAAjC,IAAAiC,MAAA,MACAqL,EAAA,GAAAlD,EACA,IAAAiD,EACA,OAAA7M,GAAA,EAAAsH,EAAAuF,EAAA5M,OAA6CqH,EAAAtH,EAASA,IACtDmL,YAAA0B,EAAA7M,YAAAmL,YACA2B,EAAAf,OAAAc,EAAA7M,GAAA+M,QAGAD,EAAAf,OAAAc,EAAA7M,GAIA,IAAAgE,GAAA8I,EAAAP,QAAA9K,EAIA,QAHAuC,EAAAwI,OAAAxI,EAAAgJ,cACAhJ,EAAAwI,MAAAxI,EAAAgJ,aAEAhJ,EAGA,IAAAiJ,GAAAnG,OAAAmG,gBAAA,SAAAjD,GACA,MAAAA,GAAAkD,UAEA1G,GAAA9D,KAAAuH,UAAAgD,EAAA,GAAAzG,GAAA9D,OACC,mBAAAgH,aAAA,mBAAAjF,iBAAAtF,KAAAgO,SAAAhO,MAED,SAAAiO,EAAAC,GACA,YAEAnP,GAAAD,QAAAoP,GAQClO,KAAA,WAED,YA6hKA,SAAAiG,GAAAkI,EAAA9N,GAEA,MAAAL,MAAAoO,KAAAD,EAAA9N,GA7hKA,GAAAgO,IAEA,SAAA/I,GAIA,QAAAgJ,GAAA5M,EAAA6M,EAAAC,GACAA,IACAA,EAAAlJ,EAGA,KACA,OAAAzE,GAAA,EAA2BA,EAAAa,EAAAZ,OAAkBD,IAAA,CAC7C,GAAAxB,GAAAqC,EAAAb,EACA,MAAAxB,IAAAmP,IAAA,CACA,IAAAD,EAGA,MAFAC,GAAAnP,MAKAmP,IAAAnP,GAEA,MAAAmP,GACS,MAAA9H,KAMT,QAAA+H,GAAAC,EAAAC,GACA,GAAAC,GACAC,EAAA5G,MAAA6C,UAAAuC,MAAAnO,KAAAiG,UAAA,EACAwJ,QACA,QAAA9N,GAAA,EAAuBA,EAAAgO,EAAA/N,OAAoBD,IAAA,CAC3C,GAAAiO,GAAAD,EAAAhO,EACA,IAAAiO,EACA,IAAAF,IAAAE,GACAA,EAAAC,eAAAH,IACA,mBAAAE,GAAAF,KACAF,GAAAC,EAAAI,eAAAH,MAAA,KACAD,EAAAC,GAAAE,EAAAF,IAKA,MAAAD,GAGAN,GAIAW,KAAA,gCAAAzJ,UAAA0J,SAAA,aAAA1J,UAAA0J,SAA6J,OAA7J,GAAAC,QAAA,sCAA6JC,KAAA5J,UAAAC,WAG7J4J,MAAA9J,EAAAC,UAAA8J,SAAAC,cAAApH,QAAA,UAGAqH,SACAC,UAAA,EACAC,IAAA,EACAC,MAAA,GACAC,OAAA,GACAC,MAAA,GACAC,OAAA,IAOAC,cAAA,SAAAC,GACA,MAAA/P,MAAAoP,OAAAW,EAAAC,UAAAhQ,KAAAoP,OAAAW,EAAAE,SACA,GAGA,GASAC,MAAA,SAAAH,EAAAI,GACA,GAAAZ,GAAAQ,EAAAK,KAQA,OALA,QAAAb,IACAA,EAAA,OAAAQ,EAAAM,SAAAN,EAAAM,SAAAN,EAAAR,UAIA,IAAAtH,MAAAqI,QAAAH,GACAZ,IAAAY,EAGA,KAAAA,EAAAjI,QAAAqH,IACA,GAGA,GAGAgB,gBAAA,sDAEAC,OAAA,WACA,GAAAhD,KAAA,GAAAiD,OAAAxI,MAAA6C,UAAAuC,MAAAnO,KAAAiG,WACA,OAAAsJ,GAAAvJ,MAAAlF,KAAAwN,IAGAkD,SAAA,WACA,GAAAlD,KAAA,GAAAiD,OAAAxI,MAAA6C,UAAAuC,MAAAnO,KAAAiG,WACA,OAAAsJ,GAAAvJ,MAAAlF,KAAAwN,IAGAmD,QAAA,SAAAC,EAAAC,GAEA,QAAAC,MADA,GAAAC,GAAAF,EAAA/F,SAMA,OAJAgG,GAAAhG,UAAA8F,EAAA9F,UACA+F,EAAA/F,UAAA,GAAAgG,GACAD,EAAA/F,UAAAkG,YAAAJ,EACAC,EAAA/F,UAAA2D,GAAA,EAAAoC,EAAA/F,UAAAiG,GACAF,GAUAI,gCAAA,SAAAC,EAAAC,EAAAC,GACA,GACAC,GADAC,GAAA,EAEAC,EAAAH,EAAAI,mBAAAN,EAAAO,WAAAC,UAAA,QAKA,KADAL,EAAAE,EAAAF,WACAA,GAAA,CACA,GAAAA,IAAAF,EACAG,GAAA,MACiB,IAAAA,GACjB,IAAAD,EAAAM,UAAAN,EAAAO,WAAAP,EAAAO,UAAA9J,OAAAhH,OAAA,EACA,KAGAuQ,GAAAE,EAAAF,WAGA,MAAAA,IAGAQ,aAAA,SAAAC,EAAAC,EAAAC,GACA,IAAAF,IAAAC,EACA,QAEA,IAAAC,GAAAF,IAAAC,EACA,QAGA,KADA,GAAAE,GAAAF,EAAArO,WACA,OAAAuO,GAAA,CACA,GAAAA,IAAAH,EACA,QAEAG,KAAAvO,WAEA,UAIAwO,UAAA,SAAAvP,GACA,SAAAA,GAAA,IAAAA,EAAAgP,WAGAQ,IAAAC,KAAAD,IAGAE,SAAA,SAAAC,EAAAC,GACA,GACA/D,GACAhB,EACA5M,EAHA4R,EAAA,GAIAC,EAAA,KACAC,EAAA,EACAC,EAAA,WACAD,EAAAN,KAAAD,MACAM,EAAA,KACA7R,EAAA0R,EAAApN,MAAAsJ,EAAAhB,GACAiF,IACAjE,EAAAhB,EAAA,MAQA,OAJA+E,IAAA,IAAAA,IACAA,EAAAC,GAGA,WACA,GAAAL,GAAAC,KAAAD,MACAS,EAAAL,GAAAJ,EAAAO,EAiBA,OAfAlE,GAAAxO,KACAwN,EAAArI,UACA,GAAAyN,KAAAL,GACAE,IACAI,aAAAJ,GACAA,EAAA,MAEAC,EAAAP,EACAvR,EAAA0R,EAAApN,MAAAsJ,EAAAhB,GACAiF,IACAjE,EAAAhB,EAAA,OAEiBiF,IACjBA,EAAAK,WAAAH,EAAAC,IAEAhS,IAIAmS,WAAA,SAAAC,EAAAC,GACA,IAAAD,EACA,QAGA,IACA,OAAAA,EAAArB,SAAA,CACA,GAAAsB,EAAAD,GACA,MAAAA,EAGA,IAAAA,EAAAjK,aAAA,uBACA,SAIAiK,IAAAtP,iBACasP,EAEb,WAGAE,aAAA,SAAApG,GAGA,MAAAjF,QAAAiF,GAAA/E,QAAA,cAAmDA,QAAA,aAAsBA,QAAA,aAAsBA,QAAA,gBAI/FoL,kBAAA,SAAAC,EAAAC,GACA,GAAAC,GAAAC,EAAAC,EAAAC,EAAAxB,EAAAyB,EAAAC,CAEA,IAAAP,EAAAQ,sBAAA,cACA,IACA,MAAAR,GAAAS,YAAA,gBAAAR,GACiB,MAAAS,IAIjB,GADAR,EAAAF,EAAAW,YAAAC,eACAV,EAAAW,YAAAX,EAAAY,WAAA,CAKA,GAJAX,EAAAD,EAAAW,WAAA,GACAN,EAAAJ,EAAAY,wBAGA,IAAAR,EAAAhC,UAAAgC,EAAA/B,YAAA2B,EAAA5S,YACA,IAAAgT,EAAAhC,UAAAgC,EAAA9M,YAAA0M,EAAA5S,WAAA,CACA,KAAAgT,EAAAjQ,YACA,IAAAiQ,EAAAjQ,WAAAW,WAAAvD,SACA6S,EAAAjQ,WAAAqF,aAAA,wBACA4K,IAAAjQ,UAEA6P,GAAAa,WAAAT,GAOA,IALAJ,EAAAc,iBAEAb,EAAAJ,EAAAtT,cAAA,OACA0T,EAAA3M,UAAAwM,EACAI,EAAAL,EAAAkB,yBACAd,EAAAhP,YACAyN,EAAAuB,EAAAhP,WACAkP,EAAAD,EAAAlR,YAAA0P,EAEAsB,GAAAgB,WAAAd,GAGAC,IACAH,IAAAiB,aACAjB,EAAAkB,cAAAf,GACAH,EAAAmB,UAAA,GACApB,EAAAqB,kBACArB,EAAAsB,SAAArB,MAKAsB,kBAAA,SAAAzD,GAGA,MAFApR,MAAA8U,WAAA,iEAEAC,EAAAF,kBAAAzD,IAGA4D,kBAAA,SAAA5D,GAGA,MAFApR,MAAA8U,WAAA,iEAEAC,EAAAC,kBAAA5D,IAGA6D,iBAAA,SAAAzB,GAGA,MAFAxT,MAAA8U,WAAA,+DAEAC,EAAAE,iBAAAzB,IAGA0B,gBAAA,SAAA9B,EAAA+B,GACA,GAAAC,GAAAL,EAAAE,iBAAAF,EAAAC,kBAAA5B,GAIA,mBAAA+B,GAAAC,EAAA5B,IACA,eAAA4B,EAAA5B,GAAA9P,WAAAyR,QAAA1P,cACA,MAAA2N,GAAAS,YAAA,kBASA,IAPAuB,EAAAD,cACAA,EAAA,KAMAnV,KAAAgP,KAAA,CACA,kBAAAmG,EACA,MAAA/B,GAAAS,YAAA,YAAAsB,EAEAA,GAAA,IAAAA,EAAA,IAEA,MAAA/B,GAAAS,YAAA,iBAAAsB,IAaAE,eAAA,SAAA7B,EAAA8B,GACA,GAAAzU,GAAA0U,EAAAD,IAAA,CACA,UAAA9B,EAAA2B,QAAA1P,cACA+N,EAAAgC,OAAA,aAIA,KAFAhC,IAAA9N,qBAAA,KAEA7E,EAAA,EAA2BA,EAAA2S,EAAA1S,OAAeD,GAAA,IAC1C,IAAA0U,OAAA/B,EAAA3S,GAAA4U,WAAA7R,KAAA8R,SACAlC,EAAA3S,GAAA2U,OAAA,WAMAG,kBAAA,SAAAnC,EAAAoC,GACA,GACA/U,GACAY,EAFAuH,EAAA4M,EAAA3M,MAAA,IAGA,UAAAuK,EAAA2B,QAAA1P,cACA,IAAAhE,EAAA,EAA2BA,EAAAuH,EAAAlI,OAAoBW,GAAA,EAC/C+R,EAAA9K,UAAAa,IAAAP,EAAAvH,QAIA,KADA+R,IAAA9N,qBAAA,KACA7E,EAAA,EAA2BA,EAAA2S,EAAA1S,OAAeD,GAAA,EAC1C,IAAAY,EAAA,EAA+BA,EAAAuH,EAAAlI,OAAoBW,GAAA,EACnD+R,EAAA3S,GAAA6H,UAAAa,IAAAP,EAAAvH,KAMAoU,WAAA,SAAA5D,GACA,IAAAA,EACA,QAEA,WAAAA,EAAAkD,QAAA1P,cACA,QAKA,KAFA,GAAA/B,GAAAuO,EAAAvO,WACAyR,EAAAzR,EAAAyR,QAAA1P,eACAzF,KAAA8V,iBAAApS,IAAA,QAAAyR,GAAA,CACA,UAAAA,EACA,QAGA,IADAzR,gBACAA,MAAAyR,QAGA,QAFAA,GAAAzR,EAAAyR,QAAA1P,cAKA,UAGAsQ,aAAA,SAAA3E,EAAA4E,GACA,UAAAA,EAAAb,QAAA1P,cAAA,CAIA,GAAA/E,GAAAsV,EAAAC,aAEA,OAAAvV,EAAAuV,cAAAd,QAAA1P,gBACAzF,KAAAkW,OAAAxV,EAAAuV,cAAA7E,GAIA2D,EAAAoB,WAAA/E,EAAA4E,EAAAxR,WAAAwR,EAAAxR,WAAA4R,YAAAtV,WAIAuV,cAAA,SAAAL,GACAhW,KAAA8U,WAAA,mCAEA9U,KAAAkW,OAAAF,IAAA5E,gBAiCAkF,gBAAA,SAAApF,EAAAqF,EAAAC,GAMA,IALA,GAAAC,GAAAF,EACAG,EAAA,KACAC,GAAAH,EAGAC,IAAAvF,GAAA,CACA,GAGA0F,GAHAC,EAAAJ,EAAA/S,WACAoT,EAAAD,EAAAE,WAAA,GACA5F,EAAAwF,EAAAF,EAAAI,EAAArS,UAeA,KAXAkS,IACAC,EAEAG,EAAAvU,YAAAmU,GAGAE,EAAAF,GAGAA,EAAAI,EAEA3F,GAAA,CACA,GAAA6F,GAAA7F,EAAA8F,WAEA9F,KAAAsF,GACAtF,EAAA+F,gBAKA/F,IAAA4F,WAAA,GAJA5F,EAAAzN,WAAAC,YAAAwN,GAOAA,EAAAiF,aACAM,EAAAnU,YAAA4O,GAGAA,EAAAwF,EAAAK,EAAA,OAIA7F,EAAAzN,WAAAC,YAAAwN,IACAA,EAAA+F,iBAAA/F,EAAAiF,cACAM,EAAAnU,YAAA4O,GAGAA,EAAA6F,GAKAJ,GACAF,EAAAnU,YAAAqU,GAGAH,EAAAI,EAGA,MAAAH,IAGAS,yBAAA,SAAAC,EAAAC,EAAAC,GACA,IAAAF,IAAAC,EACA,QAGA,IAAAnG,GAAAlR,KAAAuX,eAAAH,EAAAC,EACA,KAAAnG,EACA,QAGA,IAAAmG,IAAAD,EAAA,CACA,GAAAI,GAAAJ,EAAA1T,WACAsT,EAAAI,EAAAH,WAQA,OAPAO,GAAA7T,YAAAyT,GACAE,EAAA/U,YAAA6U,GACAJ,EACAQ,EAAAlT,aAAAgT,EAAAN,GAEAQ,EAAAjV,YAAA+U,GAEAA,EAAAJ,gBASA,OAHA1S,GACAiT,EACApG,EAHAqG,KAIA7W,EAAA,EAA2BA,EAAAqQ,EAAA7M,WAAAvD,OAAgCD,IAE3D,GADAwQ,EAAAH,EAAA7M,WAAAxD,GACA2D,EAIiB,CACjB,GAAAxE,KAAA6R,aAAAR,EAAAgG,GAAA,IACAI,EAAApG,CACA,OAEAqG,EAAA1W,KAAAqQ,OARArR,MAAA6R,aAAAR,EAAA+F,GAAA,KACA5S,EAAA6M,EAYA,IAAAsG,GAAAF,EAAAR,YACAxD,EAAAvC,EAAAE,cAAAkD,wBAsCA,OAnCA9P,KAAA4S,GACA5S,EAAAd,WAAAC,YAAAa,GACAiP,EAAAlR,YAAAiC,IAEAiP,EAAAlR,YAAAvC,KAAAsW,gBAAA9R,EAAA4S,IAIAM,EAAAE,QAAA,SAAA5B,GACAA,EAAAtS,WAAAC,YAAAqS,GACAvC,EAAAlR,YAAAyT,KAIAyB,IAAAJ,GACAI,EAAA/T,WAAAC,YAAA8T,GACAhE,EAAAlR,YAAAkV,IAEAhE,EAAAlR,YAAAvC,KAAAsW,gBAAAmB,EAAAJ,GAAA,IAIAC,EAAA/U,YAAAkR,GAEAgE,EAAA/T,aAAAwN,EAEAA,EAAA5M,aAAAgT,EAAAG,GACaE,EAEbzG,EAAA5M,aAAAgT,EAAAK,GAGAzG,EAAA3O,YAAA+U,GAGAA,EAAAJ,iBAIAW,YAAA,SAAAC,GAGA,IAFA,GAAAC,GAAA,EACA9F,EAAA6F,EACA,OAAA7F,EAAAvO,YACAuO,IAAAvO,WACAqU,GAEA,OAAAA,IAGAR,eAAA,SAAAS,EAAAC,GAMA,IALA,GAAAC,GAAAlY,KAAA6X,YAAAG,GACAG,EAAAnY,KAAA6X,YAAAI,GACAG,EAAAJ,EACAK,EAAAJ,EAEAC,IAAAC,GACAD,EAAAC,GACAC,IAAA1U,WACAwU,GAAA,IAEAG,IAAA3U,WACAyU,GAAA,EAIA,MAAAC,IAAAC,GACAD,IAAA1U,WACA2U,IAAA3U,UAGA,OAAA0U,IAIAE,4BAAA,SAAArG,GAGA,IAFA,GAAAsG,GACAvB,GACAhX,KAAA8V,iBAAA7D,KAAAjS,KAAAwY,sBAAAvG,IAAA,CAEA,IADA+E,EAAA/E,EACA+E,IAAAyB,iBAEA,GADAF,EAAA,IAAAvB,EAAArF,SAAAqF,EAAApF,UAAAoF,EAAAZ,YACAmC,EAAAzX,OAAA,EACA,QAGAmR,KAAAvO,WAEA,UAGA8U,sBAAA,SAAAxC,GACA,MAAAA,IAAA,IAAAA,EAAArE,YAAAqE,EAAAjN,aAAA,wBAGA+M,iBAAA,SAAAE,GACA,MAAAA,IAAA,IAAAA,EAAArE,UAAA,KAAA3R,KAAAuQ,eAAArI,QAAA8N,EAAA0C,SAAAjT,gBAGAkT,kBAAA,SAAA3C,GACA,MAAAhW,MAAA+S,WAAAiD,EAAA,SAAAxC,GACA,MAAAnF,GAAAyH,iBAAAtC,KAAAnF,EAAAyH,iBAAAtC,EAAA9P,eAIAkV,2BAAA,SAAA5C,GACA,KAAAA,KAAAxR,YACAwR,IAAAxR,UAGA,KADA,GAAAqU,IAAA,yDACA,KAAAA,EAAA3Q,QAAA8N,EAAA0C,SAAAjT,gBAEAuQ,IAAAtS,UAGA,cAAAsS,EAAA0C,SAAAjT,cAAA,CACA,GAAAqT,GAAA9C,EAAA+C,cAAA,SACAD,KACA9C,EAAA8C,GAGA,MAAA9C,IAGAgD,iBAAA,SAAAhD,GACA,OAAAA,EAAArE,SACA,MAAAqE,EAGA,QAAAnV,GAAA,EAA2BA,EAAAmV,EAAA3R,WAAAvD,OAA+BD,IAAA,CAC1D,GAAAoY,GAAAjZ,KAAAgZ,iBAAAhD,EAAA3R,WAAAxD,GACA,WAAAoY,EACA,MAAAA,GAGA,aAGAC,qBAAA,SAAA3D,GACA,WAAAA,EAAArN,QAAA,OACA,UAAAqN,EAEAA,GAGA4D,KAAA,WACAC,SAAA9T,EAAA+T,SAAA,kBAAA/T,GAAA+T,QAAAF,MACA7T,EAAA+T,QAAAF,KAAAjU,MAAAI,EAAA+T,QAAAlU,YAIA2P,WAAA,SAAAwE,EAAAC,EAAAC,GAEA,GAAAra,GAAAma,EAAA,8BAAAC,EAAA,WACAC,KACAra,GAAA,uBAAAqa,GAEAnL,EAAA8K,KAAAha,IAGAsa,iBAAA,SAAAH,EAAAC,EAAA/L,EAAAgM,GAEAnL,EAAAyG,WAAAwE,EAAAC,EAAAC,GACA,kBAAAxZ,MAAAuZ,IACAvZ,KAAAuZ,GAAArU,MAAAlF,KAAAwN,IAIAkM,aAAA,SAAAlG,EAAAmG,GACAA,EAAA/B,QAAA,SAAAgC,GACApG,EAAAqG,gBAAAD,MAIAE,YAAA,SAAAtG,EAAAuG,GACAA,EAAAnC,QAAA,SAAA1X,GACAsT,EAAA2B,QAAA1P,gBAAAvF,GACAsT,EAAA9P,WAAAC,YAAA6P,IAEaxT,OAIbga,cAAA,SAAAxG,EAAAtT,GACA,MAAAF,MAAA+S,WAAAS,EAAA,SAAAwC,GACA,MAAAA,GAAAb,QAAA1P,gBAAAvF,EAAAuF,iBAIAyQ,OAAA,SAAA1C,EAAAJ,GAMA,OALAK,GAAAL,EAAAkB,yBACA2F,EAAAhS,MAAA6C,UAAAuC,MAAAnO,KAAAsU,EAAAnP,YAIAxD,EAAA,EAA2BA,EAAAoZ,EAAAnZ,OAAkBD,IAC7C4S,EAAAlR,YAAA0X,EAAApZ,GAGA4S,GAAApP,WAAAvD,OACA0S,EAAA9P,WAAAwW,aAAAzG,EAAAD,GAEAA,EAAA9P,WAAAC,YAAA6P,IAIA2G,UAAA,SAAA7R,EAAAoN,EAAAlH,GAGA,GAAA9M,GAAA4G,EAAAW,MAAA,KACA5J,EAAAqC,EAAA0Y,MACAzX,EAAA2L,EAAA5M,GAAA,EAAA8M,EACA,OAAA7L,IAAAtD,EAAAsD,EAAAtD,GAAAqW,EAAA0D,QAGAiB,UAAA,SAAA/R,EAAAiG,EAAAC,GAGA,MAAAF,GAAAhG,IAAAW,MAAA,QAAAsF,EAAAC,MAIClJ,OAED,IAAAgV,IACA,WAGAA,GACAC,MACAjS,KAAA,OACAkS,OAAA,OACAC,KAAA,OACAC,UAAA,cACAC,OACA/L,KAAA,cACA8G,MAAA,YAEAkF,eAAA,EACAC,eAAA,WACAC,UAAA,6BACAC,IAAA,KAEAC,QACA1S,KAAA,SACAkS,OAAA,SACAC,KAAA,SACAC,UAAA,UACAC,OACA/L,KAAA,aACA8G,MAAA,UAEAkF,eAAA,EACAC,eAAA,kBACAC,UAAA,+BACAC,IAAA,KAEAE,WACA3S,KAAA,YACAkS,OAAA,YACAC,KAAA,YACAC,UAAA,KACAC,OACA/L,KAAA,kBACA8G,MAAA,aAEAkF,eAAA,EACAC,eAAA,kBACAC,UAAA,kCACAC,IAAA,KAEAG,eACA5S,KAAA,gBACAkS,OAAA,gBACAC,KAAA,iBACAC,UAAA,UACAC,OACA/L,KAAA,kBACA8G,MAAA,gBAEAkF,eAAA,EACAC,eAAA,WACAC,UAAA,uCAEAK,aACA7S,KAAA,cACAkS,OAAA,cACAC,KAAA,cACAC,UAAA,OAIAG,eAAA,uBACAC,UAAA,qCAEAM,WACA9S,KAAA,YACAkS,OAAA,YACAC,KAAA,YACAC,UAAA,OAIAG,eAAA,uBACAC,UAAA,mCAEAO,OACA/S,KAAA,QACAkS,OAAA,QACAC,KAAA,QACAC,UAAA,OACAG,eAAA,eACAC,UAAA,mCAEAQ,OACAhT,KAAA,QACAkS,OAAA,oBACAC,KAAA,aACAC,UAAA,cACAG,eAAA,iBACAC,UAAA,qCAEAS,aACAjT,KAAA,cACAkS,OAAA,oBACAC,KAAA,eACAC,UAAA,MACAE,eAAA,EACAC,eAAA,YACAC,UAAA,iCAEAU,eACAlT,KAAA,gBACAkS,OAAA,sBACAC,KAAA,iBACAC,UAAA,MACAE,eAAA,EACAC,eAAA,gBACAC,UAAA,iCAEAW,KACAnT,KAAA,MACAkS,OAAA,aACAC,KAAA,oBACAC,UAAA,OACAG,eAAA,cACAC,UAAA,oCAEAY,QACApT,KAAA,SACAkS,OAAA,SACAC,KAAA,SACAC,YACAG,eAAA,gBACAC,UAAA,gCAEAa,SACArT,KAAA,UACAkS,OAAA,UACAC,KAAA,UACAC,YACAG,eAAA,gBACAC,UAAA,iCAEAc,eACAtT,KAAA,gBACAkS,OAAA,gBACAC,KAAA,iBACAC,YACAC,OACA/L,KAAA,aACA8G,MAAA,UAEAmF,eAAA,WACAC,UAAA,sCAEAe,aACAvT,KAAA,cACAkS,OAAA,cACAC,KAAA,eACAC,YACAC,OACA/L,KAAA,aACA8G,MAAA,WAEAmF,eAAA,WACAC,UAAA,uCAEAgB,aACAxT,KAAA,cACAkS,OAAA,cACAC,KAAA,eACAC,YACAC,OACA/L,KAAA,aACA8G,MAAA,QAEAmF,eAAA,WACAC,UAAA,oCAEAiB,cACAzT,KAAA,eACAkS,OAAA,eACAC,KAAA,gBACAC,YACAC,OACA/L,KAAA,aACA8G,MAAA,SAEAmF,eAAA,WACAC,UAAA,qCAEAkB,SACA1T,KAAA,UACAkS,OAAA,SAAAna,GACA,gBAAAA,EAAA4b,aAEAxB,KAAA,SAAApa,GACA,MAAAA,GAAA4b,aAEAvB,SAAA,SAAAra,GACA,OAAAA,EAAA4b,cAEApB,eAAA,aAEAqB,SACA5T,KAAA,UACAkS,OAAA,SAAAna,GACA,gBAAAA,EAAA8b,cAEA1B,KAAA,SAAApa,GACA,MAAAA,GAAA8b,cAEAzB,SAAA,SAAAra,GACA,OAAAA,EAAA8b,eAEAtB,eAAA,aAIAuB,cACA9T,KAAA,eACAmS,KAAA,oBACAD,OAAA,eACAK,eAAA,WACAC,UAAA,mCAKA,IAAAuB,IACA,WAGAA,GACAC,8BAAA,EACAhc,SAAA,kEACAic,cAAA,EACAC,MAAA,EACAC,SAAA,EACAC,QAAA,IACAC,eAAA,EACAC,qBAAA,EACAC,gBAAA,EACAC,gBAAA,EACAC,UAAA,EACAC,aAAA,SACAC,mBAAA,EACAC,eAAA,EACAC,2BAAA,EACAC,cAAA9X,OACA8L,cAAA5Q,SACAyb,YAAA,KACAE,aAAA,KACAkB,aAAA,EACAC,cACAC,kBAAA,8BACAC,iBAAA,6BACAC,gBAAA,4BACAC,YAAA,KAIA,IAAAC,IACA,WAKAA,EAAA,SAAAtd,GACAgO,EAAAmC,OAAAxQ,KAAAK,IAGAsd,EAAAnN,OAAA,SAAAoN,GAyBA,GACA7L,GADAD,EAAA9R,IAQA+R,GADA6L,KAAA7O,eAAA,eACA6O,EAAA5M,YAEA,WACA,MAAAc,GAAA5M,MAAAlF,KAAAmF,YAKAkJ,EAAAmC,OAAAuB,EAAAD,EAIA,IAAA+L,GAAA,WACA7d,KAAAgR,YAAAe,EAWA,OATA8L,GAAA/S,UAAAgH,EAAAhH,UACAiH,EAAAjH,UAAA,GAAA+S,GAEAD,GACAvP,EAAAmC,OAAAuB,EAAAjH,UAAA8S,GAKA7L,GAGA4L,EAAA7S,WAQAsD,KAAA,aAOAwC,KAAAwI,OASA9Q,KAAA8Q,OAaA0E,WAAA1E,OASArS,QAAAqS,OAkBA2E,kBAAA3E,OAUA4E,SAAA5E,OAaA6E,iBAAA7E,OAUA8E,UAAA9E,OAYA+E,YAAA/E,OAgBA9T,OAAA8T,OASA5Y,SAAA4Y,OAQAgF,kBAAA,WACA,MAAApe,MAAA4Q,KAAAzC,UAQAkQ,YAAA,WACA,MAAAre,MAAA4Q,KAAA5R,IAQAsf,gBAAA,SAAAC,GACA,MAAAve,MAAA4Q,KAAAvQ,QAAAke,MAeA,aAGA,KACA,MACA,aAEA3G,QAAA,SAAA4G,GACAb,EAAA7S,UAAA0T,GAAA,WACA,MAAAxe,MAAA4Q,KAAA4N,GAAAtZ,MAAAlF,KAAA4Q,KAAAzL,gBAKA,IAAA4P,IAEA,WAGA,QAAA0J,GAAAxM,GACA,MAAA5D,GAAAyH,iBAAA7D,GACAR,WAAAiN,cAEAjN,WAAAkN,YAIA5J,GACA6J,4BAAA,SAAA3L,EAAAmK,GACA,GACA7J,GACAP,EAFAM,EAAA8J,EAAApJ,cAIA,YAAAV,EAAAY,YACA,GAGAX,EAAAD,EAAAW,WAAA,GACAjB,EAAAO,EAAAY,wBAEA9F,EAAA0E,WAAAC,EAAAC,KAGA4L,oBAAA,SAAAzB,GACA,MAAApd,MAAA4e,4BAAA,SAAApL,GACA,MAAAA,GAAAzK,aAAA,wBACaqU,IAIb0B,oCAAA,SAAAC,EAAAxL,GACA,GAAAyL,GAAA,SAAA/M,GACA,YAAAA,EAAAyG,SAAAjT,cAEA,IAAAsZ,EAAAzR,QAAAyR,EAAAxR,KACA,IAAAgG,EAAA0L,eAAAtN,UACA4B,EAAA2L,cAAA3L,EAAA0L,eAAArN,UAAA9Q,QACAuN,EAAA0E,WAAAQ,EAAA0L,eAAAD,GAAA,CAGA,IAFA,GAAAG,GAAA5L,EAAA0L,eACAG,EAAA7L,EAAA0L,eAAAvb,WACA,OAAA0b,GAAA,MAAAA,EAAA1G,SAAAjT,eACA2Z,EAAA/a,WAAA+a,EAAA/a,WAAAvD,OAAA,KAAAqe,EACAC,EAAA,MAEAD,EAAAC,EACAA,IAAA1b,WAGA,WAAA0b,GAAA,MAAAA,EAAA1G,SAAAjT,cAAA,CAEA,OADA4Z,GAAA,KACAxe,EAAA,EAAmC,OAAAwe,GAAAxe,EAAAue,EAAA1b,WAAAW,WAAAvD,OAA2ED,IAC9Gue,EAAA1b,WAAAW,WAAAxD,KAAAue,IACAC,EAAAxe,EAGA0S,GAAA+L,SAAAF,EAAA1b,WAAA2b,EAAA,GACA9L,EAAAmB,UAAA,IAGA,MAAAnB,IAMAgM,sCAAA,SAAAnM,EAAAnF,EAAAuR,EAAAC,GAEA,OAAAD,EAAA7N,UAAA8N,EAAA,EACA,QAIA,IAAAxN,GAAAuN,CAKA,IAJA,IAAAvN,EAAAN,WAEAM,EAAAuN,EAAAnb,WAAAob,IAEAxN,IAAA5D,EAAAiK,4BAAArG,GACA,QAOA,KAFA,GAAAyN,GAAAtM,EAAAuM,iBAAA1R,EAAAwD,WAAAmO,aAAAnB,GAAA,GACAoB,EAAA,EACAH,EAAArO,YAAA,CACA,GAAAyO,GAAA,KAAAJ,EAAAN,YAAAhJ,WAIA,KAHA0J,GAAAD,EAAA,KACAA,GAAA,GAEAxR,EAAAwD,aAAA6N,EAAAN,YAAAI,GAAA,GACA,MAAAK,EAEAC,KACAD,EAAA,GAIA,MAAAA,IAGAE,gCAAA,SAAA3C,GAIA,GAAA4C,GACAC,EAAAjgB,KAAA4e,4BAAA,SAAApL,GACA,GAAA0M,GAAA1M,KAAAzK,aAAA,kBAIA,OAHA,SAAAmX,IACAF,GAAA,GAEA,UAAAxM,EAAAkF,UAAA,UAAAwH,GACiB9C,EAEjB,QAAA4C,GAAAC,GAKAE,iBAAA,WACA,GAAAtf,GAGAsH,EACAiY,EAHA/M,EAAA,GACAgN,EAAArgB,KAAAK,QAAA+c,cAAApJ,cAGA,IAAAqM,EAAAnM,WAAA,CAEA,IADAkM,EAAApgB,KAAAK,QAAA+Q,cAAAtR,cAAA,OACAe,EAAA,EAAAsH,EAAAkY,EAAAnM,WAAiD/L,EAAAtH,EAASA,GAAA,EAC1Duf,EAAA7d,YAAA8d,EAAApM,WAAApT,GAAAyf,gBAEAjN,GAAA+M,EAAAvZ,UAEA,MAAAwM,IAUAkN,gBAAA,SAAAvK,EAAAzC,GACA,GAAAiN,GAAAC,CAeA,OAbAlN,KACAA,EAAAjO,OAAA0O,eAAAC,WAAA,IAGAuM,EAAAjN,EAAAiB,aACAiM,EAAAlN,EAAAiB,aAEAgM,EAAAE,mBAAA1K,GACAwK,EAAAG,OAAApN,EAAAqN,aAAArN,EAAAsN,WAEAJ,EAAAC,mBAAA1K,GACAyK,EAAAnB,SAAA/L,EAAAqN,aAAArN,EAAAsN,YAGAC,KAAAN,EAAA7f,WAAAG,OACAigB,MAAAN,EAAA9f,WAAAG,SAKAkgB,uBAAA,SAAAzN,GACA,GAAA6D,GAAA7D,EAAA0L,cACA,OAAA7H,KAAA7D,EAAAqN,cACAxJ,EAAAF,iBACA3D,EAAAsN,YAAAtN,EAAA2L,YAAA,GAGA+B,yBAAA,SAAA1N,GACA,MAAAA,GAKAvT,KAAAghB,uBAAAzN,IAAA,IAAAA,EAAA0L,eAAA5a,WAAAkP,EAAA2L,aAAAvN,SACA4B,EAAA0L,eAAA5a,WAAAkP,EAAA2L,aAIA,IAAA3L,EAAA0L,eAAAtN,SACA4B,EAAA0L,eAAAvb,WAIA6P,EAAA0L,eAdA,MAiBAiC,oBAAA,SAAA9N,GACA,GACAG,GACA4N,EACAC,EAHA9N,EAAAF,EAAAY,cAKA,KAAAV,EAAAY,YAAAZ,EAAA+N,cAAA/N,EAAAW,WAAA,GAAAE,wBACA,QAKA,IAFAZ,EAAAD,EAAAW,WAAA,GAEA,IAAAV,EAAAY,wBAAAxC,SAAA,CAGA,IAFAwP,KACAC,EAAA7N,EAAAY,wBACAiN,EAAA1d,YAAA,IAAA0d,EAAA1d,WAAAW,WAAAvD,QACAqgB,EAAAngB,KAAAogB,EAAA1d,YACA0d,IAAA1d,UAGA,OAAAyd,GAGA,SAAApb,OAAA7G,KAAAqU,EAAAY,wBAAAzO,qBAAA,cAAA8N,GACA,wBAAAF,GAAAgO,aAAAhO,EAAAgO,aAAA9N,GAAA,SAIAY,WAAA,SAAAnC,EAAAmB,GACA,GAAAG,GAAAH,EAAAmO,cACAlB,EAAAjN,EAAAY,cAEAT,GAAAmN,mBAAAzO,GACAoO,EAAA1L,kBACA0L,EAAAzL,SAAArB,IAGAiO,OAAA,SAAApO,EAAAgE,EAAA8H,EAAA7H,EAAAwJ,GACAzN,EAAAY,eAAAW,iBACA,IAAApB,GAAAH,EAAAmO,aAQA,OAPAhO,GAAA+L,SAAAlI,EAAA8H,GACA7H,EACA9D,EAAAoN,OAAAtJ,EAAAwJ,GAEAtN,EAAAmB,UAAA,GAEAtB,EAAAY,eAAAY,SAAArB,GACAA,GAUA4C,WAAA,SAAA/C,EAAAnB,EAAAwP,GACA,GAAAlO,GAAA8M,EACAnB,EAAAuC,GAAA,CAEAlO,GAAAH,EAAAmO,cACAlB,EAAAjN,EAAAY,eAEAT,EAAA+L,SAAArN,EAAAiN,GACA3L,EAAAmB,UAAA,GAEA2L,EAAA1L,kBACA0L,EAAAzL,SAAArB,IAGAsB,kBAAA,SAAAzD,GACA,GAAAkC,GAAAlC,EAAA4C,cACA,YAAAV,EAAAY,WACA,KAEAZ,EAAAW,WAAA,IAKAe,kBAAA,SAAA5D,GACA,GAAAa,GAAAb,EAAA4C,eAAA0N,WACAtK,EAAAnF,GAAA,IAAAA,EAAAN,SAAAM,EAAAvO,WAAAuO,CAEA,OAAAmF,IAGAnC,iBAAA,SAAAzB,GACA,GAAA2B,EAMA,KAJA3B,KAAA2B,UACAA,EAAA3B,EAAA2B,QAAA1P,eAGA+N,IAAAnF,EAAAyH,iBAAAtC,IACAA,IAAA9P,WACA8P,KAAA2B,UACAA,EAAA3B,EAAA2B,QAAA1P,cAIA,QACA+N,KACA2B,eAMA,IAAAwM,IAEA,WAGAA,EAAA,SAAAC,GACA5hB,KAAA4Q,KAAAgR,EACA5hB,KAAAK,QAAAL,KAAA4Q,KAAAvQ,QACAL,KAAA6hB,UACA7hB,KAAA8hB,gBACA9hB,KAAA+hB,cAGAJ,EAAA7W,WACAkX,sCAAA3T,EAAAW,KAIAiT,eAAA,SAAAzM,EAAAzF,EAAAmS,EAAAC,GACA3M,EAAA4M,iBAAArS,EAAAmS,EAAAC,GACAniB,KAAA6hB,OAAA7gB,MAAAwU,EAAAzF,EAAAmS,EAAAC,KAGAE,eAAA,SAAA7M,EAAAzF,EAAAmS,EAAAC,GACA,GACAzb,GADA3C,EAAA/D,KAAAsiB,gBAAA9M,EAAAzF,EAAAmS,EAAAC,EAEA,MAAApe,IACA2C,EAAA1G,KAAA6hB,OAAAlY,OAAA5F,EAAA,MACA2C,EAAA,GAAA6b,oBAAA7b,EAAA,GAAAA,EAAA,GAAAA,EAAA,MAIA4b,gBAAA,SAAA9M,EAAAzF,EAAAmS,EAAAC,GACA,GAAAthB,GAAA2hB,EAAAzhB,CACA,KAAAF,EAAA,EAAA2hB,EAAAxiB,KAAA6hB,OAAA/gB,OAA+C0hB,EAAA3hB,EAAOA,GAAA,EAEtD,GADAE,EAAAf,KAAA6hB,OAAAhhB,GACAE,EAAA,KAAAyU,GAAAzU,EAAA,KAAAgP,GAAAhP,EAAA,KAAAmhB,GAAAnhB,EAAA,KAAAohB,EACA,MAAAthB,EAGA,WAGA4hB,mBAAA,WAEA,IADA,GAAA/b,GAAA1G,KAAA6hB,OAAAzH,MACA1T,GACAA,EAAA,GAAA6b,oBAAA7b,EAAA,GAAAA,EAAA,GAAAA,EAAA,IACAA,EAAA1G,KAAA6hB,OAAAzH,OAKAsI,kBAAA,SAAA3S,EAAAmS,GACAliB,KAAA2iB,cAAA5S,GACA/P,KAAA8hB,aAAA/R,KACA/P,KAAA8hB,aAAA/R,OAEA/P,KAAA8hB,aAAA/R,GAAA/O,KAAAkhB,IAGAU,kBAAA,SAAA7S,EAAAmS,GACA,GAAAne,GAAA/D,KAAA6iB,sBAAA9S,EAAAmS,EACA,MAAAne,GACA/D,KAAA8hB,aAAA/R,GAAApG,OAAA5F,EAAA,IAKA8e,sBAAA,SAAA9S,EAAAmS,GACA,MAAAliB,MAAA8hB,aAAA/R,IAAA/P,KAAA8hB,aAAA/R,GAAAjP,OAIAd,KAAA8hB,aAAA/R,GAAA7H,QAAAga,GAHA,IAMAY,sBAAA,WACA9iB,KAAA8hB,iBAIAiB,mBAAA,SAAAza,EAAA2C,EAAA+X,GACAhjB,KAAA8hB,aAAAxZ,IACAtI,KAAA8hB,aAAAxZ,GAAAsP,QAAA,SAAAsK,GACAA,EAAAjX,EAAA+X,MAOAjc,QAAA,WACA/G,KAAAyiB,qBACAziB,KAAA8iB,wBACA9iB,KAAAijB,oBAEAjjB,KAAA4Q,KAAAzC,UACAnO,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAA,EAAA6D,gBAAA,0BAQAqJ,oBAAA,WACAljB,KAAAmjB,sBAOAnjB,KAAAmjB,oBAAA,SAAAC,GACApjB,KAAAqjB,0BAAAD,IACajgB,KAAAnD,MAGbA,KAAAsjB,kBAGAtjB,KAAAK,QAAA+Q,cAAAyC,YAAAkO,UAAA/gB,KAAAhB,KAAAmjB,uBAIAF,kBAAA,WACA,GAAA7P,GAAApT,KAAAK,QAAA+Q,aACA,IAAApR,KAAAmjB,qBAAA/P,EAAAS,YAAAkO,UAAA,CAKA,GAAAhe,GAAAqP,EAAAS,YAAAkO,UAAA7Z,QAAAlI,KAAAmjB,oBACA,MAAApf,GACAqP,EAAAS,YAAAkO,UAAApY,OAAA5F,EAAA,GAIAqP,EAAAS,YAAAkO,UAAAjhB,QACAd,KAAAujB,sBAKAD,gBAAA,WACA,GAAAlQ,GAAApT,KAAAK,QAAA+Q,aAGA,KAAAgC,EAAAS,YAAAkO,UAAA,CASA,GAAAyB,GAAA,SAAAC,EAAAC,EAAAC,GACA,GAAA/iB,GAAAwS,EAAAS,YAAA+P,KAAA1e,MAAAlF,KAAAmF,UAEA,KAAAiO,EAAAS,YAAAkO,UACA,MAAAnhB,EAGA,IAAA4M,GAAAvF,MAAA6C,UAAAuC,MAAAnO,KAAAiG,UAUA,OATAiO,GAAAS,YAAAkO,UAAAnK,QAAA,SAAAsK,GACAA,GACA2B,QAAAJ,EACA/N,MAAAiO,EACAnW,OACA5M,aAIAA,EAIA4iB,GAAAI,KAAAxQ,EAAAS,YAGA2P,EAAAzB,aAGA3O,EAAAS,YAAA2P,IAIAD,kBAAA,WACA,GAAAnQ,GAAApT,KAAAK,QAAA+Q,aACAgC,GAAAS,YAAA+P,OAKAxQ,EAAAS,YAAAT,EAAAS,YAAA+P,OAIAjB,cAAA,SAAAra,GACA,IAAAtI,KAAA+hB,UAAAzZ,GAAA,CAIA,OAAAA,GACA,0BAEAtI,KAAAiiB,eAAAjiB,KAAAK,QAAA+Q,cAAA0S,KAAA,YAAA9jB,KAAA+jB,oBAAA5gB,KAAAnD,OAAA,GACAA,KAAAiiB,eAAAjiB,KAAAK,QAAA+Q,cAAA0S,KAAA,QAAA9jB,KAAAgkB,gBAAA7gB,KAAAnD,OAAA,GACAA,KAAAiiB,eAAAjiB,KAAAK,QAAA+Q,cAAA0S,KAAA,QAAA9jB,KAAAikB,gBAAA9gB,KAAAnD,OAAA,EACA,MACA,YAEAA,KAAA2iB,cAAA,sBACA,MACA,aAEA3iB,KAAA2iB,cAAA,sBACA,MACA,qBAEA3iB,KAAAkkB,gBACAlkB,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAkkB,aAAAlO,EAAAjN,aAAA,wBAAAiN,EAAAnP,UAGA7G,KAAAgiB,sCACAhiB,KAAAiiB,eAAAjM,EAAA,QAAAhW,KAAAmkB,YAAAhhB,KAAAnD,QAEqBmD,KAAAnD,OAIrBA,KAAAgiB,uCACAhiB,KAAA2iB,cAAA,oBACA3iB,KAAAokB,qBAAA,EACApkB,KAAAiiB,eAAAzhB,SAAA,kBAAAR,KAAAqkB,8BAAAlhB,KAAAnD,OAEAA,KAAAkjB,sBAEA,MACA,qBAEAljB,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,QAAAhW,KAAAskB,YAAAnhB,KAAAnD,QACqBmD,KAAAnD,MACrB,MACA,oBAEAA,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,OAAAhW,KAAAukB,WAAAphB,KAAAnD,QACqBmD,KAAAnD,MACrB,MACA,wBAEAA,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,WAAAhW,KAAAwkB,eAAArhB,KAAAnD,QACqBmD,KAAAnD,MACrB,MACA,qBAEAA,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,QAAAhW,KAAAykB,YAAAthB,KAAAnD,QACqBmD,KAAAnD,MACrB,MACA,uBAEAA,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,UAAAhW,KAAA0kB,cAAAvhB,KAAAnD,QACqBmD,KAAAnD,MACrB,MACA,4BAEAA,KAAA2iB,cAAA,kBACA,MACA,0BAEA3iB,KAAA2iB,cAAA,kBACA,MACA,6BAEA3iB,KAAA2iB,cAAA,kBACA,MACA,yBAEA3iB,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,YAAAhW,KAAA2kB,gBAAAxhB,KAAAnD,QACqBA,KACrB,MACA,oBAEAA,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,WAAAhW,KAAA4kB,eAAAzhB,KAAAnD,OACAA,KAAAiiB,eAAAjM,EAAA,YAAAhW,KAAA4kB,eAAAzhB,KAAAnD,QACqBA,KACrB,MACA,oBAEAA,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,OAAAhW,KAAA6kB,WAAA1hB,KAAAnD,QACqBA,KACrB,MACA,qBAEAA,KAAA4Q,KAAAzC,SAAAyJ,QAAA,SAAA5B,GACAhW,KAAAiiB,eAAAjM,EAAA,QAAAhW,KAAA8kB,YAAA3hB,KAAAnD,QACqBA,MAGrBA,KAAA+hB,UAAAzZ,IAAA,IAGAyc,aAAA,SAAA/O,GACAA,EAAAgP,QACAhlB,KAAAilB,YAAAjP,GAAuCR,OAAAQ,EAAA1T,KAAA,WAGvC2iB,YAAA,SAAAzP,EAAA0P,GACA,GAIAC,GAJAC,EAAAplB,KAAA4Q,KAAAyU,QAAArlB,KAAA4Q,KAAAyU,QAAAC,oBAAA,KACAC,EAAAvlB,KAAA4Q,KAAA4U,mBAAA,kBACAC,EAAAF,KAAAG,kBAAAH,EAAAG,oBAAA,KACAC,EAAA3lB,KAAA4Q,KAAAgV,mBAKAD,IACA,UAAAT,EAAA5iB,MACAtC,KAAA6lB,sBACAxX,EAAAwD,aAAA8T,EAAA3lB,KAAA6lB,qBAAA,IACAxX,EAAAwD,aAAAuT,EAAAplB,KAAA6lB,qBAAA,IACAxX,EAAAwD,aAAA4T,EAAAzlB,KAAA6lB,qBAAA,MACAV,EAAAQ,GAGAR,GACAnlB,KAAA4Q,KAAAzC,SAAA2X,KAAA,SAAA9P,GAOA,OALAmP,GAAA9W,EAAAwD,aAAAmE,EAAAR,GAAA,KACA2P,EAAAnP,KAIAmP,GACiBnlB,KAIjB,IAAA+lB,IAAA1X,EAAAwD,aAAA8T,EAAAnQ,GAAA,KACAnH,EAAAwD,aAAAuT,EAAA5P,GAAA,KACAnH,EAAAwD,aAAA4T,EAAAjQ,GAAA,EAEA2P,KAAAQ,IAGAA,GAAAI,IAEAJ,EAAA9L,gBAAA,uBACA7Z,KAAA+iB,mBAAA,OAAAmC,EAAAS,IAIAR,IAEAA,EAAA5gB,aAAA,0BACAvE,KAAA+iB,mBAAA,QAAAmC,EAAAC,KAIAY,GACA/lB,KAAA+iB,mBAAA,sBAAAmC,IAIAc,YAAA,SAAAxQ,EAAA0P,GAGA,GAAAnhB,GAAAyR,EAAAzM,aAAA,sBACAyM,GAAA3O,YAAA7G,KAAAkkB,aAAAngB,IAEA/D,KAAA+iB,mBAAA,gBAAAmC,EAAA1P,GAEAxV,KAAAkkB,aAAAngB,GAAAyR,EAAA3O,WAGAwd,8BAAA,SAAAtU,GAKA,GAAAA,EAAAkW,eAAAlW,EAAAkW,cAAAC,cAAA,CACA,GACAD,GADAC,EAAAnW,EAAAkW,cAAAC,aAIAlmB,MAAA4Q,KAAAzC,SAAA2X,KAAA,SAAA9P,GACA,MAAA3H,GAAAwD,aAAAmE,EAAAkQ,GAAA,IACAD,EAAAjQ,GACA,IAEA,GACiBhW,MAGjBimB,GACAjmB,KAAAgmB,YAAAC,GAAqDzQ,OAAA0Q,EAAAD,oBAKrD5C,0BAAA,WAIA,GAAA7N,GAAAxV,KAAA4Q,KAAAgV,mBACApQ,IACAxV,KAAAgmB,YAAAxQ,GAA0CA,SAAAyQ,cAAAzQ,KAI1CwO,gBAAA,SAAAjU,GACA/P,KAAAilB,YAAAlV,EAAAyF,OAAAzF,IAGAkU,gBAAA,SAAAlU,GACA/P,KAAAilB,YAAAlV,EAAAyF,OAAAzF,IAGAgU,oBAAA,SAAAhU,GACA/P,KAAA6lB,oBAAA9V,EAAAyF,QAGA2O,YAAA,SAAApU,GACA/P,KAAAgmB,YAAAjW,EAAAkW,cAAAlW,IAGAuU,YAAA,SAAAvU,GACA/P,KAAA+iB,mBAAA,gBAAAhT,IAAAkW,gBAGA1B,WAAA,SAAAxU,GACA/P,KAAA+iB,mBAAA,eAAAhT,IAAAkW,gBAGAzB,eAAA,SAAAzU,GAKA,GAJA/P,KAAA+iB,mBAAA,mBAAAhT,IAAAkW,eAIAjmB,KAAAokB,oBAAA,CACA,GAAAc,IAAgC1P,OAAAzF,EAAAyF,OAAAyQ,cAAAlW,EAAAkW,cAIhCnT,YAAA,WACA9S,KAAAgmB,YAAAd,EAAAe,cAAAf,IACiB/hB,KAAAnD,MAAA,KAIjBykB,YAAA,SAAA1U,GACA/P,KAAA+iB,mBAAA,gBAAAhT,IAAAkW,gBAGAtB,gBAAA,SAAA5U,GACA/P,KAAA+iB,mBAAA,oBAAAhT,IAAAkW,gBAGArB,eAAA,SAAA7U,GACA/P,KAAA+iB,mBAAA,eAAAhT,IAAAkW,gBAGApB,WAAA,SAAA9U,GACA/P,KAAA+iB,mBAAA,eAAAhT,IAAAkW,gBAGAnB,YAAA,SAAA/U,GACA/P,KAAA+iB,mBAAA,gBAAAhT,IAAAkW,gBAGAvB,cAAA,SAAA3U,GAGA,MAFA/P,MAAA+iB,mBAAA,kBAAAhT,IAAAkW,eAEA5X,EAAA6B,MAAAH,EAAA1B,EAAAkB,QAAAG,OACA1P,KAAA+iB,mBAAA,uBAAAhT,IAAAkW,eAGA5X,EAAA6B,MAAAH,EAAA1B,EAAAkB,QAAAE,KACAzP,KAAA+iB,mBAAA,qBAAAhT,IAAAkW,eAGA5X,EAAA6B,MAAAH,GAAA1B,EAAAkB,QAAAM,OAAAxB,EAAAkB,QAAAC,YACAxP,KAAA+iB,mBAAA,wBAAAhT,IAAAkW,eADA,WAQA,IAAAE,IAGA,WAGAA,EAAA,SAAA9lB,EAAAuhB,GACAvT,EAAAyG,WAAA,gFAEA9U,KAAAK,UACAL,KAAAsI,KAAAjI,EAAAiI,KACAtI,KAAAoO,KAAAwT,IAGAuE,EAAArb,WACAsD,KAAA,SAAAwT,GACA5hB,KAAA4Q,KAAAgR,EAEA5hB,KAAAomB,OAAApmB,KAAAqmB,eACArmB,KAAA4Q,KAAA0V,GAAAtmB,KAAAomB,OAAA,QAAApmB,KAAAskB,YAAAnhB,KAAAnD,OACAA,KAAAK,QAAA0a,KACA/a,KAAA4Q,KAAAnK,UAAA,kBAAAzG,KAAA0kB,cAAAvhB,KAAAnD,QAGAumB,UAAA,WACA,MAAAvmB,MAAAomB,QAEAI,UAAA,WACA,wBAAAxmB,MAAAK,QAAAma,OAAAxa,KAAAK,QAAAma,OAAAxa,KAAA4Q,KAAAvQ,SAAAL,KAAAK,QAAAma,QAEAiM,QAAA,WACA,wBAAAzmB,MAAAK,QAAAoa,KAAAza,KAAAK,QAAAoa,KAAAza,KAAA4Q,KAAAvQ,SAAAL,KAAAK,QAAAoa,MAEAiM,YAAA,WACA,wBAAA1mB,MAAAK,QAAAqa,SAAA1a,KAAAK,QAAAqa,SAAA1a,KAAA4Q,KAAAvQ,SAAAL,KAAAK,QAAAqa,UAEA2L,aAAA,WACA,GAAAD,GAAApmB,KAAA4Q,KAAAvQ,QAAA+Q,cAAAtR,cAAA,UACAkO,EAAAhO,KAAAK,QAAAwa,eACA8L,EAAA3mB,KAAAymB,SAgBA,OAfAL,GAAA1d,UAAAa,IAAA,wBACA6c,EAAA1d,UAAAa,IAAA,wBAAAvJ,KAAAsI,MACA8d,EAAA7hB,aAAA,cAAAvE,KAAAwmB,aACAG,IACAP,EAAA7hB,aAAA,QAAAoiB,GACAP,EAAA7hB,aAAA,aAAAoiB,IAEA3mB,KAAA4Q,KAAAvQ,QAAAkc,eACA,gBAAAvc,KAAA4Q,KAAAvQ,QAAAkc,cAAAvc,KAAAK,QAAAya,UACA9M,EAAAhO,KAAAK,QAAAya,UACiB,gBAAA9a,MAAA4Q,KAAAvQ,QAAAkc,cAAAvc,KAAA4Q,KAAAvQ,QAAAkc,aAAAvc,KAAAsI,QACjB0F,EAAAhO,KAAA4Q,KAAAvQ,QAAAkc,aAAAvc,KAAAK,QAAAiI,QAGA8d,EAAAvf,UAAAmH,EACAoY,GAEA1B,cAAA,SAAAkC,GACA,GACApM,GADAO,EAAAlT,OAAAoF,aAAA2Z,EAAAxW,OAAAwW,EAAArX,SAAA9J,aAGAzF,MAAAK,QAAA0a,SAAA1M,EAAAyB,cAAA8W,KACAA,EAAAC,iBACAD,EAAAE,kBAEAtM,EAAAxa,KAAAwmB,YACAhM,GACAxa,KAAA4Q,KAAAmW,WAAAvM,KAIA8J,YAAA,SAAAsC,GACAA,EAAAC,iBACAD,EAAAE,iBAEA,IAAAtM,GAAAxa,KAAAwmB,WAEAhM,IACAxa,KAAA4Q,KAAAmW,WAAAvM,IAGAwD,SAAA,WACA,MAAAhe,MAAAomB,OAAA1d,UAAAY,SAAAtJ,KAAA4Q,KAAAvQ,QAAAkd,oBAEAY,YAAA,WACAne,KAAAomB,OAAA1d,UAAA7F,OAAA7C,KAAA4Q,KAAAvQ,QAAAkd,yBACAvd,MAAAgnB,YAEA9I,UAAA,WACAle,KAAAomB,OAAA1d,UAAAa,IAAAvJ,KAAA4Q,KAAAvQ,QAAAkd,yBACAvd,MAAAgnB,YAEAjJ,kBAAA,WACA,GAAAkJ,GAAA,IAIA,OAHAjnB,MAAAK,QAAAua,gBACAqM,EAAAjnB,KAAA4Q,KAAAmN,kBAAA/d,KAAAwmB,cAEAS,GAEAhJ,iBAAA,SAAAhM,GACA,GAEAiV,GACAC,EAHAC,GAAA,EACA1M,EAAA1a,KAAA0mB,aAIA,OAAA1mB,MAAAgnB,cAAA,GAAAhnB,KAAAgnB,cAAA,EACAhnB,KAAAgnB,YAGAtM,KAAA5Z,OAAA,GAAAmR,EAAAkD,UACAiS,EAAA,KAAA1M,EAAAxS,QAAA+J,EAAAkD,QAAA1P,iBAGA2hB,GAAApnB,KAAAK,QAAAsa,QACAuM,EAAAlnB,KAAAK,QAAAsa,MAAAjF,MAAAzM,MAAA,KACAke,EAAAnnB,KAAA4Q,KAAAvQ,QAAA+c,cAAAiK,iBAAApV,EAAA,MAAAqV,iBAAAtnB,KAAAK,QAAAsa,MAAA/L,MACAsY,EAAAtP,QAAA,SAAA2P,GACAvnB,KAAAgnB,aACAI,EAAA,KAAAD,EAAAjf,QAAAqf,IAIAH,GAAA,oBAAApnB,KAAAK,QAAAsa,MAAA/L,QACA5O,KAAAgnB,WAAAI,KAGiBpnB,OAGjBonB,OAKA,IAAAI,IAGA,WAGA,QAAAC,KACApZ,EAAAyG,WAAA,kFACA9U,KAAA8R,QAAA,EACA9R,KAAAK,SACAiI,KAAA,SACAkS,OAAA,aACAC,KAAA,OACAC,UAAA,KACAG,eAAA,WACAC,UAAA,6BACAC,IAAA,KAEA/a,KAAAsI,KAAA,SACAtI,KAAA0nB,SAAA,EAGAD,EAAA3c,WAKA6c,cAAA,WACAC,eAAA,UAIAtD,YAAA,SAAAsC,GACAA,EAAAC,iBACAD,EAAAE,iBAEA,IAAAe,GAAA9S,EAAAkM,yBAAAlM,EAAAF,kBAAA7U,KAAA4Q,KAAAvQ,QAAA+Q,eACA,OAAAyW,GAAA1S,SACA,MAAA0S,EAAA1S,QAAA1P,cACAzF,KAAA4Q,KAAAmW,WAAA,WAGA/mB,KAAA8nB,eACA9nB,KAAA+nB,YAGA,IAKArD,cAAA,SAAAkC,GACA,GAAA7L,GAAAlT,OAAAoF,aAAA2Z,EAAAxW,OAAAwW,EAAArX,SAAA9J;AAEAzF,KAAAK,QAAA0a,SAAA1M,EAAAyB,cAAA8W,KACAA,EAAAC,iBACAD,EAAAE,kBAEA9mB,KAAAskB,YAAAsC,KAKAoB,QAAA,WAIA,MAHAhoB,MAAAioB,OACAjoB,KAAAioB,KAAAjoB,KAAAkoB,cAEAloB,KAAAioB,MAGAE,YAAA,WAEA,GAAAC,IACA,uEAAApoB,KAAA4Q,KAAAvQ,QAAAgoB,uBAAA,KAoCA,OAjCAD,GAAApnB,KACA,kDACA,gBAAAhB,KAAA4Q,KAAAvQ,QAAAkc,aAAA,8BAAAvc,KAAA2nB,cACA,QAGAS,EAAApnB,KAAA,mDACA,gBAAAhB,KAAA4Q,KAAAvQ,QAAAkc,aAAA,8BAAAvc,KAAA4nB,eACA,QAKA5nB,KAAA4Q,KAAAvQ,QAAAioB,cAGAF,EAAApnB,KACA,sEACA,UACAhB,KAAA4Q,KAAAvQ,QAAAkoB,yBACA,YAIAvoB,KAAA4Q,KAAAvQ,QAAAmoB,cAGAJ,EAAApnB,KACA,sEACA,yBAIAonB,EAAAnnB,KAAA,KAKA6mB,YAAA,WACA,gBAAA9nB,KAAAgoB,UAAArN,MAAA8N,SAGAC,SAAA,WACA1oB,KAAAgoB,UAAArN,MAAA8N,QAAA,OACAzoB,KAAA2oB,WAAAjT,MAAA,IAGAqS,SAAA,SAAAa,GACA,GAAAC,GAAA7oB,KAAA2oB,UAEA3oB,MAAA4Q,KAAAkY,gBACA9oB,KAAA4Q,KAAAmY,4BACA/oB,KAAAgoB,UAAArN,MAAA8N,QAAA,QACAzoB,KAAA4Q,KAAAoY,qBAEAH,EAAAnT,MAAAkT,GAAA,GACAC,EAAA7D,SAIAiE,WAAA,WACA,MAAAjpB,MAAAioB,MAIAjoB,KAAAioB,KAAAvkB,YACA1D,KAAAioB,KAAAvkB,WAAAC,YAAA3D,KAAAioB,iBAGAjoB,MAAAioB,OAPA,GAYAiB,YAAA,WAEA,GAAAC,GAAAnpB,KAAAgoB,UAAAjP,cAAA,wCACAqQ,EAAAppB,KAAAgoB,UAAAjP,cAAA,wCACAsQ,GACA9T,IAAAvV,KAAA2oB,WAAAjT,MAiBA,OAdA1V,MAAA4Q,KAAAvQ,QAAAipB,kBACAD,EAAA9T,IAAAvV,KAAAspB,gBAAAD,EAAA9T,MAGA4T,KAAAI,QACAF,EAAA7T,OAAA,SAEA6T,EAAA7T,OAAA,QAGA4T,KAAAG,UACAF,EAAAzT,YAAA5V,KAAA4Q,KAAAvQ,QAAAmpB,mBAGAH,GAGAI,WAAA,WACA,GAAAJ,GAAArpB,KAAAkpB,aACAlpB,MAAA0pB,iBAAAL,IAGAK,iBAAA,SAAAL,GACArpB,KAAA4Q,KAAA+Y,mBACA3pB,KAAA4Q,KAAAgZ,WAAAP,GACArpB,KAAA4Q,KAAAiZ,kBAGAP,gBAAA,SAAA5T,GACA,GAAAoU,GAAA,qCACA,QAAAA,EAAAzkB,KAAAqQ,GAAA,cAAAA,GAGAqU,aAAA,WACA/pB,KAAA4Q,KAAA+Y,mBACA3pB,KAAA4Q,KAAAiZ,kBAKAG,iBAAA,SAAA/B,GACA,GAAAxa,GAAAwa,EAAAlP,cAAA,gCACAkR,EAAAhC,EAAAlP,cAAA,+BACA8P,EAAAZ,EAAAlP,cAAA,+BAGA/Y,MAAA4Q,KAAA0V,GAAA2B,EAAA,QAAAjoB,KAAAkqB,gBAAA/mB,KAAAnD,OAGAA,KAAA4Q,KAAA0V,GAAAuC,EAAA,QAAA7oB,KAAAmqB,mBAAAhnB,KAAAnD,OAGAA,KAAA4Q,KAAA0V,GAAA7Y,EAAA,QAAAzN,KAAAoqB,iBAAAjnB,KAAAnD,OAGAA,KAAA4Q,KAAA0V,GAAA2D,EAAA,QAAAjqB,KAAAqqB,gBAAAlnB,KAAAnD,OAAA,IAIAkoB,WAAA,WACA,GAAA9U,GAAApT,KAAA4Q,KAAAvQ,QAAA+Q,cACA6W,EAAA7U,EAAAtT,cAAA,MAQA,OALAmoB,GAAAloB,UAAA,6BACAkoB,EAAAjpB,GAAA,qCAAAgB,KAAA4Q,KAAA5R,GACAipB,EAAAphB,UAAA7G,KAAAmoB,cACAnoB,KAAAgqB,iBAAA/B,GAEAA,GAGAU,SAAA,WACA,MAAA3oB,MAAAgoB,UAAAjP,cAAA,sCAGAoR,mBAAA,SAAApa,GAEA,MAAAA,GAAAR,UAAAlB,EAAAkB,QAAAG,OACAK,EAAA8W,qBACA7mB,MAAAypB,mBAKA1Z,EAAAR,UAAAlB,EAAAkB,QAAAI,SACAI,EAAA8W,iBACA7mB,KAAA+pB,kBAIAG,gBAAA,SAAAna,GAEAA,EAAA+W,mBAGAuD,gBAAA,SAAAta,GAEAA,EAAA8W,iBACA7mB,KAAAypB,cAGAW,iBAAA,SAAAra,GAEAA,EAAA8W,iBACA7mB,KAAA+pB,iBAIAvC,EAAAnZ,EAAAsC,QAAAwV,EAAAsB,KAIA,IAAA6C,IAGA,WAGAA,EAAA,WACAjc,EAAAyG,WAAA,uFACA9U,KAAA8R,QAAA,EACA9R,KAAAsI,KAAA,kBAGAgiB,EAAAxf,WAIAyf,qBAAA,IAEAnc,KAAA,WAEApO,KAAAulB,cAAAvlB,KAAAwqB,gBACAxqB,KAAA4Q,KAAAvQ,QAAA4c,kBAAA1a,YAAAvC,KAAAulB,eAEAvlB,KAAAyqB,qBAGA/E,kBAAA,WACA,MAAA1lB,MAAAulB,eAGAiF,cAAA,WACA,GAAAhX,GAAAxT,KAAA4Q,KAAAvQ,QAAA+Q,cAAAtR,cAAA,MAQA,OANA0T,GAAAxU,GAAA,gCAAAgB,KAAA4Q,KAAA5R,GACAwU,EAAAzT,UAAA,+BACAyT,EAAA3M,UAAA7G,KAAAmoB,cAEAnoB,KAAA4Q,KAAA0V,GAAA9S,EAAA,QAAAxT,KAAAskB,YAAAnhB,KAAAnD,OAEAwT,GAGA2U,YAAA,WACA,0KAKAc,WAAA,WACAjpB,KAAAulB,gBACAvlB,KAAAulB,cAAA7hB,YACA1D,KAAAulB,cAAA7hB,WAAAC,YAAA3D,KAAAulB,qBAEAvlB,MAAAulB,gBAIAmF,YAAA,WACA1qB,KAAAulB,cAAA7c,UAAA7F,OAAA,uCACA7C,KAAA2qB,aAAA,MAGAC,YAAA,SAAAC,GACA,MAAA7qB,MAAAulB,cAAA7c,UAAAY,SAAA,wCACAuhB,EAAA9hB,aAAA,yBACA,GAGA/I,KAAAuqB,uBACAvqB,KAAAulB,cAAAxM,cAAA/Y,KAAAuqB,sBAAAnU,YAAAyU,EAAApV,WAAA7R,KAAA8R,MACA1V,KAAAulB,cAAAxM,cAAA/Y,KAAAuqB,sBAAA3mB,KAAAinB,EAAApV,WAAA7R,KAAA8R,OAGA1V,KAAAulB,cAAA7c,UAAAa,IAAA,6BACAvJ,KAAAulB,cAAA7c,UAAA7F,OAAA,8BAEA7C,KAAAulB,cAAA7c,UAAAY,SAAA,wCACAtJ,KAAAulB,cAAA7c,UAAAa,IAAA,uCAGAvJ,KAAA2qB,aAAAE,EAEA7qB,KAAA8qB,kBACA9qB,KAAA+qB,wBAEA/qB,OAGA8qB,gBAAA,WACA,GAGAE,GACAC,EAJAC,EAAAlrB,KAAAulB,cAAA4F,aACAC,EAAAprB,KAAA2qB,aAAAU,wBACAC,GAAAF,EAAAtK,KAAAsK,EAAArK,OAAA,CAIAiK,GAAAhrB,KAAAulB,cAAAgG,YAAA,EACAN,EAAAjrB,KAAA4Q,KAAAvQ,QAAAoc,SAAAuO,EAEAhrB,KAAAulB,cAAA5K,MAAA6Q,IAAAC,KAAAC,MAAAR,EAAAE,EAAAO,OAAA3rB,KAAA4Q,KAAAvQ,QAAAqc,QAAA1c,KAAA4Q,KAAAvQ,QAAA+c,cAAAwO,YAAA5rB,KAAAulB,cAAA4F,cAAA,KACAH,EAAAM,EACAtrB,KAAAulB,cAAA5K,MAAAmG,KAAAmK,EAAAD,EAAA,KACahrB,KAAA4Q,KAAAvQ,QAAA+c,cAAAyO,WAAAP,EAAAN,EACbhrB,KAAAulB,cAAA5K,MAAAmG,KAAA9gB,KAAA4Q,KAAAvQ,QAAA+c,cAAAyO,WAAAZ,EAAAD,EAAA,KAEAhrB,KAAAulB,cAAA5K,MAAAmG,KAAAmK,EAAAK,EAAA,MAIAb,kBAAA,WACAzqB,KAAA4Q,KAAAnK,UAAA,oBAAAzG,KAAA8rB,wBAAA3oB,KAAAnD,QAGAskB,YAAA,SAAAvU,GACA,GAAAgc,GAAA/rB,KAAA4Q,KAAA4U,mBAAA,UACAmF,EAAA3qB,KAAA2qB,YAEAoB,IAAApB,IACA5a,EAAA8W,iBAEA7mB,KAAA4Q,KAAAob,cAAAhsB,KAAA2qB,cAIA3qB,KAAA4Q,KAAA4L,MAAA,WACAmO,IACAoB,EAAAhE,SAAA4C,EAAAlV,WAAA7R,KAAA8R,OACAiV,EAAA,OAEiBxnB,KAAAnD,QAGjBA,KAAA0qB,eAGAuB,qBAAA,WACAjsB,KAAAksB,gBAAA,KACAlsB,KAAA4Q,KAAAub,IAAAnsB,KAAA2qB,aAAA,WAAA3qB,KAAAosB,8BACApsB,KAAAosB,6BAAA,MAGAN,wBAAA,SAAA/b,GACA,GAAAyF,GAAAnH,EAAA2L,cAAAjK,EAAAyF,OAAA,IAEA,IAAAA,EAAA,CAKA,uBAAAnQ,KAAAmQ,EAAA6W,YAAA,oBAAAhnB,KAAAmQ,EAAA6W,WACA,QAIA,IAAArsB,KAAA4Q,KAAAyU,SAAArlB,KAAA4Q,KAAAyU,QAAAyC,cAEA,QAIA9nB,MAAA2qB,cAAA3qB,KAAA2qB,eAAAnV,GACAxV,KAAAssB,wBAGAtsB,KAAAksB,gBAAA1W,EAEAxV,KAAAosB,6BAAApsB,KAAAisB,qBAAA9oB,KAAAnD,MACAA,KAAA4Q,KAAA0V,GAAAtmB,KAAAksB,gBAAA,WAAAlsB,KAAAosB,8BAIApsB,KAAA4Q,KAAA4L,MAAA,WACAxc,KAAAksB,iBAEAlsB,KAAA4qB,YAAA5qB,KAAAksB,kBAEiB/oB,KAAAnD,SAIjBusB,uBAAA,WACAvsB,KAAAwsB,UAAA,GAAApa,OAAAqa,UACAzsB,KAAA0sB,UAAA,GAGAC,sBAAA,SAAA5c,GACAA,EAAA6c,eAAA,iBAAAvnB,KAAA0K,EAAA6c,cAAA7sB,aACAC,KAAA0sB,UAAA,IAIAG,cAAA,WACA,GAAA7sB,KAAA0sB,SACA,QAEA,IAAAI,IAAA,GAAA1a,OAAAqa,UAAAzsB,KAAAwsB,QACAM,GAAA9sB,KAAA4Q,KAAAvQ,QAAA0sB,wBAEA/sB,KAAAssB,yBAIAA,sBAAA,WAEAU,cAAAhtB,KAAAitB,eACAjtB,KAAAktB,iCACAltB,KAAA4Q,KAAAub,IAAAnsB,KAAAulB,cAAA,YAAAvlB,KAAAktB,gCACAltB,KAAA4Q,KAAAub,IAAAnsB,KAAAulB,cAAA,WAAAvlB,KAAAmtB,+BACAntB,KAAA2qB,eACA3qB,KAAA4Q,KAAAub,IAAAnsB,KAAA2qB,aAAA,YAAA3qB,KAAAktB,gCACAltB,KAAA4Q,KAAAub,IAAAnsB,KAAA2qB,aAAA,WAAA3qB,KAAAmtB,iCAIAntB,KAAA0qB,cAEA1qB,KAAA0sB,SAAA1sB,KAAAktB,+BAAAltB,KAAAmtB,8BAAA,MAIApC,sBAAA,WACA/qB,KAAAwsB,UAAA,GAAApa,OAAAqa,UACAzsB,KAAA0sB,UAAA,EAEA1sB,KAAAktB,+BAAAltB,KAAAusB,uBAAAppB,KAAAnD,MACAA,KAAAmtB,8BAAAntB,KAAA2sB,sBAAAxpB,KAAAnD,MAEAA,KAAAitB,cAAAG,YAAAptB,KAAA6sB,cAAA1pB,KAAAnD,MAAA,KAEAA,KAAA4Q,KAAA0V,GAAAtmB,KAAAulB,cAAA,YAAAvlB,KAAAktB,gCACAltB,KAAA4Q,KAAA0V,GAAAtmB,KAAAulB,cAAA,WAAAvlB,KAAAmtB,+BACAntB,KAAA4Q,KAAA0V,GAAAtmB,KAAA2qB,aAAA,YAAA3qB,KAAAktB,gCACAltB,KAAA4Q,KAAA0V,GAAAtmB,KAAA2qB,aAAA,WAAA3qB,KAAAmtB,mCAMA,IAAAE,IAGA,WAGA,QAAAC,KACAjf,EAAAyG,WAAA,sFACA9U,KAAA8R,QAAA,EACA9R,KAAAK,SACAiI,KAAA,WACAkS,OAAA,WACAC,KAAA,8BACAI,eAAA,SACAC,UAAA,qCAEA9a,KAAAsI,KAAA,WACAtI,KAAA0nB,SAAA,EAGA4F,EAAAxiB,WAMAwZ,YAAA,SAAAsC,GAIA,GAHAA,EAAAC,iBACAD,EAAAE,mBAEA9mB,KAAA8nB,cAAA,CAEA,GAAAyF,GAAAvtB,KAAA4Q,KAAAvQ,QAAA+Q,cAAAoc,kBAAA,cACAxtB,MAAA+nB,SAAAwF,GAGA,UAIAvF,QAAA,WAIA,MAHAhoB,MAAAioB,OACAjoB,KAAAioB,KAAAjoB,KAAAkoB,cAEAloB,KAAAioB,MAIAH,YAAA,WACA,gBAAA9nB,KAAAgoB,UAAArN,MAAA8N,SAGAC,SAAA,WACA1oB,KAAAgoB,UAAArN,MAAA8N,QAAA,OACAzoB,KAAA2oB,WAAAjT,MAAA,IAGAqS,SAAA,SAAAwF,GACA,GAAA1E,GAAA7oB,KAAA2oB,UAEA3oB,MAAA4Q,KAAAkY,gBACA9oB,KAAA4Q,KAAAmY,4BACA/oB,KAAAgoB,UAAArN,MAAA8N,QAAA,QACAzoB,KAAA4Q,KAAAoY,qBAEAH,EAAAnT,MAAA6X,GAAA,GACA1E,EAAA7D,SAIAiE,WAAA,WACA,MAAAjpB,MAAAioB,MAIAjoB,KAAAioB,KAAAvkB,YACA1D,KAAAioB,KAAAvkB,WAAAC,YAAA3D,KAAAioB,iBAGAjoB,MAAAioB,OAPA,GAYAwB,WAAA,WACAzpB,KAAA4Q,KAAA+Y,mBACA3pB,KAAA4Q,KAAAiZ,kBAGAE,aAAA,WACA/pB,KAAA4Q,KAAA+Y,mBACA3pB,KAAAytB,gBACAztB,KAAA4Q,KAAAiZ,kBAKA3B,WAAA,WACA,GAAA9U,GAAApT,KAAA4Q,KAAAvQ,QAAA+Q,cACA6W,EAAA7U,EAAAtT,cAAA,OACA+oB,EAAAzV,EAAAtT,cAAA,SACA2N,EAAA2F,EAAAtT,cAAA,KACAmqB,EAAA7W,EAAAtT,cAAA,IAyCA,OAtCAmoB,GAAAloB,UAAA,6BACAkoB,EAAAjpB,GAAA,uCAAAgB,KAAA4Q,KAAA5R,GAGAgB,KAAA4Q,KAAA0V,GAAA2B,EAAA,QAAAjoB,KAAAkqB,gBAAA/mB,KAAAnD,OAGA6oB,EAAAtkB,aAAA,gBACAskB,EAAAtkB,aAAA,WACAskB,EAAAtkB,aAAA,WACAskB,EAAA9oB,UAAA,8BACAkoB,EAAA1lB,YAAAsmB,GAGA7oB,KAAA4Q,KAAA0V,GAAAuC,EAAA,SAAA7oB,KAAA0tB,mBAAAvqB,KAAAnD,OAGAiqB,EAAA1lB,aAAA,YACA0lB,EAAAlqB,UAAA,4BACAkqB,EAAApjB,UAAA,gBAAA7G,KAAA4Q,KAAAvQ,QAAAkc,aACA,8BACA,WACA0L,EAAA1lB,YAAA0nB,GAGAjqB,KAAA4Q,KAAA0V,GAAA2D,EAAA,QAAAjqB,KAAAqqB,gBAAAlnB,KAAAnD,OAAA,GAGAyN,EAAAlJ,aAAA,YACAkJ,EAAA1N,UAAA,6BACA0N,EAAA5G,UAAA,gBAAA7G,KAAA4Q,KAAAvQ,QAAAkc,aACA,8BACA,UACA0L,EAAA1lB,YAAAkL,GAGAzN,KAAA4Q,KAAA0V,GAAA7Y,EAAA,QAAAzN,KAAAoqB,iBAAAjnB,KAAAnD,OAEAioB,GAGAU,SAAA,WACA,MAAA3oB,MAAAgoB,UAAAjP,cAAA,sCAGA0U,cAAA,WACA1Y,EAAAmM,oBAAAlhB,KAAA4Q,KAAAvQ,QAAA+Q,eAAAwG,QAAA,SAAApE,GACA,SAAAA,EAAA2B,SAAA3B,EAAAma,aAAA,SACAna,EAAAqG,gBAAA,WAKA6T,mBAAA,WACA,GAAAtiB,GAAApL,KAAA2oB,WAAAjT,KACA,OAAAtK,EACApL,KAAAytB,gBAEAztB,KAAA4Q,KAAAmW,WAAA,YAAkD3b,UAIlD8e,gBAAA,SAAAna,GAEAA,EAAA+W,mBAGAuD,gBAAA,SAAAta,GAEAA,EAAA8W,iBACA7mB,KAAAypB,cAGAW,iBAAA,SAAAra,GAEAA,EAAA8W,iBACA7mB,KAAA+pB,iBAIAsD,EAAAhf,EAAAsC,QAAAwV,EAAAmH,KAEA,IAAAM,IACA,WAKAA,EAAAjQ,EAAAnN,QACApC,KAAA,WACApO,KAAAomB,OAAApmB,KAAAqmB,eACArmB,KAAAsmB,GAAAtmB,KAAAomB,OAAA,QAAApmB,KAAAskB,YAAAnhB,KAAAnD,OACAA,KAAA+a,KACA/a,KAAAyG,UAAA,kBAAAzG,KAAA0kB,cAAAvhB,KAAAnD,QAWAumB,UAAA,WACA,MAAAvmB,MAAAomB,QAGAI,UAAA,WACA,wBAAAxmB,MAAAwa,OAAAxa,KAAAwa,OAAAxa,KAAA4Q,KAAAvQ,SAAAL,KAAAwa,QAGAiM,QAAA,WACA,wBAAAzmB,MAAAya,KAAAza,KAAAya,KAAAza,KAAA4Q,KAAAvQ,SAAAL,KAAAya,MAGAiM,YAAA,WACA,wBAAA1mB,MAAA0a,SAAA1a,KAAA0a,SAAA1a,KAAA4Q,KAAAvQ,SAAAL,KAAA0a,UAGA2L,aAAA,WACA,GAAAD,GAAApmB,KAAAQ,SAAAV,cAAA,UACAkO,EAAAhO,KAAA6a,eACA8L,EAAA3mB,KAAAymB,UACAlK,EAAAvc,KAAAse,gBAAA,eAgBA,OAfA8H,GAAA1d,UAAAa,IAAA,wBACA6c,EAAA1d,UAAAa,IAAA,wBAAAvJ,KAAAsI,MACA8d,EAAA7hB,aAAA,cAAAvE,KAAAwmB,aACAG,IACAP,EAAA7hB,aAAA,QAAAoiB,GACAP,EAAA7hB,aAAA,aAAAoiB,IAEApK,IACA,gBAAAA,GAAAvc,KAAA8a,UACA9M,EAAAhO,KAAA8a,UACiB,gBAAAyB,MAAAvc,KAAAsI,QACjB0F,EAAAuO,EAAAvc,KAAAsI,QAGA8d,EAAAvf,UAAAmH,EACAoY,GAGA1B,cAAA,SAAA3U,GACA,GAAAyK,EAEAnM,GAAA6B,MAAAH,EAAA/P,KAAA+a,IAAA8S,WAAA,KAAAxf,EAAAyB,cAAAC,OAAA+d,WACA/d,EAAA8W,iBACA9W,EAAA+W,kBAEAtM,EAAAxa,KAAAwmB,YACAhM,GACAxa,KAAA+mB,WAAAvM,KAKA8J,YAAA,SAAAvU,GACAA,EAAA8W,iBACA9W,EAAA+W,iBAEA,IAAAtM,GAAAxa,KAAAwmB,WAEAhM,IACAxa,KAAA+mB,WAAAvM,IAIAwD,SAAA,WACA,MAAAhe,MAAAomB,OAAA1d,UAAAY,SAAAtJ,KAAAse,gBAAA,uBAGAH,YAAA,WACAne,KAAAomB,OAAA1d,UAAA7F,OAAA7C,KAAAse,gBAAA,4BACAte,MAAAgnB,YAGA9I,UAAA,WACAle,KAAAomB,OAAA1d,UAAAa,IAAAvJ,KAAAse,gBAAA,4BACAte,MAAAgnB,YAGAjJ,kBAAA,WACA,GAAAkJ,GAAA,IAIA,OAHAjnB,MAAA4a,gBACAqM,EAAAjnB,KAAA4Q,KAAAmN,kBAAA/d,KAAAwmB,cAEAS,GAGAhJ,iBAAA,SAAAhM,GACA,GAEAiV,GACAC,EAHAC,GAAA,EACA1M,EAAA1a,KAAA0mB,aAIA,OAAA1mB,MAAAgnB,cAAA,GAAAhnB,KAAAgnB,cAAA,EACAhnB,KAAAgnB,YAGAtM,KAAA5Z,OAAA,GAAAmR,EAAAkD,UACAiS,EAAA,KAAA1M,EAAAxS,QAAA+J,EAAAkD,QAAA1P,iBAGA2hB,GAAApnB,KAAA2a,QACAuM,EAAAlnB,KAAA2a,MAAAjF,MAAAzM,MAAA,KACAke,EAAAnnB,KAAAsF,OAAA+hB,iBAAApV,EAAA,MAAAqV,iBAAAtnB,KAAA2a,MAAA/L,MACAsY,EAAAtP,QAAA,SAAA2P,GACAvnB,KAAAgnB,aACAI,EAAA,KAAAD,EAAAjf,QAAAqf,IAIAH,GAAA,oBAAApnB,KAAA2a,MAAA/L,QACA5O,KAAAgnB,WAAAI,KAGiBpnB,OAGjBonB,QAKA,IAAA2G,IACA,WAKA,GAAAC,GAAA,YAKAD,GAAAH,EAAApd,QAEAmX,cAAA,WACAC,eAAA,UAQAF,SAAA,EASAM,QAAAgG,EAOAlG,YAAAkG,EAOAtF,SAAAsF,MAGA,IAAAC,IACA,WAKAA,EAAAF,EAAAvd,QAQA0d,kBAAA,KAKAC,sBAAA,SAKAC,gBAAA,EAKAC,gBAAA,uBAMAlF,gBAAA,EAKAmF,mBAAA,qBAGAhmB,KAAA,SACAkS,OAAA,aACAC,KAAA,OACAC,UAAA,KACAG,eAAA,WACAC,UAAA,6BACAC,IAAA,IAIAuJ,YAAA,SAAAvU,GACAA,EAAA8W,iBACA9W,EAAA+W,iBAEA,IAAAvT,GAAAwB,EAAAF,kBAAA7U,KAAAQ,SAEA,aAAA+S,EAAA0L,eAAAvG,SAAAjT,eACA,MAAA8N,EAAAqN,aAAAlI,SAAAjT,eACA4I,EAAA2L,cAAAjF,EAAAkM,yBAAA1N,GAAA,KACAvT,KAAA+mB,WAAA,WAGA/mB,KAAA8nB,eACA9nB,KAAA+nB,YAGA,IAKArD,cAAA,SAAA3U,GACA1B,EAAA6B,MAAAH,EAAA/P,KAAA+a,IAAA8S,WAAA,KAAAxf,EAAAyB,cAAAC,IACA/P,KAAAskB,YAAAvU,IAKAiY,QAAA,WAIA,MAHAhoB,MAAAioB,OACAjoB,KAAAioB,KAAAjoB,KAAAkoB,cAEAloB,KAAAioB,MAGAE,YAAA,WACA,GAAAC,IACA,uEAAApoB,KAAAquB,gBAAA,KAsCA,OAnCAjG,GAAApnB,KACA,kDACA,gBAAAhB,KAAAse,gBAAA,8CAAAte,KAAA2nB,cACA,QAGAS,EAAApnB,KAAA,mDACA,gBAAAhB,KAAAse,gBAAA,8CAAAte,KAAA4nB,eACA,QAKA5nB,KAAAmpB,gBAGAf,EAAApnB,KACA,sEACA,UACAhB,KAAAsuB,mBACA,YAIAtuB,KAAAkuB,mBAGA9F,EAAApnB,KACA,sEACA,UACAhB,KAAAmuB,sBACA,YAIA/F,EAAAnnB,KAAA,KAKA6mB,YAAA,WACA,gBAAA9nB,KAAAgoB,UAAArN,MAAA8N,SAGAC,SAAA,WACA1oB,KAAAgoB,UAAArN,MAAA8N,QAAA,OACAzoB,KAAA2oB,WAAAjT,MAAA,IAGAqS,SAAA,SAAAa,GACA,GAAAC,GAAA7oB,KAAA2oB,UAEA3oB,MAAA4Q,KAAAkY,gBACA9oB,KAAA4Q,KAAAmY,4BACA/oB,KAAAgoB,UAAArN,MAAA8N,QAAA,QACAzoB,KAAA4Q,KAAAoY,qBAEAH,EAAAnT,MAAAkT,GAAA,GACAC,EAAA7D,SAIAje,QAAA,WACA,MAAA/G,MAAAioB,MAIAjoB,KAAAioB,KAAAvkB,YACA1D,KAAAioB,KAAAvkB,WAAAC,YAAA3D,KAAAioB,iBAGAjoB,MAAAioB,OAPA,GAWAgB,WAAA,WACA5a,EAAAoL,iBAAAva,KAAAc,KAAA,uBAAAmF,UAAA,WAKA+jB,YAAA,WAEA,GAAAC,GAAAnpB,KAAAgoB,UAAAjP,cAAA,wCACAqQ,EAAAppB,KAAAgoB,UAAAjP,cAAA,wCACAsQ,GACA9T,IAAAvV,KAAA2oB,WAAAjT,MAgBA,OAbA1V,MAAAouB,iBACA/E,EAAA9T,IAAAvV,KAAAspB,gBAAAD,EAAA9T,MAGA8T,EAAA7T,OAAA,QACA2T,KAAAI,UACAF,EAAA7T,OAAA,UAGA4T,KAAAG,UACAF,EAAAzT,YAAA5V,KAAAkuB,mBAGA7E,GAGAI,WAAA,WACA,GAAAJ,GAAArpB,KAAAkpB,aACAlpB,MAAA0pB,iBAAAL,IAGAK,iBAAA,SAAAL,GACArpB,KAAA4Q,KAAA+Y,mBACA3pB,KAAA+mB,WAAA/mB,KAAAwa,OAAA6O,GACArpB,KAAA4Q,KAAAiZ,kBAGAP,gBAAA,SAAA5T,GACA,GAAAoU,GAAA,qCACA,QAAAA,EAAAzkB,KAAAqQ,GAAA,cAAAA,GAGAqU,aAAA,WACA/pB,KAAA4Q,KAAA+Y,mBACA3pB,KAAA4Q,KAAAiZ,kBAIAG,iBAAA,SAAA/B,GACA,GAAAxa,GAAAwa,EAAAlP,cAAA,gCACAkR,EAAAhC,EAAAlP,cAAA,+BACA8P,EAAAZ,EAAAlP,cAAA,+BAGA/Y,MAAAsmB,GAAA2B,EAAA,QAAAjoB,KAAAkqB,gBAAA/mB,KAAAnD,OAGAA,KAAAsmB,GAAAuC,EAAA,QAAA7oB,KAAAmqB,mBAAAhnB,KAAAnD,OAGAA,KAAAsmB,GAAA7Y,EAAA,QAAAzN,KAAAoqB,iBAAAjnB,KAAAnD,OAGAA,KAAAsmB,GAAA2D,EAAA,QAAAjqB,KAAAqqB,gBAAAlnB,KAAAnD,OAAA,IAIAkoB,WAAA,WACA,GAAA9U,GAAApT,KAAAQ,SACAynB,EAAA7U,EAAAtT,cAAA,MAQA,OALAmoB,GAAAloB,UAAA,6BACAkoB,EAAAjpB,GAAA,qCAAAgB,KAAAqe,cACA4J,EAAAphB,UAAA7G,KAAAmoB,cACAnoB,KAAAgqB,iBAAA/B,GAEAA,GAGAU,SAAA,WACA,MAAA3oB,MAAAgoB,UAAAjP,cAAA,sCAGAoR,mBAAA,SAAApa,GAEA,MAAAA,GAAAR,UAAAlB,EAAAkB,QAAAG,OACAK,EAAA8W,qBACA7mB,MAAAypB,mBAKA1Z,EAAAR,UAAAlB,EAAAkB,QAAAI,SACAI,EAAA8W,iBACA7mB,KAAA+pB,kBAIAG,gBAAA,SAAAna,GAEAA,EAAA+W,mBAGAuD,gBAAA,SAAAta,GAEAA,EAAA8W,iBACA7mB,KAAAypB,cAGAW,iBAAA,SAAAra,GAEAA,EAAA8W,iBACA7mB,KAAA+pB,oBAIA,IAAAwE,IACA,WAKAA,EAAA5Q,EAAAnN,QACAlI,KAAA,iBAOAkmB,UAAA,IAKAjE,qBAAA,IAGA9N,SAAA,EACAC,QAAA,IACAO,mBAAA,EAEA7O,KAAA,WACApO,KAAAulB,cAAAvlB,KAAAwqB,gBAEAxqB,KAAAid,oBACAjd,KAAAid,kBAAAjd,KAAAQ,SAAAsjB,MAEA9jB,KAAAid,kBAAA1a,YAAAvC,KAAAulB,eAEAvlB,KAAAyqB,qBAGA/E,kBAAA,WACA,MAAA1lB,MAAAulB,eAGAiF,cAAA,WACA,GAAAhX,GAAAxT,KAAAQ,SAAAV,cAAA,MAQA,OANA0T,GAAAxU,GAAA,gCAAAgB,KAAAqe,cACA7K,EAAAzT,UAAA,+BACAyT,EAAA3M,UAAA7G,KAAAmoB,cAEAnoB,KAAAsmB,GAAA9S,EAAA,QAAAxT,KAAAskB,YAAAnhB,KAAAnD,OAEAwT,GAGA2U,YAAA,WACA,0KAKAphB,QAAA,WACA/G,KAAAulB,gBACAvlB,KAAAulB,cAAA7hB,YACA1D,KAAAulB,cAAA7hB,WAAAC,YAAA3D,KAAAulB,qBAEAvlB,MAAAulB,gBAKA0D,WAAA,WACA5a,EAAAoL,iBAAAva,KAAAc,KAAA,uBAAAmF,UAAA,WAGAulB,YAAA,WACA1qB,KAAAulB,cAAA7c,UAAA7F,OAAA,uCACA7C,KAAA2qB,aAAA,MAGAC,YAAA,SAAAC,GACA,MAAA7qB,MAAAulB,cAAA7c,UAAAY,SAAA,wCACAuhB,EAAA9hB,aAAA,yBACA,GAGA/I,KAAAuqB,uBACAvqB,KAAAulB,cAAAxM,cAAA/Y,KAAAuqB,sBAAAnU,YAAAyU,EAAApV,WAAA7R,KAAA8R,MACA1V,KAAAulB,cAAAxM,cAAA/Y,KAAAuqB,sBAAA3mB,KAAAinB,EAAApV,WAAA7R,KAAA8R,OAGA1V,KAAAulB,cAAA7c,UAAAa,IAAA,6BACAvJ,KAAAulB,cAAA7c,UAAA7F,OAAA,8BAEA7C,KAAAulB,cAAA7c,UAAAY,SAAA,wCACAtJ,KAAAulB,cAAA7c,UAAAa,IAAA,uCAGAvJ,KAAA2qB,aAAAE,EAEA7qB,KAAA8qB,kBACA9qB,KAAA+qB,wBAEA/qB,OAGA8qB,gBAAA,WACA,GAGAE,GACAC,EAJAC,EAAAlrB,KAAAulB,cAAA4F,aACAC,EAAAprB,KAAA2qB,aAAAU,wBACAC,GAAAF,EAAAtK,KAAAsK,EAAArK,OAAA,CAIAiK,GAAAhrB,KAAAulB,cAAAgG,YAAA,EACAN,EAAAjrB,KAAAyc,SAAAuO,EAEAhrB,KAAAulB,cAAA5K,MAAA6Q,IAAAC,KAAAC,MAAAR,EAAAE,EAAAO,OAAA3rB,KAAA0c,QAAA1c,KAAAsF,OAAAsmB,YAAA5rB,KAAAulB,cAAA4F,cAAA,KACAH,EAAAM,EACAtrB,KAAAulB,cAAA5K,MAAAmG,KAAAmK,EAAAD,EAAA,KACahrB,KAAAsF,OAAAumB,WAAAP,EAAAN,EACbhrB,KAAAulB,cAAA5K,MAAAmG,KAAA9gB,KAAAsF,OAAAumB,WAAAZ,EAAAD,EAAA,KAEAhrB,KAAAulB,cAAA5K,MAAAmG,KAAAmK,EAAAK,EAAA,MAIAb,kBAAA,WACAzqB,KAAAyG,UAAA,oBAAAzG,KAAA8rB,wBAAA3oB,KAAAnD,QAGAskB,YAAA,SAAAvU,GACA,GAAAgc,GAAA/rB,KAAA4Q,KAAA4U,mBAAA,UACAmF,EAAA3qB,KAAA2qB,YAEAoB,IAAApB,IACA5a,EAAA8W,iBAEA7mB,KAAA4Q,KAAAob,cAAAhsB,KAAA2qB,cAIA3qB,KAAA4Q,KAAA4L,MAAA,WACAmO,IACAoB,EAAAhE,SAAA4C,EAAAlV,WAAA7R,KAAA8R,OACAiV,EAAA,OAEiBxnB,KAAAnD,QAGjBA,KAAA0qB,eAGAuB,qBAAA,WACAjsB,KAAAksB,gBAAA,KACAlsB,KAAAmsB,IAAAnsB,KAAA2qB,aAAA,WAAA3qB,KAAAosB,8BACApsB,KAAAosB,6BAAA,MAGAN,wBAAA,SAAA/b,GACA,GAAAyF,GAAAnH,EAAA2L,cAAAjK,EAAAyF,OAAA,IAEA,SAAAA,EAAA,CAOA,uBAAAnQ,KAAAmQ,EAAA6W,YAAA,oBAAAhnB,KAAAmQ,EAAA6W,WACA,QAIA,IAAArsB,KAAA4Q,KAAAyU,SAAArlB,KAAA4Q,KAAAyU,QAAAyC,cAEA,QAIA9nB,MAAA2qB,cAAA3qB,KAAA2qB,eAAAnV,GACAxV,KAAAssB,wBAGAtsB,KAAAksB,gBAAA1W,EAEAxV,KAAAosB,6BAAApsB,KAAAisB,qBAAA9oB,KAAAnD,MACAA,KAAAsmB,GAAAtmB,KAAAksB,gBAAA,WAAAlsB,KAAAosB,8BAIApsB,KAAA4Q,KAAA4L,MAAA,WACAxc,KAAAksB,iBAEAlsB,KAAA4qB,YAAA5qB,KAAAksB,kBAEa/oB,KAAAnD,SAGbusB,uBAAA,WACAvsB,KAAAwsB,UAAA,GAAApa,OAAAqa,UACAzsB,KAAA0sB,UAAA,GAGAC,sBAAA,SAAA5c,GACAA,EAAA6c,eAAA,iBAAAvnB,KAAA0K,EAAA6c,cAAA7sB,aACAC,KAAA0sB,UAAA,IAIAG,cAAA,WACA,GAAA7sB,KAAA0sB,SACA,QAEA,IAAAI,IAAA,GAAA1a,OAAAqa,UAAAzsB,KAAAwsB,QACAM,GAAA9sB,KAAAwuB,WAEAxuB,KAAAssB,yBAIAA,sBAAA,WAEAU,cAAAhtB,KAAAitB,eACAjtB,KAAAktB,iCACAltB,KAAAmsB,IAAAnsB,KAAAulB,cAAA,YAAAvlB,KAAAktB,gCACAltB,KAAAmsB,IAAAnsB,KAAAulB,cAAA,WAAAvlB,KAAAmtB,+BACAntB,KAAA2qB,eACA3qB,KAAAmsB,IAAAnsB,KAAA2qB,aAAA,YAAA3qB,KAAAktB,gCACAltB,KAAAmsB,IAAAnsB,KAAA2qB,aAAA,WAAA3qB,KAAAmtB,iCAIAntB,KAAA0qB,cAEA1qB,KAAA0sB,SAAA1sB,KAAAktB,+BAAAltB,KAAAmtB,8BAAA,MAIApC,sBAAA,WACA/qB,KAAAwsB,UAAA,GAAApa,OAAAqa,UACAzsB,KAAA0sB,UAAA,EAEA1sB,KAAAktB,+BAAAltB,KAAAusB,uBAAAppB,KAAAnD,MACAA,KAAAmtB,8BAAAntB,KAAA2sB,sBAAAxpB,KAAAnD,MAEAA,KAAAitB,cAAAG,YAAAptB,KAAA6sB,cAAA1pB,KAAAnD,MAAA,KAEAA,KAAAsmB,GAAAtmB,KAAAulB,cAAA,YAAAvlB,KAAAktB,gCACAltB,KAAAsmB,GAAAtmB,KAAAulB,cAAA,WAAAvlB,KAAAmtB,+BACAntB,KAAAsmB,GAAAtmB,KAAA2qB,aAAA,YAAA3qB,KAAAktB,gCACAltB,KAAAsmB,GAAAtmB,KAAA2qB,aAAA,WAAA3qB,KAAAmtB,oCAKA,IAAAsB,GACAC,EACAC,EACAC,CAEAF,IAAA,sCACA,mBACAC,EAAA,k2BAQAC,EACA,qEAEiDD,EAAA,oFAEjDA,EAAA,KAEA,WAKA,QAAAE,GAAA5c,GACA,OAAA5D,EAAA2L,cAAA/H,EAAA,KAHA,GAAA6c,GAAA,GAAA5f,QAAA,KAAAyf,EAAA,SAMAF,GAAA9Q,EAAAnN,QACApC,KAAA,WACApO,KAAA+uB,sBAAA,EACA/uB,KAAAyG,UAAA,mBAAAzG,KAAAgvB,WAAA7rB,KAAAnD,OACAA,KAAAyG,UAAA,eAAAzG,KAAAivB,OAAA9rB,KAAAnD,OAEAA,KAAAQ,SAAAqT,YAAA,wBAGA9M,QAAA,WAEA/G,KAAAQ,SAAAoT,sBAAA,kBACA5T,KAAAQ,SAAAqT,YAAA,wBAIAob,OAAA,SAAAC,EAAAlM,GACAhjB,KAAAmvB,eAAAnM,IAGAgM,WAAA,SAAAI,GACApvB,KAAA+uB,sBAIA1gB,EAAA6B,MAAAkf,GAAA/gB,EAAAkB,QAAAK,MAAAvB,EAAAkB,QAAAG,UACAmD,aAAA7S,KAAAqvB,uBAEArvB,KAAAqvB,sBAAAvc,WAAA,WACA,IACA,GAAAuN,GAAArgB,KAAA4Q,KAAA0e,iBACAtvB,MAAAmvB,eAAAC,EAAA5Z,SAGAxV,KAAA4Q,KAAA2e,gBAAAlP,GAAA,GAEqB,MAAA3Z,GACrBpB,OAAA+T,SACA/T,OAAA+T,QAAAmW,MAAA,4BAAA9oB,GAEA1G,KAAA+uB,sBAAA,IAEiB5rB,KAAAnD,MAAA,KAIjBmvB,eAAA,SAAAM,GAMA,GAAAC,GAAAD,EAAAE,iBAAA,KACAC,GAAA,CACA,KAAAF,EAAA5uB,SACA4uB,GAAAD,GAEA,QAAA5uB,GAAA,EAA2BA,EAAA6uB,EAAA5uB,OAAuBD,IAClD+uB,EAAA5vB,KAAA6vB,4BAAAH,EAAA7uB,KAAA+uB,EACAA,EAAA5vB,KAAA8vB,4BAAAJ,EAAA7uB,KAAA+uB,CAEA,OAAAA,IAGAG,uBAAA,SAAA3Q,EAAA4Q,EAAAC,GACA,MAAAD,KAAAC,EACA7Q,EAAA8Q,UAAAF,EAAAC,GAEA,MAGAE,qBAAA,SAAA/Q,EAAAgR,EAAAC,EAAAJ,GACA,GAAAK,GACAC,CACAD,GAAAL,GAAAG,GAAAhR,GAAAxN,UAAA9Q,QACAsvB,EAAAhR,EAAAxN,UAAA9Q,OAAA,GACA,EACAyvB,GAAAH,GAAAhR,GAAAxN,UAAA9Q,QACAwvB,EAAA,EAAAD,GACAC,GAAAD,GACAJ,IAAAK,GACA,IAAAC,IACAH,GAAAhR,GAAA8Q,UAAAK,IAIAV,4BAAA,SAAA7Z,GAIA,OAHAwa,GAAAxa,EAAA2Z,iBAAA,+BACAC,GAAA,EAEA/uB,EAAA,EAA2BA,EAAA2vB,EAAA1vB,OAAkBD,IAAA,CAC7C,GAAAuV,GAAAoa,EAAA3vB,GAAAuV,WAIA,IAHA,KAAAA,EAAAlO,QAAA,SACAkO,EAAA/H,EAAA6K,qBAAA9C,IAEAoa,EAAA3vB,GAAAkI,aAAA,eAAAqN,GAAAyY,EAAA2B,EAAA3vB,IAAA,CACA+uB,GAAA,CACA,IAAAa,GAAAra,EAAArO,QAAA,UACA,IAAAyoB,EAAA3vB,GAAAkI,aAAA,eAAA0nB,EAAA,CACA,GAAAC,GAAAta,EAAAtV,OAAA2vB,EAAA3vB,OACA6vB,EAAAtiB,EAAAiI,gBAAAka,EAAA3vB,GAAAb,KAAA4wB,mBAAAJ,EAAA3vB,GAAA6vB,GACAF,GAAA3vB,GAAA6C,WAAAY,aAAAqsB,EAAAH,EAAA3vB,GAAAoW,iBAIA5I,GAAA6H,OAAAsa,EAAA3vB,GAAAb,KAAAQ,WAIA,MAAAovB,IAGAgB,mBAAA,SAAA5a,EAAA6a,GAKA,IAJA,GAAAnR,GAAA1f,KAAAQ,SAAAmf,iBAAA3J,EAAAvE,WAAAC,UAAA,SACAof,GAAA,EAGAA,GACAA,EAAA,OAAApR,EAAAjI,WAMA,KAHA,GAAA2H,GACA2R,EACAC,EACAH,EAAA,UAAAG,GACA5R,EAAAM,EAAAN,YACA2R,EAAA3R,EAAAxN,UACAmf,EAAAjwB,OAAA+vB,GACAG,EAAA5R,EAAA8Q,UAAAa,EAAAjwB,OAAA+vB,GACAA,EAAA,IAEAG,EAAAtR,EAAAsR,eACAH,GAAAE,EAAAjwB,OAGA,OAAAkwB,IAGAlB,4BAAA,SAAA9Z,GAIA,OAHAib,GAAAjxB,KAAAkxB,iBAAAlb,GACAmb,GAAA,EAEAC,EAAA,EAAoCA,EAAAH,EAAAnwB,OAA6BswB,IACjED,EAAAnxB,KAAA4pB,WAAA5pB,KAAAqxB,8BAAArb,EAAAib,EAAAG,IACAH,EAAAG,GAAAxtB,OAAAutB,CAEA,OAAAA,IAGAD,iBAAA,SAAAzB,GAMA,IALA,GAAA6B,GAAA,GAAApiB,QAAA0f,EAAA,MACAxY,EAAAqZ,EAAArZ,YACArL,EAAA,KACAkmB,KAEA,QAAAlmB,EAAAumB,EAAAniB,KAAAiH,KAAA,CACA,GAAAmb,IAAA,EACAC,EAAAzmB,EAAAhH,MAAAgH,EAAA,GAAAjK,MAEAywB,KAAA,IAAAxmB,EAAAhH,OAAA,KAAA2qB,EAAAxmB,QAAAkO,EAAArL,EAAAhH,MAAA,KACAytB,IAAApb,EAAAtV,QAAA,KAAA4tB,EAAAxmB,QAAAkO,EAAAob,KAEAD,MAAA,KAAAxmB,EAAA,GAAA7C,QAAA,MACA4mB,EAAAzpB,KAAA0F,EAAA,GAAA9B,MAAA,KAAAmR,MAAAnR,MAAA,KAAAwoB,UAEAF,GACAN,EAAAjwB,MACA4C,KAAAmH,EAAA,GACAuC,MAAAvC,EAAAhH,MACAwJ,IAAAikB,IAIA,MAAAP,IAGAI,8BAAA,SAAArb,EAAAjL,GAQA,IAPA,GAAA2U,GAAA1f,KAAAQ,SAAAmf,iBAAA3J,EAAAvE,WAAAC,UAAA,SACAggB,KACAzB,EAAA,EACA0B,GAAA,EACAvS,EAAA,KACAgR,EAAA,KAEA,QAAAhR,EAAAM,EAAArO,eACAsgB,GAAA5mB,EAAAuC,MAAA2iB,EAAA7Q,EAAAxN,UAAA9Q,SACA6wB,GAAA,EACAvB,EAAApwB,KAAA+vB,uBAAA3Q,EAAArU,EAAAuC,MAAA2iB,IAEA0B,GACA3xB,KAAAmwB,qBAAA/Q,EAAAgR,EAAArlB,EAAAwC,IAAA0iB,IAEA0B,GAAA1B,IAAAllB,EAAAwC,MARA,CAUiB,GAAAokB,GAAA1B,EAAAllB,EAAAwC,IAAA,EACjB,SAAAlE,OAAA,sCAGAsoB,IACAD,EAAA1wB,KAAAovB,GAAAhR,GAGA6Q,GAAA7Q,EAAAxN,UAAA9Q,OACA,OAAAsvB,IACAH,GAAAG,EAAAxe,UAAA9Q,OAEA4e,EAAArO,YAEA+e,EAAA,KAEA,MAAAsB,IAGA9H,WAAA,SAAAgI,EAAAhuB,GAEA,OADAiuB,IAAA,EACAhxB,EAAA,EAA2BA,EAAA+wB,EAAA9wB,QAAA+wB,KAAA,EAAiDhxB,IAE5EgxB,IAAAxjB,EAAA0E,WAAA6e,EAAA/wB,GAAA,SAAAoR,GACA,YAAAA,EAAAyG,SAAAjT,eACAwM,EAAAlJ,cAAA,SAAAkJ,EAAAlJ,aAAA,mBAGA,IAAA8oB,EACA,QAGA,IAAAC,GAAA9xB,KAAAQ,SAAAV,cAAA,KACAiyB,EAAA/xB,KAAAQ,SAAAV,cAAA,QACAkyB,EAAA3jB,EAAA6K,qBAAAtV,EAOA,OANAyK,GAAA8I,yBAAAya,EAAA,GAAAA,IAAA9wB,OAAA,GAAAixB,GACAA,EAAAxtB,aAAA,yBACAwtB,EAAAxtB,aAAA,YAAAytB,GACAF,EAAAvtB,aAAA,OAAAytB,GACAD,EAAAruB,WAAAY,aAAAwtB,EAAAC,GACAD,EAAAvvB,YAAAwvB,IACA,OAIA,IAAAE,IAEA,WAGAA,EAAAtU,EAAAnN,QACApC,KAAA,WACApO,KAAAyG,UAAA,eAAAzG,KAAAkyB,WAAA/uB,KAAAnD,OACAA,KAAAyG,UAAA,eAAAzG,KAAA6kB,WAAA1hB,KAAAnD,QAGAkyB,WAAA,SAAAniB,GACA,GAAAhQ,GAAA,wBACAgQ,GAAA8W,iBACA9W,EAAAoiB,aAAAC,WAAA,OAEA,aAAAriB,EAAAzN,KACAyN,EAAAyF,OAAA9M,UAAAa,IAAAxJ,GACa,cAAAgQ,EAAAzN,MACbyN,EAAAyF,OAAA9M,UAAA7F,OAAA9C,IAIA8kB,WAAA,SAAA9U,GACA,GACAsiB,GADAtyB,EAAA,wBAEAgQ,GAAA8W,iBACA9W,EAAA+W,kBAIA/W,EAAAoiB,aAAAE,QACAA,EAAApqB,MAAA6C,UAAAuC,MAAAnO,KAAA6Q,EAAAoiB,aAAAE,MAAA,GACAA,EAAAvM,KAAA,SAAAwM,GACA,GAAAA,EAAAhwB,KAAAyI,MAAA,UACA,GAAAwnB,GAAAvzB,CACAuzB,GAAA,GAAAC,YACAD,EAAAE,cAAAH,GAEAtzB,EAAA,mBAAAoT,MACA/D,EAAA8E,kBAAAnT,KAAAQ,SAAA,yCAAAxB,EAAA,QAEAuzB,EAAAG,OAAA,WACA,GAAAC,GAAA3yB,KAAAQ,SAAAC,eAAAzB,EACA2zB,KACAA,EAAA9Y,gBAAA,MACA8Y,EAAA9Y,gBAAA,SACA8Y,EAAAC,IAAAL,EAAA3xB,SAEyBuC,KAAAnD,QAERmD,KAAAnD,QAEjB+P,EAAAyF,OAAA9M,UAAA7F,OAAA9C,QAKA,IAAA8yB,IACA,WAKAA,EAAA9E,EAAAvd,QAEAlI,KAAA,WACAkS,OAAA,WACAC,KAAA,8BACAI,eAAA,SACAC,UAAA,oCAIAwJ,YAAA,SAAAsC,GAIA,GAHAA,EAAAC,iBACAD,EAAAE,mBAEA9mB,KAAA8nB,cAAA,CAEA,GAAAyF,GAAAvtB,KAAAQ,SAAAgtB,kBAAA,cACAxtB,MAAA+nB,SAAAwF,GAGA,UAIAvF,QAAA,WAIA,MAHAhoB,MAAAioB,OACAjoB,KAAAioB,KAAAjoB,KAAAkoB,cAEAloB,KAAAioB,MAIAH,YAAA,WACA,gBAAA9nB,KAAAgoB,UAAArN,MAAA8N,SAGAC,SAAA,WACA1oB,KAAAgoB,UAAArN,MAAA8N,QAAA,OACAzoB,KAAA2oB,WAAAjT,MAAA,IAGAqS,SAAA,SAAAwF,GACA,GAAA1E,GAAA7oB,KAAA2oB,UAEA3oB,MAAA4Q,KAAAkY,gBACA9oB,KAAA4Q,KAAAmY,4BACA/oB,KAAAgoB,UAAArN,MAAA8N,QAAA,QACAzoB,KAAA4Q,KAAAoY,qBAEAH,EAAAnT,MAAA6X,GAAA,GACA1E,EAAA7D,SAIAje,QAAA,WACA,MAAA/G,MAAAioB,MAIAjoB,KAAAioB,KAAAvkB,YACA1D,KAAAioB,KAAAvkB,WAAAC,YAAA3D,KAAAioB,iBAGAjoB,MAAAioB,OAPA,GAWAgB,WAAA,WACA5a,EAAAoL,iBAAAva,KAAAc,KAAA,uBAAAmF,UAAA,WAKAskB,WAAA,WACAzpB,KAAA4Q,KAAA+Y,mBACA3pB,KAAA4Q,KAAAiZ,kBAGAE,aAAA,WACA/pB,KAAA4Q,KAAA+Y,mBACA3pB,KAAAytB,gBACAztB,KAAA4Q,KAAAiZ,kBAIA3B,WAAA,WACA,GAAA9U,GAAApT,KAAAQ,SACAynB,EAAA7U,EAAAtT,cAAA,OACA+oB,EAAAzV,EAAAtT,cAAA,SACA2N,EAAA2F,EAAAtT,cAAA,KACAmqB,EAAA7W,EAAAtT,cAAA,IAyCA,OAtCAmoB,GAAAloB,UAAA,6BACAkoB,EAAAjpB,GAAA,uCAAAgB,KAAAqe,cAGAre,KAAAsmB,GAAA2B,EAAA,QAAAjoB,KAAAkqB,gBAAA/mB,KAAAnD,OAGA6oB,EAAAtkB,aAAA,gBACAskB,EAAAtkB,aAAA,WACAskB,EAAAtkB,aAAA,WACAskB,EAAA9oB,UAAA,8BACAkoB,EAAA1lB,YAAAsmB,GAGA7oB,KAAAsmB,GAAAuC,EAAA,SAAA7oB,KAAA0tB,mBAAAvqB,KAAAnD,OAGAiqB,EAAA1lB,aAAA,YACA0lB,EAAAlqB,UAAA,4BACAkqB,EAAApjB,UAAA,gBAAA7G,KAAAse,gBAAA,gBACA,8BACA,WACA2J,EAAA1lB,YAAA0nB,GAGAjqB,KAAAsmB,GAAA2D,EAAA,QAAAjqB,KAAAqqB,gBAAAlnB,KAAAnD,OAAA,GAGAyN,EAAAlJ,aAAA,YACAkJ,EAAA1N,UAAA,6BACA0N,EAAA5G,UAAA,gBAAA7G,KAAAse,gBAAA,gBACA,8BACA,UACA2J,EAAA1lB,YAAAkL,GAGAzN,KAAAsmB,GAAA7Y,EAAA,QAAAzN,KAAAoqB,iBAAAjnB,KAAAnD,OAEAioB,GAGAU,SAAA,WACA,MAAA3oB,MAAAgoB,UAAAjP,cAAA,sCAGA0U,cAAA,WACA1Y,EAAAmM,oBAAAlhB,KAAAQ,UAAAoX,QAAA,SAAApE,GACA,SAAAA,EAAA2B,SAAA3B,EAAAma,aAAA,SACAna,EAAAqG,gBAAA,WAKA6T,mBAAA,WACA,GAAAtiB,GAAApL,KAAA2oB,WAAAjT,KACA,OAAAtK,EACApL,KAAAytB,gBAEAztB,KAAA+mB,WAAA,YAA6C3b,UAI7C8e,gBAAA,SAAAna,GAEAA,EAAA+W,mBAGAuD,gBAAA,SAAAta,GAEAA,EAAA8W,iBACA7mB,KAAAypB,cAGAW,iBAAA,SAAAra,GAEAA,EAAA8W,iBACA7mB,KAAA+pB,oBAIA,IAAA+I,IAEA,WASA,QAAAC,KACA,QAGA,GAAA7jB,QAAA,yCACA,GAAAA,QAAA,6BAGA,GAAAA,QAAA,0DACA,GAAAA,QAAA,oDAGA,GAAAA,QAAA,6FAAwF,4CAGxF,GAAAA,QAAA,8EAGA,GAAAA,QAAA,2EAGA,GAAAA,QAAA,0BAA6C,WAG7C,GAAAA,QAAA,sJAAyK,kBAIzK,GAAAA,QAAA,uBACA,GAAAA,QAAA,kBAGA,GAAAA,QAAA;CAKA4jB,EAAAnV,EAAAnN,QAMAwiB,gBAAA,EAKAC,iBAAA,EAMAC,qBAMAC,YAAA,uBAMAC,WAAA,QAGA/V,aAAA,EACAV,eAAA,EAEAvO,KAAA,YACApO,KAAAgzB,gBAAAhzB,KAAAizB,kBACAjzB,KAAAyG,UAAA,gBAAAzG,KAAA8kB,YAAA3hB,KAAAnD,QAIA8kB,YAAA,SAAA/U,EAAAiG,GACA,GAAA0Z,GAEArwB,EAGAg0B,EACAC,EALAjgB,EAAA,GAEAkgB,EAAA,YACAC,EAAA,YAeA,IAXAxzB,KAAAsF,OAAAmuB,eAAAra,SAAArJ,EAAA0jB,gBACA1jB,EAAA0jB,cAAAzzB,KAAAsF,OAAAmuB,cAMAF,EAAA,OACAC,EAAA,QAGAzjB,EAAA0jB,eACA1jB,EAAA0jB,cAAAC,UACA3jB,EAAA4jB,iBAAA,CAMA,GALA5jB,EAAA8W,iBAEAwM,EAAAtjB,EAAA0jB,cAAAC,QAAAH,GACAD,EAAAvjB,EAAA0jB,cAAAC,QAAAF,GAEAxzB,KAAAizB,iBAAAI,EACA,MAAArzB,MAAA4zB,WAAAP,EAGA,IAAArzB,KAAA2c,eAAA3G,EAAAjN,aAAA,uBAaAsK,EAAAhF,EAAA6E,aAAAogB,OAVA,IAFA5D,EAAA4D,EAAArqB,MAAA,YAEAymB,EAAA5uB,OAAA,EACA,IAAAzB,EAAA,EAAmCA,EAAAqwB,EAAA5uB,OAAuBzB,GAAA,EAC1D,KAAAqwB,EAAArwB,KACAgU,GAAA,MAAAhF,EAAA6E,aAAAwc,EAAArwB,IAAA,YAIAgU,GAAAhF,EAAA6E,aAAAwc,EAAA,GAKArhB,GAAA8E,kBAAAnT,KAAAQ,SAAA6S,KAIAugB,WAAA,SAAAh0B,GACA,GAAAiB,GAAAgzB,EACAC,EAAA,cAAAzuB,KAAAzF,GACAm0B,EAAAhB,IAAAtiB,OAAAzQ,KAAAkzB,sBAEA,KAAAryB,EAAA,EAAuBA,EAAAkzB,EAAAjzB,OAAyBD,GAAA,EAChDjB,IAAAmI,QAAAgsB,EAAAlzB,GAAA,GAAAkzB,EAAAlzB,GAAA,GAGA,OAAAizB,IAKAD,EAAAj0B,EAAAqJ,MAAA,gBAEAjJ,MAAAg0B,UAAA,MAAAH,EAAA5yB,KAAA,oBANAjB,KAAAg0B,UAAAp0B,IASAo0B,UAAA,SAAA3gB,EAAAhT,GACAA,EAAAgO,EAAAqC,YAAsCrQ,GACtC8yB,WAAAnzB,KAAAmzB,WACAC,UAAApzB,KAAAozB,WAGA,IAAAS,GAAAI,EAAApzB,EAAAqzB,EAAAC,EAAAn0B,KAAAQ,SAAA8T,wBAUA,KARA6f,EAAA5xB,YAAAvC,KAAAQ,SAAAV,cAAA,SAEAo0B,EAAAC,EAAApb,cAAA,QACAmb,EAAArtB,UAAAwM,EAEArT,KAAAo0B,aAAAF,GAEAL,EAAAK,EAAAvE,iBAAA,KACA9uB,EAAA,EAAuBA,EAAAgzB,EAAA/yB,OAAmBD,GAAA,EAC1CozB,EAAAJ,EAAAhzB,GAEA,MAAAozB,EAAA9e,QAAA1P,eAAAzF,KAAAqd,aACAhP,EAAAgH,eAAA4e,GAGA5lB,EAAAqL,aAAAua,EAAA5zB,EAAA8yB,YACA9kB,EAAAyL,YAAAma,EAAA5zB,EAAA+yB,UAKA,KADAS,EAAAK,EAAAvE,iBAAA,cACA9uB,EAAA,EAAuBA,EAAAgzB,EAAA/yB,OAAmBD,GAAA,EAQ1C,OAPAozB,EAAAJ,EAAAhzB,GAKAozB,EAAAptB,UAAAotB,EAAAptB,UAAAkB,QAAA,YAEAksB,EAAAvb,SAAAjT,eACA,QACA,UACAzF,KAAAq0B,mBAAAJ,EACA,MACA,UACAj0B,KAAAs0B,gBAAAL,GAKA5lB,EAAA8E,kBAAAnT,KAAAQ,SAAA0zB,EAAArtB,UAAAkB,QAAA,UAAwF,OAGxFwsB,cAAA,SAAA/gB,GACA,MAAAA,KAAA,MAAAA,EAAA2B,QAAA1P,eAAA,QAAA+N,EAAA2B,QAAA1P,gBAGA4uB,mBAAA,SAAA7gB,GACA,QAAAnO,KAAAmO,EAAA4C,cAAA5C,EAAA9P,YACA8P,EAAA9P,WAAAC,YAAA6P,IAIA8gB,gBAAA,SAAA9gB,GACAxT,KAAAu0B,cAAA/gB,EAAAghB,wBAEAx0B,KAAAy0B,iBAAAjhB,IACaxT,KAAAu0B,cAAA/gB,EAAA9P,aAAA8P,EAAA9P,WAAAc,aAAAgP,KAAA9P,WAAA+T,YAAAjE,EAGAA,EAAA9P,YAAA,IAAA8P,EAAA9P,WAAAgxB,mBAAA,KAAAlhB,EAAA9P,WAAA0S,aAEbpW,KAAAy0B,iBAAAjhB,GAHAxT,KAAAy0B,iBAAAjhB,IAQAihB,iBAAA,SAAAjhB,GACAA,KAAA9P,aACA8P,EAAA9P,uBAAA,IAAA8P,EAAA9P,WAAAgxB,kBACAlhB,EAAA9P,sBAAAC,YAAA6P,EAAA9P,YAEA8P,EAAA9P,WAAAC,YAAA6P,KAKA4gB,aAAA,SAAAO,GACA,GAAA9zB,GACA2S,EACAohB,EACApE,EAAAmE,EAAAhF,iBAAA,iBACAkF,EAAA,SAAArhB,GACA,MAAAA,IAAA,UAAAA,EAAAkF,UAAA,UAAAlF,EAAAzK,aAAA,mBAGA,KAAAlI,EAAA,EAAuBA,EAAA2vB,EAAA1vB,OAAkBD,GAAA,EACzC2S,EAAAgd,EAAA3vB,GACA+zB,EAAA50B,KAAAQ,SAAAV,cAAA0T,EAAA9K,UAAAY,SAAA,iBAEAkK,EAAA9K,UAAAY,SAAA,SAAAkK,EAAA9K,UAAAY,SAAA,UAEAsrB,EAAA/tB,UAAA,MAAA2M,EAAA3M,UAAA,OAEA+tB,EAAA/tB,UAAA2M,EAAA3M,UAEA2M,EAAA9P,WAAAwW,aAAA0a,EAAAphB,EAIA,KADAgd,EAAAmE,EAAAhF,iBAAA,QACA9uB,EAAA,EAAuBA,EAAA2vB,EAAA1vB,OAAkBD,GAAA,GAIzC,GAHA2S,EAAAgd,EAAA3vB,GAGAwN,EAAA0E,WAAAS,EAAAqhB,GACA,QAIAxmB,GAAA6H,OAAA1C,EAAAxT,KAAAQ,gBAMA,IAAAs0B,IAEA,WAKAA,EAAAnX,EAAAnN,QACAlI,KAAA,cAOA1I,KAAA,iBAKAm1B,aAAA,EAEA3mB,KAAA,WACApO,KAAAg1B,mBACAh1B,KAAAi1B,uBAGAD,iBAAA,WACAh1B,KAAAoe,oBAAAxG,QAAA,SAAApE,GACAA,EAAAzK,aAAA,qBACAyK,EAAAjP,aAAA,mBAAAvE,KAAAJ,MAEAI,KAAAk1B,kBAAA1hB,IACaxT,OAGb+G,QAAA,WACA/G,KAAAoe,oBAAAxG,QAAA,SAAApE,GACAA,EAAAzK,aAAA,sBAAA/I,KAAAJ,MACA4T,EAAAqG,gBAAA,qBAEa7Z,OAGbm1B,gBAAA,SAAA3hB,GACAA,GACAA,EAAA9K,UAAAa,IAAA,8BAIA6rB,gBAAA,SAAA5hB,GACAA,GACAA,EAAA9K,UAAA7F,OAAA,8BAIAqyB,kBAAA,SAAA1hB,GAEA,MAAAA,GAAAuF,cAAA,iCAAAvF,EAAA4C,YAAArO,QAAA,qBAIA/H,MAAAo1B,gBAAA5hB,GAHAxT,KAAAm1B,gBAAA3hB,IAMAyhB,oBAAA,WAEAj1B,KAAAyG,UAAA,OAAAzG,KAAAq1B,0BAAAlyB,KAAAnD,OAGAA,KAAAyG,UAAA,eAAAzG,KAAAukB,WAAAphB,KAAAnD,OAGAA,KAAA+0B,YACA/0B,KAAAyG,UAAA,gBAAAzG,KAAAs1B,2BAAAnyB,KAAAnD,OAEAA,KAAAyG,UAAA,gBAAAzG,KAAAukB,WAAAphB,KAAAnD,OAIAA,KAAAyG,UAAA,mBAAAzG,KAAAs1B,2BAAAnyB,KAAAnD,OACAA,KAAAyG,UAAA,gBAAAzG,KAAAs1B,2BAAAnyB,KAAAnD,QAGAs1B,2BAAA,SAAAvlB,EAAAiG,GAEAhW,KAAAo1B,gBAAApf,IAGAuO,WAAA,SAAAxU,EAAAiG,GAEAhW,KAAAk1B,kBAAAlf,IAGAqf,0BAAA,WAEAr1B,KAAAg1B,wBAKA,IAAAO,IAEA,WAGAA,EAAA,SAAA3T,GACA5hB,KAAA4Q,KAAAgR,EACA5hB,KAAAK,QAAAuhB,EAAAvhB,QAEAL,KAAAw1B,wBAGAD,EAAAzqB,WAGA2qB,cAAA,WACA,GAAApQ,GAAArlB,KAAA4Q,KAAAvQ,QAAA+Q,cAAAtR,cAAA,MAsBA,OApBAulB,GAAArmB,GAAA,yBAAAgB,KAAA4Q,KAAA5R,GACAqmB,EAAAtlB,UAAA,wBAEAC,KAAAK,QAAAq1B,cACArQ,EAAAtlB,WAAA,kBAEAslB,EAAAtlB,WAAA,mBAGAslB,EAAA9iB,YAAAvC,KAAA21B,wBAGA31B,KAAA4Q,KAAAglB,SAAAhe,QAAA,SAAAie,GACAA,EAAAnO,SACArC,EAAA9iB,YAAAszB,EAAA7N,aAIAhoB,KAAAi1B,sBAEA5P,GAGAsQ,qBAAA,WACA,GACAG,GACAC,EACAz1B,EACAu1B,EAJAG,EAAAh2B,KAAA4Q,KAAAvQ,QAAA+Q,cAAAtR,cAAA,KA8BA,OAxBAk2B,GAAAh3B,GAAA,gCAAAgB,KAAA4Q,KAAA5R,GACAg3B,EAAAj2B,UAAA,yCACAi2B,EAAArb,MAAA8N,QAAA,QAEAzoB,KAAA4Q,KAAAvQ,QAAAC,QAAAsX,QAAA,SAAAwO,GACAyP,EAAA71B,KAAA4Q,KAAA4U,mBAAAY,GACA,kBAAAyP,GAAAtP,YACAwP,EAAAF,EAAAtP,UAAAvmB,KAAA4Q,MACAklB,EAAA91B,KAAA4Q,KAAAvQ,QAAA+Q,cAAAtR,cAAA,MACAuO,EAAA6D,UAAA6jB,GACAD,EAAAvzB,YAAAwzB,GAEAD,EAAAjvB,UAAAkvB,EAEAC,EAAAzzB,YAAAuzB,KAEa3yB,KAAAnD,OAEbM,EAAA01B,EAAArG,iBAAA,UACArvB,EAAAQ,OAAA,IACAR,EAAA,GAAAoI,UAAAa,IAAAvJ,KAAAK,QAAAmd,kBACAld,IAAAQ,OAAA,GAAA4H,UAAAa,IAAAvJ,KAAAK,QAAAod,kBAGAuY,GAGAjvB,QAAA,WACA/G,KAAAqlB,UACArlB,KAAAqlB,QAAA3hB,YACA1D,KAAAqlB,QAAA3hB,WAAAC,YAAA3D,KAAAqlB,eAEArlB,MAAAqlB,UAKA4D,WAAA,WACA5a,EAAAoL,iBAAAva,KAAAc,KAAA,uBAAAmF,UAAA,WAKAmgB,kBAAA,WAKA,MAJAtlB,MAAAqlB,UACArlB,KAAAqlB,QAAArlB,KAAAy1B,iBAGAz1B,KAAAqlB,SAGA4Q,yBAAA,WACA,MAAAj2B,MAAAslB,oBAAAvM,cAAA,mCAKAyc,qBAAA,WAIAx1B,KAAAk2B,yBAAA7nB,EAAAgE,SAAA,WACArS,KAAA4Q,KAAAoN,UACAhe,KAAAm2B,0BAEahzB,KAAAnD,QAGbi1B,oBAAA,WAEAj1B,KAAA4Q,KAAAnK,UAAA,OAAAzG,KAAAukB,WAAAphB,KAAAnD,OACAA,KAAA4Q,KAAAnK,UAAA,QAAAzG,KAAAo2B,YAAAjzB,KAAAnD,OAGAA,KAAA4Q,KAAAnK,UAAA,gBAAAzG,KAAAq2B,oBAAAlzB,KAAAnD,OACAA,KAAA4Q,KAAAnK,UAAA,gBAAAzG,KAAAs2B,oBAAAnzB,KAAAnD,OAGAA,KAAA4Q,KAAA0V,GAAAtmB,KAAAK,QAAA+Q,cAAAmlB,gBAAA,UAAAv2B,KAAAw2B,sBAAArzB,KAAAnD,OAGAA,KAAAK,QAAAq1B,eAAA11B,KAAAK,QAAAo2B,eAEAz2B,KAAA4Q,KAAA0V,GAAAtmB,KAAAK,QAAA+c,cAAA,SAAApd,KAAA02B,mBAAAvzB,KAAAnD,OAAA,GAIAA,KAAA4Q,KAAA0V,GAAAtmB,KAAAK,QAAA+c,cAAA,SAAApd,KAAA22B,mBAAAxzB,KAAAnD,QAGA02B,mBAAA,WACA12B,KAAAm2B,0BAGAQ,mBAAA,WACA32B,KAAAk2B,4BAGAM,sBAAA,SAAAzmB,GAEA,MAAAA,IACAA,EAAAyF,QACAnH,EAAAwD,aAAA7R,KAAAslB,oBAAAvV,EAAAyF,SACA,MAEAxV,MAAA8d,cAGAuY,oBAAA,WAGAvjB,WAAA,WACA9S,KAAA8d,cACa3a,KAAAnD,MAAA,IAGbs2B,oBAAA,WACAt2B,KAAA8d,cAGAyG,WAAA,WAEA1R,aAAA7S,KAAA42B,aAIA/jB,aAAA7S,KAAA62B,kBAGA72B,KAAA42B,YAAA9jB,WAAA,WACA9S,KAAA82B,eACa3zB,KAAAnD,MAAA,IAGbo2B,YAAA,WACAp2B,KAAA8d,cAKAgK,YAAA,WACA,MAAA9nB,MAAAslB,oBAAA5c,UAAAY,SAAA,iCAGAytB,YAAA,WACAlkB,aAAA7S,KAAA42B,aACA52B,KAAA8nB,gBACA9nB,KAAAslB,oBAAA5c,UAAAa,IAAA,gCACAvJ,KAAA4Q,KAAAomB,QAAA,iBAAmDh3B,KAAA4Q,KAAAgV,qBAEnD,kBAAA5lB,MAAAK,QAAA42B,gBACA5oB,EAAAyG,WAAA,yDACA9U,KAAAK,QAAA42B,mBAKAH,YAAA,WACA92B,KAAA8nB,gBACA9nB,KAAAslB,oBAAA5c,UAAA7F,OAAA,gCACA7C,KAAA4Q,KAAAomB,QAAA,iBAAmDh3B,KAAA4Q,KAAAgV,qBAEnD5lB,KAAA4Q,KAAAglB,SAAAhe,QAAA,SAAAie,GACA,kBAAAA,GAAAqB,SACA7oB,EAAAyG,WAAA,kDACA+gB,EAAAqB,YAIA,kBAAAl3B,MAAAK,QAAA82B,gBACA9oB,EAAAyG,WAAA,yDACA9U,KAAAK,QAAA82B,mBAKAC,iCAAA,WACA,gBAAAp3B,KAAAi2B,2BAAAtb,MAAA8N,SAGAM,0BAAA,WACA/oB,KAAAo3B,qCACAp3B,KAAAi2B,2BAAAtb,MAAA8N,QAAA,SAIA4O,0BAAA,WACAr3B,KAAAs3B,qBAEAt3B,KAAAo3B,qCACAp3B,KAAAi2B,2BAAAtb,MAAA8N,QAAA,SAKAzoB,KAAA62B,iBAAA72B,KAAA4Q,KAAA4L,MAAA,WACAxc,KAAA+2B,eACa5zB,KAAAnD,QAGbs3B,mBAAA,WAEAt3B,KAAA4Q,KAAAglB,SAAAhe,QAAA,SAAAie,GACAA,EAAAnO,SAAAmO,EAAA/N,eACA+N,EAAAnN,cAQA6O,8BAAA,WACA,GAAAC,GAAA,4BACAC,EAAA,GAAAvoB,QAAA,KAAAb,EAAAkC,eAAAtP,KAAA,oBACAy2B,EAAA3iB,EAAAoL,iBAAAjhB,KAAAc,MAAA+H,QAAAyvB,EAAA,IACAG,EAAAD,EAAA3sB,MAAA0sB,EAEA,SAAAE,KAAA72B,OAAA,GAGA82B,gBAAA,WACA,GAAAtkB,GAAAtT,KAAAK,QAAA+c,cAAApJ,eACA6jB,EAAAvkB,EAAAW,WAAA,EAkBA,IAAAjU,KAAAK,QAAA8c,2BACA0a,EAAA5Y,eAAArN,WACAimB,EAAA3Y,cAAA2Y,EAAA5Y,eAAArN,UAAA9Q,OAAA,CACA,GAAAg3B,GAAAzpB,EAAA4C,gCAAA8D,EAAA8J,oBAAA7e,KAAAK,QAAA+c,eAAAya,EAAA5Y,eAAAjf,KAAAK,QAAA+Q,cACA,IAAA0mB,EAAA,CAEA,IADA,GAAArW,GAAA,EACA,IAAAqW,EAAAlmB,UAAAmmB,OAAAtW,EAAA,GAAA3Z,OAAAhH,QACA2gB,GAAA,CAEA,IAAAuW,GAAAh4B,KAAAK,QAAA+Q,cAAAmQ,aACAyW,GAAA1Y,SAAAwY,EAAArW,GACAuW,EAAArX,OAAAkX,EAAAjX,aAAAiX,EAAAhX,WACAvN,EAAAqB,kBACArB,EAAAsB,SAAAojB,GACAH,EAAAG,KAKAla,WAAA,WACA,IAAA9d,KAAA4Q,KAAAqnB,wBAAA,CAMA,IAAAj4B,KAAA4Q,KAAAgV,qBACA7Q,EAAAgL,gCAAA/f,KAAAK,QAAA+c,eACA,MAAApd,MAAA82B,aAMA,IAAAoB,GAAAnjB,EAAA8J,oBAAA7e,KAAAK,QAAA+c,cACA,QAAA8a,GACA,KAAAl4B,KAAA4Q,KAAAzC,SAAAjG,QAAAgwB,IACAA,EAAAnvB,aAAA,wBACA/I,KAAA82B,cAMA92B,KAAAK,QAAA83B,wBAAAn4B,KAAAK,QAAAq1B,cACA11B,KAAAo4B,uBAIA,KAAAp4B,KAAAK,QAAA+c,cAAApJ,eAAArT,WAAAmH,QACA9H,KAAAK,QAAAic,gCAAA,GAAAtc,KAAAu3B,gCACAv3B,KAAA82B,kBAGA92B,MAAAo4B,yBAIAxS,kBAAA,WACA,MAAA5lB,MAAA4Q,KAAAgV,qBAKAwS,qBAAA,WACAp4B,KAAA43B,kBACA53B,KAAAq4B,yBACAr4B,KAAA4Q,KAAAomB,QAAA,qBAAmDh3B,KAAA4Q,KAAAgV,qBACnD5lB,KAAAq3B,4BACAr3B,KAAAgpB,sBAGAqP,uBAAA,WACAr4B,KAAA4Q,KAAAglB,SAAAhe,QAAA,SAAAie,GACA,kBAAAA,GAAA7X,UACA,kBAAA6X,GAAA1X,aACA0X,EAAA1X,eAEahb,KAAAnD,OAEbA,KAAAs4B,sBAGAA,mBAAA,WACA,GAGA50B,GAHA60B,KACAtR,EAAA,KACA4Q,EAAA9iB,EAAAF,kBAAA7U,KAAAK,QAAA+Q,eAEAonB,EAAA,SAAA3C,GACA,kBAAAA,GAAA/X,WACA+X,EAAA/X,WAAApa,GACqB,kBAAAmyB,GAAA7X,UACrB,kBAAA6X,GAAA5X,kBACA,kBAAA4X,GAAA3X,YACA2X,EAAA7X,YAAA6X,EAAA5X,iBAAAva,IACAmyB,EAAA3X,YAKA,IAAA2Z,EAyBA,IArBAn0B,EAAAqR,EAAAkM,yBAAA4W,GAGA73B,KAAA4Q,KAAAglB,SAAAhe,QAAA,SAAAiM,GAEA,wBAAAA,GAAA9F,oBACAkJ,EAAApD,EAAA9F,oBAGA,OAAAkJ,QACAA,GAAA,kBAAApD,GAAA3F,WACA2F,EAAA3F,iBAMAqa,GAAAv3B,KAAA6iB,KAIAzK,SAAA1V,EAAAyR,SAAA,KAAA9G,EAAAkC,eAAArI,QAAAxE,EAAAyR,QAAA1P,eACA8yB,EAAA3gB,QAAA4gB,GAGA,KAAAx4B,KAAA4Q,KAAAzC,SAAAjG,QAAAxE,KAGAA,gBAMAyyB,uBAAA,WACAn2B,KAAA8nB,eACA9nB,KAAAgpB,sBAIAA,mBAAA,WACA,GAEAzD,GAFAnF,EAAApgB,KAAA4Q,KAAAgV,oBACAtS,EAAAtT,KAAAK,QAAA+c,cAAApJ,cAIA,OAAAoM,IAIApgB,KAAAK,QAAAq1B,eACA11B,KAAA+2B,cACA/2B,KAAAy4B,sBAAArY,IACa9M,EAAA+N,cACbrhB,KAAA+2B,cACA/2B,KAAA04B,gBAAAplB,IAGAiS,EAAAvlB,KAAA4Q,KAAA4U,mBAAA,uBAEAD,GAAA,kBAAAA,GAAAmF,aACAnF,EAAAmF,gBAdA1qB,MAkBAy4B,sBAAA,SAAArY,GAEApgB,KAAAslB,oBAAA3K,MAAAmG,KAAA,GAGA,IASA6X,GATAC,EAAA54B,KAAAK,QAAA+Q,cAAAmlB,iBAAAv2B,KAAAK,QAAA+Q,cAAAmlB,gBAAAqC,WAAA54B,KAAAK,QAAA+Q,cAAA0S,KAAA8U,UACAC,EAAA74B,KAAAK,QAAA+c,cAAAyO,WACAiN,EAAA94B,KAAAslB,oBACAyT,EAAA3Y,EAAAiL,wBACA2N,EAAAD,EAAAvN,IAAAoN,EACAK,EAAAF,EAAAjY,KAAAiY,EAAAG,MAAA,EACAC,EAAAL,EAAA3N,aACAiO,EAAAN,EAAAvN,YACAP,EAAAoO,EAAA,CAuBA,QApBAp5B,KAAAK,QAAAo2B,cAEAmC,EAAAI,EAAA5Y,EAAA+K,aAAAgO,GACAL,EAAAne,MAAA6Q,IAAAwN,EAAA5Y,EAAA+K,aAAAgO,EAAA,KACAL,EAAApwB,UAAA7F,OAAA,mBAGiB+1B,EAAAI,EAAAG,GACjBL,EAAApwB,UAAAa,IAAA,kBACAuvB,EAAAne,MAAA6Q,IAAA,QAIAsN,EAAApwB,UAAA7F,OAAA,kBACAi2B,EAAAne,MAAA6Q,IAAAwN,EAAAG,EAAA,MAGAL,EAAAne,MAAA6Q,IAAAwN,EAAAG,EAAA,KAGAn5B,KAAAK,QAAA2c,cACA,WACA2b,EAAAI,EAAAjY,IACA,MAEA,aACA6X,EAAAI,EAAAhY,MAAAqY,CACA,MAEA,cACAT,EAAAM,EAAAjO,EAIA,EAAA2N,EACAA,EAAA,EACaA,EAAAS,EAAAP,IACbF,EAAAE,EAAApN,KAAA4N,KAAAD,GAAA,GAGAN,EAAAne,MAAAmG,KAAA6X,EAAA,MAGAD,gBAAA,SAAAplB,GAEAtT,KAAAslB,oBAAA3K,MAAAmG,KAAA,GAEA,IAAA+X,GAAA74B,KAAAK,QAAA+c,cAAAyO,WACAtY,EAAAD,EAAAW,WAAA,GACAmX,EAAA7X,EAAA8X,wBACAC,GAAAF,EAAAtK,KAAAsK,EAAArK,OAAA,EACA+X,EAAA94B,KAAAslB,oBACA6T,EAAAL,EAAA3N,aACAiO,EAAAN,EAAAvN,YACAP,EAAAoO,EAAA,EACAlO,EAAA,GACAD,EAAAjrB,KAAAK,QAAAoc,SAAAuO,CAEAI,GAAAI,IAAAN,GACA4N,EAAApwB,UAAAa,IAAA,6BACAuvB,EAAApwB,UAAA7F,OAAA,8BACAi2B,EAAAne,MAAA6Q,IAAAN,EAAAE,EAAAO,OAAA3rB,KAAAK,QAAAqc,QAAA1c,KAAAK,QAAA+c,cAAAwO,YAAAuN,EAAA,OAEAL,EAAApwB,UAAAa,IAAA,8BACAuvB,EAAApwB,UAAA7F,OAAA,6BACAi2B,EAAAne,MAAA6Q,IAAAJ,EAAAI,IAAAxrB,KAAAK,QAAAqc,QAAA1c,KAAAK,QAAA+c,cAAAwO,YAAAuN,EAAA,MAGAnO,EAAAM,EACAwN,EAAAne,MAAAmG,KAAAmK,EAAAD,EAAA,KACaA,EAAA6N,EAAAvN,EACbwN,EAAAne,MAAAmG,KAAA+X,EAAA5N,EAAAD,EAAA,KAEA8N,EAAAne,MAAAmG,KAAAmK,EAAAK,EAAA,SAMA,IAAAgO,EAmlCA,OAllCA,YAGAA,GACAlT,OAAAwH,EACA3F,KAAA8F,EAEA+D,OAAA7D,EACA1I,cAAAgJ,EACAxR,SAAA0R,EACAlB,SAAAsF,EACA3V,cAAA+U,EACAsH,MAAAzG,EACA0G,YAAA1E,MASA,WAKA,QAAA2E,GAAA1pB,EAAAiG,GACA,GAAAhW,KAAAK,QAAAsc,eAAA3G,EAAAjN,aAAA,uBACAgH,EAAA8W,qBACS,IAAA7mB,KAAAK,QAAAuc,qBAAA5G,EAAAjN,aAAA,+BACT,GAAAkJ,GAAA8C,EAAAC,kBAAAhV,KAAAK,QAAA+Q,gBAGAa,GAAA,KAAAA,EAAAmE,YAAAtO,QACAmK,EAAAuiB,wBAAA,KAAAviB,EAAAuiB,uBAAApe,YAAAtO,SACAiI,EAAA8W,kBAKA,QAAA6S,GAAA3pB,GAEA,GAAAkC,GAAA8C,EAAAC,kBAAAhV,KAAAK,QAAA+Q,eACAlR,EAAA+R,KAAAkD,QAAA1P,aAEA,SAAAvF,IACA6P,EAAA8W,iBACAxY,EAAA8E,kBAAAnT,KAAAK,QAAA+Q,cAAA,SAIA/C,EAAAwH,WAAA5D,KACAlC,EAAA8W,iBAGA9W,EAAA+d,SACA9tB,KAAAK,QAAA+Q,cAAAyC,YAAA,mBAEA7T,KAAAK,QAAA+Q,cAAAyC,YAAA,mBAKA,QAAA8lB,GAAA5pB,GACA,GAAA1Q,GAAA4S,EAAA8C,EAAAC,kBAAAhV,KAAAK,QAAA+Q,eACA+D,EAAAlD,EAAAkD,QAAA1P,cACAm0B,EAAA,oBACAC,EAAA,MAEAxrB,GAAA6B,MAAAH,GAAA1B,EAAAkB,QAAAC,UAAAnB,EAAAkB,QAAAG,SAEAuC,EAAAuiB,wBAEAqF,EAAAx0B,KAAA8P,IAEA,IAAAJ,EAAAwL,gBAAAtO,GAAA6O,KACAzS,EAAA6B,MAAAH,EAAA1B,EAAAkB,QAAAC,YAAAoqB,EAAAv0B,KAAA4M,EAAAuiB,uBAAA3tB,YAIAoL,EAAAuiB,uBAAA9wB,WAAAC,YAAAsO,EAAAuiB,wBACAzkB,EAAA8W,kBACaxY,EAAA6B,MAAAH,EAAA1B,EAAAkB,QAAAG,SAGbrQ,EAAAW,KAAAK,QAAA+Q,cAAAtR,cAAA,KACAT,EAAAwH,UAAA,OACAoL,EAAAuiB,uBAAA9wB,WAAAY,aAAAjF,EAAA4S,GACAlC,EAAA8W,kBAESxY,EAAA6B,MAAAH,EAAA1B,EAAAkB,QAAAM,SAEToC,EAAA6nB,oBACA7nB,EAAAuiB,yBAEAqF,EAAAx0B,KAAA8P,IAEAykB,EAAAv0B,KAAA4M,EAAApL,YAEAgzB,EAAAx0B,KAAA4M,EAAA6nB,mBAAA3kB,UAOAJ,EAAAoB,WAAAnW,KAAAK,QAAA+Q,cAAAa,EAAA6nB,oBAEA7nB,EAAAuiB,uBAAA9wB,WAAAC,YAAAsO,GAEAlC,EAAA8W,kBACSxY,EAAA6B,MAAAH,EAAA1B,EAAAkB,QAAAC,YACT,OAAA2F,GAEAykB,EAAAv0B,KAAA4M,EAAApL,aAEAoL,EAAAuiB,yBAEAviB,EAAAgE,cAAAue,wBAEAviB,EAAA6nB,oBACA,OAAA7nB,EAAA6nB,mBAAA3kB,QAAA1P,gBAUApG,EAAAW,KAAAK,QAAA+Q,cAAAtR,cAAA,KACAT,EAAAwH,UAAA,OACAoL,EAAAgE,4BAAA3R,aAAAjF,EAAA4S,EAAAgE,eAGAlB,EAAAoB,WAAAnW,KAAAK,QAAA+Q,cAAA/R,GAGA4S,EAAAgE,cAAAtS,YAAAsO,GAEAlC,EAAA8W,kBAIA,QAAApC,GAAA1U,GACA,GACAoF,GADAlD,EAAA8C,EAAAC,kBAAAhV,KAAAK,QAAA+Q,cAGAa,KAIAA,EAAAlJ,aAAA,4BAAAkJ,EAAA8nB,SAAAj5B,QACAd,KAAAK,QAAA+Q,cAAAyC,YAAA,sBAGAxF,EAAA6B,MAAAH,EAAA1B,EAAAkB,QAAAG,SAAArB,EAAAwH,WAAA5D,KACAkD,EAAAlD,EAAAkD,QAAA1P,cAEA,MAAA0P,EACAnV,KAAAK,QAAA+Q,cAAAyC,YAAA,kBACa9D,EAAA+d,UAAA/d,EAAAE,SAEb,MAAA5K,KAAA8P,IACAnV,KAAAK,QAAA+Q,cAAAyC,YAAA,wBAQA,QAAAmmB,GAAAC,GACAA,IACAA,MAGA,gBAAAA,KACAA,EAAAj6B,KAAAK,QAAA+Q,cAAAue,iBAAAsK,IAGA5rB,EAAA6D,UAAA+nB,KACAA,MAGA,IAAA9rB,GAAAlG,MAAA6C,UAAAuC,MAAAnI,MAAA+0B,EAGAj6B,MAAAmO,YACAA,EAAAyJ,QAAA,SAAA5B,EAAAjS,GACA,aAAAiS,EAAAb,QAAA1P,cACAzF,KAAAmO,SAAAnN,KAAAk5B,EAAAh7B,KAAAc,KAAAgW,EAAAjS,IAEA/D,KAAAmO,SAAAnN,KAAAgV,IAEShW,MAGT,QAAAm6B,GAAAtE,EAAAnlB,GAMA,MALA/I,QAAAwI,KAAAO,GAAAkH,QAAA,SAAAhJ,GACAwK,SAAAyc,EAAAjnB,KACAinB,EAAAjnB,GAAA8B,EAAA9B,MAGAinB,EAGA,QAAAuE,GAAAvE,EAAAvtB,EAAAsZ,GACA,mBAAAiU,GAAA/jB,QACAzD,EAAA8K,KAAA,yIAGA,IAAAmgB,IACAh0B,OAAAsc,EAAAvhB,QAAA+c,cACA5c,SAAAohB,EAAAvhB,QAAA+Q,cAmBA,OAhBAykB,GAAA/jB,UAAA,IACAwnB,EAAA1oB,KAAAgR,GAGAiU,EAAAsE,EAAAtE,EAAAyD,GAGA,kBAAAzD,GAAAznB,MAEAynB,EAAAznB,KAAAwT,GAIAiU,EAAAvtB,OACAutB,EAAAvtB,QAEAutB,EAGA,QAAAwE,KACA,GAAAx5B,GACAy5B,GAAA,CAIA,IAAAt6B,KAAAK,QAAAk6B,qBACA,QAGA,IAAAv6B,KAAAK,QAAAklB,iBAAA,EACA,QAGA,IAAAvlB,KAAAK,QAAAid,WAAA,kBACA,QAGA,IAAAtd,KAAAK,QAAAwc,eACA,QAGA,KAAAhc,EAAA,EAAmBA,EAAAb,KAAAmO,SAAArN,OAA0BD,GAAA,EAC7C,IAAAb,KAAAmO,SAAAtN,GAAAkI,aAAA,yBACAuxB,GAAA,CACA,OAIA,MAAAA,GAGA,QAAAE,KACA,MAAAx6B,MAAAK,QAAAid,WAAA,aACA,EAIAtd,KAAAK,QAAAo6B,qBACA,EAGAz6B,KAAAK,QAAAm5B,eAAA,EAGA,QAAAkB,KACA,MAAA16B,MAAAK,QAAAid,WAAA,cACA,EAGAtd,KAAAK,QAAA0c,YAAA,EAGA,QAAA4d,KACA,MAAA36B,MAAAK,QAAAid,WAAA,mBACA,EAGAtd,KAAAK,QAAA6c,iBAAA,EAGA,QAAAgd,GAAAU,EAAA57B,GACA,GAAA67B,GAAA76B,KAAAK,QAAA+Q,cAAAtR,cAAA,OACAg7B,EAAA,iBAAA1oB,KAAAD,MAAA,IAAAnT,EACA+7B,GACA,uBACA,uBACA,mBACA,sBACA,6BACA,uBACA,aAoBA,OAjBAF,GAAA96B,UAAA66B,EAAA76B,UACA86B,EAAA77B,GAAA87B,EACAD,EAAAh0B,UAAA+zB,EAAAllB,MACAmlB,EAAAt2B,aAAA,4BAAAvF,GACA+7B,EAAAnjB,QAAA,SAAAgC,GACAghB,EAAAjN,aAAA/T,IACAihB,EAAAt2B,aAAAqV,EAAAghB,EAAA7xB,aAAA6Q,MAIAghB,EAAAlyB,UAAAa,IAAA,wBACAqxB,EAAAr2B,aAAA,4BAAAvF,GACA47B,EAAAl3B,WAAAY,aACAu2B,EACAD,GAGAC,EAGA,QAAAG,KACAh7B,KAAAmO,SAAAyJ,QAAA,SAAA5B,EAAAjS,GACA/D,KAAAK,QAAAyc,gBAAA9G,EAAAjN,aAAA,0BACAiN,EAAAzR,aAAA,sBACAyR,EAAAzR,aAAA,aAAAvE,KAAAK,QAAAqd,aAEA1H,EAAAzR,aAAA,0BACAyR,EAAAzR,aAAA,kBACAyR,EAAAzR,aAAA,qBACAyR,EAAAzR,aAAA,sBAAAR,GAEAiS,EAAA2X,aAAA,8BACA3tB,KAAAsmB,GAAAtQ,EAAA,iBAAAjG,GACA,GAAAyF,GAAAzF,EAAAyF,OACAolB,EAAAplB,EAAA9R,WAAAqV,cAAA,uCAAAvD,EAAAzM,aAAA,kCACA6xB,KACAA,EAAAllB,MAAA1V,KAAAi7B,YAAAzlB,EAAAxW,IAAA0W,QAEiBvS,KAAAnD,QAERA,MAGT,QAAAk7B,KACA,GAAAl7B,KAAAqlB,SAAArlB,KAAAK,QAAAwc,eACA,QAGA,IAAAse,GAAAn7B,KAAAmO,SAAA2X,KAAA,SAAA9P,GACA,OAAAA,EAAAjN,aAAA,yBAGAoyB,KACAn7B,KAAAqlB,QAAA,GAAAkQ,GAAAv1B,MACAA,KAAAK,QAAA4c,kBAAA1a,YAAAvC,KAAAqlB,QAAAC,sBAIA,QAAA8V,KACA,GAAAv6B,EAUA,IAPAb,KAAAyG,UAAA,qBAAAizB,EAAAv2B,KAAAnD,OAGAA,KAAAyG,UAAA,wBAAAkzB,EAAAx2B,KAAAnD,OACAA,KAAAyG,UAAA,uBAAAkzB,EAAAx2B,KAAAnD,OAGAA,KAAAK,QAAAsc,eAAA3c,KAAAK,QAAAuc,oBACA5c,KAAAyG,UAAA,uBAAAgzB,EAAAt2B,KAAAnD,WAEA,KAAAa,EAAA,EAAuBA,EAAAb,KAAAmO,SAAArN,OAA0BD,GAAA,EACjD,GAAAb,KAAAmO,SAAAtN,GAAAkI,aAAA,wBAAA/I,KAAAmO,SAAAtN,GAAAkI,aAAA,+BACA/I,KAAAyG,UAAA,uBAAAgzB,EAAAt2B,KAAAnD,MACA,OAOAA,KAAAK,QAAAsc,eACA3c,KAAAmO,SAAAyJ,QAAA,SAAA5B,GACAA,EAAAjN,aAAA,wBACA/I,KAAAsmB,GAAAtQ,EAAA,QAAAyO,EAAAthB,KAAAnD,QAEaA,MAIb,QAAAq7B,GAAAh7B,GAEA,GAAAi7B,IACA17B,KAAA,gBAAAI,MAAAK,QAAAm5B,YAAAx5B,KAAAK,QAAAm5B,YAAApgB,OAGA,WAAAnT,GAAAqX,WAAAkc,YACAnrB,EAAAmC,UAA0BnQ,EAAAi7B,IAI1B,QAAAC,GAAAl7B,GAEA,GAAAi7B,IACA9M,UAAAxuB,KAAAK,QAAA0sB,uBACAtQ,SAAAzc,KAAAK,QAAAoc,SACAC,QAAA1c,KAAAK,QAAAqc,QACAO,kBAAAjd,KAAAK,QAAA4c,kBAGA,WAAAhX,GAAAqX,WAAAiI,cACAlX,EAAAmC,UAA0BnQ,EAAAi7B,IAI1B,QAAAE,GAAAn7B,GAEA,GAAAi7B,IACApN,kBAAAluB,KAAAK,QAAAmoB,aAAAxoB,KAAAK,QAAAmpB,mBAAA,MAAApQ,OACAgV,eAAApuB,KAAAK,QAAAipB,gBACA+E,gBAAAruB,KAAAK,QAAAgoB,uBACAc,eAAAnpB,KAAAK,QAAAioB,aACAgG,mBAAAtuB,KAAAK,QAAAkoB,yBAGA,WAAAtiB,GAAAqX,WAAAwU,OACAzjB,EAAAmC,UAA0BnQ,EAAAi7B,IAI1B,QAAAG,GAAAp7B,GAEA,GAAAi7B,IACAtI,eAAAhzB,KAAAK,QAAA2yB,eACAC,gBAAAjzB,KAAAK,QAAA4yB,gBACAtW,cAAA3c,KAAAK,QAAAsc,cACAU,YAAArd,KAAAK,QAAAgd,YAGA,WAAApX,GAAAqX,WAAAic,MACAlrB,EAAAmC,UAA0BnQ,EAAAi7B,IAI1B,QAAAI,KACA,GAEAC,GACArzB,EAHAhI,EAAAN,KAAAK,QAAAC,QACAgd,EAAAtd,KAAAK,QAAAid,UAGAtd,MAAA41B,YAEAt1B,EAAAsX,QAAA,SAAAgkB,GACAte,EAAAse,IACAD,EAAAvB,EAAA9c,EAAAse,KAAA57B,MACAA,KAAA41B,SAAA50B,KAAA26B,IACa,WAAAC,GACbD,EAAAvB,EAAAoB,EAAAt8B,KAAAc,UAAAK,QAAAyxB,QAAA,SAAA9xB,MACAA,KAAA41B,SAAA50B,KAAA26B,IACa,aAAAC,GACbD,EAAAvB,EAAA,GAAAn0B,GAAAqX,WAAAiQ,SAAAqO,EAAA57B,MACAA,KAAA41B,SAAA50B,KAAA26B,IACarhB,EAAAvL,eAAA6sB,KACbD,EAAAvB,EAAA,GAAAn0B,GAAAqX,WAAA8I,OAAA9L,EAAAshB,MAAA57B,MACAA,KAAA41B,SAAA50B,KAAA26B,KAES37B,KAET,KAAAsI,IAAAgV,GACAA,EAAAvO,eAAAzG,IAAA,KAAAhI,EAAA4H,QAAAI,KACAqzB,EAAAvB,EAAA9c,EAAAhV,KAAAtI,MACAA,KAAA41B,SAAA50B,KAAA26B,GAsBA,IAjBA37B,KAAAK,QAAAid,WAAA,OACAtd,KAAA41B,SAAA50B,KAAAo5B,EAAAqB,EAAAv8B,KAAAc,UAAAK,QAAAk5B,OAAA,QAAAv5B,OAIAq6B,EAAAn7B,KAAAc,OACAA,KAAA41B,SAAA50B,KAAAo5B,EAAAmB,EAAAr8B,KAAAc,UAAAK,QAAAklB,eAAA,iBAAAvlB,OAGA06B,EAAAx7B,KAAAc,OACAA,KAAA41B,SAAA50B,KAAAo5B,EAAA,GAAAn0B,GAAAqX,WAAAP,SAAA,YAAA/c,OAGA26B,EAAAz7B,KAAAc,OACAA,KAAA41B,SAAA50B,KAAAo5B,EAAA,GAAAn0B,GAAAqX,WAAAJ,cAAA,iBAAAld,OAGAw6B,EAAAt7B,KAAAc,MAAA,CACA,GAAA67B,GAAA,gBAAA77B,MAAAK,QAAAm5B,eAAqFx5B,KAAAK,QAAAm5B,WACrFx5B,MAAA41B,SAAA50B,KAAAo5B,EAAAiB,EAAAn8B,KAAAc,KAAA67B,GAAA,cAAA77B,QAIA,QAAA87B,GAAAprB,EAAArQ,GACA,GAAA07B,KACA,0CACA,4CACA,oDACA,4CACA,4CACA,iDACA,yCACA,yDACA,qDACA,gDACA,6CACA,6CACA,4CAeA,OAZA17B,KACA07B,EAAAnkB,QAAA,SAAAokB,GACA37B,EAAA0O,eAAAitB,EAAA,KAAA5iB,SAAA/Y,EAAA27B,EAAA,KACA3tB,EAAAyG,WAAAknB,EAAA,GAAAA,EAAA,eAIA37B,EAAA0O,eAAA,gCAAA1O,GAAAm5B,aACAnrB,EAAAyG,WAAA,4CAIAzG,EAAAqC,YAA+BrQ,EAAAqQ,GAG/B,QAAAurB,GAAAzhB,EAAA6O,GAEA,GACAte,GADAmxB,EAAA,iBAOA,OADAnxB,GAAAmxB,EAAA/sB,KAAAqL,GACAzP,EACAsD,EAAA6G,gBAAAlV,KAAAK,QAAA+Q,cAAArG,EAAA,IAGA,aAAAyP,EACAxa,KAAAK,QAAA+Q,cAAAyC,YAAA,cAAAwV,EAAAje,MAGA,eAAAoP,EACAxa,KAAA4pB,WAAAP,GAGA,UAAA7O,EACAxa,KAAAK,QAAA+Q,cAAAyC,YAAA,iBAAA7T,KAAAK,QAAA+c,cAAApJ,gBAGAhU,KAAAK,QAAA+Q,cAAAyC,YAAA2G,GAAA,QAIAvU,EAAAk2B,SACA7hB,cACA6L,gBACAqB,kBACA6F,oBACAkI,UACAhH,cAAAjE,GAGArkB,EAAA0X,YAEA1X,EAAAqX,WAAAgc,EACArzB,EAAAm2B,KAAA/tB,EACApI,EAAAqN,UAAAyB,EAEA9O,EAAA6E,WACA4F,SAAA2L,EAGAjO,KAAA,SAAAD,EAAA9N,GACA,GAAAy6B,GAAA,CASA,KAPA96B,KAAAK,QAAAy7B,EAAA58B,KAAAc,UAAA0Q,SAAArQ,GACAL,KAAAq8B,aAAAluB,EAEAnO,KAAAK,QAAA4c,oBACAjd,KAAAK,QAAA4c,kBAAAjd,KAAAK,QAAA+Q,cAAA0S,MAGA9jB,KAAAK,QAAA4c,kBAAAlE,cAAA,0BAAA+hB,IACAA,GAAA,CAKA,OAFA96B,MAAAhB,GAAA87B,EAEA96B,KAAAs8B,SAGAA,MAAA,WACAt8B,KAAAge,WAIAgc,EAAA96B,KAAAc,UAAAq8B,cACA,IAAAr8B,KAAAmO,SAAArN,SAIAd,KAAA6hB,OAAA,GAAAF,GAAA3hB,MACAA,KAAAge,UAAA,EAGAgd,EAAA97B,KAAAc,MACA07B,EAAAx8B,KAAAc,MACAk7B,EAAAh8B,KAAAc,MACAo7B,EAAAl8B,KAAAc,SAGA+G,QAAA,WACA/G,KAAAge,WAIAhe,KAAAge,UAAA,EAEAhe,KAAA41B,SAAAhe,QAAA,SAAAie,GACA,kBAAAA,GAAA9uB,QACA8uB,EAAA9uB,UACiB,kBAAA8uB,GAAA5M,aACjB5a,EAAA8K,KAAA,uHACA0c,EAAA5M,eAEajpB,MAEboZ,SAAApZ,KAAAqlB,UACArlB,KAAAqlB,QAAAte,gBACA/G,MAAAqlB,SAGArlB,KAAA6hB,OAAA9a,UAEA/G,KAAAmO,SAAAyJ,QAAA,SAAA5B,GAcA,GAZAhW,KAAAK,QAAAqd,aACA1H,EAAAnP,UAAAmP,EAAAnP,WAGAmP,EAAA6D,gBAAA,mBACA7D,EAAA6D,gBAAA,cACA7D,EAAA6D,gBAAA,uBACA7D,EAAA6D,gBAAA,uBACA7D,EAAA6D,gBAAA,QACA7D,EAAA6D,gBAAA,kBAGA7D,EAAA2X,aAAA,8BACA,GAAAiN,GAAA5kB,EAAAtS,WAAAqV,cAAA,uCAAA/C,EAAAjN,aAAA,kCACA6xB,IAEAA,EAAAlyB,UAAA7F,OAAA,wBAEAmT,EAAAtS,YACAsS,EAAAtS,WAAAC,YAAAqS,KAGahW,MACbA,KAAAmO,cAGAmY,GAAA,SAAA9Q,EAAAzF,EAAAmS,EAAAC,GACAniB,KAAA6hB,OAAAI,eAAAzM,EAAAzF,EAAAmS,EAAAC,IAGAgK,IAAA,SAAA3W,EAAAzF,EAAAmS,EAAAC,GACAniB,KAAA6hB,OAAAQ,eAAA7M,EAAAzF,EAAAmS,EAAAC,IAGA1b,UAAA,SAAAsJ,EAAAmS,GACAliB,KAAA6hB,OAAAa,kBAAA3S,EAAAmS,IAGAqa,YAAA,SAAAxsB,EAAAmS,GACAliB,KAAA6hB,OAAAe,kBAAA7S,EAAAmS,IAGAsa,YAAA,WACAnuB,EAAA8K,KAAA,sKAIA6d,QAAA,SAAA1uB,EAAA2C,EAAA+X,GACAhjB,KAAA6hB,OAAAkB,mBAAAza,EAAA2C,EAAA+X,IAGAxG,MAAA,SAAAxX,GACA,GAAAuF,GAAAvK,IACA,OAAA8S,YAAA,WACAvI,EAAAyT,UACAhZ,KAEahF,KAAAK,QAAAmc,QAGbye,UAAA,WACA,GAAAp6B,GACA47B,EACAzuB,IACA,KAAAnN,EAAA,EAAuBA,EAAAb,KAAAmO,SAAArN,OAA0BD,GAAA,EACjD47B,EAAA,KAAAz8B,KAAAmO,SAAAtN,GAAA7B,GAAAgB,KAAAmO,SAAAtN,GAAA7B,GAAA,WAAA6B,EACAmN,EAAAyuB,IACA/mB,MAAA1V,KAAAmO,SAAAtN,GAAAgG,UAAAiB,OAGA,OAAAkG,IAGAwX,mBAAA,SAAAld,GACA,GAAAutB,EAUA,OATA71B,MAAA41B,UAAA51B,KAAA41B,SAAA90B,QACAd,KAAA41B,SAAA9P,KAAA,SAAA6V,GACA,MAAAA,GAAArzB,UACAutB,EAAA8F,GACA,IAEA,IAGA9F,GAWA6G,eAAA,SAAAC,GACA,KAAAx3B,UAAArE,OAAA,IAIA,GACA66B,GACArzB,EAFAkF,EAAAvF,MAAA6C,UAAAuC,MAAAnO,KAAAiG,UAAA,EAIA,KAAAmD,IAAAtI,MAAAK,QAAAid,WACAtd,KAAAK,QAAAid,WAAAvO,eAAAzG,KACAqzB,EAAA37B,KAAAK,QAAAid,WAAAhV,GACA8Q,SAAAuiB,EAAAgB,IACAhB,EAAAgB,GAAAz3B,MAAAy2B,EAAAnuB,GAIA,OAAAxN,QAGA48B,qBAAA,WACA58B,KAAAi4B,yBAAA,GAGA4E,sBAAA,WACA78B,KAAAi4B,yBAAA,GAGApO,eAAA,WAIA,MAHA7pB,MAAAqlB,SACArlB,KAAAqlB,QAAAvH,aAEA9d,MAKA+d,kBAAA,SAAAvD,GACA,GACAzP,GADA+xB,EAAA,gBAEA7V,EAAA,IAGAlc,GAAA+xB,EAAA3tB,KAAAqL,GACAzP,IACAyP,EAAAzP,EAAA,GAGA,KACAkc,EAAAjnB,KAAAK,QAAA+Q,cAAA2M,kBAAAvD,GACa,MAAAuiB,GACb9V,EAAA,KAGA,MAAAA,IAGAF,WAAA,SAAAvM,EAAA6O,GAEA,GACAte,GACAnK,EAFAk8B,EAAA,eA0BA,OAnBA/xB,GAAA+xB,EAAA3tB,KAAAqL,GACAzP,GAEA/K,KAAA8oB,gBAEA9oB,KAAAg9B,oBACAp8B,EAAAq7B,EAAA/8B,KAAAc,KAAA+K,EAAA,GAAAse,GAEArpB,KAAA2pB,oBAEA/oB,EAAAq7B,EAAA/8B,KAAAc,KAAAwa,EAAA6O,IAIA,wBAAA7O,GAAA,sBAAAA,IACAnM,EAAA0H,aAAA/V,KAAAK,QAAA+Q,cAAApR,KAAAihB,4BAGAjhB,KAAA6pB,iBACAjpB,GAGAqgB,yBAAA,SAAA1N,GAIA,MAHA6F,UAAA7F,IACAA,EAAAvT,KAAAK,QAAA+c,cAAApJ,eAAAC,WAAA,IAEAc,EAAAkM,yBAAA1N,IAIAwV,0BAAA,WAIA,MAHA/oB,MAAAqlB,SACArlB,KAAAqlB,QAAA0D,4BAEA/oB,MAIAgpB,mBAAA,WACAhpB,KAAAqlB,SACArlB,KAAAqlB,QAAA2D,sBAIAgU,kBAAA,WACA,GAAA5b,GAAArM,EAAA8J,oBAAA7e,KAAAK,QAAA+c,cAEA,IAAAgE,EAAA,CAEA,SAAAA,EAAA2Y,SAAAj5B,QACAsgB,IAAA2Y,SAAA,EAGA/5B,MAAAgsB,cAAA5K,KAIA4K,cAAA,SAAAhW,GACAjB,EAAAX,WAAA4B,EAAAhW,KAAAK,QAAA+Q,cAEA,IAAA6rB,GAAAloB,EAAA8J,oBAAA7e,KAAAK,QAAA+c,cACA6f,IACAj9B,KAAA6hB,OAAAkD,aAAAkY,IAIArX,kBAAA,WACA,GAAAsX,EAWA,OAVAl9B,MAAAmO,SAAA2X,KAAA,SAAA9P,GAOA,OALAknB,GAAAlnB,EAAAjN,aAAA,yBACAm0B,EAAAlnB,KAIAknB,GACal9B,MAEbk9B,GAMA5N,gBAAA,WACA,GAEA/b,GACA4pB,EACA7vB,EAJAyR,EAAA,KACAzL,EAAAtT,KAAAK,QAAA+c,cAAApJ,eAIAopB,EAAA,EAEA,IAAA9pB,EAAAY,WAAA,IACAX,EAAAD,EAAAW,WAAA,GACAkpB,EAAA5pB,EAAAiB,aAGAxU,KAAAmO,SAAA2X,KAAA,SAAAtS,EAAAzP,GACA,MAAAyP,KAAAD,EAAA0L,gBAAA5Q,EAAAwD,aAAA2B,EAAAD,EAAA0L,iBACAme,EAAAr5B,GACA,IAEA,IAGAq5B,EAAA,KACAD,EAAAzc,mBAAA1gB,KAAAmO,SAAAivB,IACAD,EAAAxc,OAAApN,EAAA0L,eAAA1L,EAAA2L,aACA5R,EAAA6vB,EAAAx8B,WAAAG,OAEAie,GACAzR,QACAC,IAAAD,EAAAiG,EAAA5S,WAAAG,OACAs8B,wBAGA,IAAA9vB,IAAA,CACA,GAAA+vB,GAAAtoB,EAAAwK,sCACAvf,KAAAK,QAAA+Q,cACApR,KAAAmO,SAAAivB,GACA7pB,EAAA0L,eACA1L,EAAA2L,YACA,KAAAme,IACAte,EAAAse,oBAUA,MAJA,QAAAte,GAAA,IAAAA,EAAAqe,4BACAre,GAAAqe,qBAGAre,GAGA+J,cAAA,WACA9oB,KAAA+e,eAAA/e,KAAAsvB,mBAYAC,gBAAA,SAAA+N,EAAAC,GACA,GAAAD,EAAA,CAIA,GAWArrB,GAGApR,EACAwf,EACAmd,EAhBAJ,EAAAhkB,SAAAkkB,EAAAF,qBACA,EAAAE,EAAAF,qBACAre,GACAqe,uBACA9vB,MAAAgwB,EAAAhwB,MACAC,IAAA+vB,EAAA/vB,KAEAkwB,EAAAz9B,KAAAmO,SAAA4Q,EAAAqe,sBACAM,EAAA,EACAnqB,EAAAvT,KAAAK,QAAA+Q,cAAAmQ,cACAoc,GAAAF,GAEAG,GAAA,EACAC,GAAA,CASA,KAJAtqB,EAAA+L,SAAAme,EAAA,GACAlqB,EAAAmB,UAAA,GAEAzC,EAAA0rB,EAAAvjB,OACAyjB,GAAA5rB,GAAA,CACA,OAAAA,EAAAN,SACA6rB,EAAAE,EAAAzrB,EAAAnR,QACA88B,GAAA7e,EAAAzR,OAAAowB,GAAA3e,EAAAzR,OAAAkwB,IACAjqB,EAAA+L,SAAArN,EAAA8M,EAAAzR,MAAAowB,GACAE,GAAA,GAEAA,GAAA7e,EAAAxR,KAAAmwB,GAAA3e,EAAAxR,KAAAiwB,IACAjqB,EAAAoN,OAAA1O,EAAA8M,EAAAxR,IAAAmwB,GACAG,GAAA,GAEAH,EAAAF,MAGA,KADA38B,EAAAoR,EAAA5N,WAAAvD,OAAA,EACAD,GAAA,GACA88B,EAAA38B,KAAAiR,EAAA5N,WAAAxD,IACAA,GAAA,CAGAg9B,KACA5rB,EAAA0rB,EAAAvjB,OAIA,GAAAkjB,EAAAD,iBAAA,CAIA,IAHA,GAAAlsB,GAAA9C,EAAAsK,kBAAApF,EAAA0L,gBACAlb,EAAA,EAEAA,EAAAu5B,EAAAD,kBAAAlsB,EAAA8F,cACA9F,IAAA8F,YACAlT,MAEAoN,EAAAiF,YAAAtV,OAAA,MAOAyS,EAAA+L,SAAAjR,EAAAuK,2BAAAzH,GAAA,GAIAosB,IACAhqB,EAAAwB,EAAA+J,oCAAAC,EAAAxL,IAEA8M,EAAArgB,KAAAK,QAAA+c,cAAApJ,eACAqM,EAAA1L,kBACA0L,EAAAzL,SAAArB,KAGAoW,iBAAA,WACA3pB,KAAAuvB,gBAAAvvB,KAAA+e,iBAGA6K,WAAA,SAAAP,GACA,GAAAyU,GACAj9B,CAcA,IAZAwoB,EAAA9T,KAAA8T,EAAA9T,IAAAzN,OAAAhH,OAAA,IACAd,KAAAK,QAAA+Q,cAAAyC,YAAA,gBAAAwV,EAAA9T,MAEAvV,KAAAK,QAAAgd,aAAA,WAAAgM,EAAA7T,SACAnH,EAAAgH,eAAAN,EAAAC,kBAAAhV,KAAAK,QAAA+Q,eAAAiY,EAAA9T,KAGA8T,EAAAzT,aACAvH,EAAAsH,kBAAAZ,EAAAC,kBAAAhV,KAAAK,QAAA+Q,eAAAiY,EAAAzT,cAIA5V,KAAAK,QAAAgd,aAAA,WAAAgM,EAAA7T,QAAA6T,EAAAzT,YAGA,IAFAkoB,EAAA99B,KAAAK,QAAA+Q,cAAAorB,YAAA,cACAsB,EAAAC,UAAA,cAAA/9B,KAAAK,QAAA+c,eACAvc,EAAA,EAA2BA,EAAAb,KAAAmO,SAAArN,OAA0BD,GAAA,EACrDb,KAAAmO,SAAAtN,GAAAm9B,cAAAF,IAMAG,SAAA,WACA5vB,EAAAoL,iBAAAva,KAAAc,KAAA,mBAAAmF,UAAA,WAIA8jB,WAAA,WACA5a,EAAAoL,iBAAAva,KAAAc,KAAA,uBAAAmF,UAAA,WAGAyuB,WAAA,SAAAh0B,GACAI,KAAAwlB,mBAAA,SAAAoO,WAAAh0B,IAGAo0B,UAAA,SAAA3gB,EAAAhT,GACAL,KAAAwlB,mBAAA,SAAAwO,UAAA3gB,EAAAhT,QAKA4F,EAAAuT,QAAA,SAAA0kB,EAAAC,EAAAC,GACA,OACAF,MAAAG,SAAAH,EAAA,IACAC,MAAAE,SAAAF,EAAA,IACAC,SAAAC,SAAAD,EAAA,IACAz9B,SAAA,WACA,OAAAu9B,EAAAC,EAAAC,GAAAn9B,KAAA,QAGCiE,MAAAlF,MAEDwZ,QAAA,UACCA,QAAAvQ,MAAA,MAEDhD,OVyeM,SAASlH,EAAQD,EAASH,GWl9NhC,GAAAqP,GAAArP,EAAA,EACA,iBAAAqP,SAAAjP,EAAAC,GAAAgP,EAAA,KAEArP,GAAA,GAAAqP,KACAA,GAAAswB,SAAAv/B,EAAAD,QAAAkP,EAAAswB,SXw+NM,SAASv/B,EAAQD,EAASH,GY5+NhC,GAAAqP,GAAArP,EAAA,EACA,iBAAAqP,SAAAjP,EAAAC,GAAAgP,EAAA,KAEArP,GAAA,GAAAqP,KACAA,GAAAswB,SAAAv/B,EAAAD,QAAAkP,EAAAswB,SZkgOM,SAASv/B,EAAQD,EAASH,GatgOhC,GAAAqP,GAAArP,EAAA,EACA,iBAAAqP,SAAAjP,EAAAC,GAAAgP,EAAA,KAEArP,GAAA,GAAAqP,KACAA,GAAAswB,SAAAv/B,EAAAD,QAAAkP,EAAAswB","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/example/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(10);\n\t__webpack_require__(11);\n\t__webpack_require__(9);\n\t\n\tvar React = __webpack_require__(3);\n\tvar Editor = __webpack_require__(4);\n\t\n\tvar App = React.createClass({\n\t  displayName: 'App',\n\t\n\t  getInitialState: function getInitialState() {\n\t    return { text: 'Fusce dapibus, tellus ac cursus commodo' };\n\t  },\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      'div',\n\t      { className: 'app' },\n\t      React.createElement(\n\t        'h1',\n\t        null,\n\t        'react-medium-editor'\n\t      ),\n\t      React.createElement(\n\t        'h3',\n\t        null,\n\t        'Html content'\n\t      ),\n\t      React.createElement(\n\t        'div',\n\t        null,\n\t        this.state.text\n\t      ),\n\t      React.createElement(\n\t        'h3',\n\t        null,\n\t        'Editor #1 (<pre> tag)'\n\t      ),\n\t      React.createElement(Editor, {\n\t        tag: 'pre',\n\t        text: this.state.text,\n\t        onChange: this.handleChange,\n\t        options: { buttons: ['bold', 'italic', 'underline'] }\n\t      }),\n\t      React.createElement(\n\t        'h3',\n\t        null,\n\t        'Editor #2'\n\t      ),\n\t      React.createElement(Editor, {\n\t        text: this.state.text,\n\t        onChange: this.handleChange\n\t      })\n\t    );\n\t  },\n\t\n\t  handleChange: function handleChange(text) {\n\t    this.setState({ text: text });\n\t  }\n\t});\n\t\n\tReact.render(React.createElement(App, null), document.getElementById('app'));\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\r\n\t// css base code, injected by the css-loader\r\n\tmodule.exports = function() {\r\n\t\tvar list = [];\r\n\t\r\n\t\t// return the list of modules as css string\r\n\t\tlist.toString = function toString() {\r\n\t\t\tvar result = [];\r\n\t\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar item = this[i];\r\n\t\t\t\tif(item[2]) {\r\n\t\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.push(item[1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result.join(\"\");\r\n\t\t};\r\n\t\r\n\t\t// import a list of modules into the list\r\n\t\tlist.i = function(modules, mediaQuery) {\r\n\t\t\tif(typeof modules === \"string\")\r\n\t\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\t\tvar alreadyImportedModules = {};\r\n\t\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar id = this[i][0];\r\n\t\t\t\tif(typeof id === \"number\")\r\n\t\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t\t}\r\n\t\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\t\tvar item = modules[i];\r\n\t\t\t\t// skip already imported module\r\n\t\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.push(item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn list;\r\n\t};\r\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\r\n\tvar stylesInDom = {},\r\n\t\tmemoize = function(fn) {\r\n\t\t\tvar memo;\r\n\t\t\treturn function () {\r\n\t\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\r\n\t\t\t\treturn memo;\r\n\t\t\t};\r\n\t\t},\r\n\t\tisOldIE = memoize(function() {\r\n\t\t\treturn /msie [6-9]\\b/.test(window.navigator.userAgent.toLowerCase());\r\n\t\t}),\r\n\t\tgetHeadElement = memoize(function () {\r\n\t\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\r\n\t\t}),\r\n\t\tsingletonElement = null,\r\n\t\tsingletonCounter = 0;\r\n\t\r\n\tmodule.exports = function(list, options) {\r\n\t\tif(false) {\r\n\t\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\r\n\t\t}\r\n\t\r\n\t\toptions = options || {};\r\n\t\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\r\n\t\t// tags it will allow on a page\r\n\t\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\r\n\t\r\n\t\tvar styles = listToStyles(list);\r\n\t\taddStylesToDom(styles, options);\r\n\t\r\n\t\treturn function update(newList) {\r\n\t\t\tvar mayRemove = [];\r\n\t\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\t\tvar item = styles[i];\r\n\t\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\t\tdomStyle.refs--;\r\n\t\t\t\tmayRemove.push(domStyle);\r\n\t\t\t}\r\n\t\t\tif(newList) {\r\n\t\t\t\tvar newStyles = listToStyles(newList);\r\n\t\t\t\taddStylesToDom(newStyles, options);\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < mayRemove.length; i++) {\r\n\t\t\t\tvar domStyle = mayRemove[i];\r\n\t\t\t\tif(domStyle.refs === 0) {\r\n\t\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\r\n\t\t\t\t\t\tdomStyle.parts[j]();\r\n\t\t\t\t\tdelete stylesInDom[domStyle.id];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction addStylesToDom(styles, options) {\r\n\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\tvar item = styles[i];\r\n\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\tif(domStyle) {\r\n\t\t\t\tdomStyle.refs++;\r\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\r\n\t\t\t\t\tdomStyle.parts[j](item.parts[j]);\r\n\t\t\t\t}\r\n\t\t\t\tfor(; j < item.parts.length; j++) {\r\n\t\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar parts = [];\r\n\t\t\t\tfor(var j = 0; j < item.parts.length; j++) {\r\n\t\t\t\t\tparts.push(addStyle(item.parts[j], options));\r\n\t\t\t\t}\r\n\t\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction listToStyles(list) {\r\n\t\tvar styles = [];\r\n\t\tvar newStyles = {};\r\n\t\tfor(var i = 0; i < list.length; i++) {\r\n\t\t\tvar item = list[i];\r\n\t\t\tvar id = item[0];\r\n\t\t\tvar css = item[1];\r\n\t\t\tvar media = item[2];\r\n\t\t\tvar sourceMap = item[3];\r\n\t\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\r\n\t\t\tif(!newStyles[id])\r\n\t\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\r\n\t\t\telse\r\n\t\t\t\tnewStyles[id].parts.push(part);\r\n\t\t}\r\n\t\treturn styles;\r\n\t}\r\n\t\r\n\tfunction createStyleElement() {\r\n\t\tvar styleElement = document.createElement(\"style\");\r\n\t\tvar head = getHeadElement();\r\n\t\tstyleElement.type = \"text/css\";\r\n\t\thead.appendChild(styleElement);\r\n\t\treturn styleElement;\r\n\t}\r\n\t\r\n\tfunction createLinkElement() {\r\n\t\tvar linkElement = document.createElement(\"link\");\r\n\t\tvar head = getHeadElement();\r\n\t\tlinkElement.rel = \"stylesheet\";\r\n\t\thead.appendChild(linkElement);\r\n\t\treturn linkElement;\r\n\t}\r\n\t\r\n\tfunction addStyle(obj, options) {\r\n\t\tvar styleElement, update, remove;\r\n\t\r\n\t\tif (options.singleton) {\r\n\t\t\tvar styleIndex = singletonCounter++;\r\n\t\t\tstyleElement = singletonElement || (singletonElement = createStyleElement());\r\n\t\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\r\n\t\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\r\n\t\t} else if(obj.sourceMap &&\r\n\t\t\ttypeof URL === \"function\" &&\r\n\t\t\ttypeof URL.createObjectURL === \"function\" &&\r\n\t\t\ttypeof URL.revokeObjectURL === \"function\" &&\r\n\t\t\ttypeof Blob === \"function\" &&\r\n\t\t\ttypeof btoa === \"function\") {\r\n\t\t\tstyleElement = createLinkElement();\r\n\t\t\tupdate = updateLink.bind(null, styleElement);\r\n\t\t\tremove = function() {\r\n\t\t\t\tstyleElement.parentNode.removeChild(styleElement);\r\n\t\t\t\tif(styleElement.href)\r\n\t\t\t\t\tURL.revokeObjectURL(styleElement.href);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tstyleElement = createStyleElement();\r\n\t\t\tupdate = applyToTag.bind(null, styleElement);\r\n\t\t\tremove = function() {\r\n\t\t\t\tstyleElement.parentNode.removeChild(styleElement);\r\n\t\t\t};\r\n\t\t}\r\n\t\r\n\t\tupdate(obj);\r\n\t\r\n\t\treturn function updateStyle(newObj) {\r\n\t\t\tif(newObj) {\r\n\t\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tupdate(obj = newObj);\r\n\t\t\t} else {\r\n\t\t\t\tremove();\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tvar replaceText = (function () {\r\n\t\tvar textStore = [];\r\n\t\r\n\t\treturn function (index, replacement) {\r\n\t\t\ttextStore[index] = replacement;\r\n\t\t\treturn textStore.filter(Boolean).join('\\n');\r\n\t\t};\r\n\t})();\r\n\t\r\n\tfunction applyToSingletonTag(styleElement, index, remove, obj) {\r\n\t\tvar css = remove ? \"\" : obj.css;\r\n\t\r\n\t\tif (styleElement.styleSheet) {\r\n\t\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\r\n\t\t} else {\r\n\t\t\tvar cssNode = document.createTextNode(css);\r\n\t\t\tvar childNodes = styleElement.childNodes;\r\n\t\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\r\n\t\t\tif (childNodes.length) {\r\n\t\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\r\n\t\t\t} else {\r\n\t\t\t\tstyleElement.appendChild(cssNode);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction applyToTag(styleElement, obj) {\r\n\t\tvar css = obj.css;\r\n\t\tvar media = obj.media;\r\n\t\tvar sourceMap = obj.sourceMap;\r\n\t\r\n\t\tif(media) {\r\n\t\t\tstyleElement.setAttribute(\"media\", media)\r\n\t\t}\r\n\t\r\n\t\tif(styleElement.styleSheet) {\r\n\t\t\tstyleElement.styleSheet.cssText = css;\r\n\t\t} else {\r\n\t\t\twhile(styleElement.firstChild) {\r\n\t\t\t\tstyleElement.removeChild(styleElement.firstChild);\r\n\t\t\t}\r\n\t\t\tstyleElement.appendChild(document.createTextNode(css));\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction updateLink(linkElement, obj) {\r\n\t\tvar css = obj.css;\r\n\t\tvar media = obj.media;\r\n\t\tvar sourceMap = obj.sourceMap;\r\n\t\r\n\t\tif(sourceMap) {\r\n\t\t\t// http://stackoverflow.com/a/26603875\r\n\t\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\r\n\t\t}\r\n\t\r\n\t\tvar blob = new Blob([css], { type: \"text/css\" });\r\n\t\r\n\t\tvar oldSrc = linkElement.href;\r\n\t\r\n\t\tlinkElement.href = URL.createObjectURL(blob);\r\n\t\r\n\t\tif(oldSrc)\r\n\t\t\tURL.revokeObjectURL(oldSrc);\r\n\t}\r\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\tmodule.exports = React;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(3);\n\tvar MediumEditor = __webpack_require__(8);\n\t\n\tmodule.exports = React.createClass({\n\t  displayName: 'MediumEditor',\n\t\n\t  getInitialState: function getInitialState() {\n\t    return {\n\t      text: this.props.text\n\t    };\n\t  },\n\t\n\t  getDefaultProps: function getDefaultProps() {\n\t    return {\n\t      tag: 'div'\n\t    };\n\t  },\n\t\n\t  componentDidMount: function componentDidMount() {\n\t    var _this = this;\n\t\n\t    var dom = this.getDOMNode();\n\t    this.medium = new MediumEditor(dom, this.props.options);\n\t    this.medium.subscribe('editableInput', function (e) {\n\t      _this._updated = true;\n\t      _this.change(dom.innerHTML);\n\t    });\n\t  },\n\t\n\t  componentWillUnmount: function componentWillUnmount() {\n\t    this.medium.destroy();\n\t  },\n\t\n\t  componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n\t    if (nextProps.text !== this.state.text && !this._updated) {\n\t      this.setState({ text: nextProps.text });\n\t    }\n\t\n\t    if (this._updated) this._updated = false;\n\t  },\n\t\n\t  render: function render() {\n\t    return React.createElement(this.props.tag, {\n\t      className: this.props.className,\n\t      contentEditable: true,\n\t      dangerouslySetInnerHTML: { __html: this.state.text }\n\t    });\n\t  },\n\t\n\t  change: function change(text) {\n\t    if (this.props.onChange) this.props.onChange(text);\n\t  }\n\t});\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(1)();\n\texports.push([module.id, \"*{box-sizing:border-box}body{margin:0;padding:0}.app{max-width:500px;margin:0 auto}[contenteditable=true]{padding:5px 9px;background-color:#eaeaea;border-radius:4px;outline:0}\", \"\"]);\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(1)();\n\texports.push([module.id, \".clearfix:after{display:block;visibility:hidden;clear:both;height:0;content:\\\" \\\";font-size:0}@-webkit-keyframes pop-upwards{0%{-webkit-transform:matrix(.97,0,0,1,0,12);transform:matrix(.97,0,0,1,0,12);opacity:0}20%{-webkit-transform:matrix(.99,0,0,1,0,2);transform:matrix(.99,0,0,1,0,2);opacity:.7}40%{-webkit-transform:matrix(1,0,0,1,0,-1);transform:matrix(1,0,0,1,0,-1);opacity:1}100%,70%{-webkit-transform:matrix(1,0,0,1,0,0);transform:matrix(1,0,0,1,0,0);opacity:1}}@keyframes pop-upwards{0%{-webkit-transform:matrix(.97,0,0,1,0,12);transform:matrix(.97,0,0,1,0,12);opacity:0}20%{-webkit-transform:matrix(.99,0,0,1,0,2);transform:matrix(.99,0,0,1,0,2);opacity:.7}40%{-webkit-transform:matrix(1,0,0,1,0,-1);transform:matrix(1,0,0,1,0,-1);opacity:1}100%,70%{-webkit-transform:matrix(1,0,0,1,0,0);transform:matrix(1,0,0,1,0,0);opacity:1}}.data-medium-element sup{vertical-align:super}.data-medium-element sub{vertical-align:sub}.data-medium-element img{max-width:100%}.medium-editor-hidden{display:none}.medium-toolbar-arrow-over:before,.medium-toolbar-arrow-under:after{position:absolute;left:50%;display:block;margin-left:-8px;width:0;height:0;border-style:solid;content:\\\"\\\"}.medium-toolbar-arrow-under:after{border-width:8px 8px 0}.medium-toolbar-arrow-over:before{top:-8px;border-width:0 8px 8px}.medium-editor-anchor-preview,.medium-editor-toolbar{position:absolute;top:0;left:0;z-index:2000;visibility:hidden;font-size:16px;font-family:HelveticaNeue,Helvetica,Arial,sans-serif}.medium-editor-anchor-preview ul,.medium-editor-toolbar ul{margin:0;padding:0}.medium-editor-anchor-preview li,.medium-editor-toolbar li{float:left;margin:0;padding:0;list-style:none}.medium-editor-anchor-preview li button,.medium-editor-toolbar li button{display:block;margin:0;padding:15px;cursor:pointer;font-size:14px;line-height:1.33;text-decoration:none;box-sizing:border-box}.medium-editor-anchor-preview li button:focus,.medium-editor-toolbar li button:focus{outline:0}.medium-editor-anchor-preview li .medium-editor-action-underline,.medium-editor-toolbar li .medium-editor-action-underline{text-decoration:underline}.medium-editor-anchor-preview li .medium-editor-action-pre,.medium-editor-toolbar li .medium-editor-action-pre{padding:15px 0;font-weight:100;font-size:12px;font-family:Menlo,monospace}.medium-editor-anchor-preview{max-width:280px;word-break:break-all;word-wrap:break-word;text-align:center;line-height:1.4}.medium-editor-anchor-preview a{display:inline-block;margin:5px 5px 5px 10px;color:#fff}.medium-editor-anchor-preview-active,.medium-editor-toolbar-active{visibility:visible}.sticky-toolbar{position:fixed;top:1px}.medium-editor-toolbar-active.stalker-toolbar{-webkit-animation:pop-upwards 160ms forwards linear;animation:pop-upwards 160ms forwards linear}.medium-editor-action-bold{font-weight:bolder}.medium-editor-action-italic{font-style:italic}.medium-editor-toolbar-form{display:none}.medium-editor-toolbar-form a,.medium-editor-toolbar-form input{font-family:HelveticaNeue,Helvetica,Arial,sans-serif}.medium-editor-toolbar-form .medium-editor-toolbar-input,.medium-editor-toolbar-form label{margin:0;padding:6px;width:316px;border:none;font-size:14px;box-sizing:border-box}.medium-editor-toolbar-form .medium-editor-toolbar-input:focus,.medium-editor-toolbar-form label:focus{outline:0;border:none;box-shadow:none;appearance:none}.medium-editor-toolbar-form label{display:block}.medium-editor-toolbar-form a{display:inline-block;margin:0 10px;text-decoration:none;font-weight:bolder;font-size:24px}.medium-editor-placeholder{position:relative}.medium-editor-placeholder:after{position:absolute;top:0;left:0;content:attr(data-placeholder)!important;font-style:italic;white-space:pre}.medium-editor-dragover{background:#ddd}.medium-image-loading{width:40px;height:40px;background-color:#333;display:inline-block;border-radius:100%;-webkit-animation:medium-image-loading-animation 1s infinite ease-in-out;animation:medium-image-loading-animation 1s infinite ease-in-out}@-webkit-keyframes medium-image-loading-animation{0%{-webkit-transform:scale(0);transform:scale(0)}100%{-webkit-transform:scale(1);transform:scale(1);opacity:0}}@keyframes medium-image-loading-animation{0%{-webkit-transform:scale(0);transform:scale(0)}100%{-webkit-transform:scale(1);transform:scale(1);opacity:0}}\", \"\"]);\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(1)();\n\texports.push([module.id, \".medium-toolbar-arrow-under:after{top:50px;border-color:#242424 transparent transparent}.medium-toolbar-arrow-over:before{top:-8px;border-color:transparent transparent #242424}.medium-editor-toolbar{border:1px solid #000;background-color:#242424;background:-webkit-linear-gradient(top,#242424,rgba(36,36,36,.75));background:linear-gradient(to bottom,#242424,rgba(36,36,36,.75));border-radius:5px;box-shadow:0 0 3px #000}.medium-editor-toolbar li button{min-width:50px;height:50px;border:0;border-right:1px solid #000;border-left:1px solid #333;border-left:1px solid rgba(255,255,255,.1);background-color:#242424;color:#fff;background:-webkit-linear-gradient(top,#242424,rgba(36,36,36,.89));background:linear-gradient(to bottom,#242424,rgba(36,36,36,.89));box-shadow:0 2px 2px rgba(0,0,0,.3);-webkit-transition:background-color .2s ease-in;transition:background-color .2s ease-in}.medium-editor-toolbar li button:hover{background-color:#000;color:#ff0}.medium-editor-toolbar li .medium-editor-button-first{border-top-left-radius:5px;border-bottom-left-radius:5px}.medium-editor-toolbar li .medium-editor-button-last{border-top-right-radius:5px;border-bottom-right-radius:5px}.medium-editor-toolbar li .medium-editor-button-active{background-color:#000;color:#fff;background:-webkit-linear-gradient(top,#242424,rgba(0,0,0,.89));background:linear-gradient(to bottom,#242424,rgba(0,0,0,.89))}.medium-editor-toolbar-form{background:#242424;color:#999;border-radius:5px}.medium-editor-toolbar-form .medium-editor-toolbar-input{height:50px;background:#242424;color:#ccc;box-sizing:border-box}.medium-editor-toolbar-form a{color:#fff}.medium-editor-toolbar-anchor-preview{background:#242424;color:#fff;border-radius:5px}.medium-editor-placeholder:after{color:#b3b3b1}\", \"\"]);\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*global self, document, DOMException */\n\t\n\t/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\t\n\t// Full polyfill for browsers with no classList support\n\tif (!(\"classList\" in document.createElement(\"_\"))) {\n\t  (function (view) {\n\t\n\t  \"use strict\";\n\t\n\t  if (!('Element' in view)) return;\n\t\n\t  var\n\t      classListProp = \"classList\"\n\t    , protoProp = \"prototype\"\n\t    , elemCtrProto = view.Element[protoProp]\n\t    , objCtr = Object\n\t    , strTrim = String[protoProp].trim || function () {\n\t      return this.replace(/^\\s+|\\s+$/g, \"\");\n\t    }\n\t    , arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t      var\n\t          i = 0\n\t        , len = this.length\n\t      ;\n\t      for (; i < len; i++) {\n\t        if (i in this && this[i] === item) {\n\t          return i;\n\t        }\n\t      }\n\t      return -1;\n\t    }\n\t    // Vendors: please allow content code to instantiate DOMExceptions\n\t    , DOMEx = function (type, message) {\n\t      this.name = type;\n\t      this.code = DOMException[type];\n\t      this.message = message;\n\t    }\n\t    , checkTokenAndGetIndex = function (classList, token) {\n\t      if (token === \"\") {\n\t        throw new DOMEx(\n\t            \"SYNTAX_ERR\"\n\t          , \"An invalid or illegal string was specified\"\n\t        );\n\t      }\n\t      if (/\\s/.test(token)) {\n\t        throw new DOMEx(\n\t            \"INVALID_CHARACTER_ERR\"\n\t          , \"String contains an invalid character\"\n\t        );\n\t      }\n\t      return arrIndexOf.call(classList, token);\n\t    }\n\t    , ClassList = function (elem) {\n\t      var\n\t          trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t        , classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t        , i = 0\n\t        , len = classes.length\n\t      ;\n\t      for (; i < len; i++) {\n\t        this.push(classes[i]);\n\t      }\n\t      this._updateClassName = function () {\n\t        elem.setAttribute(\"class\", this.toString());\n\t      };\n\t    }\n\t    , classListProto = ClassList[protoProp] = []\n\t    , classListGetter = function () {\n\t      return new ClassList(this);\n\t    }\n\t  ;\n\t  // Most DOMException implementations don't allow calling DOMException's toString()\n\t  // on non-DOMExceptions. Error's toString() is sufficient here.\n\t  DOMEx[protoProp] = Error[protoProp];\n\t  classListProto.item = function (i) {\n\t    return this[i] || null;\n\t  };\n\t  classListProto.contains = function (token) {\n\t    token += \"\";\n\t    return checkTokenAndGetIndex(this, token) !== -1;\n\t  };\n\t  classListProto.add = function () {\n\t    var\n\t        tokens = arguments\n\t      , i = 0\n\t      , l = tokens.length\n\t      , token\n\t      , updated = false\n\t    ;\n\t    do {\n\t      token = tokens[i] + \"\";\n\t      if (checkTokenAndGetIndex(this, token) === -1) {\n\t        this.push(token);\n\t        updated = true;\n\t      }\n\t    }\n\t    while (++i < l);\n\t\n\t    if (updated) {\n\t      this._updateClassName();\n\t    }\n\t  };\n\t  classListProto.remove = function () {\n\t    var\n\t        tokens = arguments\n\t      , i = 0\n\t      , l = tokens.length\n\t      , token\n\t      , updated = false\n\t      , index\n\t    ;\n\t    do {\n\t      token = tokens[i] + \"\";\n\t      index = checkTokenAndGetIndex(this, token);\n\t      while (index !== -1) {\n\t        this.splice(index, 1);\n\t        updated = true;\n\t        index = checkTokenAndGetIndex(this, token);\n\t      }\n\t    }\n\t    while (++i < l);\n\t\n\t    if (updated) {\n\t      this._updateClassName();\n\t    }\n\t  };\n\t  classListProto.toggle = function (token, force) {\n\t    token += \"\";\n\t\n\t    var\n\t        result = this.contains(token)\n\t      , method = result ?\n\t        force !== true && \"remove\"\n\t      :\n\t        force !== false && \"add\"\n\t    ;\n\t\n\t    if (method) {\n\t      this[method](token);\n\t    }\n\t\n\t    if (force === true || force === false) {\n\t      return force;\n\t    } else {\n\t      return !result;\n\t    }\n\t  };\n\t  classListProto.toString = function () {\n\t    return this.join(\" \");\n\t  };\n\t\n\t  if (objCtr.defineProperty) {\n\t    var classListPropDesc = {\n\t        get: classListGetter\n\t      , enumerable: true\n\t      , configurable: true\n\t    };\n\t    try {\n\t      objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t    } catch (ex) { // IE 8 doesn't support enumerable:true\n\t      if (ex.number === -0x7FF5EC54) {\n\t        classListPropDesc.enumerable = false;\n\t        objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t      }\n\t    }\n\t  } else if (objCtr[protoProp].__defineGetter__) {\n\t    elemCtrProto.__defineGetter__(classListProp, classListGetter);\n\t  }\n\t\n\t  }(self));\n\t}\n\t\n\t/* Blob.js\n\t * A Blob implementation.\n\t * 2014-07-24\n\t *\n\t * By Eli Grey, http://eligrey.com\n\t * By Devin Samarin, https://github.com/dsamarin\n\t * License: X11/MIT\n\t *   See https://github.com/eligrey/Blob.js/blob/master/LICENSE.md\n\t */\n\t\n\t/*global self, unescape */\n\t/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,\n\t  plusplus: true */\n\t\n\t/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */\n\t\n\t(function (view) {\n\t  \"use strict\";\n\t\n\t  view.URL = view.URL || view.webkitURL;\n\t\n\t  if (view.Blob && view.URL) {\n\t    try {\n\t      new Blob;\n\t      return;\n\t    } catch (e) {}\n\t  }\n\t\n\t  // Internally we use a BlobBuilder implementation to base Blob off of\n\t  // in order to support older browsers that only have BlobBuilder\n\t  var BlobBuilder = view.BlobBuilder || view.WebKitBlobBuilder || view.MozBlobBuilder || (function(view) {\n\t    var\n\t        get_class = function(object) {\n\t        return Object.prototype.toString.call(object).match(/^\\[object\\s(.*)\\]$/)[1];\n\t      }\n\t      , FakeBlobBuilder = function BlobBuilder() {\n\t        this.data = [];\n\t      }\n\t      , FakeBlob = function Blob(data, type, encoding) {\n\t        this.data = data;\n\t        this.size = data.length;\n\t        this.type = type;\n\t        this.encoding = encoding;\n\t      }\n\t      , FBB_proto = FakeBlobBuilder.prototype\n\t      , FB_proto = FakeBlob.prototype\n\t      , FileReaderSync = view.FileReaderSync\n\t      , FileException = function(type) {\n\t        this.code = this[this.name = type];\n\t      }\n\t      , file_ex_codes = (\n\t          \"NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR \"\n\t        + \"NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR\"\n\t      ).split(\" \")\n\t      , file_ex_code = file_ex_codes.length\n\t      , real_URL = view.URL || view.webkitURL || view\n\t      , real_create_object_URL = real_URL.createObjectURL\n\t      , real_revoke_object_URL = real_URL.revokeObjectURL\n\t      , URL = real_URL\n\t      , btoa = view.btoa\n\t      , atob = view.atob\n\t\n\t      , ArrayBuffer = view.ArrayBuffer\n\t      , Uint8Array = view.Uint8Array\n\t\n\t      , origin = /^[\\w-]+:\\/*\\[?[\\w\\.:-]+\\]?(?::[0-9]+)?/\n\t    ;\n\t    FakeBlob.fake = FB_proto.fake = true;\n\t    while (file_ex_code--) {\n\t      FileException.prototype[file_ex_codes[file_ex_code]] = file_ex_code + 1;\n\t    }\n\t    // Polyfill URL\n\t    if (!real_URL.createObjectURL) {\n\t      URL = view.URL = function(uri) {\n\t        var\n\t            uri_info = document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n\t          , uri_origin\n\t        ;\n\t        uri_info.href = uri;\n\t        if (!(\"origin\" in uri_info)) {\n\t          if (uri_info.protocol.toLowerCase() === \"data:\") {\n\t            uri_info.origin = null;\n\t          } else {\n\t            uri_origin = uri.match(origin);\n\t            uri_info.origin = uri_origin && uri_origin[1];\n\t          }\n\t        }\n\t        return uri_info;\n\t      };\n\t    }\n\t    URL.createObjectURL = function(blob) {\n\t      var\n\t          type = blob.type\n\t        , data_URI_header\n\t      ;\n\t      if (type === null) {\n\t        type = \"application/octet-stream\";\n\t      }\n\t      if (blob instanceof FakeBlob) {\n\t        data_URI_header = \"data:\" + type;\n\t        if (blob.encoding === \"base64\") {\n\t          return data_URI_header + \";base64,\" + blob.data;\n\t        } else if (blob.encoding === \"URI\") {\n\t          return data_URI_header + \",\" + decodeURIComponent(blob.data);\n\t        } if (btoa) {\n\t          return data_URI_header + \";base64,\" + btoa(blob.data);\n\t        } else {\n\t          return data_URI_header + \",\" + encodeURIComponent(blob.data);\n\t        }\n\t      } else if (real_create_object_URL) {\n\t        return real_create_object_URL.call(real_URL, blob);\n\t      }\n\t    };\n\t    URL.revokeObjectURL = function(object_URL) {\n\t      if (object_URL.substring(0, 5) !== \"data:\" && real_revoke_object_URL) {\n\t        real_revoke_object_URL.call(real_URL, object_URL);\n\t      }\n\t    };\n\t    FBB_proto.append = function(data/*, endings*/) {\n\t      var bb = this.data;\n\t      // decode data to a binary string\n\t      if (Uint8Array && (data instanceof ArrayBuffer || data instanceof Uint8Array)) {\n\t        var\n\t            str = \"\"\n\t          , buf = new Uint8Array(data)\n\t          , i = 0\n\t          , buf_len = buf.length\n\t        ;\n\t        for (; i < buf_len; i++) {\n\t          str += String.fromCharCode(buf[i]);\n\t        }\n\t        bb.push(str);\n\t      } else if (get_class(data) === \"Blob\" || get_class(data) === \"File\") {\n\t        if (FileReaderSync) {\n\t          var fr = new FileReaderSync;\n\t          bb.push(fr.readAsBinaryString(data));\n\t        } else {\n\t          // async FileReader won't work as BlobBuilder is sync\n\t          throw new FileException(\"NOT_READABLE_ERR\");\n\t        }\n\t      } else if (data instanceof FakeBlob) {\n\t        if (data.encoding === \"base64\" && atob) {\n\t          bb.push(atob(data.data));\n\t        } else if (data.encoding === \"URI\") {\n\t          bb.push(decodeURIComponent(data.data));\n\t        } else if (data.encoding === \"raw\") {\n\t          bb.push(data.data);\n\t        }\n\t      } else {\n\t        if (typeof data !== \"string\") {\n\t          data += \"\"; // convert unsupported types to strings\n\t        }\n\t        // decode UTF-16 to binary string\n\t        bb.push(unescape(encodeURIComponent(data)));\n\t      }\n\t    };\n\t    FBB_proto.getBlob = function(type) {\n\t      if (!arguments.length) {\n\t        type = null;\n\t      }\n\t      return new FakeBlob(this.data.join(\"\"), type, \"raw\");\n\t    };\n\t    FBB_proto.toString = function() {\n\t      return \"[object BlobBuilder]\";\n\t    };\n\t    FB_proto.slice = function(start, end, type) {\n\t      var args = arguments.length;\n\t      if (args < 3) {\n\t        type = null;\n\t      }\n\t      return new FakeBlob(\n\t          this.data.slice(start, args > 1 ? end : this.data.length)\n\t        , type\n\t        , this.encoding\n\t      );\n\t    };\n\t    FB_proto.toString = function() {\n\t      return \"[object Blob]\";\n\t    };\n\t    FB_proto.close = function() {\n\t      this.size = 0;\n\t      delete this.data;\n\t    };\n\t    return FakeBlobBuilder;\n\t  }(view));\n\t\n\t  view.Blob = function(blobParts, options) {\n\t    var type = options ? (options.type || \"\") : \"\";\n\t    var builder = new BlobBuilder();\n\t    if (blobParts) {\n\t      for (var i = 0, len = blobParts.length; i < len; i++) {\n\t        if (Uint8Array && blobParts[i] instanceof Uint8Array) {\n\t          builder.append(blobParts[i].buffer);\n\t        }\n\t        else {\n\t          builder.append(blobParts[i]);\n\t        }\n\t      }\n\t    }\n\t    var blob = builder.getBlob(type);\n\t    if (!blob.slice && blob.webkitSlice) {\n\t      blob.slice = blob.webkitSlice;\n\t    }\n\t    return blob;\n\t  };\n\t\n\t  var getPrototypeOf = Object.getPrototypeOf || function(object) {\n\t    return object.__proto__;\n\t  };\n\t  view.Blob.prototype = getPrototypeOf(new view.Blob());\n\t}(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content || this));\n\t\n\t(function (root, factory) {\n\t    'use strict';\n\t    if (true) {\n\t        module.exports = factory;\n\t    } else if (typeof define === 'function' && define.amd) {\n\t        define(function () {\n\t            return factory;\n\t        });\n\t    } else {\n\t        root.MediumEditor = factory;\n\t    }\n\t}(this, function () {\n\t\n\t    'use strict';\n\t\n\tvar Util;\n\t\n\t(function (window) {\n\t    'use strict';\n\t\n\t    // Params: Array, Boolean, Object\n\t    function getProp(parts, create, context) {\n\t        if (!context) {\n\t            context = window;\n\t        }\n\t\n\t        try {\n\t            for (var i = 0; i < parts.length; i++) {\n\t                var p = parts[i];\n\t                if (!(p in context)) {\n\t                    if (create) {\n\t                        context[p] = {};\n\t                    } else {\n\t                        return;\n\t                    }\n\t                }\n\t                context = context[p];\n\t            }\n\t            return context;\n\t        } catch (e) {\n\t            // 'p in context' throws an exception when context is a number, boolean, etc. rather than an object,\n\t            // so in that corner case just return undefined (by having no return statement)\n\t        }\n\t    }\n\t\n\t    function copyInto(overwrite, dest) {\n\t        var prop,\n\t            sources = Array.prototype.slice.call(arguments, 2);\n\t        dest = dest || {};\n\t        for (var i = 0; i < sources.length; i++) {\n\t            var source = sources[i];\n\t            if (source) {\n\t                for (prop in source) {\n\t                    if (source.hasOwnProperty(prop) &&\n\t                        typeof source[prop] !== 'undefined' &&\n\t                        (overwrite || dest.hasOwnProperty(prop) === false)) {\n\t                        dest[prop] = source[prop];\n\t                    }\n\t                }\n\t            }\n\t        }\n\t        return dest;\n\t    }\n\t\n\t    Util = {\n\t\n\t        // http://stackoverflow.com/questions/17907445/how-to-detect-ie11#comment30165888_17907562\n\t        // by rg89\n\t        isIE: ((navigator.appName === 'Microsoft Internet Explorer') || ((navigator.appName === 'Netscape') && (new RegExp('Trident/.*rv:([0-9]{1,}[.0-9]{0,})').exec(navigator.userAgent) !== null))),\n\t\n\t        // http://stackoverflow.com/a/11752084/569101\n\t        isMac: (window.navigator.platform.toUpperCase().indexOf('MAC') >= 0),\n\t\n\t        // https://github.com/jashkenas/underscore\n\t        keyCode: {\n\t            BACKSPACE: 8,\n\t            TAB: 9,\n\t            ENTER: 13,\n\t            ESCAPE: 27,\n\t            SPACE: 32,\n\t            DELETE: 46\n\t        },\n\t\n\t        /**\n\t         * Returns true if it's metaKey on Mac, or ctrlKey on non-Mac.\n\t         * See #591\n\t         */\n\t        isMetaCtrlKey: function (event) {\n\t            if ((this.isMac && event.metaKey) || (!this.isMac && event.ctrlKey)) {\n\t                return true;\n\t            }\n\t\n\t            return false;\n\t        },\n\t\n\t        /**\n\t         * Returns true if the key associated to the event is inside keys array\n\t         *\n\t         * @see : https://github.com/jquery/jquery/blob/0705be475092aede1eddae01319ec931fb9c65fc/src/event.js#L473-L484\n\t         * @see : http://stackoverflow.com/q/4471582/569101\n\t         */\n\t        isKey: function (event, keys) {\n\t            var keyCode = event.which;\n\t\n\t            // getting the key code from event\n\t            if (null === keyCode) {\n\t                keyCode = event.charCode !== null ? event.charCode : event.keyCode;\n\t            }\n\t\n\t            // it's not an array let's just compare strings!\n\t            if (false === Array.isArray(keys)) {\n\t                return keyCode === keys;\n\t            }\n\t\n\t            if (-1 === keys.indexOf(keyCode)) {\n\t                return false;\n\t            }\n\t\n\t            return true;\n\t        },\n\t\n\t        parentElements: ['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre'],\n\t\n\t        extend: function extend(/* dest, source1, source2, ...*/) {\n\t            var args = [true].concat(Array.prototype.slice.call(arguments));\n\t            return copyInto.apply(this, args);\n\t        },\n\t\n\t        defaults: function defaults(/*dest, source1, source2, ...*/) {\n\t            var args = [false].concat(Array.prototype.slice.call(arguments));\n\t            return copyInto.apply(this, args);\n\t        },\n\t\n\t        derives: function derives(base, derived) {\n\t            var origPrototype = derived.prototype;\n\t            function Proto() { }\n\t            Proto.prototype = base.prototype;\n\t            derived.prototype = new Proto();\n\t            derived.prototype.constructor = base;\n\t            derived.prototype = copyInto(false, derived.prototype, origPrototype);\n\t            return derived;\n\t        },\n\t\n\t        // Find the next node in the DOM tree that represents any text that is being\n\t        // displayed directly next to the targetNode (passed as an argument)\n\t        // Text that appears directly next to the current node can be:\n\t        //  - A sibling text node\n\t        //  - A descendant of a sibling element\n\t        //  - A sibling text node of an ancestor\n\t        //  - A descendant of a sibling element of an ancestor\n\t        findAdjacentTextNodeWithContent: function findAdjacentTextNodeWithContent(rootNode, targetNode, ownerDocument) {\n\t            var pastTarget = false,\n\t                nextNode,\n\t                nodeIterator = ownerDocument.createNodeIterator(rootNode, NodeFilter.SHOW_TEXT, null, false);\n\t\n\t            // Use a native NodeIterator to iterate over all the text nodes that are descendants\n\t            // of the rootNode.  Once past the targetNode, choose the first non-empty text node\n\t            nextNode = nodeIterator.nextNode();\n\t            while (nextNode) {\n\t                if (nextNode === targetNode) {\n\t                    pastTarget = true;\n\t                } else if (pastTarget) {\n\t                    if (nextNode.nodeType === 3 && nextNode.nodeValue && nextNode.nodeValue.trim().length > 0) {\n\t                        break;\n\t                    }\n\t                }\n\t                nextNode = nodeIterator.nextNode();\n\t            }\n\t\n\t            return nextNode;\n\t        },\n\t\n\t        isDescendant: function isDescendant(parent, child, checkEquality) {\n\t            if (!parent || !child) {\n\t                return false;\n\t            }\n\t            if (checkEquality && parent === child) {\n\t                return true;\n\t            }\n\t            var node = child.parentNode;\n\t            while (node !== null) {\n\t                if (node === parent) {\n\t                    return true;\n\t                }\n\t                node = node.parentNode;\n\t            }\n\t            return false;\n\t        },\n\t\n\t        // https://github.com/jashkenas/underscore\n\t        isElement: function isElement(obj) {\n\t            return !!(obj && obj.nodeType === 1);\n\t        },\n\t\n\t        now: Date.now,\n\t\n\t        // https://github.com/jashkenas/underscore\n\t        throttle: function (func, wait) {\n\t            var THROTTLE_INTERVAL = 50,\n\t                context,\n\t                args,\n\t                result,\n\t                timeout = null,\n\t                previous = 0,\n\t                later = function () {\n\t                    previous = Date.now();\n\t                    timeout = null;\n\t                    result = func.apply(context, args);\n\t                    if (!timeout) {\n\t                        context = args = null;\n\t                    }\n\t                };\n\t\n\t            if (!wait && wait !== 0) {\n\t                wait = THROTTLE_INTERVAL;\n\t            }\n\t\n\t            return function () {\n\t                var now = Date.now(),\n\t                    remaining = wait - (now - previous);\n\t\n\t                context = this;\n\t                args = arguments;\n\t                if (remaining <= 0 || remaining > wait) {\n\t                    if (timeout) {\n\t                        clearTimeout(timeout);\n\t                        timeout = null;\n\t                    }\n\t                    previous = now;\n\t                    result = func.apply(context, args);\n\t                    if (!timeout) {\n\t                        context = args = null;\n\t                    }\n\t                } else if (!timeout) {\n\t                    timeout = setTimeout(later, remaining);\n\t                }\n\t                return result;\n\t            };\n\t        },\n\t\n\t        traverseUp: function (current, testElementFunction) {\n\t            if (!current) {\n\t                return false;\n\t            }\n\t\n\t            do {\n\t                if (current.nodeType === 1) {\n\t                    if (testElementFunction(current)) {\n\t                        return current;\n\t                    }\n\t                    // do not traverse upwards past the nearest containing editor\n\t                    if (current.getAttribute('data-medium-element')) {\n\t                        return false;\n\t                    }\n\t                }\n\t\n\t                current = current.parentNode;\n\t            } while (current);\n\t\n\t            return false;\n\t        },\n\t\n\t        htmlEntities: function (str) {\n\t            // converts special characters (like <) into their escaped/encoded values (like &lt;).\n\t            // This allows you to show to display the string without the browser reading it as HTML.\n\t            return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n\t        },\n\t\n\t        // http://stackoverflow.com/questions/6690752/insert-html-at-caret-in-a-contenteditable-div\n\t        insertHTMLCommand: function (doc, html) {\n\t            var selection, range, el, fragment, node, lastNode, toReplace;\n\t\n\t            if (doc.queryCommandSupported('insertHTML')) {\n\t                try {\n\t                    return doc.execCommand('insertHTML', false, html);\n\t                } catch (ignore) {}\n\t            }\n\t\n\t            selection = doc.defaultView.getSelection();\n\t            if (selection.getRangeAt && selection.rangeCount) {\n\t                range = selection.getRangeAt(0);\n\t                toReplace = range.commonAncestorContainer;\n\t                // Ensure range covers maximum amount of nodes as possible\n\t                // By moving up the DOM and selecting ancestors whose only child is the range\n\t                if ((toReplace.nodeType === 3 && toReplace.nodeValue === range.toString()) ||\n\t                        (toReplace.nodeType !== 3 && toReplace.innerHTML === range.toString())) {\n\t                    while (toReplace.parentNode &&\n\t                            toReplace.parentNode.childNodes.length === 1 &&\n\t                            !toReplace.parentNode.getAttribute('data-medium-element')) {\n\t                        toReplace = toReplace.parentNode;\n\t                    }\n\t                    range.selectNode(toReplace);\n\t                }\n\t                range.deleteContents();\n\t\n\t                el = doc.createElement('div');\n\t                el.innerHTML = html;\n\t                fragment = doc.createDocumentFragment();\n\t                while (el.firstChild) {\n\t                    node = el.firstChild;\n\t                    lastNode = fragment.appendChild(node);\n\t                }\n\t                range.insertNode(fragment);\n\t\n\t                // Preserve the selection:\n\t                if (lastNode) {\n\t                    range = range.cloneRange();\n\t                    range.setStartAfter(lastNode);\n\t                    range.collapse(true);\n\t                    selection.removeAllRanges();\n\t                    selection.addRange(range);\n\t                }\n\t            }\n\t        },\n\t\n\t        getSelectionRange: function (ownerDocument) {\n\t            this.deprecated('Util.getSelectionRange', 'Selection.getSelectionRange', 'v5.0.0');\n\t\n\t            return Selection.getSelectionRange(ownerDocument);\n\t        },\n\t\n\t        getSelectionStart: function (ownerDocument) {\n\t            this.deprecated('Util.getSelectionStart', 'Selection.getSelectionStart', 'v5.0.0');\n\t\n\t            return Selection.getSelectionStart(ownerDocument);\n\t        },\n\t\n\t        getSelectionData: function (el) {\n\t            this.deprecated('Util.getSelectionData', 'Selection.getSelectionData', 'v5.0.0');\n\t\n\t            return Selection.getSelectionData(el);\n\t        },\n\t\n\t        execFormatBlock: function (doc, tagName) {\n\t            var selectionData = Selection.getSelectionData(Selection.getSelectionStart(doc));\n\t            // FF handles blockquote differently on formatBlock\n\t            // allowing nesting, we need to use outdent\n\t            // https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla\n\t            if (tagName === 'blockquote' && selectionData.el &&\n\t                    selectionData.el.parentNode.tagName.toLowerCase() === 'blockquote') {\n\t                return doc.execCommand('outdent', false, null);\n\t            }\n\t            if (selectionData.tagName === tagName) {\n\t                tagName = 'p';\n\t            }\n\t            // When IE we need to add <> to heading elements and\n\t            //  blockquote needs to be called as indent\n\t            // http://stackoverflow.com/questions/10741831/execcommand-formatblock-headings-in-ie\n\t            // http://stackoverflow.com/questions/1816223/rich-text-editor-with-blockquote-function/1821777#1821777\n\t            if (this.isIE) {\n\t                if (tagName === 'blockquote') {\n\t                    return doc.execCommand('indent', false, tagName);\n\t                }\n\t                tagName = '<' + tagName + '>';\n\t            }\n\t            return doc.execCommand('formatBlock', false, tagName);\n\t        },\n\t\n\t        /**\n\t         * Set target to blank on the given el element\n\t         *\n\t         * TODO: not sure if this should be here\n\t         *\n\t         * When creating a link (using core -> createLink) the selection returned by Firefox will be the parent of the created link\n\t         * instead of the created link itself (as it is for Chrome for example), so we retrieve all \"a\" children to grab the good one by\n\t         * using `anchorUrl` to ensure that we are adding target=\"_blank\" on the good one.\n\t         * This isn't a bulletproof solution anyway ..\n\t         */\n\t        setTargetBlank: function (el, anchorUrl) {\n\t            var i, url = anchorUrl || false;\n\t            if (el.tagName.toLowerCase() === 'a') {\n\t                el.target = '_blank';\n\t            } else {\n\t                el = el.getElementsByTagName('a');\n\t\n\t                for (i = 0; i < el.length; i += 1) {\n\t                    if (false === url || url === el[i].attributes.href.value) {\n\t                        el[i].target = '_blank';\n\t                    }\n\t                }\n\t            }\n\t        },\n\t\n\t        addClassToAnchors: function (el, buttonClass) {\n\t            var classes = buttonClass.split(' '),\n\t                i,\n\t                j;\n\t            if (el.tagName.toLowerCase() === 'a') {\n\t                for (j = 0; j < classes.length; j += 1) {\n\t                    el.classList.add(classes[j]);\n\t                }\n\t            } else {\n\t                el = el.getElementsByTagName('a');\n\t                for (i = 0; i < el.length; i += 1) {\n\t                    for (j = 0; j < classes.length; j += 1) {\n\t                        el[i].classList.add(classes[j]);\n\t                    }\n\t                }\n\t            }\n\t        },\n\t\n\t        isListItem: function (node) {\n\t            if (!node) {\n\t                return false;\n\t            }\n\t            if (node.tagName.toLowerCase() === 'li') {\n\t                return true;\n\t            }\n\t\n\t            var parentNode = node.parentNode,\n\t                tagName = parentNode.tagName.toLowerCase();\n\t            while (!this.isBlockContainer(parentNode) && tagName !== 'div') {\n\t                if (tagName === 'li') {\n\t                    return true;\n\t                }\n\t                parentNode = parentNode.parentNode;\n\t                if (parentNode && parentNode.tagName) {\n\t                    tagName = parentNode.tagName.toLowerCase();\n\t                } else {\n\t                    return false;\n\t                }\n\t            }\n\t            return false;\n\t        },\n\t\n\t        cleanListDOM: function (ownerDocument, element) {\n\t            if (element.tagName.toLowerCase() !== 'li') {\n\t                return;\n\t            }\n\t\n\t            var list = element.parentElement;\n\t\n\t            if (list.parentElement.tagName.toLowerCase() === 'p') { // yes we need to clean up\n\t                this.unwrap(list.parentElement, ownerDocument);\n\t\n\t                // move cursor at the end of the text inside the list\n\t                // for some unknown reason, the cursor is moved to end of the \"visual\" line\n\t                Selection.moveCursor(ownerDocument, element.firstChild, element.firstChild.textContent.length);\n\t            }\n\t        },\n\t\n\t        unwrapElement: function (element) {\n\t            this.deprecated('unwrapElement', 'unwrap', 'v5.0.0');\n\t\n\t            this.unwrap(element, element.ownerDocument);\n\t        },\n\t\n\t        /* splitDOMTree\n\t         *\n\t         * Given a root element some descendant element, split the root element\n\t         * into its own element containing the descendant element and all elements\n\t         * on the left or right side of the descendant ('right' is default)\n\t         *\n\t         * example:\n\t         *\n\t         *         <div>\n\t         *      /    |   \\\n\t         *  <span> <span> <span>\n\t         *   / \\    / \\    / \\\n\t         *  1   2  3   4  5   6\n\t         *\n\t         *  If I wanted to split this tree given the <div> as the root and \"4\" as the leaf\n\t         *  the result would be (the prime ' marks indicates nodes that are created as clones):\n\t         *\n\t         *   SPLITTING OFF 'RIGHT' TREE       SPLITTING OFF 'LEFT' TREE\n\t         *\n\t         *     <div>            <div>'              <div>'      <div>\n\t         *      / \\              / \\                 / \\          |\n\t         * <span> <span>   <span>' <span>       <span> <span>   <span>\n\t         *   / \\    |        |      / \\           /\\     /\\       /\\\n\t         *  1   2   3        4     5   6         1  2   3  4     5  6\n\t         *\n\t         *  The above example represents splitting off the 'right' or 'left' part of a tree, where\n\t         *  the <div>' would be returned as an element not appended to the DOM, and the <div>\n\t         *  would remain in place where it was\n\t         *\n\t        */\n\t        splitOffDOMTree: function (rootNode, leafNode, splitLeft) {\n\t            var splitOnNode = leafNode,\n\t                createdNode = null,\n\t                splitRight = !splitLeft;\n\t\n\t            // loop until we hit the root\n\t            while (splitOnNode !== rootNode) {\n\t                var currParent = splitOnNode.parentNode,\n\t                    newParent = currParent.cloneNode(false),\n\t                    targetNode = (splitRight ? splitOnNode : currParent.firstChild),\n\t                    appendLast;\n\t\n\t                // Create a new parent element which is a clone of the current parent\n\t                if (createdNode) {\n\t                    if (splitRight) {\n\t                        // If we're splitting right, add previous created element before siblings\n\t                        newParent.appendChild(createdNode);\n\t                    } else {\n\t                        // If we're splitting left, add previous created element last\n\t                        appendLast = createdNode;\n\t                    }\n\t                }\n\t                createdNode = newParent;\n\t\n\t                while (targetNode) {\n\t                    var sibling = targetNode.nextSibling;\n\t                    // Special handling for the 'splitNode'\n\t                    if (targetNode === splitOnNode) {\n\t                        if (!targetNode.hasChildNodes()) {\n\t                            targetNode.parentNode.removeChild(targetNode);\n\t                        } else {\n\t                            // For the node we're splitting on, if it has children, we need to clone it\n\t                            // and not just move it\n\t                            targetNode = targetNode.cloneNode(false);\n\t                        }\n\t                        // If the resulting split node has content, add it\n\t                        if (targetNode.textContent) {\n\t                            createdNode.appendChild(targetNode);\n\t                        }\n\t\n\t                        targetNode = (splitRight ? sibling : null);\n\t                    } else {\n\t                        // For general case, just remove the element and only\n\t                        // add it to the split tree if it contains something\n\t                        targetNode.parentNode.removeChild(targetNode);\n\t                        if (targetNode.hasChildNodes() || targetNode.textContent) {\n\t                            createdNode.appendChild(targetNode);\n\t                        }\n\t\n\t                        targetNode = sibling;\n\t                    }\n\t                }\n\t\n\t                // If we had an element we wanted to append at the end, do that now\n\t                if (appendLast) {\n\t                    createdNode.appendChild(appendLast);\n\t                }\n\t\n\t                splitOnNode = currParent;\n\t            }\n\t\n\t            return createdNode;\n\t        },\n\t\n\t        moveTextRangeIntoElement: function (startNode, endNode, newElement) {\n\t            if (!startNode || !endNode) {\n\t                return false;\n\t            }\n\t\n\t            var rootNode = this.findCommonRoot(startNode, endNode);\n\t            if (!rootNode) {\n\t                return false;\n\t            }\n\t\n\t            if (endNode === startNode) {\n\t                var temp = startNode.parentNode,\n\t                    sibling = startNode.nextSibling;\n\t                temp.removeChild(startNode);\n\t                newElement.appendChild(startNode);\n\t                if (sibling) {\n\t                    temp.insertBefore(newElement, sibling);\n\t                } else {\n\t                    temp.appendChild(newElement);\n\t                }\n\t                return newElement.hasChildNodes();\n\t            }\n\t\n\t            // create rootChildren array which includes all the children\n\t            // we care about\n\t            var rootChildren = [],\n\t                firstChild,\n\t                lastChild,\n\t                nextNode;\n\t            for (var i = 0; i < rootNode.childNodes.length; i++) {\n\t                nextNode = rootNode.childNodes[i];\n\t                if (!firstChild) {\n\t                    if (this.isDescendant(nextNode, startNode, true)) {\n\t                        firstChild = nextNode;\n\t                    }\n\t                } else {\n\t                    if (this.isDescendant(nextNode, endNode, true)) {\n\t                        lastChild = nextNode;\n\t                        break;\n\t                    } else {\n\t                        rootChildren.push(nextNode);\n\t                    }\n\t                }\n\t            }\n\t\n\t            var afterLast = lastChild.nextSibling,\n\t                fragment = rootNode.ownerDocument.createDocumentFragment();\n\t\n\t            // build up fragment on startNode side of tree\n\t            if (firstChild === startNode) {\n\t                firstChild.parentNode.removeChild(firstChild);\n\t                fragment.appendChild(firstChild);\n\t            } else {\n\t                fragment.appendChild(this.splitOffDOMTree(firstChild, startNode));\n\t            }\n\t\n\t            // add any elements between firstChild & lastChild\n\t            rootChildren.forEach(function (element) {\n\t                element.parentNode.removeChild(element);\n\t                fragment.appendChild(element);\n\t            });\n\t\n\t            // build up fragment on endNode side of the tree\n\t            if (lastChild === endNode) {\n\t                lastChild.parentNode.removeChild(lastChild);\n\t                fragment.appendChild(lastChild);\n\t            } else {\n\t                fragment.appendChild(this.splitOffDOMTree(lastChild, endNode, true));\n\t            }\n\t\n\t            // Add fragment into passed in element\n\t            newElement.appendChild(fragment);\n\t\n\t            if (lastChild.parentNode === rootNode) {\n\t                // If last child is in the root, insert newElement in front of it\n\t                rootNode.insertBefore(newElement, lastChild);\n\t            } else if (afterLast) {\n\t                // If last child was removed, but it had a sibling, insert in front of it\n\t                rootNode.insertBefore(newElement, afterLast);\n\t            } else {\n\t                // lastChild was removed and was the last actual element just append\n\t                rootNode.appendChild(newElement);\n\t            }\n\t\n\t            return newElement.hasChildNodes();\n\t        },\n\t\n\t        /* based on http://stackoverflow.com/a/6183069 */\n\t        depthOfNode: function (inNode) {\n\t            var theDepth = 0,\n\t                node = inNode;\n\t            while (node.parentNode !== null) {\n\t                node = node.parentNode;\n\t                theDepth++;\n\t            }\n\t            return theDepth;\n\t        },\n\t\n\t        findCommonRoot: function (inNode1, inNode2) {\n\t            var depth1 = this.depthOfNode(inNode1),\n\t                depth2 = this.depthOfNode(inNode2),\n\t                node1 = inNode1,\n\t                node2 = inNode2;\n\t\n\t            while (depth1 !== depth2) {\n\t                if (depth1 > depth2) {\n\t                    node1 = node1.parentNode;\n\t                    depth1 -= 1;\n\t                } else {\n\t                    node2 = node2.parentNode;\n\t                    depth2 -= 1;\n\t                }\n\t            }\n\t\n\t            while (node1 !== node2) {\n\t                node1 = node1.parentNode;\n\t                node2 = node2.parentNode;\n\t            }\n\t\n\t            return node1;\n\t        },\n\t        /* END - based on http://stackoverflow.com/a/6183069 */\n\t\n\t        isElementAtBeginningOfBlock: function (node) {\n\t            var textVal,\n\t                sibling;\n\t            while (!this.isBlockContainer(node) && !this.isMediumEditorElement(node)) {\n\t                sibling = node;\n\t                while (sibling = sibling.previousSibling) {\n\t                    textVal = sibling.nodeType === 3 ? sibling.nodeValue : sibling.textContent;\n\t                    if (textVal.length > 0) {\n\t                        return false;\n\t                    }\n\t                }\n\t                node = node.parentNode;\n\t            }\n\t            return true;\n\t        },\n\t\n\t        isMediumEditorElement: function (element) {\n\t            return element && element.nodeType !== 3 && !!element.getAttribute('data-medium-element');\n\t        },\n\t\n\t        isBlockContainer: function (element) {\n\t            return element && element.nodeType !== 3 && this.parentElements.indexOf(element.nodeName.toLowerCase()) !== -1;\n\t        },\n\t\n\t        getBlockContainer: function (element) {\n\t            return this.traverseUp(element, function (el) {\n\t                return Util.isBlockContainer(el) && !Util.isBlockContainer(el.parentNode);\n\t            });\n\t        },\n\t\n\t        getFirstSelectableLeafNode: function (element) {\n\t            while (element && element.firstChild) {\n\t                element = element.firstChild;\n\t            }\n\t            var emptyElements = ['br', 'col', 'colgroup', 'hr', 'img', 'input', 'source', 'wbr'];\n\t            while (emptyElements.indexOf(element.nodeName.toLowerCase()) !== -1) {\n\t                // We don't want to set the selection to an element that can't have children, this messes up Gecko.\n\t                element = element.parentNode;\n\t            }\n\t            // Selecting at the beginning of a table doesn't work in PhantomJS.\n\t            if (element.nodeName.toLowerCase() === 'table') {\n\t                var firstCell = element.querySelector('th, td');\n\t                if (firstCell) {\n\t                    element = firstCell;\n\t                }\n\t            }\n\t            return element;\n\t        },\n\t\n\t        getFirstTextNode: function (element) {\n\t            if (element.nodeType === 3) {\n\t                return element;\n\t            }\n\t\n\t            for (var i = 0; i < element.childNodes.length; i++) {\n\t                var textNode = this.getFirstTextNode(element.childNodes[i]);\n\t                if (textNode !== null) {\n\t                    return textNode;\n\t                }\n\t            }\n\t            return null;\n\t        },\n\t\n\t        ensureUrlHasProtocol: function (url) {\n\t            if (url.indexOf('://') === -1) {\n\t                return 'http://' + url;\n\t            }\n\t            return url;\n\t        },\n\t\n\t        warn: function () {\n\t            if (window.console !== undefined && typeof window.console.warn === 'function') {\n\t                window.console.warn.apply(window.console, arguments);\n\t            }\n\t        },\n\t\n\t        deprecated: function (oldName, newName, version) {\n\t            // simple deprecation warning mechanism.\n\t            var m = oldName + ' is deprecated, please use ' + newName + ' instead.';\n\t            if (version) {\n\t                m += ' Will be removed in ' + version;\n\t            }\n\t            Util.warn(m);\n\t        },\n\t\n\t        deprecatedMethod: function (oldName, newName, args, version) {\n\t            // run the replacement and warn when someone calls a deprecated method\n\t            Util.deprecated(oldName, newName, version);\n\t            if (typeof this[newName] === 'function') {\n\t                this[newName].apply(this, args);\n\t            }\n\t        },\n\t\n\t        cleanupAttrs: function (el, attrs) {\n\t            attrs.forEach(function (attr) {\n\t                el.removeAttribute(attr);\n\t            });\n\t        },\n\t\n\t        cleanupTags: function (el, tags) {\n\t            tags.forEach(function (tag) {\n\t                if (el.tagName.toLowerCase() === tag) {\n\t                    el.parentNode.removeChild(el);\n\t                }\n\t            }, this);\n\t        },\n\t\n\t        // get the closest parent\n\t        getClosestTag: function (el, tag) {\n\t            return this.traverseUp(el, function (element) {\n\t                return element.tagName.toLowerCase() === tag.toLowerCase();\n\t            });\n\t        },\n\t\n\t        unwrap: function (el, doc) {\n\t            var fragment = doc.createDocumentFragment(),\n\t                nodes = Array.prototype.slice.call(el.childNodes);\n\t\n\t            // cast nodeList to array since appending child\n\t            // to a different node will alter length of el.childNodes\n\t            for (var i = 0; i < nodes.length; i++) {\n\t                fragment.appendChild(nodes[i]);\n\t            }\n\t\n\t            if (fragment.childNodes.length) {\n\t                el.parentNode.replaceChild(fragment, el);\n\t            } else {\n\t                el.parentNode.removeChild(el);\n\t            }\n\t        },\n\t\n\t        setObject: function (name, value, context) {\n\t            // summary:\n\t            //      Set a property from a dot-separated string, such as 'A.B.C'\n\t            var parts = name.split('.'),\n\t                p = parts.pop(),\n\t                obj = getProp(parts, true, context);\n\t            return obj && p ? (obj[p] = value) : undefined; // Object\n\t        },\n\t\n\t        getObject: function (name, create, context) {\n\t            // summary:\n\t            //      Get a property from a dot-separated string, such as 'A.B.C'\n\t            return getProp(name ? name.split('.') : [], create, context); // Object\n\t        }\n\t\n\t    };\n\t}(window));\n\t\n\tvar ButtonsData;\n\t(function () {\n\t    'use strict';\n\t\n\t    ButtonsData = {\n\t        'bold': {\n\t            name: 'bold',\n\t            action: 'bold',\n\t            aria: 'bold',\n\t            tagNames: ['b', 'strong'],\n\t            style: {\n\t                prop: 'font-weight',\n\t                value: '700|bold'\n\t            },\n\t            useQueryState: true,\n\t            contentDefault: '<b>B</b>',\n\t            contentFA: '<i class=\"fa fa-bold\"></i>',\n\t            key: 'B'\n\t        },\n\t        'italic': {\n\t            name: 'italic',\n\t            action: 'italic',\n\t            aria: 'italic',\n\t            tagNames: ['i', 'em'],\n\t            style: {\n\t                prop: 'font-style',\n\t                value: 'italic'\n\t            },\n\t            useQueryState: true,\n\t            contentDefault: '<b><i>I</i></b>',\n\t            contentFA: '<i class=\"fa fa-italic\"></i>',\n\t            key: 'I'\n\t        },\n\t        'underline': {\n\t            name: 'underline',\n\t            action: 'underline',\n\t            aria: 'underline',\n\t            tagNames: ['u'],\n\t            style: {\n\t                prop: 'text-decoration',\n\t                value: 'underline'\n\t            },\n\t            useQueryState: true,\n\t            contentDefault: '<b><u>U</u></b>',\n\t            contentFA: '<i class=\"fa fa-underline\"></i>',\n\t            key: 'U'\n\t        },\n\t        'strikethrough': {\n\t            name: 'strikethrough',\n\t            action: 'strikethrough',\n\t            aria: 'strike through',\n\t            tagNames: ['strike'],\n\t            style: {\n\t                prop: 'text-decoration',\n\t                value: 'line-through'\n\t            },\n\t            useQueryState: true,\n\t            contentDefault: '<s>A</s>',\n\t            contentFA: '<i class=\"fa fa-strikethrough\"></i>'\n\t        },\n\t        'superscript': {\n\t            name: 'superscript',\n\t            action: 'superscript',\n\t            aria: 'superscript',\n\t            tagNames: ['sup'],\n\t            /* firefox doesn't behave the way we want it to, so we CAN'T use queryCommandState for superscript\n\t               https://github.com/guardian/scribe/blob/master/BROWSERINCONSISTENCIES.md#documentquerycommandstate */\n\t            // useQueryState: true\n\t            contentDefault: '<b>x<sup>1</sup></b>',\n\t            contentFA: '<i class=\"fa fa-superscript\"></i>'\n\t        },\n\t        'subscript': {\n\t            name: 'subscript',\n\t            action: 'subscript',\n\t            aria: 'subscript',\n\t            tagNames: ['sub'],\n\t            /* firefox doesn't behave the way we want it to, so we CAN'T use queryCommandState for subscript\n\t               https://github.com/guardian/scribe/blob/master/BROWSERINCONSISTENCIES.md#documentquerycommandstate */\n\t            // useQueryState: true\n\t            contentDefault: '<b>x<sub>1</sub></b>',\n\t            contentFA: '<i class=\"fa fa-subscript\"></i>'\n\t        },\n\t        'image': {\n\t            name: 'image',\n\t            action: 'image',\n\t            aria: 'image',\n\t            tagNames: ['img'],\n\t            contentDefault: '<b>image</b>',\n\t            contentFA: '<i class=\"fa fa-picture-o\"></i>'\n\t        },\n\t        'quote': {\n\t            name: 'quote',\n\t            action: 'append-blockquote',\n\t            aria: 'blockquote',\n\t            tagNames: ['blockquote'],\n\t            contentDefault: '<b>&ldquo;</b>',\n\t            contentFA: '<i class=\"fa fa-quote-right\"></i>'\n\t        },\n\t        'orderedlist': {\n\t            name: 'orderedlist',\n\t            action: 'insertorderedlist',\n\t            aria: 'ordered list',\n\t            tagNames: ['ol'],\n\t            useQueryState: true,\n\t            contentDefault: '<b>1.</b>',\n\t            contentFA: '<i class=\"fa fa-list-ol\"></i>'\n\t        },\n\t        'unorderedlist': {\n\t            name: 'unorderedlist',\n\t            action: 'insertunorderedlist',\n\t            aria: 'unordered list',\n\t            tagNames: ['ul'],\n\t            useQueryState: true,\n\t            contentDefault: '<b>&bull;</b>',\n\t            contentFA: '<i class=\"fa fa-list-ul\"></i>'\n\t        },\n\t        'pre': {\n\t            name: 'pre',\n\t            action: 'append-pre',\n\t            aria: 'preformatted text',\n\t            tagNames: ['pre'],\n\t            contentDefault: '<b>0101</b>',\n\t            contentFA: '<i class=\"fa fa-code fa-lg\"></i>'\n\t        },\n\t        'indent': {\n\t            name: 'indent',\n\t            action: 'indent',\n\t            aria: 'indent',\n\t            tagNames: [],\n\t            contentDefault: '<b>&rarr;</b>',\n\t            contentFA: '<i class=\"fa fa-indent\"></i>'\n\t        },\n\t        'outdent': {\n\t            name: 'outdent',\n\t            action: 'outdent',\n\t            aria: 'outdent',\n\t            tagNames: [],\n\t            contentDefault: '<b>&larr;</b>',\n\t            contentFA: '<i class=\"fa fa-outdent\"></i>'\n\t        },\n\t        'justifyCenter': {\n\t            name: 'justifyCenter',\n\t            action: 'justifyCenter',\n\t            aria: 'center justify',\n\t            tagNames: [],\n\t            style: {\n\t                prop: 'text-align',\n\t                value: 'center'\n\t            },\n\t            contentDefault: '<b>C</b>',\n\t            contentFA: '<i class=\"fa fa-align-center\"></i>'\n\t        },\n\t        'justifyFull': {\n\t            name: 'justifyFull',\n\t            action: 'justifyFull',\n\t            aria: 'full justify',\n\t            tagNames: [],\n\t            style: {\n\t                prop: 'text-align',\n\t                value: 'justify'\n\t            },\n\t            contentDefault: '<b>J</b>',\n\t            contentFA: '<i class=\"fa fa-align-justify\"></i>'\n\t        },\n\t        'justifyLeft': {\n\t            name: 'justifyLeft',\n\t            action: 'justifyLeft',\n\t            aria: 'left justify',\n\t            tagNames: [],\n\t            style: {\n\t                prop: 'text-align',\n\t                value: 'left'\n\t            },\n\t            contentDefault: '<b>L</b>',\n\t            contentFA: '<i class=\"fa fa-align-left\"></i>'\n\t        },\n\t        'justifyRight': {\n\t            name: 'justifyRight',\n\t            action: 'justifyRight',\n\t            aria: 'right justify',\n\t            tagNames: [],\n\t            style: {\n\t                prop: 'text-align',\n\t                value: 'right'\n\t            },\n\t            contentDefault: '<b>R</b>',\n\t            contentFA: '<i class=\"fa fa-align-right\"></i>'\n\t        },\n\t        'header1': {\n\t            name: 'header1',\n\t            action: function (options) {\n\t                return 'append-' + options.firstHeader;\n\t            },\n\t            aria: function (options) {\n\t                return options.firstHeader;\n\t            },\n\t            tagNames: function (options) {\n\t                return [options.firstHeader];\n\t            },\n\t            contentDefault: '<b>H1</b>'\n\t        },\n\t        'header2': {\n\t            name: 'header2',\n\t            action: function (options) {\n\t                return 'append-' + options.secondHeader;\n\t            },\n\t            aria: function (options) {\n\t                return options.secondHeader;\n\t            },\n\t            tagNames: function (options) {\n\t                return [options.secondHeader];\n\t            },\n\t            contentDefault: '<b>H2</b>'\n\t        },\n\t        // Known inline elements that are not removed, or not removed consistantly across browsers:\n\t        // <span>, <label>, <br>\n\t        'removeFormat': {\n\t            name: 'removeFormat',\n\t            aria: 'remove formatting',\n\t            action: 'removeFormat',\n\t            contentDefault: '<b>X</b>',\n\t            contentFA: '<i class=\"fa fa-eraser\"></i>'\n\t        }\n\t    };\n\t\n\t})();\n\tvar editorDefaults;\n\t(function () {\n\t    // summary: The default options hash used by the Editor\n\t\n\t    editorDefaults = {\n\t        allowMultiParagraphSelection: true,\n\t        buttons: ['bold', 'italic', 'underline', 'anchor', 'header1', 'header2', 'quote'],\n\t        buttonLabels: false,\n\t        delay: 0,\n\t        diffLeft: 0,\n\t        diffTop: -10,\n\t        disableReturn: false,\n\t        disableDoubleReturn: false,\n\t        disableToolbar: false,\n\t        disableEditing: false,\n\t        autoLink: false,\n\t        toolbarAlign: 'center',\n\t        elementsContainer: false,\n\t        imageDragging: true,\n\t        standardizeSelectionStart: false,\n\t        contentWindow: window,\n\t        ownerDocument: document,\n\t        firstHeader: 'h3',\n\t        secondHeader: 'h4',\n\t        targetBlank: false,\n\t        extensions: {},\n\t        activeButtonClass: 'medium-editor-button-active',\n\t        firstButtonClass: 'medium-editor-button-first',\n\t        lastButtonClass: 'medium-editor-button-last',\n\t        spellcheck: true\n\t    };\n\t})();\n\t\n\tvar Extension;\n\t(function () {\n\t    'use strict';\n\t\n\t    /* global Util */\n\t\n\t    Extension = function (options) {\n\t        Util.extend(this, options);\n\t    };\n\t\n\t    Extension.extend = function (protoProps) {\n\t        // magic extender thinger. mostly borrowed from backbone/goog.inherits\n\t        // place this function on some thing you want extend-able.\n\t        //\n\t        // example:\n\t        //\n\t        //      function Thing(args){\n\t        //          this.options = args;\n\t        //      }\n\t        //\n\t        //      Thing.prototype = { foo: \"bar\" };\n\t        //      Thing.extend = extenderify;\n\t        //\n\t        //      var ThingTwo = Thing.extend({ foo: \"baz\" });\n\t        //\n\t        //      var thingOne = new Thing(); // foo === \"bar\"\n\t        //      var thingTwo = new ThingTwo(); // foo === \"baz\"\n\t        //\n\t        //      which seems like some simply shallow copy nonsense\n\t        //      at first, but a lot more is going on there.\n\t        //\n\t        //      passing a `constructor` to the extend props\n\t        //      will cause the instance to instantiate through that\n\t        //      instead of the parent's constructor.\n\t\n\t        var parent = this,\n\t            child;\n\t\n\t        // The constructor function for the new subclass is either defined by you\n\t        // (the \"constructor\" property in your `extend` definition), or defaulted\n\t        // by us to simply call the parent's constructor.\n\t\n\t        if (protoProps && protoProps.hasOwnProperty('constructor')) {\n\t            child = protoProps.constructor;\n\t        } else {\n\t            child = function () {\n\t                return parent.apply(this, arguments);\n\t            };\n\t        }\n\t\n\t        // das statics (.extend comes over, so your subclass can have subclasses too)\n\t        Util.extend(child, parent);\n\t\n\t        // Set the prototype chain to inherit from `parent`, without calling\n\t        // `parent`'s constructor function.\n\t        var Surrogate = function () {\n\t            this.constructor = child;\n\t        };\n\t        Surrogate.prototype = parent.prototype;\n\t        child.prototype = new Surrogate();\n\t\n\t        if (protoProps) {\n\t            Util.extend(child.prototype, protoProps);\n\t        }\n\t\n\t        // todo: $super?\n\t\n\t        return child;\n\t    };\n\t\n\t    Extension.prototype = {\n\t        /* init: [function]\n\t         *\n\t         * Called by MediumEditor during initialization.\n\t         * The .base property will already have been set to\n\t         * current instance of MediumEditor when this is called.\n\t         * All helper methods will exist as well\n\t         */\n\t        init: function () {},\n\t\n\t        /* base: [MediumEditor instance]\n\t         *\n\t         * If not overriden, this will be set to the current instance\n\t         * of MediumEditor, before the init method is called\n\t         */\n\t        base: undefined,\n\t\n\t        /* name: [string]\n\t         *\n\t         * 'name' of the extension, used for retrieving the extension.\n\t         * If not set, MediumEditor will set this to be the key\n\t         * used when passing the extension into MediumEditor via the\n\t         * 'extensions' option\n\t         */\n\t        name: undefined,\n\t\n\t        /* checkState: [function (node)]\n\t         *\n\t         * If implemented, this function will be called one or more times\n\t         * the state of the editor & toolbar are updated.\n\t         * When the state is updated, the editor does the following:\n\t         *\n\t         * 1) Find the parent node containing the current selection\n\t         * 2) Call checkState on the extension, passing the node as an argument\n\t         * 3) Get the parent node of the previous node\n\t         * 4) Repeat steps #2 and #3 until we move outside the parent contenteditable\n\t         */\n\t        checkState: undefined,\n\t\n\t        /* destroy: [function ()]\n\t         *\n\t         * This method should remove any created html, custom event handlers\n\t         * or any other cleanup tasks that should be performed.\n\t         * If implemented, this function will be called when MediumEditor's\n\t         * destroy method has been called.\n\t         */\n\t        destroy: undefined,\n\t\n\t        /* As alternatives to checkState, these functions provide a more structured\n\t         * path to updating the state of an extension (usually a button) whenever\n\t         * the state of the editor & toolbar are updated.\n\t         */\n\t\n\t        /* queryCommandState: [function ()]\n\t         *\n\t         * If implemented, this function will be called once on each extension\n\t         * when the state of the editor/toolbar is being updated.\n\t         *\n\t         * If this function returns a non-null value, the extension will\n\t         * be ignored as the code climbs the dom tree.\n\t         *\n\t         * If this function returns true, and the setActive() function is defined\n\t         * setActive() will be called\n\t         */\n\t        queryCommandState: undefined,\n\t\n\t        /* isActive: [function ()]\n\t         *\n\t         * If implemented, this function will be called when MediumEditor\n\t         * has determined that this extension is 'active' for the current selection.\n\t         * This may be called when the editor & toolbar are being updated,\n\t         * but only if queryCommandState() or isAlreadyApplied() functions\n\t         * are implemented, and when called, return true.\n\t         */\n\t        isActive: undefined,\n\t\n\t        /* isAlreadyApplied: [function (node)]\n\t         *\n\t         * If implemented, this function is similar to checkState() in\n\t         * that it will be called repeatedly as MediumEditor moves up\n\t         * the DOM to update the editor & toolbar after a state change.\n\t         *\n\t         * NOTE: This function will NOT be called if checkState() has\n\t         * been implemented. This function will NOT be called if\n\t         * queryCommandState() is implemented and returns a non-null\n\t         * value when called\n\t         */\n\t        isAlreadyApplied: undefined,\n\t\n\t        /* setActive: [function ()]\n\t         *\n\t         * If implemented, this function is called when MediumEditor knows\n\t         * that this extension is currently enabled.  Currently, this\n\t         * function is called when updating the editor & toolbar, and\n\t         * only if queryCommandState() or isAlreadyApplied(node) return\n\t         * true when called\n\t         */\n\t        setActive: undefined,\n\t\n\t        /* setInactive: [function ()]\n\t         *\n\t         * If implemented, this function is called when MediumEditor knows\n\t         * that this extension is currently disabled.  Curently, this\n\t         * is called at the beginning of each state change for\n\t         * the editor & toolbar. After calling this, MediumEditor\n\t         * will attempt to update the extension, either via checkState()\n\t         * or the combination of queryCommandState(), isAlreadyApplied(node),\n\t         * isActive(), and setActive()\n\t         */\n\t        setInactive: undefined,\n\t\n\t        /************************ Helpers ************************\n\t         * The following are helpers that are either set by MediumEditor\n\t         * during initialization, or are helper methods which either\n\t         * route calls to the MediumEditor instance or provide common\n\t         * functionality for all extensions\n\t         *********************************************************/\n\t\n\t        /* window: [Window]\n\t         *\n\t         * If not overriden, this will be set to the window object\n\t         * to be used by MediumEditor and its extensions.  This is\n\t         * passed via the 'contentWindow' option to MediumEditor\n\t         * and is the global 'window' object by default\n\t         */\n\t        'window': undefined,\n\t\n\t        /* document: [Document]\n\t         *\n\t         * If not overriden, this will be set to the document object\n\t         * to be used by MediumEditor and its extensions. This is\n\t         * passed via the 'ownerDocument' optin to MediumEditor\n\t         * and is the global 'document' object by default\n\t         */\n\t        'document': undefined,\n\t\n\t        /* getEditorElements: [function ()]\n\t         *\n\t         * Helper function which returns an array containing\n\t         * all the contenteditable elements for this instance\n\t         * of MediumEditor\n\t         */\n\t        getEditorElements: function () {\n\t            return this.base.elements;\n\t        },\n\t\n\t        /* getEditorId: [function ()]\n\t         *\n\t         * Helper function which returns a unique identifier\n\t         * for this instance of MediumEditor\n\t         */\n\t        getEditorId: function () {\n\t            return this.base.id;\n\t        },\n\t\n\t        /* getEditorOptions: [function (option)]\n\t         *\n\t         * Helper function which returns the value of an option\n\t         * used to initialize this instance of MediumEditor\n\t         */\n\t        getEditorOption: function (option) {\n\t            return this.base.options[option];\n\t        }\n\t    };\n\t\n\t    /* List of method names to add to the prototype of Extension\n\t     * Each of these methods will be defined as helpers that\n\t     * just call directly into the MediumEditor instance.\n\t     *\n\t     * example for 'on' method:\n\t     * Extension.prototype.on = function () {\n\t     *     return this.base.on.apply(this.base, arguments);\n\t     * }\n\t     */\n\t    [\n\t        // general helpers\n\t        'execAction',\n\t\n\t        // event handling\n\t        'on',\n\t        'off',\n\t        'subscribe'\n\t\n\t    ].forEach(function (helper) {\n\t        Extension.prototype[helper] = function () {\n\t            return this.base[helper].apply(this.base, arguments);\n\t        };\n\t    });\n\t})();\n\t\n\tvar Selection;\n\t\n\t(function () {\n\t    'use strict';\n\t\n\t    function filterOnlyParentElements(node) {\n\t        if (Util.isBlockContainer(node)) {\n\t            return NodeFilter.FILTER_ACCEPT;\n\t        } else {\n\t            return NodeFilter.FILTER_SKIP;\n\t        }\n\t    }\n\t\n\t    Selection = {\n\t        findMatchingSelectionParent: function (testElementFunction, contentWindow) {\n\t            var selection = contentWindow.getSelection(),\n\t                range,\n\t                current;\n\t\n\t            if (selection.rangeCount === 0) {\n\t                return false;\n\t            }\n\t\n\t            range = selection.getRangeAt(0);\n\t            current = range.commonAncestorContainer;\n\t\n\t            return Util.traverseUp(current, testElementFunction);\n\t        },\n\t\n\t        getSelectionElement: function (contentWindow) {\n\t            return this.findMatchingSelectionParent(function (el) {\n\t                return el.getAttribute('data-medium-element');\n\t            }, contentWindow);\n\t        },\n\t\n\t        // Utility method called from importSelection only\n\t        importSelectionMoveCursorPastAnchor: function (selectionState, range) {\n\t            var nodeInsideAnchorTagFunction = function (node) {\n\t                return node.nodeName.toLowerCase() === 'a';\n\t            };\n\t            if (selectionState.start === selectionState.end &&\n\t                    range.startContainer.nodeType === 3 &&\n\t                    range.startOffset === range.startContainer.nodeValue.length &&\n\t                    Util.traverseUp(range.startContainer, nodeInsideAnchorTagFunction)) {\n\t                var prevNode = range.startContainer,\n\t                    currentNode = range.startContainer.parentNode;\n\t                while (currentNode !== null && currentNode.nodeName.toLowerCase() !== 'a') {\n\t                    if (currentNode.childNodes[currentNode.childNodes.length - 1] !== prevNode) {\n\t                        currentNode = null;\n\t                    } else {\n\t                        prevNode = currentNode;\n\t                        currentNode = currentNode.parentNode;\n\t                    }\n\t                }\n\t                if (currentNode !== null && currentNode.nodeName.toLowerCase() === 'a') {\n\t                    var currentNodeIndex = null;\n\t                    for (var i = 0; currentNodeIndex === null && i < currentNode.parentNode.childNodes.length; i++) {\n\t                        if (currentNode.parentNode.childNodes[i] === currentNode) {\n\t                            currentNodeIndex = i;\n\t                        }\n\t                    }\n\t                    range.setStart(currentNode.parentNode, currentNodeIndex + 1);\n\t                    range.collapse(true);\n\t                }\n\t            }\n\t            return range;\n\t        },\n\t\n\t        // Returns 0 unless the cursor is within or preceded by empty paragraphs/blocks,\n\t        // in which case it returns the count of such preceding paragraphs, including\n\t        // the empty paragraph in which the cursor itself may be embedded.\n\t        getIndexRelativeToAdjacentEmptyBlocks: function (doc, root, cursorContainer, cursorOffset) {\n\t            // If there is text in front of the cursor, that means there isn't only empty blocks before it\n\t            if (cursorContainer.nodeType === 3 && cursorOffset > 0) {\n\t                return 0;\n\t            }\n\t\n\t            // Check if the block that contains the cursor has any other text in front of the cursor\n\t            var node = cursorContainer;\n\t            if (node.nodeType !== 3) {\n\t                //node = cursorContainer.childNodes.length === cursorOffset ? null : cursorContainer.childNodes[cursorOffset];\n\t                node = cursorContainer.childNodes[cursorOffset];\n\t            }\n\t            if (node && !Util.isElementAtBeginningOfBlock(node)) {\n\t                return 0;\n\t            }\n\t\n\t            // Walk over block elements, counting number of empty blocks between last piece of text\n\t            // and the block the cursor is in\n\t            var treeWalker = doc.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, filterOnlyParentElements, false),\n\t                emptyBlocksCount = 0;\n\t            while (treeWalker.nextNode()) {\n\t                var blockIsEmpty = treeWalker.currentNode.textContent === '';\n\t                if (blockIsEmpty || emptyBlocksCount > 0) {\n\t                    emptyBlocksCount += 1;\n\t                }\n\t                if (Util.isDescendant(treeWalker.currentNode, cursorContainer, true)) {\n\t                    return emptyBlocksCount;\n\t                }\n\t                if (!blockIsEmpty) {\n\t                    emptyBlocksCount = 0;\n\t                }\n\t            }\n\t\n\t            return emptyBlocksCount;\n\t        },\n\t\n\t        selectionInContentEditableFalse: function (contentWindow) {\n\t            // determine if the current selection is exclusively inside\n\t            // a contenteditable=\"false\", though treat the case of an\n\t            // explicit contenteditable=\"true\" inside a \"false\" as false.\n\t            var sawtrue,\n\t                sawfalse = this.findMatchingSelectionParent(function (el) {\n\t                    var ce = el && el.getAttribute('contenteditable');\n\t                    if (ce === 'true') {\n\t                        sawtrue = true;\n\t                    }\n\t                    return el.nodeName !== '#text' && ce === 'false';\n\t                }, contentWindow);\n\t\n\t            return !sawtrue && sawfalse;\n\t        },\n\t\n\t        // http://stackoverflow.com/questions/4176923/html-of-selected-text\n\t        // by Tim Down\n\t        getSelectionHtml: function getSelectionHtml() {\n\t            var i,\n\t                html = '',\n\t                sel = this.options.contentWindow.getSelection(),\n\t                len,\n\t                container;\n\t            if (sel.rangeCount) {\n\t                container = this.options.ownerDocument.createElement('div');\n\t                for (i = 0, len = sel.rangeCount; i < len; i += 1) {\n\t                    container.appendChild(sel.getRangeAt(i).cloneContents());\n\t                }\n\t                html = container.innerHTML;\n\t            }\n\t            return html;\n\t        },\n\t\n\t        /**\n\t         *  Find the caret position within an element irrespective of any inline tags it may contain.\n\t         *\n\t         *  @param {DOMElement} An element containing the cursor to find offsets relative to.\n\t         *  @param {Range} A Range representing cursor position. Will window.getSelection if none is passed.\n\t         *  @return {Object} 'left' and 'right' attributes contain offsets from begining and end of Element\n\t         */\n\t        getCaretOffsets: function getCaretOffsets(element, range) {\n\t            var preCaretRange, postCaretRange;\n\t\n\t            if (!range) {\n\t                range = window.getSelection().getRangeAt(0);\n\t            }\n\t\n\t            preCaretRange = range.cloneRange();\n\t            postCaretRange = range.cloneRange();\n\t\n\t            preCaretRange.selectNodeContents(element);\n\t            preCaretRange.setEnd(range.endContainer, range.endOffset);\n\t\n\t            postCaretRange.selectNodeContents(element);\n\t            postCaretRange.setStart(range.endContainer, range.endOffset);\n\t\n\t            return {\n\t                left: preCaretRange.toString().length,\n\t                right: postCaretRange.toString().length\n\t            };\n\t        },\n\t\n\t        // http://stackoverflow.com/questions/15867542/range-object-get-selection-parent-node-chrome-vs-firefox\n\t        rangeSelectsSingleNode: function (range) {\n\t            var startNode = range.startContainer;\n\t            return startNode === range.endContainer &&\n\t                startNode.hasChildNodes() &&\n\t                range.endOffset === range.startOffset + 1;\n\t        },\n\t\n\t        getSelectedParentElement: function (range) {\n\t            if (!range) {\n\t                return null;\n\t            }\n\t\n\t            // Selection encompasses a single element\n\t            if (this.rangeSelectsSingleNode(range) && range.startContainer.childNodes[range.startOffset].nodeType !== 3) {\n\t                return range.startContainer.childNodes[range.startOffset];\n\t            }\n\t\n\t            // Selection range starts inside a text node, so get its parent\n\t            if (range.startContainer.nodeType === 3) {\n\t                return range.startContainer.parentNode;\n\t            }\n\t\n\t            // Selection starts inside an element\n\t            return range.startContainer;\n\t        },\n\t\n\t        getSelectedElements: function (doc) {\n\t            var selection = doc.getSelection(),\n\t                range,\n\t                toRet,\n\t                currNode;\n\t\n\t            if (!selection.rangeCount || selection.isCollapsed || !selection.getRangeAt(0).commonAncestorContainer) {\n\t                return [];\n\t            }\n\t\n\t            range = selection.getRangeAt(0);\n\t\n\t            if (range.commonAncestorContainer.nodeType === 3) {\n\t                toRet = [];\n\t                currNode = range.commonAncestorContainer;\n\t                while (currNode.parentNode && currNode.parentNode.childNodes.length === 1) {\n\t                    toRet.push(currNode.parentNode);\n\t                    currNode = currNode.parentNode;\n\t                }\n\t\n\t                return toRet;\n\t            }\n\t\n\t            return [].filter.call(range.commonAncestorContainer.getElementsByTagName('*'), function (el) {\n\t                return (typeof selection.containsNode === 'function') ? selection.containsNode(el, true) : true;\n\t            });\n\t        },\n\t\n\t        selectNode: function (node, doc) {\n\t            var range = doc.createRange(),\n\t                sel = doc.getSelection();\n\t\n\t            range.selectNodeContents(node);\n\t            sel.removeAllRanges();\n\t            sel.addRange(range);\n\t        },\n\t\n\t        select: function (doc, startNode, startOffset, endNode, endOffset) {\n\t            doc.getSelection().removeAllRanges();\n\t            var range = doc.createRange();\n\t            range.setStart(startNode, startOffset);\n\t            if (endNode) {\n\t                range.setEnd(endNode, endOffset);\n\t            } else {\n\t                range.collapse(true);\n\t            }\n\t            doc.getSelection().addRange(range);\n\t            return range;\n\t        },\n\t\n\t        /**\n\t         * Move cursor to the given node with the given offset.\n\t         *\n\t         * @param  {DomDocument} doc     Current document\n\t         * @param  {DomElement}  node    Element where to jump\n\t         * @param  {integer}     offset  Where in the element should we jump, 0 by default\n\t         */\n\t        moveCursor: function (doc, node, offset) {\n\t            var range, sel,\n\t                startOffset = offset || 0;\n\t\n\t            range = doc.createRange();\n\t            sel = doc.getSelection();\n\t\n\t            range.setStart(node, startOffset);\n\t            range.collapse(true);\n\t\n\t            sel.removeAllRanges();\n\t            sel.addRange(range);\n\t        },\n\t\n\t        getSelectionRange: function (ownerDocument) {\n\t            var selection = ownerDocument.getSelection();\n\t            if (selection.rangeCount === 0) {\n\t                return null;\n\t            }\n\t            return selection.getRangeAt(0);\n\t        },\n\t\n\t        // http://stackoverflow.com/questions/1197401/how-can-i-get-the-element-the-caret-is-in-with-javascript-when-using-contentedi\n\t        // by You\n\t        getSelectionStart: function (ownerDocument) {\n\t            var node = ownerDocument.getSelection().anchorNode,\n\t                startNode = (node && node.nodeType === 3 ? node.parentNode : node);\n\t\n\t            return startNode;\n\t        },\n\t\n\t        getSelectionData: function (el) {\n\t            var tagName;\n\t\n\t            if (el && el.tagName) {\n\t                tagName = el.tagName.toLowerCase();\n\t            }\n\t\n\t            while (el && !Util.isBlockContainer(el)) {\n\t                el = el.parentNode;\n\t                if (el && el.tagName) {\n\t                    tagName = el.tagName.toLowerCase();\n\t                }\n\t            }\n\t\n\t            return {\n\t                el: el,\n\t                tagName: tagName\n\t            };\n\t        }\n\t    };\n\t}());\n\t\n\tvar Events;\n\t\n\t(function () {\n\t    'use strict';\n\t\n\t    Events = function (instance) {\n\t        this.base = instance;\n\t        this.options = this.base.options;\n\t        this.events = [];\n\t        this.customEvents = {};\n\t        this.listeners = {};\n\t    };\n\t\n\t    Events.prototype = {\n\t        InputEventOnContenteditableSupported: !Util.isIE,\n\t\n\t        // Helpers for event handling\n\t\n\t        attachDOMEvent: function (target, event, listener, useCapture) {\n\t            target.addEventListener(event, listener, useCapture);\n\t            this.events.push([target, event, listener, useCapture]);\n\t        },\n\t\n\t        detachDOMEvent: function (target, event, listener, useCapture) {\n\t            var index = this.indexOfListener(target, event, listener, useCapture),\n\t                e;\n\t            if (index !== -1) {\n\t                e = this.events.splice(index, 1)[0];\n\t                e[0].removeEventListener(e[1], e[2], e[3]);\n\t            }\n\t        },\n\t\n\t        indexOfListener: function (target, event, listener, useCapture) {\n\t            var i, n, item;\n\t            for (i = 0, n = this.events.length; i < n; i = i + 1) {\n\t                item = this.events[i];\n\t                if (item[0] === target && item[1] === event && item[2] === listener && item[3] === useCapture) {\n\t                    return i;\n\t                }\n\t            }\n\t            return -1;\n\t        },\n\t\n\t        detachAllDOMEvents: function () {\n\t            var e = this.events.pop();\n\t            while (e) {\n\t                e[0].removeEventListener(e[1], e[2], e[3]);\n\t                e = this.events.pop();\n\t            }\n\t        },\n\t\n\t        // custom events\n\t        attachCustomEvent: function (event, listener) {\n\t            this.setupListener(event);\n\t            if (!this.customEvents[event]) {\n\t                this.customEvents[event] = [];\n\t            }\n\t            this.customEvents[event].push(listener);\n\t        },\n\t\n\t        detachCustomEvent: function (event, listener) {\n\t            var index = this.indexOfCustomListener(event, listener);\n\t            if (index !== -1) {\n\t                this.customEvents[event].splice(index, 1);\n\t                // TODO: If array is empty, should detach internal listeners via destroyListener()\n\t            }\n\t        },\n\t\n\t        indexOfCustomListener: function (event, listener) {\n\t            if (!this.customEvents[event] || !this.customEvents[event].length) {\n\t                return -1;\n\t            }\n\t\n\t            return this.customEvents[event].indexOf(listener);\n\t        },\n\t\n\t        detachAllCustomEvents: function () {\n\t            this.customEvents = {};\n\t            // TODO: Should detach internal listeners here via destroyListener()\n\t        },\n\t\n\t        triggerCustomEvent: function (name, data, editable) {\n\t            if (this.customEvents[name]) {\n\t                this.customEvents[name].forEach(function (listener) {\n\t                    listener(data, editable);\n\t                });\n\t            }\n\t        },\n\t\n\t        // Cleaning up\n\t\n\t        destroy: function () {\n\t            this.detachAllDOMEvents();\n\t            this.detachAllCustomEvents();\n\t            this.detachExecCommand();\n\t\n\t            if (this.base.elements) {\n\t                this.base.elements.forEach(function (element) {\n\t                    element.removeAttribute('data-medium-focused');\n\t                });\n\t            }\n\t        },\n\t\n\t        // Listening to calls to document.execCommand\n\t\n\t        // Attach a listener to be notified when document.execCommand is called\n\t        attachToExecCommand: function () {\n\t            if (this.execCommandListener) {\n\t                return;\n\t            }\n\t\n\t            // Store an instance of the listener so:\n\t            // 1) We only attach to execCommand once\n\t            // 2) We can remove the listener later\n\t            this.execCommandListener = function (execInfo) {\n\t                this.handleDocumentExecCommand(execInfo);\n\t            }.bind(this);\n\t\n\t            // Ensure that execCommand has been wrapped correctly\n\t            this.wrapExecCommand();\n\t\n\t            // Add listener to list of execCommand listeners\n\t            this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener);\n\t        },\n\t\n\t        // Remove our listener for calls to document.execCommand\n\t        detachExecCommand: function () {\n\t            var doc = this.options.ownerDocument;\n\t            if (!this.execCommandListener || !doc.execCommand.listeners) {\n\t                return;\n\t            }\n\t\n\t            // Find the index of this listener in the array of listeners so it can be removed\n\t            var index = doc.execCommand.listeners.indexOf(this.execCommandListener);\n\t            if (index !== -1) {\n\t                doc.execCommand.listeners.splice(index, 1);\n\t            }\n\t\n\t            // If the list of listeners is now empty, put execCommand back to its original state\n\t            if (!doc.execCommand.listeners.length) {\n\t                this.unwrapExecCommand();\n\t            }\n\t        },\n\t\n\t        // Wrap document.execCommand in a custom method so we can listen to calls to it\n\t        wrapExecCommand: function () {\n\t            var doc = this.options.ownerDocument;\n\t\n\t            // Ensure all instance of MediumEditor only wrap execCommand once\n\t            if (doc.execCommand.listeners) {\n\t                return;\n\t            }\n\t\n\t            // Create a wrapper method for execCommand which will:\n\t            // 1) Call document.execCommand with the correct arguments\n\t            // 2) Loop through any listeners and notify them that execCommand was called\n\t            //    passing extra info on the call\n\t            // 3) Return the result\n\t            var wrapper = function (aCommandName, aShowDefaultUI, aValueArgument) {\n\t                var result = doc.execCommand.orig.apply(this, arguments);\n\t\n\t                if (!doc.execCommand.listeners) {\n\t                    return result;\n\t                }\n\t\n\t                var args = Array.prototype.slice.call(arguments);\n\t                doc.execCommand.listeners.forEach(function (listener) {\n\t                    listener({\n\t                        command: aCommandName,\n\t                        value: aValueArgument,\n\t                        args: args,\n\t                        result: result\n\t                    });\n\t                });\n\t\n\t                return result;\n\t            };\n\t\n\t            // Store a reference to the original execCommand\n\t            wrapper.orig = doc.execCommand;\n\t\n\t            // Attach an array for storing listeners\n\t            wrapper.listeners = [];\n\t\n\t            // Overwrite execCommand\n\t            doc.execCommand = wrapper;\n\t        },\n\t\n\t        // Revert document.execCommand back to its original self\n\t        unwrapExecCommand: function () {\n\t            var doc = this.options.ownerDocument;\n\t            if (!doc.execCommand.orig) {\n\t                return;\n\t            }\n\t\n\t            // Use the reference to the original execCommand to revert back\n\t            doc.execCommand = doc.execCommand.orig;\n\t        },\n\t\n\t        // Listening to browser events to emit events medium-editor cares about\n\t        setupListener: function (name) {\n\t            if (this.listeners[name]) {\n\t                return;\n\t            }\n\t\n\t            switch (name) {\n\t                case 'externalInteraction':\n\t                    // Detecting when user has interacted with elements outside of MediumEditor\n\t                    this.attachDOMEvent(this.options.ownerDocument.body, 'mousedown', this.handleBodyMousedown.bind(this), true);\n\t                    this.attachDOMEvent(this.options.ownerDocument.body, 'click', this.handleBodyClick.bind(this), true);\n\t                    this.attachDOMEvent(this.options.ownerDocument.body, 'focus', this.handleBodyFocus.bind(this), true);\n\t                    break;\n\t                case 'blur':\n\t                    // Detecting when focus is lost\n\t                    this.setupListener('externalInteraction');\n\t                    break;\n\t                case 'focus':\n\t                    // Detecting when focus moves into some part of MediumEditor\n\t                    this.setupListener('externalInteraction');\n\t                    break;\n\t                case 'editableInput':\n\t                    // setup cache for knowing when the content has changed\n\t                    this.contentCache = [];\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.contentCache[element.getAttribute('medium-editor-index')] = element.innerHTML;\n\t\n\t                        // Attach to the 'oninput' event, handled correctly by most browsers\n\t                        if (this.InputEventOnContenteditableSupported) {\n\t                            this.attachDOMEvent(element, 'input', this.handleInput.bind(this));\n\t                        }\n\t                    }.bind(this));\n\t\n\t                    // For browsers which don't support the input event on contenteditable (IE)\n\t                    // we'll attach to 'selectionchange' on the document and 'keypress' on the editables\n\t                    if (!this.InputEventOnContenteditableSupported) {\n\t                        this.setupListener('editableKeypress');\n\t                        this.keypressUpdateInput = true;\n\t                        this.attachDOMEvent(document, 'selectionchange', this.handleDocumentSelectionChange.bind(this));\n\t                        // Listen to calls to execCommand\n\t                        this.attachToExecCommand();\n\t                    }\n\t                    break;\n\t                case 'editableClick':\n\t                    // Detecting click in the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'click', this.handleClick.bind(this));\n\t                    }.bind(this));\n\t                    break;\n\t                case 'editableBlur':\n\t                    // Detecting blur in the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'blur', this.handleBlur.bind(this));\n\t                    }.bind(this));\n\t                    break;\n\t                case 'editableKeypress':\n\t                    // Detecting keypress in the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'keypress', this.handleKeypress.bind(this));\n\t                    }.bind(this));\n\t                    break;\n\t                case 'editableKeyup':\n\t                    // Detecting keyup in the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'keyup', this.handleKeyup.bind(this));\n\t                    }.bind(this));\n\t                    break;\n\t                case 'editableKeydown':\n\t                    // Detecting keydown on the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'keydown', this.handleKeydown.bind(this));\n\t                    }.bind(this));\n\t                    break;\n\t                case 'editableKeydownEnter':\n\t                    // Detecting keydown for ENTER on the contenteditables\n\t                    this.setupListener('editableKeydown');\n\t                    break;\n\t                case 'editableKeydownTab':\n\t                    // Detecting keydown for TAB on the contenteditable\n\t                    this.setupListener('editableKeydown');\n\t                    break;\n\t                case 'editableKeydownDelete':\n\t                    // Detecting keydown for DELETE/BACKSPACE on the contenteditables\n\t                    this.setupListener('editableKeydown');\n\t                    break;\n\t                case 'editableMouseover':\n\t                    // Detecting mouseover on the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'mouseover', this.handleMouseover.bind(this));\n\t                    }, this);\n\t                    break;\n\t                case 'editableDrag':\n\t                    // Detecting dragover and dragleave on the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'dragover', this.handleDragging.bind(this));\n\t                        this.attachDOMEvent(element, 'dragleave', this.handleDragging.bind(this));\n\t                    }, this);\n\t                    break;\n\t                case 'editableDrop':\n\t                    // Detecting drop on the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'drop', this.handleDrop.bind(this));\n\t                    }, this);\n\t                    break;\n\t                case 'editablePaste':\n\t                    // Detecting paste on the contenteditables\n\t                    this.base.elements.forEach(function (element) {\n\t                        this.attachDOMEvent(element, 'paste', this.handlePaste.bind(this));\n\t                    }, this);\n\t                    break;\n\t            }\n\t            this.listeners[name] = true;\n\t        },\n\t\n\t        focusElement: function (element) {\n\t            element.focus();\n\t            this.updateFocus(element, { target: element, type: 'focus' });\n\t        },\n\t\n\t        updateFocus: function (target, eventObj) {\n\t            var toolbarEl = this.base.toolbar ? this.base.toolbar.getToolbarElement() : null,\n\t                anchorPreview = this.base.getExtensionByName('anchor-preview'),\n\t                previewEl = (anchorPreview && anchorPreview.getPreviewElement) ? anchorPreview.getPreviewElement() : null,\n\t                hadFocus = this.base.getFocusedElement(),\n\t                toFocus;\n\t\n\t            // For clicks, we need to know if the mousedown that caused the click happened inside the existing focused element.\n\t            // If so, we don't want to focus another element\n\t            if (hadFocus &&\n\t                    eventObj.type === 'click' &&\n\t                    this.lastMousedownTarget &&\n\t                    (Util.isDescendant(hadFocus, this.lastMousedownTarget, true) ||\n\t                     Util.isDescendant(toolbarEl, this.lastMousedownTarget, true) ||\n\t                     Util.isDescendant(previewEl, this.lastMousedownTarget, true))) {\n\t                toFocus = hadFocus;\n\t            }\n\t\n\t            if (!toFocus) {\n\t                this.base.elements.some(function (element) {\n\t                    // If the target is part of an editor element, this is the element getting focus\n\t                    if (!toFocus && (Util.isDescendant(element, target, true))) {\n\t                        toFocus = element;\n\t                    }\n\t\n\t                    // bail if we found an element that's getting focus\n\t                    return !!toFocus;\n\t                }, this);\n\t            }\n\t\n\t            // Check if the target is external (not part of the editor, toolbar, or anchorpreview)\n\t            var externalEvent = !Util.isDescendant(hadFocus, target, true) &&\n\t                                !Util.isDescendant(toolbarEl, target, true) &&\n\t                                !Util.isDescendant(previewEl, target, true);\n\t\n\t            if (toFocus !== hadFocus) {\n\t                // If element has focus, and focus is going outside of editor\n\t                // Don't blur focused element if clicking on editor, toolbar, or anchorpreview\n\t                if (hadFocus && externalEvent) {\n\t                    // Trigger blur on the editable that has lost focus\n\t                    hadFocus.removeAttribute('data-medium-focused');\n\t                    this.triggerCustomEvent('blur', eventObj, hadFocus);\n\t                }\n\t\n\t                // If focus is going into an editor element\n\t                if (toFocus) {\n\t                    // Trigger focus on the editable that now has focus\n\t                    toFocus.setAttribute('data-medium-focused', true);\n\t                    this.triggerCustomEvent('focus', eventObj, toFocus);\n\t                }\n\t            }\n\t\n\t            if (externalEvent) {\n\t                this.triggerCustomEvent('externalInteraction', eventObj);\n\t            }\n\t        },\n\t\n\t        updateInput: function (target, eventObj) {\n\t            // An event triggered which signifies that the user may have changed someting\n\t            // Look in our cache of input for the contenteditables to see if something changed\n\t            var index = target.getAttribute('medium-editor-index');\n\t            if (target.innerHTML !== this.contentCache[index]) {\n\t                // The content has changed since the last time we checked, fire the event\n\t                this.triggerCustomEvent('editableInput', eventObj, target);\n\t            }\n\t            this.contentCache[index] = target.innerHTML;\n\t        },\n\t\n\t        handleDocumentSelectionChange: function (event) {\n\t            // When selectionchange fires, target and current target are set\n\t            // to document, since this is where the event is handled\n\t            // However, currentTarget will have an 'activeElement' property\n\t            // which will point to whatever element has focus.\n\t            if (event.currentTarget && event.currentTarget.activeElement) {\n\t                var activeElement = event.currentTarget.activeElement,\n\t                    currentTarget;\n\t                // We can look at the 'activeElement' to determine if the selectionchange has\n\t                // happened within a contenteditable owned by this instance of MediumEditor\n\t                this.base.elements.some(function (element) {\n\t                    if (Util.isDescendant(element, activeElement, true)) {\n\t                        currentTarget = element;\n\t                        return true;\n\t                    }\n\t                    return false;\n\t                }, this);\n\t\n\t                // We know selectionchange fired within one of our contenteditables\n\t                if (currentTarget) {\n\t                    this.updateInput(currentTarget, { target: activeElement, currentTarget: currentTarget });\n\t                }\n\t            }\n\t        },\n\t\n\t        handleDocumentExecCommand: function () {\n\t            // document.execCommand has been called\n\t            // If one of our contenteditables currently has focus, we should\n\t            // attempt to trigger the 'editableInput' event\n\t            var target = this.base.getFocusedElement();\n\t            if (target) {\n\t                this.updateInput(target, { target: target, currentTarget: target });\n\t            }\n\t        },\n\t\n\t        handleBodyClick: function (event) {\n\t            this.updateFocus(event.target, event);\n\t        },\n\t\n\t        handleBodyFocus: function (event) {\n\t            this.updateFocus(event.target, event);\n\t        },\n\t\n\t        handleBodyMousedown: function (event) {\n\t            this.lastMousedownTarget = event.target;\n\t        },\n\t\n\t        handleInput: function (event) {\n\t            this.updateInput(event.currentTarget, event);\n\t        },\n\t\n\t        handleClick: function (event) {\n\t            this.triggerCustomEvent('editableClick', event, event.currentTarget);\n\t        },\n\t\n\t        handleBlur: function (event) {\n\t            this.triggerCustomEvent('editableBlur', event, event.currentTarget);\n\t        },\n\t\n\t        handleKeypress: function (event) {\n\t            this.triggerCustomEvent('editableKeypress', event, event.currentTarget);\n\t\n\t            // If we're doing manual detection of the editableInput event we need\n\t            // to check for input changes during 'keypress'\n\t            if (this.keypressUpdateInput) {\n\t                var eventObj = { target: event.target, currentTarget: event.currentTarget };\n\t\n\t                // In IE, we need to let the rest of the event stack complete before we detect\n\t                // changes to input, so using setTimeout here\n\t                setTimeout(function () {\n\t                    this.updateInput(eventObj.currentTarget, eventObj);\n\t                }.bind(this), 0);\n\t            }\n\t        },\n\t\n\t        handleKeyup: function (event) {\n\t            this.triggerCustomEvent('editableKeyup', event, event.currentTarget);\n\t        },\n\t\n\t        handleMouseover: function (event) {\n\t            this.triggerCustomEvent('editableMouseover', event, event.currentTarget);\n\t        },\n\t\n\t        handleDragging: function (event) {\n\t            this.triggerCustomEvent('editableDrag', event, event.currentTarget);\n\t        },\n\t\n\t        handleDrop: function (event) {\n\t            this.triggerCustomEvent('editableDrop', event, event.currentTarget);\n\t        },\n\t\n\t        handlePaste: function (event) {\n\t            this.triggerCustomEvent('editablePaste', event, event.currentTarget);\n\t        },\n\t\n\t        handleKeydown: function (event) {\n\t            this.triggerCustomEvent('editableKeydown', event, event.currentTarget);\n\t\n\t            if (Util.isKey(event, Util.keyCode.ENTER)) {\n\t                return this.triggerCustomEvent('editableKeydownEnter', event, event.currentTarget);\n\t            }\n\t\n\t            if (Util.isKey(event, Util.keyCode.TAB)) {\n\t                return this.triggerCustomEvent('editableKeydownTab', event, event.currentTarget);\n\t            }\n\t\n\t            if (Util.isKey(event, [Util.keyCode.DELETE, Util.keyCode.BACKSPACE])) {\n\t                return this.triggerCustomEvent('editableKeydownDelete', event, event.currentTarget);\n\t            }\n\t        }\n\t    };\n\t}());\n\t\n\t/* istanbul ignore next */\n\tvar DefaultButton;\n\t\n\t/* istanbul ignore next */\n\t(function () {\n\t    'use strict';\n\t\n\t    DefaultButton = function (options, instance) {\n\t        Util.deprecated('MediumEditor.statics.DefaultButton', 'MediumEditor.extensions.button', 'v5.0.0');\n\t\n\t        this.options = options;\n\t        this.name = options.name;\n\t        this.init(instance);\n\t    };\n\t\n\t    DefaultButton.prototype = {\n\t        init: function (instance) {\n\t            this.base = instance;\n\t\n\t            this.button = this.createButton();\n\t            this.base.on(this.button, 'click', this.handleClick.bind(this));\n\t            if (this.options.key) {\n\t                this.base.subscribe('editableKeydown', this.handleKeydown.bind(this));\n\t            }\n\t        },\n\t        getButton: function () {\n\t            return this.button;\n\t        },\n\t        getAction: function () {\n\t            return (typeof this.options.action === 'function') ? this.options.action(this.base.options) : this.options.action;\n\t        },\n\t        getAria: function () {\n\t            return (typeof this.options.aria === 'function') ? this.options.aria(this.base.options) : this.options.aria;\n\t        },\n\t        getTagNames: function () {\n\t            return (typeof this.options.tagNames === 'function') ? this.options.tagNames(this.base.options) : this.options.tagNames;\n\t        },\n\t        createButton: function () {\n\t            var button = this.base.options.ownerDocument.createElement('button'),\n\t                content = this.options.contentDefault,\n\t                ariaLabel = this.getAria();\n\t            button.classList.add('medium-editor-action');\n\t            button.classList.add('medium-editor-action-' + this.name);\n\t            button.setAttribute('data-action', this.getAction());\n\t            if (ariaLabel) {\n\t                button.setAttribute('title', ariaLabel);\n\t                button.setAttribute('aria-label', ariaLabel);\n\t            }\n\t            if (this.base.options.buttonLabels) {\n\t                if (this.base.options.buttonLabels === 'fontawesome' && this.options.contentFA) {\n\t                    content = this.options.contentFA;\n\t                } else if (typeof this.base.options.buttonLabels === 'object' && this.base.options.buttonLabels[this.name]) {\n\t                    content = this.base.options.buttonLabels[this.options.name];\n\t                }\n\t            }\n\t            button.innerHTML = content;\n\t            return button;\n\t        },\n\t        handleKeydown: function (evt) {\n\t            var key = String.fromCharCode(evt.which || evt.keyCode).toLowerCase(),\n\t                action;\n\t\n\t            if (this.options.key === key && Util.isMetaCtrlKey(evt)) {\n\t                evt.preventDefault();\n\t                evt.stopPropagation();\n\t\n\t                action = this.getAction();\n\t                if (action) {\n\t                    this.base.execAction(action);\n\t                }\n\t            }\n\t        },\n\t        handleClick: function (evt) {\n\t            evt.preventDefault();\n\t            evt.stopPropagation();\n\t\n\t            var action = this.getAction();\n\t\n\t            if (action) {\n\t                this.base.execAction(action);\n\t            }\n\t        },\n\t        isActive: function () {\n\t            return this.button.classList.contains(this.base.options.activeButtonClass);\n\t        },\n\t        setInactive: function () {\n\t            this.button.classList.remove(this.base.options.activeButtonClass);\n\t            delete this.knownState;\n\t        },\n\t        setActive: function () {\n\t            this.button.classList.add(this.base.options.activeButtonClass);\n\t            delete this.knownState;\n\t        },\n\t        queryCommandState: function () {\n\t            var queryState = null;\n\t            if (this.options.useQueryState) {\n\t                queryState = this.base.queryCommandState(this.getAction());\n\t            }\n\t            return queryState;\n\t        },\n\t        isAlreadyApplied: function (node) {\n\t            var isMatch = false,\n\t                tagNames = this.getTagNames(),\n\t                styleVals,\n\t                computedStyle;\n\t\n\t            if (this.knownState === false || this.knownState === true) {\n\t                return this.knownState;\n\t            }\n\t\n\t            if (tagNames && tagNames.length > 0 && node.tagName) {\n\t                isMatch = tagNames.indexOf(node.tagName.toLowerCase()) !== -1;\n\t            }\n\t\n\t            if (!isMatch && this.options.style) {\n\t                styleVals = this.options.style.value.split('|');\n\t                computedStyle = this.base.options.contentWindow.getComputedStyle(node, null).getPropertyValue(this.options.style.prop);\n\t                styleVals.forEach(function (val) {\n\t                    if (!this.knownState) {\n\t                        isMatch = (computedStyle.indexOf(val) !== -1);\n\t                        // text-decoration is not inherited by default\n\t                        // so if the computed style for text-decoration doesn't match\n\t                        // don't write to knownState so we can fallback to other checks\n\t                        if (isMatch || this.options.style.prop !== 'text-decoration') {\n\t                            this.knownState = isMatch;\n\t                        }\n\t                    }\n\t                }, this);\n\t            }\n\t\n\t            return isMatch;\n\t        }\n\t    };\n\t}());\n\t/* istanbul ignore next */\n\tvar AnchorExtension;\n\t\n\t/* istanbul ignore next */\n\t(function () {\n\t    'use strict';\n\t\n\t    function AnchorDerived() {\n\t        Util.deprecated('MediumEditor.statics.AnchorExtension', 'MediumEditor.extensions.anchor', 'v5.0.0');\n\t        this.parent = true;\n\t        this.options = {\n\t            name: 'anchor',\n\t            action: 'createLink',\n\t            aria: 'link',\n\t            tagNames: ['a'],\n\t            contentDefault: '<b>#</b>',\n\t            contentFA: '<i class=\"fa fa-link\"></i>',\n\t            key: 'k'\n\t        };\n\t        this.name = 'anchor';\n\t        this.hasForm = true;\n\t    }\n\t\n\t    AnchorDerived.prototype = {\n\t\n\t        // Button and Extension handling\n\t\n\t        // labels for the anchor-edit form buttons\n\t        formSaveLabel: '&#10003;',\n\t        formCloseLabel: '&times;',\n\t\n\t        // Called when the button the toolbar is clicked\n\t        // Overrides DefaultButton.handleClick\n\t        handleClick: function (evt) {\n\t            evt.preventDefault();\n\t            evt.stopPropagation();\n\t\n\t            var selectedParentElement = Selection.getSelectedParentElement(Selection.getSelectionRange(this.base.options.ownerDocument));\n\t            if (selectedParentElement.tagName &&\n\t                    selectedParentElement.tagName.toLowerCase() === 'a') {\n\t                return this.base.execAction('unlink');\n\t            }\n\t\n\t            if (!this.isDisplayed()) {\n\t                this.showForm();\n\t            }\n\t\n\t            return false;\n\t        },\n\t\n\t        // Called when user hits the defined shortcut (CTRL / COMMAND + K)\n\t        // Overrides DefaultButton.handleKeydown\n\t        handleKeydown: function (evt) {\n\t            var key = String.fromCharCode(evt.which || evt.keyCode).toLowerCase();\n\t\n\t            if (this.options.key === key && Util.isMetaCtrlKey(evt)) {\n\t                evt.preventDefault();\n\t                evt.stopPropagation();\n\t\n\t                this.handleClick(evt);\n\t            }\n\t        },\n\t\n\t        // Called by medium-editor to append form to the toolbar\n\t        getForm: function () {\n\t            if (!this.form) {\n\t                this.form = this.createForm();\n\t            }\n\t            return this.form;\n\t        },\n\t\n\t        getTemplate: function () {\n\t\n\t            var template = [\n\t                '<input type=\"text\" class=\"medium-editor-toolbar-input\" placeholder=\"', this.base.options.anchorInputPlaceholder, '\">'\n\t            ];\n\t\n\t            template.push(\n\t                '<a href=\"#\" class=\"medium-editor-toolbar-save\">',\n\t                this.base.options.buttonLabels === 'fontawesome' ? '<i class=\"fa fa-check\"></i>' : this.formSaveLabel,\n\t                '</a>'\n\t            );\n\t\n\t            template.push('<a href=\"#\" class=\"medium-editor-toolbar-close\">',\n\t                this.base.options.buttonLabels === 'fontawesome' ? '<i class=\"fa fa-times\"></i>' : this.formCloseLabel,\n\t                '</a>');\n\t\n\t            // both of these options are slightly moot with the ability to\n\t            // override the various form buildup/serialize functions.\n\t\n\t            if (this.base.options.anchorTarget) {\n\t                // fixme: ideally, this options.anchorInputCheckboxLabel would be a formLabel too,\n\t                // figure out how to deprecate? also consider `fa-` icon default implcations.\n\t                template.push(\n\t                    '<input type=\"checkbox\" class=\"medium-editor-toolbar-anchor-target\">',\n\t                    '<label>',\n\t                    this.base.options.anchorInputCheckboxLabel,\n\t                    '</label>'\n\t                );\n\t            }\n\t\n\t            if (this.base.options.anchorButton) {\n\t                // fixme: expose this `Button` text as a formLabel property, too\n\t                // and provide similar access to a `fa-` icon default.\n\t                template.push(\n\t                    '<input type=\"checkbox\" class=\"medium-editor-toolbar-anchor-button\">',\n\t                    '<label>Button</label>'\n\t                );\n\t            }\n\t\n\t            return template.join('');\n\t\n\t        },\n\t\n\t        // Used by medium-editor when the default toolbar is to be displayed\n\t        isDisplayed: function () {\n\t            return this.getForm().style.display === 'block';\n\t        },\n\t\n\t        hideForm: function () {\n\t            this.getForm().style.display = 'none';\n\t            this.getInput().value = '';\n\t        },\n\t\n\t        showForm: function (linkValue) {\n\t            var input = this.getInput();\n\t\n\t            this.base.saveSelection();\n\t            this.base.hideToolbarDefaultActions();\n\t            this.getForm().style.display = 'block';\n\t            this.base.setToolbarPosition();\n\t\n\t            input.value = linkValue || '';\n\t            input.focus();\n\t        },\n\t\n\t        // Called by core when tearing down medium-editor (deactivate)\n\t        deactivate: function () {\n\t            if (!this.form) {\n\t                return false;\n\t            }\n\t\n\t            if (this.form.parentNode) {\n\t                this.form.parentNode.removeChild(this.form);\n\t            }\n\t\n\t            delete this.form;\n\t        },\n\t\n\t        // core methods\n\t\n\t        getFormOpts: function () {\n\t            // no notion of private functions? wanted `_getFormOpts`\n\t            var targetCheckbox = this.getForm().querySelector('.medium-editor-toolbar-anchor-target'),\n\t                buttonCheckbox = this.getForm().querySelector('.medium-editor-toolbar-anchor-button'),\n\t                opts = {\n\t                    url: this.getInput().value\n\t                };\n\t\n\t            if (this.base.options.checkLinkFormat) {\n\t                opts.url = this.checkLinkFormat(opts.url);\n\t            }\n\t\n\t            if (targetCheckbox && targetCheckbox.checked) {\n\t                opts.target = '_blank';\n\t            } else {\n\t                opts.target = '_self';\n\t            }\n\t\n\t            if (buttonCheckbox && buttonCheckbox.checked) {\n\t                opts.buttonClass = this.base.options.anchorButtonClass;\n\t            }\n\t\n\t            return opts;\n\t        },\n\t\n\t        doFormSave: function () {\n\t            var opts = this.getFormOpts();\n\t            this.completeFormSave(opts);\n\t        },\n\t\n\t        completeFormSave: function (opts) {\n\t            this.base.restoreSelection();\n\t            this.base.createLink(opts);\n\t            this.base.checkSelection();\n\t        },\n\t\n\t        checkLinkFormat: function (value) {\n\t            var re = /^(https?|ftps?|rtmpt?):\\/\\/|mailto:/;\n\t            return (re.test(value) ? '' : 'http://') + value;\n\t        },\n\t\n\t        doFormCancel: function () {\n\t            this.base.restoreSelection();\n\t            this.base.checkSelection();\n\t        },\n\t\n\t        // form creation and event handling\n\t\n\t        attachFormEvents: function (form) {\n\t            var close = form.querySelector('.medium-editor-toolbar-close'),\n\t                save = form.querySelector('.medium-editor-toolbar-save'),\n\t                input = form.querySelector('.medium-editor-toolbar-input');\n\t\n\t            // Handle clicks on the form itself\n\t            this.base.on(form, 'click', this.handleFormClick.bind(this));\n\t\n\t            // Handle typing in the textbox\n\t            this.base.on(input, 'keyup', this.handleTextboxKeyup.bind(this));\n\t\n\t            // Handle close button clicks\n\t            this.base.on(close, 'click', this.handleCloseClick.bind(this));\n\t\n\t            // Handle save button clicks (capture)\n\t            this.base.on(save, 'click', this.handleSaveClick.bind(this), true);\n\t\n\t        },\n\t\n\t        createForm: function () {\n\t            var doc = this.base.options.ownerDocument,\n\t                form = doc.createElement('div');\n\t\n\t            // Anchor Form (div)\n\t            form.className = 'medium-editor-toolbar-form';\n\t            form.id = 'medium-editor-toolbar-form-anchor-' + this.base.id;\n\t            form.innerHTML = this.getTemplate();\n\t            this.attachFormEvents(form);\n\t\n\t            return form;\n\t        },\n\t\n\t        getInput: function () {\n\t            return this.getForm().querySelector('input.medium-editor-toolbar-input');\n\t        },\n\t\n\t        handleTextboxKeyup: function (event) {\n\t            // For ENTER -> create the anchor\n\t            if (event.keyCode === Util.keyCode.ENTER) {\n\t                event.preventDefault();\n\t                this.doFormSave();\n\t                return;\n\t            }\n\t\n\t            // For ESCAPE -> close the form\n\t            if (event.keyCode === Util.keyCode.ESCAPE) {\n\t                event.preventDefault();\n\t                this.doFormCancel();\n\t            }\n\t        },\n\t\n\t        handleFormClick: function (event) {\n\t            // make sure not to hide form when clicking inside the form\n\t            event.stopPropagation();\n\t        },\n\t\n\t        handleSaveClick: function (event) {\n\t            // Clicking Save -> create the anchor\n\t            event.preventDefault();\n\t            this.doFormSave();\n\t        },\n\t\n\t        handleCloseClick: function (event) {\n\t            // Click Close -> close the form\n\t            event.preventDefault();\n\t            this.doFormCancel();\n\t        }\n\t    };\n\t\n\t    AnchorExtension = Util.derives(DefaultButton, AnchorDerived);\n\t\n\t}());\n\t/* istanbul ignore next */\n\tvar AnchorPreviewDeprecated;\n\t\n\t/* istanbul ignore next */\n\t(function () {\n\t    'use strict';\n\t\n\t    AnchorPreviewDeprecated = function () {\n\t        Util.deprecated('MediumEditor.statics.AnchorPreview', 'MediumEditor.extensions.anchorPreview', 'v5.0.0');\n\t        this.parent = true;\n\t        this.name = 'anchor-preview';\n\t    };\n\t\n\t    AnchorPreviewDeprecated.prototype = {\n\t\n\t        // the default selector to locate where to\n\t        // put the activeAnchor value in the preview\n\t        previewValueSelector: 'a',\n\t\n\t        init: function () {\n\t\n\t            this.anchorPreview = this.createPreview();\n\t            this.base.options.elementsContainer.appendChild(this.anchorPreview);\n\t\n\t            this.attachToEditables();\n\t        },\n\t\n\t        getPreviewElement: function () {\n\t            return this.anchorPreview;\n\t        },\n\t\n\t        createPreview: function () {\n\t            var el = this.base.options.ownerDocument.createElement('div');\n\t\n\t            el.id = 'medium-editor-anchor-preview-' + this.base.id;\n\t            el.className = 'medium-editor-anchor-preview';\n\t            el.innerHTML = this.getTemplate();\n\t\n\t            this.base.on(el, 'click', this.handleClick.bind(this));\n\t\n\t            return el;\n\t        },\n\t\n\t        getTemplate: function () {\n\t            return '<div class=\"medium-editor-toolbar-anchor-preview\" id=\"medium-editor-toolbar-anchor-preview\">' +\n\t                '    <a class=\"medium-editor-toolbar-anchor-preview-inner\"></a>' +\n\t                '</div>';\n\t        },\n\t\n\t        deactivate: function () {\n\t            if (this.anchorPreview) {\n\t                if (this.anchorPreview.parentNode) {\n\t                    this.anchorPreview.parentNode.removeChild(this.anchorPreview);\n\t                }\n\t                delete this.anchorPreview;\n\t            }\n\t        },\n\t\n\t        hidePreview: function () {\n\t            this.anchorPreview.classList.remove('medium-editor-anchor-preview-active');\n\t            this.activeAnchor = null;\n\t        },\n\t\n\t        showPreview: function (anchorEl) {\n\t            if (this.anchorPreview.classList.contains('medium-editor-anchor-preview-active') ||\n\t                    anchorEl.getAttribute('data-disable-preview')) {\n\t                return true;\n\t            }\n\t\n\t            if (this.previewValueSelector) {\n\t                this.anchorPreview.querySelector(this.previewValueSelector).textContent = anchorEl.attributes.href.value;\n\t                this.anchorPreview.querySelector(this.previewValueSelector).href = anchorEl.attributes.href.value;\n\t            }\n\t\n\t            this.anchorPreview.classList.add('medium-toolbar-arrow-over');\n\t            this.anchorPreview.classList.remove('medium-toolbar-arrow-under');\n\t\n\t            if (!this.anchorPreview.classList.contains('medium-editor-anchor-preview-active')) {\n\t                this.anchorPreview.classList.add('medium-editor-anchor-preview-active');\n\t            }\n\t\n\t            this.activeAnchor = anchorEl;\n\t\n\t            this.positionPreview();\n\t            this.attachPreviewHandlers();\n\t\n\t            return this;\n\t        },\n\t\n\t        positionPreview: function () {\n\t            var buttonHeight = this.anchorPreview.offsetHeight,\n\t                boundary = this.activeAnchor.getBoundingClientRect(),\n\t                middleBoundary = (boundary.left + boundary.right) / 2,\n\t                halfOffsetWidth,\n\t                defaultLeft;\n\t\n\t            halfOffsetWidth = this.anchorPreview.offsetWidth / 2;\n\t            defaultLeft = this.base.options.diffLeft - halfOffsetWidth;\n\t\n\t            this.anchorPreview.style.top = Math.round(buttonHeight + boundary.bottom - this.base.options.diffTop + this.base.options.contentWindow.pageYOffset - this.anchorPreview.offsetHeight) + 'px';\n\t            if (middleBoundary < halfOffsetWidth) {\n\t                this.anchorPreview.style.left = defaultLeft + halfOffsetWidth + 'px';\n\t            } else if ((this.base.options.contentWindow.innerWidth - middleBoundary) < halfOffsetWidth) {\n\t                this.anchorPreview.style.left = this.base.options.contentWindow.innerWidth + defaultLeft - halfOffsetWidth + 'px';\n\t            } else {\n\t                this.anchorPreview.style.left = defaultLeft + middleBoundary + 'px';\n\t            }\n\t        },\n\t\n\t        attachToEditables: function () {\n\t            this.base.subscribe('editableMouseover', this.handleEditableMouseover.bind(this));\n\t        },\n\t\n\t        handleClick: function (event) {\n\t            var anchorExtension = this.base.getExtensionByName('anchor'),\n\t                activeAnchor = this.activeAnchor;\n\t\n\t            if (anchorExtension && activeAnchor) {\n\t                event.preventDefault();\n\t\n\t                this.base.selectElement(this.activeAnchor);\n\t\n\t                // Using setTimeout + options.delay because:\n\t                // We may actually be displaying the anchor form, which should be controlled by options.delay\n\t                this.base.delay(function () {\n\t                    if (activeAnchor) {\n\t                        anchorExtension.showForm(activeAnchor.attributes.href.value);\n\t                        activeAnchor = null;\n\t                    }\n\t                }.bind(this));\n\t            }\n\t\n\t            this.hidePreview();\n\t        },\n\t\n\t        handleAnchorMouseout: function () {\n\t            this.anchorToPreview = null;\n\t            this.base.off(this.activeAnchor, 'mouseout', this.instanceHandleAnchorMouseout);\n\t            this.instanceHandleAnchorMouseout = null;\n\t        },\n\t\n\t        handleEditableMouseover: function (event) {\n\t            var target = Util.getClosestTag(event.target, 'a');\n\t\n\t            if (target) {\n\t\n\t                // Detect empty href attributes\n\t                // The browser will make href=\"\" or href=\"#top\"\n\t                // into absolute urls when accessed as event.targed.href, so check the html\n\t                if (!/href=[\"']\\S+[\"']/.test(target.outerHTML) || /href=[\"']#\\S+[\"']/.test(target.outerHTML)) {\n\t                    return true;\n\t                }\n\t\n\t                // only show when hovering on anchors\n\t                if (this.base.toolbar && this.base.toolbar.isDisplayed()) {\n\t                    // only show when toolbar is not present\n\t                    return true;\n\t                }\n\t\n\t                // detach handler for other anchor in case we hovered multiple anchors quickly\n\t                if (this.activeAnchor && this.activeAnchor !== target) {\n\t                    this.detachPreviewHandlers();\n\t                }\n\t\n\t                this.anchorToPreview = target;\n\t\n\t                this.instanceHandleAnchorMouseout = this.handleAnchorMouseout.bind(this);\n\t                this.base.on(this.anchorToPreview, 'mouseout', this.instanceHandleAnchorMouseout);\n\t                // Using setTimeout + options.delay because:\n\t                // - We're going to show the anchor preview according to the configured delay\n\t                //   if the mouse has not left the anchor tag in that time\n\t                this.base.delay(function () {\n\t                    if (this.anchorToPreview) {\n\t                        //this.activeAnchor = this.anchorToPreview;\n\t                        this.showPreview(this.anchorToPreview);\n\t                    }\n\t                }.bind(this));\n\t            }\n\t        },\n\t\n\t        handlePreviewMouseover: function () {\n\t            this.lastOver = (new Date()).getTime();\n\t            this.hovering = true;\n\t        },\n\t\n\t        handlePreviewMouseout: function (event) {\n\t            if (!event.relatedTarget || !/anchor-preview/.test(event.relatedTarget.className)) {\n\t                this.hovering = false;\n\t            }\n\t        },\n\t\n\t        updatePreview: function () {\n\t            if (this.hovering) {\n\t                return true;\n\t            }\n\t            var durr = (new Date()).getTime() - this.lastOver;\n\t            if (durr > this.base.options.anchorPreviewHideDelay) {\n\t                // hide the preview 1/2 second after mouse leaves the link\n\t                this.detachPreviewHandlers();\n\t            }\n\t        },\n\t\n\t        detachPreviewHandlers: function () {\n\t            // cleanup\n\t            clearInterval(this.intervalTimer);\n\t            if (this.instanceHandlePreviewMouseover) {\n\t                this.base.off(this.anchorPreview, 'mouseover', this.instanceHandlePreviewMouseover);\n\t                this.base.off(this.anchorPreview, 'mouseout', this.instanceHandlePreviewMouseout);\n\t                if (this.activeAnchor) {\n\t                    this.base.off(this.activeAnchor, 'mouseover', this.instanceHandlePreviewMouseover);\n\t                    this.base.off(this.activeAnchor, 'mouseout', this.instanceHandlePreviewMouseout);\n\t                }\n\t            }\n\t\n\t            this.hidePreview();\n\t\n\t            this.hovering = this.instanceHandlePreviewMouseover = this.instanceHandlePreviewMouseout = null;\n\t        },\n\t\n\t        // TODO: break up method and extract out handlers\n\t        attachPreviewHandlers: function () {\n\t            this.lastOver = (new Date()).getTime();\n\t            this.hovering = true;\n\t\n\t            this.instanceHandlePreviewMouseover = this.handlePreviewMouseover.bind(this);\n\t            this.instanceHandlePreviewMouseout = this.handlePreviewMouseout.bind(this);\n\t\n\t            this.intervalTimer = setInterval(this.updatePreview.bind(this), 200);\n\t\n\t            this.base.on(this.anchorPreview, 'mouseover', this.instanceHandlePreviewMouseover);\n\t            this.base.on(this.anchorPreview, 'mouseout', this.instanceHandlePreviewMouseout);\n\t            this.base.on(this.activeAnchor, 'mouseover', this.instanceHandlePreviewMouseover);\n\t            this.base.on(this.activeAnchor, 'mouseout', this.instanceHandlePreviewMouseout);\n\t        }\n\t    };\n\t}());\n\t\n\t/* istanbul ignore next */\n\tvar FontSizeExtension;\n\t\n\t/* istanbul ignore next */\n\t(function () {\n\t    'use strict';\n\t\n\t    function FontSizeDerived() {\n\t        Util.deprecated('MediumEditor.statics.FontSizeExtension', 'MediumEditor.extensions.fontSize', 'v5.0.0');\n\t        this.parent = true;\n\t        this.options = {\n\t            name: 'fontsize',\n\t            action: 'fontSize',\n\t            aria: 'increase/decrease font size',\n\t            contentDefault: '&#xB1;', // ±\n\t            contentFA: '<i class=\"fa fa-text-height\"></i>'\n\t        };\n\t        this.name = 'fontsize';\n\t        this.hasForm = true;\n\t    }\n\t\n\t    FontSizeDerived.prototype = {\n\t\n\t        // Button and Extension handling\n\t\n\t        // Called when the button the toolbar is clicked\n\t        // Overrides DefaultButton.handleClick\n\t        handleClick: function (evt) {\n\t            evt.preventDefault();\n\t            evt.stopPropagation();\n\t\n\t            if (!this.isDisplayed()) {\n\t                // Get fontsize of current selection (convert to string since IE returns this as number)\n\t                var fontSize = this.base.options.ownerDocument.queryCommandValue('fontSize') + '';\n\t                this.showForm(fontSize);\n\t            }\n\t\n\t            return false;\n\t        },\n\t\n\t        // Called by medium-editor to append form to the toolbar\n\t        getForm: function () {\n\t            if (!this.form) {\n\t                this.form = this.createForm();\n\t            }\n\t            return this.form;\n\t        },\n\t\n\t        // Used by medium-editor when the default toolbar is to be displayed\n\t        isDisplayed: function () {\n\t            return this.getForm().style.display === 'block';\n\t        },\n\t\n\t        hideForm: function () {\n\t            this.getForm().style.display = 'none';\n\t            this.getInput().value = '';\n\t        },\n\t\n\t        showForm: function (fontSize) {\n\t            var input = this.getInput();\n\t\n\t            this.base.saveSelection();\n\t            this.base.hideToolbarDefaultActions();\n\t            this.getForm().style.display = 'block';\n\t            this.base.setToolbarPosition();\n\t\n\t            input.value = fontSize || '';\n\t            input.focus();\n\t        },\n\t\n\t        // Called by core when tearing down medium-editor (deactivate)\n\t        deactivate: function () {\n\t            if (!this.form) {\n\t                return false;\n\t            }\n\t\n\t            if (this.form.parentNode) {\n\t                this.form.parentNode.removeChild(this.form);\n\t            }\n\t\n\t            delete this.form;\n\t        },\n\t\n\t        // core methods\n\t\n\t        doFormSave: function () {\n\t            this.base.restoreSelection();\n\t            this.base.checkSelection();\n\t        },\n\t\n\t        doFormCancel: function () {\n\t            this.base.restoreSelection();\n\t            this.clearFontSize();\n\t            this.base.checkSelection();\n\t        },\n\t\n\t        // form creation and event handling\n\t\n\t        createForm: function () {\n\t            var doc = this.base.options.ownerDocument,\n\t                form = doc.createElement('div'),\n\t                input = doc.createElement('input'),\n\t                close = doc.createElement('a'),\n\t                save = doc.createElement('a');\n\t\n\t            // Font Size Form (div)\n\t            form.className = 'medium-editor-toolbar-form';\n\t            form.id = 'medium-editor-toolbar-form-fontsize-' + this.base.id;\n\t\n\t            // Handle clicks on the form itself\n\t            this.base.on(form, 'click', this.handleFormClick.bind(this));\n\t\n\t            // Add font size slider\n\t            input.setAttribute('type', 'range');\n\t            input.setAttribute('min', '1');\n\t            input.setAttribute('max', '7');\n\t            input.className = 'medium-editor-toolbar-input';\n\t            form.appendChild(input);\n\t\n\t            // Handle typing in the textbox\n\t            this.base.on(input, 'change', this.handleSliderChange.bind(this));\n\t\n\t            // Add save buton\n\t            save.setAttribute('href', '#');\n\t            save.className = 'medium-editor-toobar-save';\n\t            save.innerHTML = this.base.options.buttonLabels === 'fontawesome' ?\n\t                             '<i class=\"fa fa-check\"></i>' :\n\t                             '&#10003;';\n\t            form.appendChild(save);\n\t\n\t            // Handle save button clicks (capture)\n\t            this.base.on(save, 'click', this.handleSaveClick.bind(this), true);\n\t\n\t            // Add close button\n\t            close.setAttribute('href', '#');\n\t            close.className = 'medium-editor-toobar-close';\n\t            close.innerHTML = this.base.options.buttonLabels === 'fontawesome' ?\n\t                              '<i class=\"fa fa-times\"></i>' :\n\t                              '&times;';\n\t            form.appendChild(close);\n\t\n\t            // Handle close button clicks\n\t            this.base.on(close, 'click', this.handleCloseClick.bind(this));\n\t\n\t            return form;\n\t        },\n\t\n\t        getInput: function () {\n\t            return this.getForm().querySelector('input.medium-editor-toolbar-input');\n\t        },\n\t\n\t        clearFontSize: function () {\n\t            Selection.getSelectedElements(this.base.options.ownerDocument).forEach(function (el) {\n\t                if (el.tagName === 'FONT' && el.hasAttribute('size')) {\n\t                    el.removeAttribute('size');\n\t                }\n\t            });\n\t        },\n\t\n\t        handleSliderChange: function () {\n\t            var size = this.getInput().value;\n\t            if (size === '4') {\n\t                this.clearFontSize();\n\t            } else {\n\t                this.base.execAction('fontSize', { size: size });\n\t            }\n\t        },\n\t\n\t        handleFormClick: function (event) {\n\t            // make sure not to hide form when clicking inside the form\n\t            event.stopPropagation();\n\t        },\n\t\n\t        handleSaveClick: function (event) {\n\t            // Clicking Save -> create the font size\n\t            event.preventDefault();\n\t            this.doFormSave();\n\t        },\n\t\n\t        handleCloseClick: function (event) {\n\t            // Click Close -> close the form\n\t            event.preventDefault();\n\t            this.doFormCancel();\n\t        }\n\t    };\n\t\n\t    FontSizeExtension = Util.derives(DefaultButton, FontSizeDerived);\n\t}());\n\tvar Button;\n\t(function () {\n\t    'use strict';\n\t\n\t    /*global Util, Extension */\n\t\n\t    Button = Extension.extend({\n\t        init: function () {\n\t            this.button = this.createButton();\n\t            this.on(this.button, 'click', this.handleClick.bind(this));\n\t            if (this.key) {\n\t                this.subscribe('editableKeydown', this.handleKeydown.bind(this));\n\t            }\n\t        },\n\t\n\t        /* getButton: [function ()]\n\t         *\n\t         * If implemented, this function will be called when\n\t         * the toolbar is being created.  The DOM Element returned\n\t         * by this function will be appended to the toolbar along\n\t         * with any other buttons.\n\t         */\n\t        getButton: function () {\n\t            return this.button;\n\t        },\n\t\n\t        getAction: function () {\n\t            return (typeof this.action === 'function') ? this.action(this.base.options) : this.action;\n\t        },\n\t\n\t        getAria: function () {\n\t            return (typeof this.aria === 'function') ? this.aria(this.base.options) : this.aria;\n\t        },\n\t\n\t        getTagNames: function () {\n\t            return (typeof this.tagNames === 'function') ? this.tagNames(this.base.options) : this.tagNames;\n\t        },\n\t\n\t        createButton: function () {\n\t            var button = this.document.createElement('button'),\n\t                content = this.contentDefault,\n\t                ariaLabel = this.getAria(),\n\t                buttonLabels = this.getEditorOption('buttonLabels');\n\t            button.classList.add('medium-editor-action');\n\t            button.classList.add('medium-editor-action-' + this.name);\n\t            button.setAttribute('data-action', this.getAction());\n\t            if (ariaLabel) {\n\t                button.setAttribute('title', ariaLabel);\n\t                button.setAttribute('aria-label', ariaLabel);\n\t            }\n\t            if (buttonLabels) {\n\t                if (buttonLabels === 'fontawesome' && this.contentFA) {\n\t                    content = this.contentFA;\n\t                } else if (typeof buttonLabels === 'object' && buttonLabels[this.name]) {\n\t                    content = buttonLabels[this.name];\n\t                }\n\t            }\n\t            button.innerHTML = content;\n\t            return button;\n\t        },\n\t\n\t        handleKeydown: function (event) {\n\t            var action;\n\t\n\t            if (Util.isKey(event, this.key.charCodeAt(0)) && Util.isMetaCtrlKey(event) && !event.shiftKey) {\n\t                event.preventDefault();\n\t                event.stopPropagation();\n\t\n\t                action = this.getAction();\n\t                if (action) {\n\t                    this.execAction(action);\n\t                }\n\t            }\n\t        },\n\t\n\t        handleClick: function (event) {\n\t            event.preventDefault();\n\t            event.stopPropagation();\n\t\n\t            var action = this.getAction();\n\t\n\t            if (action) {\n\t                this.execAction(action);\n\t            }\n\t        },\n\t\n\t        isActive: function () {\n\t            return this.button.classList.contains(this.getEditorOption('activeButtonClass'));\n\t        },\n\t\n\t        setInactive: function () {\n\t            this.button.classList.remove(this.getEditorOption('activeButtonClass'));\n\t            delete this.knownState;\n\t        },\n\t\n\t        setActive: function () {\n\t            this.button.classList.add(this.getEditorOption('activeButtonClass'));\n\t            delete this.knownState;\n\t        },\n\t\n\t        queryCommandState: function () {\n\t            var queryState = null;\n\t            if (this.useQueryState) {\n\t                queryState = this.base.queryCommandState(this.getAction());\n\t            }\n\t            return queryState;\n\t        },\n\t\n\t        isAlreadyApplied: function (node) {\n\t            var isMatch = false,\n\t                tagNames = this.getTagNames(),\n\t                styleVals,\n\t                computedStyle;\n\t\n\t            if (this.knownState === false || this.knownState === true) {\n\t                return this.knownState;\n\t            }\n\t\n\t            if (tagNames && tagNames.length > 0 && node.tagName) {\n\t                isMatch = tagNames.indexOf(node.tagName.toLowerCase()) !== -1;\n\t            }\n\t\n\t            if (!isMatch && this.style) {\n\t                styleVals = this.style.value.split('|');\n\t                computedStyle = this.window.getComputedStyle(node, null).getPropertyValue(this.style.prop);\n\t                styleVals.forEach(function (val) {\n\t                    if (!this.knownState) {\n\t                        isMatch = (computedStyle.indexOf(val) !== -1);\n\t                        // text-decoration is not inherited by default\n\t                        // so if the computed style for text-decoration doesn't match\n\t                        // don't write to knownState so we can fallback to other checks\n\t                        if (isMatch || this.style.prop !== 'text-decoration') {\n\t                            this.knownState = isMatch;\n\t                        }\n\t                    }\n\t                }, this);\n\t            }\n\t\n\t            return isMatch;\n\t        }\n\t    });\n\t}());\n\t\n\tvar FormExtension;\n\t(function () {\n\t    'use strict';\n\t\n\t    /* global Button */\n\t\n\t    var noop = function () {};\n\t\n\t    /* Base functionality for an extension whcih will display\n\t     * a 'form' inside the toolbar\n\t     */\n\t    FormExtension = Button.extend({\n\t        // default labels for the form buttons\n\t        formSaveLabel: '&#10003;',\n\t        formCloseLabel: '&times;',\n\t\n\t        /* hasForm: [boolean]\n\t         *\n\t         * Setting this to true will cause getForm() to be called\n\t         * when the toolbar is created, so the form can be appended\n\t         * inside the toolbar container\n\t         */\n\t        hasForm: true,\n\t\n\t        /* getForm: [function ()]\n\t         *\n\t         * When hasForm is true, this function must be implemented\n\t         * and return a DOM Element which will be appended to\n\t         * the toolbar container. The form should start hidden, and\n\t         * the extension can choose when to hide/show it\n\t         */\n\t        getForm: noop,\n\t\n\t        /* isDisplayed: [function ()]\n\t         *\n\t         * This function should return true/false reflecting\n\t         * whether the form is currently displayed\n\t         */\n\t        isDisplayed: noop,\n\t\n\t        /* hideForm: [function ()]\n\t         *\n\t         * This function should hide the form element inside\n\t         * the toolbar container\n\t         */\n\t        hideForm: noop\n\t    });\n\t})();\n\tvar AnchorForm;\n\t(function () {\n\t    'use strict';\n\t\n\t    /*global Util, Selection, FormExtension */\n\t\n\t    AnchorForm = FormExtension.extend({\n\t        /* Anchor Form Options */\n\t\n\t        /* customClassOption: [string]  (previously options.anchorButton + options.anchorButtonClass)\n\t         * Custom class name the user can optionally have added to their created links (ie 'button').\n\t         * If passed as a non-empty string, a checkbox will be displayed allowing the user to choose\n\t         * whether to have the class added to the created link or not.\n\t         */\n\t        customClassOption: null,\n\t\n\t        /* customClassOptionText: [string]\n\t         * text to be shown in the checkbox when the __customClassOption__ is being used.\n\t         */\n\t        customClassOptionText: 'Button',\n\t\n\t        /* linkValidation: [boolean]  (previously options.checkLinkFormat)\n\t         * enables/disables check for common URL protocols on anchor links.\n\t         */\n\t        linkValidation: false,\n\t\n\t        /* placeholderText: [string]  (previously options.anchorInputPlaceholder)\n\t         * text to be shown as placeholder of the anchor input.\n\t         */\n\t        placeholderText: 'Paste or type a link',\n\t\n\t        /* targetCheckbox: [boolean]  (previously options.anchorTarget)\n\t         * enables/disables displaying a \"Open in new window\" checkbox, which when checked\n\t         * changes the `target` attribute of the created link.\n\t         */\n\t        targetCheckbox: false,\n\t\n\t        /* targetCheckboxText: [string]  (previously options.anchorInputCheckboxLabel)\n\t         * text to be shown in the checkbox enabled via the __targetCheckbox__ option.\n\t         */\n\t        targetCheckboxText: 'Open in new window',\n\t\n\t        // Options for the Button base class\n\t        name: 'anchor',\n\t        action: 'createLink',\n\t        aria: 'link',\n\t        tagNames: ['a'],\n\t        contentDefault: '<b>#</b>',\n\t        contentFA: '<i class=\"fa fa-link\"></i>',\n\t        key: 'K',\n\t\n\t        // Called when the button the toolbar is clicked\n\t        // Overrides ButtonExtension.handleClick\n\t        handleClick: function (event) {\n\t            event.preventDefault();\n\t            event.stopPropagation();\n\t\n\t            var range = Selection.getSelectionRange(this.document);\n\t\n\t            if (range.startContainer.nodeName.toLowerCase() === 'a' ||\n\t                range.endContainer.nodeName.toLowerCase() === 'a' ||\n\t                Util.getClosestTag(Selection.getSelectedParentElement(range), 'a')) {\n\t                return this.execAction('unlink');\n\t            }\n\t\n\t            if (!this.isDisplayed()) {\n\t                this.showForm();\n\t            }\n\t\n\t            return false;\n\t        },\n\t\n\t        // Called when user hits the defined shortcut (CTRL / COMMAND + K)\n\t        // Overrides Button.handleKeydown\n\t        handleKeydown: function (event) {\n\t            if (Util.isKey(event, this.key.charCodeAt(0)) && Util.isMetaCtrlKey(event)) {\n\t                this.handleClick(event);\n\t            }\n\t        },\n\t\n\t        // Called by medium-editor to append form to the toolbar\n\t        getForm: function () {\n\t            if (!this.form) {\n\t                this.form = this.createForm();\n\t            }\n\t            return this.form;\n\t        },\n\t\n\t        getTemplate: function () {\n\t            var template = [\n\t                '<input type=\"text\" class=\"medium-editor-toolbar-input\" placeholder=\"', this.placeholderText, '\">'\n\t            ];\n\t\n\t            template.push(\n\t                '<a href=\"#\" class=\"medium-editor-toolbar-save\">',\n\t                this.getEditorOption('buttonLabels') === 'fontawesome' ? '<i class=\"fa fa-check\"></i>' : this.formSaveLabel,\n\t                '</a>'\n\t            );\n\t\n\t            template.push('<a href=\"#\" class=\"medium-editor-toolbar-close\">',\n\t                this.getEditorOption('buttonLabels') === 'fontawesome' ? '<i class=\"fa fa-times\"></i>' : this.formCloseLabel,\n\t                '</a>');\n\t\n\t            // both of these options are slightly moot with the ability to\n\t            // override the various form buildup/serialize functions.\n\t\n\t            if (this.targetCheckbox) {\n\t                // fixme: ideally, this targetCheckboxText would be a formLabel too,\n\t                // figure out how to deprecate? also consider `fa-` icon default implcations.\n\t                template.push(\n\t                    '<input type=\"checkbox\" class=\"medium-editor-toolbar-anchor-target\">',\n\t                    '<label>',\n\t                    this.targetCheckboxText,\n\t                    '</label>'\n\t                );\n\t            }\n\t\n\t            if (this.customClassOption) {\n\t                // fixme: expose this `Button` text as a formLabel property, too\n\t                // and provide similar access to a `fa-` icon default.\n\t                template.push(\n\t                    '<input type=\"checkbox\" class=\"medium-editor-toolbar-anchor-button\">',\n\t                    '<label>',\n\t                    this.customClassOptionText,\n\t                    '</label>'\n\t                );\n\t            }\n\t\n\t            return template.join('');\n\t\n\t        },\n\t\n\t        // Used by medium-editor when the default toolbar is to be displayed\n\t        isDisplayed: function () {\n\t            return this.getForm().style.display === 'block';\n\t        },\n\t\n\t        hideForm: function () {\n\t            this.getForm().style.display = 'none';\n\t            this.getInput().value = '';\n\t        },\n\t\n\t        showForm: function (linkValue) {\n\t            var input = this.getInput();\n\t\n\t            this.base.saveSelection();\n\t            this.base.hideToolbarDefaultActions();\n\t            this.getForm().style.display = 'block';\n\t            this.base.setToolbarPosition();\n\t\n\t            input.value = linkValue || '';\n\t            input.focus();\n\t        },\n\t\n\t        // Called by core when tearing down medium-editor (destroy)\n\t        destroy: function () {\n\t            if (!this.form) {\n\t                return false;\n\t            }\n\t\n\t            if (this.form.parentNode) {\n\t                this.form.parentNode.removeChild(this.form);\n\t            }\n\t\n\t            delete this.form;\n\t        },\n\t\n\t        // TODO: deprecate\n\t        deactivate: function () {\n\t            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n\t        },\n\t\n\t        // core methods\n\t\n\t        getFormOpts: function () {\n\t            // no notion of private functions? wanted `_getFormOpts`\n\t            var targetCheckbox = this.getForm().querySelector('.medium-editor-toolbar-anchor-target'),\n\t                buttonCheckbox = this.getForm().querySelector('.medium-editor-toolbar-anchor-button'),\n\t                opts = {\n\t                    url: this.getInput().value\n\t                };\n\t\n\t            if (this.linkValidation) {\n\t                opts.url = this.checkLinkFormat(opts.url);\n\t            }\n\t\n\t            opts.target = '_self';\n\t            if (targetCheckbox && targetCheckbox.checked) {\n\t                opts.target = '_blank';\n\t            }\n\t\n\t            if (buttonCheckbox && buttonCheckbox.checked) {\n\t                opts.buttonClass = this.customClassOption;\n\t            }\n\t\n\t            return opts;\n\t        },\n\t\n\t        doFormSave: function () {\n\t            var opts = this.getFormOpts();\n\t            this.completeFormSave(opts);\n\t        },\n\t\n\t        completeFormSave: function (opts) {\n\t            this.base.restoreSelection();\n\t            this.execAction(this.action, opts);\n\t            this.base.checkSelection();\n\t        },\n\t\n\t        checkLinkFormat: function (value) {\n\t            var re = /^(https?|ftps?|rtmpt?):\\/\\/|mailto:/;\n\t            return (re.test(value) ? '' : 'http://') + value;\n\t        },\n\t\n\t        doFormCancel: function () {\n\t            this.base.restoreSelection();\n\t            this.base.checkSelection();\n\t        },\n\t\n\t        // form creation and event handling\n\t        attachFormEvents: function (form) {\n\t            var close = form.querySelector('.medium-editor-toolbar-close'),\n\t                save = form.querySelector('.medium-editor-toolbar-save'),\n\t                input = form.querySelector('.medium-editor-toolbar-input');\n\t\n\t            // Handle clicks on the form itself\n\t            this.on(form, 'click', this.handleFormClick.bind(this));\n\t\n\t            // Handle typing in the textbox\n\t            this.on(input, 'keyup', this.handleTextboxKeyup.bind(this));\n\t\n\t            // Handle close button clicks\n\t            this.on(close, 'click', this.handleCloseClick.bind(this));\n\t\n\t            // Handle save button clicks (capture)\n\t            this.on(save, 'click', this.handleSaveClick.bind(this), true);\n\t\n\t        },\n\t\n\t        createForm: function () {\n\t            var doc = this.document,\n\t                form = doc.createElement('div');\n\t\n\t            // Anchor Form (div)\n\t            form.className = 'medium-editor-toolbar-form';\n\t            form.id = 'medium-editor-toolbar-form-anchor-' + this.getEditorId();\n\t            form.innerHTML = this.getTemplate();\n\t            this.attachFormEvents(form);\n\t\n\t            return form;\n\t        },\n\t\n\t        getInput: function () {\n\t            return this.getForm().querySelector('input.medium-editor-toolbar-input');\n\t        },\n\t\n\t        handleTextboxKeyup: function (event) {\n\t            // For ENTER -> create the anchor\n\t            if (event.keyCode === Util.keyCode.ENTER) {\n\t                event.preventDefault();\n\t                this.doFormSave();\n\t                return;\n\t            }\n\t\n\t            // For ESCAPE -> close the form\n\t            if (event.keyCode === Util.keyCode.ESCAPE) {\n\t                event.preventDefault();\n\t                this.doFormCancel();\n\t            }\n\t        },\n\t\n\t        handleFormClick: function (event) {\n\t            // make sure not to hide form when clicking inside the form\n\t            event.stopPropagation();\n\t        },\n\t\n\t        handleSaveClick: function (event) {\n\t            // Clicking Save -> create the anchor\n\t            event.preventDefault();\n\t            this.doFormSave();\n\t        },\n\t\n\t        handleCloseClick: function (event) {\n\t            // Click Close -> close the form\n\t            event.preventDefault();\n\t            this.doFormCancel();\n\t        }\n\t    });\n\t}());\n\tvar AnchorPreview;\n\t(function () {\n\t    'use strict';\n\t\n\t    /*global Util, Extension */\n\t\n\t    AnchorPreview = Extension.extend({\n\t        name: 'anchor-preview',\n\t\n\t        // Anchor Preview Options\n\t\n\t        /* hideDelay: [number]  (previously options.anchorPreviewHideDelay)\n\t         * time in milliseconds to show the anchor tag preview after the mouse has left the anchor tag.\n\t         */\n\t        hideDelay: 500,\n\t\n\t        /* previewValueSelector: [string]\n\t         * the default selector to locate where to put the activeAnchor value in the preview\n\t         */\n\t        previewValueSelector: 'a',\n\t\n\t        /* ----- internal options needed from base ----- */\n\t        diffLeft: 0, // deprecated (should use .getEditorOption() instead)\n\t        diffTop: -10, // deprecated (should use .getEditorOption() instead)\n\t        elementsContainer: false, // deprecated (should use .getEditorOption() instead)\n\t\n\t        init: function () {\n\t            this.anchorPreview = this.createPreview();\n\t\n\t            if (!this.elementsContainer) {\n\t                this.elementsContainer = this.document.body;\n\t            }\n\t            this.elementsContainer.appendChild(this.anchorPreview);\n\t\n\t            this.attachToEditables();\n\t        },\n\t\n\t        getPreviewElement: function () {\n\t            return this.anchorPreview;\n\t        },\n\t\n\t        createPreview: function () {\n\t            var el = this.document.createElement('div');\n\t\n\t            el.id = 'medium-editor-anchor-preview-' + this.getEditorId();\n\t            el.className = 'medium-editor-anchor-preview';\n\t            el.innerHTML = this.getTemplate();\n\t\n\t            this.on(el, 'click', this.handleClick.bind(this));\n\t\n\t            return el;\n\t        },\n\t\n\t        getTemplate: function () {\n\t            return '<div class=\"medium-editor-toolbar-anchor-preview\" id=\"medium-editor-toolbar-anchor-preview\">' +\n\t                '    <a class=\"medium-editor-toolbar-anchor-preview-inner\"></a>' +\n\t                '</div>';\n\t        },\n\t\n\t        destroy: function () {\n\t            if (this.anchorPreview) {\n\t                if (this.anchorPreview.parentNode) {\n\t                    this.anchorPreview.parentNode.removeChild(this.anchorPreview);\n\t                }\n\t                delete this.anchorPreview;\n\t            }\n\t        },\n\t\n\t        // TODO: deprecate\n\t        deactivate: function () {\n\t            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n\t        },\n\t\n\t        hidePreview: function () {\n\t            this.anchorPreview.classList.remove('medium-editor-anchor-preview-active');\n\t            this.activeAnchor = null;\n\t        },\n\t\n\t        showPreview: function (anchorEl) {\n\t            if (this.anchorPreview.classList.contains('medium-editor-anchor-preview-active') ||\n\t                    anchorEl.getAttribute('data-disable-preview')) {\n\t                return true;\n\t            }\n\t\n\t            if (this.previewValueSelector) {\n\t                this.anchorPreview.querySelector(this.previewValueSelector).textContent = anchorEl.attributes.href.value;\n\t                this.anchorPreview.querySelector(this.previewValueSelector).href = anchorEl.attributes.href.value;\n\t            }\n\t\n\t            this.anchorPreview.classList.add('medium-toolbar-arrow-over');\n\t            this.anchorPreview.classList.remove('medium-toolbar-arrow-under');\n\t\n\t            if (!this.anchorPreview.classList.contains('medium-editor-anchor-preview-active')) {\n\t                this.anchorPreview.classList.add('medium-editor-anchor-preview-active');\n\t            }\n\t\n\t            this.activeAnchor = anchorEl;\n\t\n\t            this.positionPreview();\n\t            this.attachPreviewHandlers();\n\t\n\t            return this;\n\t        },\n\t\n\t        positionPreview: function () {\n\t            var buttonHeight = this.anchorPreview.offsetHeight,\n\t                boundary = this.activeAnchor.getBoundingClientRect(),\n\t                middleBoundary = (boundary.left + boundary.right) / 2,\n\t                halfOffsetWidth,\n\t                defaultLeft;\n\t\n\t            halfOffsetWidth = this.anchorPreview.offsetWidth / 2;\n\t            defaultLeft = this.diffLeft - halfOffsetWidth;\n\t\n\t            this.anchorPreview.style.top = Math.round(buttonHeight + boundary.bottom - this.diffTop + this.window.pageYOffset - this.anchorPreview.offsetHeight) + 'px';\n\t            if (middleBoundary < halfOffsetWidth) {\n\t                this.anchorPreview.style.left = defaultLeft + halfOffsetWidth + 'px';\n\t            } else if ((this.window.innerWidth - middleBoundary) < halfOffsetWidth) {\n\t                this.anchorPreview.style.left = this.window.innerWidth + defaultLeft - halfOffsetWidth + 'px';\n\t            } else {\n\t                this.anchorPreview.style.left = defaultLeft + middleBoundary + 'px';\n\t            }\n\t        },\n\t\n\t        attachToEditables: function () {\n\t            this.subscribe('editableMouseover', this.handleEditableMouseover.bind(this));\n\t        },\n\t\n\t        handleClick: function (event) {\n\t            var anchorExtension = this.base.getExtensionByName('anchor'),\n\t                activeAnchor = this.activeAnchor;\n\t\n\t            if (anchorExtension && activeAnchor) {\n\t                event.preventDefault();\n\t\n\t                this.base.selectElement(this.activeAnchor);\n\t\n\t                // Using setTimeout + delay because:\n\t                // We may actually be displaying the anchor form, which should be controlled by delay\n\t                this.base.delay(function () {\n\t                    if (activeAnchor) {\n\t                        anchorExtension.showForm(activeAnchor.attributes.href.value);\n\t                        activeAnchor = null;\n\t                    }\n\t                }.bind(this));\n\t            }\n\t\n\t            this.hidePreview();\n\t        },\n\t\n\t        handleAnchorMouseout: function () {\n\t            this.anchorToPreview = null;\n\t            this.off(this.activeAnchor, 'mouseout', this.instanceHandleAnchorMouseout);\n\t            this.instanceHandleAnchorMouseout = null;\n\t        },\n\t\n\t        handleEditableMouseover: function (event) {\n\t            var target = Util.getClosestTag(event.target, 'a');\n\t\n\t            if (false === target) {\n\t                return;\n\t            }\n\t\n\t            // Detect empty href attributes\n\t            // The browser will make href=\"\" or href=\"#top\"\n\t            // into absolute urls when accessed as event.targed.href, so check the html\n\t            if (!/href=[\"']\\S+[\"']/.test(target.outerHTML) || /href=[\"']#\\S+[\"']/.test(target.outerHTML)) {\n\t                return true;\n\t            }\n\t\n\t            // only show when hovering on anchors\n\t            if (this.base.toolbar && this.base.toolbar.isDisplayed()) {\n\t                // only show when toolbar is not present\n\t                return true;\n\t            }\n\t\n\t            // detach handler for other anchor in case we hovered multiple anchors quickly\n\t            if (this.activeAnchor && this.activeAnchor !== target) {\n\t                this.detachPreviewHandlers();\n\t            }\n\t\n\t            this.anchorToPreview = target;\n\t\n\t            this.instanceHandleAnchorMouseout = this.handleAnchorMouseout.bind(this);\n\t            this.on(this.anchorToPreview, 'mouseout', this.instanceHandleAnchorMouseout);\n\t            // Using setTimeout + delay because:\n\t            // - We're going to show the anchor preview according to the configured delay\n\t            //   if the mouse has not left the anchor tag in that time\n\t            this.base.delay(function () {\n\t                if (this.anchorToPreview) {\n\t                    //this.activeAnchor = this.anchorToPreview;\n\t                    this.showPreview(this.anchorToPreview);\n\t                }\n\t            }.bind(this));\n\t        },\n\t\n\t        handlePreviewMouseover: function () {\n\t            this.lastOver = (new Date()).getTime();\n\t            this.hovering = true;\n\t        },\n\t\n\t        handlePreviewMouseout: function (event) {\n\t            if (!event.relatedTarget || !/anchor-preview/.test(event.relatedTarget.className)) {\n\t                this.hovering = false;\n\t            }\n\t        },\n\t\n\t        updatePreview: function () {\n\t            if (this.hovering) {\n\t                return true;\n\t            }\n\t            var durr = (new Date()).getTime() - this.lastOver;\n\t            if (durr > this.hideDelay) {\n\t                // hide the preview 1/2 second after mouse leaves the link\n\t                this.detachPreviewHandlers();\n\t            }\n\t        },\n\t\n\t        detachPreviewHandlers: function () {\n\t            // cleanup\n\t            clearInterval(this.intervalTimer);\n\t            if (this.instanceHandlePreviewMouseover) {\n\t                this.off(this.anchorPreview, 'mouseover', this.instanceHandlePreviewMouseover);\n\t                this.off(this.anchorPreview, 'mouseout', this.instanceHandlePreviewMouseout);\n\t                if (this.activeAnchor) {\n\t                    this.off(this.activeAnchor, 'mouseover', this.instanceHandlePreviewMouseover);\n\t                    this.off(this.activeAnchor, 'mouseout', this.instanceHandlePreviewMouseout);\n\t                }\n\t            }\n\t\n\t            this.hidePreview();\n\t\n\t            this.hovering = this.instanceHandlePreviewMouseover = this.instanceHandlePreviewMouseout = null;\n\t        },\n\t\n\t        // TODO: break up method and extract out handlers\n\t        attachPreviewHandlers: function () {\n\t            this.lastOver = (new Date()).getTime();\n\t            this.hovering = true;\n\t\n\t            this.instanceHandlePreviewMouseover = this.handlePreviewMouseover.bind(this);\n\t            this.instanceHandlePreviewMouseout = this.handlePreviewMouseout.bind(this);\n\t\n\t            this.intervalTimer = setInterval(this.updatePreview.bind(this), 200);\n\t\n\t            this.on(this.anchorPreview, 'mouseover', this.instanceHandlePreviewMouseover);\n\t            this.on(this.anchorPreview, 'mouseout', this.instanceHandlePreviewMouseout);\n\t            this.on(this.activeAnchor, 'mouseover', this.instanceHandlePreviewMouseover);\n\t            this.on(this.activeAnchor, 'mouseout', this.instanceHandlePreviewMouseout);\n\t        }\n\t    });\n\t}());\n\t\n\tvar AutoLink,\n\t    WHITESPACE_CHARS,\n\t    KNOWN_TLDS_FRAGMENT,\n\t    LINK_REGEXP_TEXT;\n\t\n\tWHITESPACE_CHARS = [' ', '\\t', '\\n', '\\r', '\\u00A0', '\\u2000', '\\u2001', '\\u2002', '\\u2003',\n\t                                    '\\u2028', '\\u2029'];\n\tKNOWN_TLDS_FRAGMENT = 'com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|' +\n\t    'xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|' +\n\t    'bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|' +\n\t    'fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|' +\n\t    'is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|' +\n\t    'mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|' +\n\t    'pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|' +\n\t    'tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw';\n\tLINK_REGEXP_TEXT =\n\t    '(' +\n\t    // Version of Gruber URL Regexp optimized for JS: http://stackoverflow.com/a/17733640\n\t    '((?:(https?://|ftps?://|nntp://)|www\\\\d{0,3}[.]|[a-z0-9.\\\\-]+[.](' + KNOWN_TLDS_FRAGMENT + ')\\\\\\/)\\\\S+(?:[^\\\\s`!\\\\[\\\\]{};:\\'\\\".,?\\u00AB\\u00BB\\u201C\\u201D\\u2018\\u2019]))' +\n\t    // Addition to above Regexp to support bare domains/one level subdomains with common non-i18n TLDs and without www prefix:\n\t    ')|(([a-z0-9\\\\-]+\\\\.)?[a-z0-9\\\\-]+\\\\.(' + KNOWN_TLDS_FRAGMENT + '))';\n\t\n\t(function () {\n\t    'use strict';\n\t\n\t    var KNOWN_TLDS_REGEXP = new RegExp('^(' + KNOWN_TLDS_FRAGMENT + ')$', 'i');\n\t\n\t    function nodeIsNotInsideAnchorTag(node) {\n\t        return !Util.getClosestTag(node, 'a');\n\t    }\n\t\n\t    AutoLink = Extension.extend({\n\t        init: function () {\n\t            this.disableEventHandling = false;\n\t            this.subscribe('editableKeypress', this.onKeypress.bind(this));\n\t            this.subscribe('editableBlur', this.onBlur.bind(this));\n\t            // MS IE has it's own auto-URL detect feature but ours is better in some ways. Be consistent.\n\t            this.document.execCommand('AutoUrlDetect', false, false);\n\t        },\n\t\n\t        destroy: function () {\n\t            // Turn AutoUrlDetect back on\n\t            if (this.document.queryCommandSupported('AutoUrlDetect')) {\n\t                this.document.execCommand('AutoUrlDetect', false, true);\n\t            }\n\t        },\n\t\n\t        onBlur: function (blurEvent, editable) {\n\t            this.performLinking(editable);\n\t        },\n\t\n\t        onKeypress: function (keyPressEvent) {\n\t            if (this.disableEventHandling) {\n\t                return;\n\t            }\n\t\n\t            if (Util.isKey(keyPressEvent, [Util.keyCode.SPACE, Util.keyCode.ENTER])) {\n\t                clearTimeout(this.performLinkingTimeout);\n\t                // Saving/restoring the selection in the middle of a keypress doesn't work well...\n\t                this.performLinkingTimeout = setTimeout(function () {\n\t                    try {\n\t                        var sel = this.base.exportSelection();\n\t                        if (this.performLinking(keyPressEvent.target)) {\n\t                            // pass true for favorLaterSelectionAnchor - this is needed for links at the end of a\n\t                            // paragraph in MS IE, or MS IE causes the link to be deleted right after adding it.\n\t                            this.base.importSelection(sel, true);\n\t                        }\n\t                    } catch (e) {\n\t                        if (window.console) {\n\t                            window.console.error('Failed to perform linking', e);\n\t                        }\n\t                        this.disableEventHandling = true;\n\t                    }\n\t                }.bind(this), 0);\n\t            }\n\t        },\n\t\n\t        performLinking: function (contenteditable) {\n\t            // Perform linking on a paragraph level basis as otherwise the detection can wrongly find the end\n\t            // of one paragraph and the beginning of another paragraph to constitute a link, such as a paragraph ending\n\t            // \"link.\" and the next paragraph beginning with \"my\" is interpreted into \"link.my\" and the code tries to create\n\t            // a link across paragraphs - which doesn't work and is terrible.\n\t            // (Medium deletes the spaces/returns between P tags so the textContent ends up without paragraph spacing)\n\t            var paragraphs = contenteditable.querySelectorAll('p'),\n\t                documentModified = false;\n\t            if (paragraphs.length === 0) {\n\t                paragraphs = [contenteditable];\n\t            }\n\t            for (var i = 0; i < paragraphs.length; i++) {\n\t                documentModified = this.removeObsoleteAutoLinkSpans(paragraphs[i]) || documentModified;\n\t                documentModified = this.performLinkingWithinElement(paragraphs[i]) || documentModified;\n\t            }\n\t            return documentModified;\n\t        },\n\t\n\t        splitStartNodeIfNeeded: function (currentNode, matchStartIndex, currentTextIndex) {\n\t            if (matchStartIndex !== currentTextIndex) {\n\t                return currentNode.splitText(matchStartIndex - currentTextIndex);\n\t            }\n\t            return null;\n\t        },\n\t\n\t        splitEndNodeIfNeeded: function (currentNode, newNode, matchEndIndex, currentTextIndex) {\n\t            var textIndexOfEndOfFarthestNode,\n\t                endSplitPoint;\n\t            textIndexOfEndOfFarthestNode = currentTextIndex + (newNode || currentNode).nodeValue.length +\n\t                    (newNode ? currentNode.nodeValue.length : 0) -\n\t                    1;\n\t            endSplitPoint = (newNode || currentNode).nodeValue.length -\n\t                    (textIndexOfEndOfFarthestNode + 1 - matchEndIndex);\n\t            if (textIndexOfEndOfFarthestNode >= matchEndIndex &&\n\t                    currentTextIndex !== textIndexOfEndOfFarthestNode &&\n\t                    endSplitPoint !== 0) {\n\t                (newNode || currentNode).splitText(endSplitPoint);\n\t            }\n\t        },\n\t\n\t        removeObsoleteAutoLinkSpans: function (element) {\n\t            var spans = element.querySelectorAll('span[data-auto-link=\"true\"]'),\n\t                documentModified = false;\n\t\n\t            for (var i = 0; i < spans.length; i++) {\n\t                var textContent = spans[i].textContent;\n\t                if (textContent.indexOf('://') === -1) {\n\t                    textContent = Util.ensureUrlHasProtocol(textContent);\n\t                }\n\t                if (spans[i].getAttribute('data-href') !== textContent && nodeIsNotInsideAnchorTag(spans[i])) {\n\t                    documentModified = true;\n\t                    var trimmedTextContent = textContent.replace(/\\s+$/, '');\n\t                    if (spans[i].getAttribute('data-href') === trimmedTextContent) {\n\t                        var charactersTrimmed = textContent.length - trimmedTextContent.length,\n\t                            subtree = Util.splitOffDOMTree(spans[i], this.splitTextBeforeEnd(spans[i], charactersTrimmed));\n\t                        spans[i].parentNode.insertBefore(subtree, spans[i].nextSibling);\n\t                    } else {\n\t                        // Some editing has happened to the span, so just remove it entirely. The user can put it back\n\t                        // around just the href content if they need to prevent it from linking\n\t                        Util.unwrap(spans[i], this.document);\n\t                    }\n\t                }\n\t            }\n\t            return documentModified;\n\t        },\n\t\n\t        splitTextBeforeEnd: function (element, characterCount) {\n\t            var treeWalker = this.document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, false),\n\t                lastChildNotExhausted = true;\n\t\n\t            // Start the tree walker at the last descendant of the span\n\t            while (lastChildNotExhausted) {\n\t                lastChildNotExhausted = treeWalker.lastChild() !== null;\n\t            }\n\t\n\t            var currentNode,\n\t                currentNodeValue,\n\t                previousNode;\n\t            while (characterCount > 0 && previousNode !== null) {\n\t                currentNode = treeWalker.currentNode;\n\t                currentNodeValue = currentNode.nodeValue;\n\t                if (currentNodeValue.length > characterCount) {\n\t                    previousNode = currentNode.splitText(currentNodeValue.length - characterCount);\n\t                    characterCount = 0;\n\t                } else {\n\t                    previousNode = treeWalker.previousNode();\n\t                    characterCount -= currentNodeValue.length;\n\t                }\n\t            }\n\t            return previousNode;\n\t        },\n\t\n\t        performLinkingWithinElement: function (element) {\n\t            var matches = this.findLinkableText(element),\n\t                linkCreated = false;\n\t\n\t            for (var matchIndex = 0; matchIndex < matches.length; matchIndex++) {\n\t                linkCreated = this.createLink(this.findOrCreateMatchingTextNodes(element, matches[matchIndex]),\n\t                    matches[matchIndex].href) || linkCreated;\n\t            }\n\t            return linkCreated;\n\t        },\n\t\n\t        findLinkableText: function (contenteditable) {\n\t            var linkRegExp = new RegExp(LINK_REGEXP_TEXT, 'gi'),\n\t                textContent = contenteditable.textContent,\n\t                match = null,\n\t                matches = [];\n\t\n\t            while ((match = linkRegExp.exec(textContent)) !== null) {\n\t                var matchOk = true,\n\t                    matchEnd = match.index + match[0].length;\n\t                // If the regexp detected something as a link that has text immediately preceding/following it, bail out.\n\t                matchOk = (match.index === 0 || WHITESPACE_CHARS.indexOf(textContent[match.index - 1]) !== -1) &&\n\t                    (matchEnd === textContent.length || WHITESPACE_CHARS.indexOf(textContent[matchEnd]) !== -1);\n\t                // If the regexp detected a bare domain that doesn't use one of our expected TLDs, bail out.\n\t                matchOk = matchOk && (match[0].indexOf('/') !== -1 ||\n\t                    KNOWN_TLDS_REGEXP.test(match[0].split('.').pop().split('?').shift()));\n\t\n\t                if (matchOk) {\n\t                    matches.push({\n\t                        href: match[0],\n\t                        start: match.index,\n\t                        end: matchEnd\n\t                    });\n\t                }\n\t            }\n\t            return matches;\n\t        },\n\t\n\t        findOrCreateMatchingTextNodes: function (element, match) {\n\t            var treeWalker = this.document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, false),\n\t                matchedNodes = [],\n\t                currentTextIndex = 0,\n\t                startReached = false,\n\t                currentNode = null,\n\t                newNode = null;\n\t\n\t            while ((currentNode = treeWalker.nextNode()) !== null) {\n\t                if (!startReached && match.start < (currentTextIndex + currentNode.nodeValue.length)) {\n\t                    startReached = true;\n\t                    newNode = this.splitStartNodeIfNeeded(currentNode, match.start, currentTextIndex);\n\t                }\n\t                if (startReached) {\n\t                    this.splitEndNodeIfNeeded(currentNode, newNode, match.end, currentTextIndex);\n\t                }\n\t                if (startReached && currentTextIndex === match.end) {\n\t                    break; // Found the node(s) corresponding to the link. Break out and move on to the next.\n\t                } else if (startReached && currentTextIndex > (match.end + 1)) {\n\t                    throw new Error('PerformLinking overshot the target!'); // should never happen...\n\t                }\n\t\n\t                if (startReached) {\n\t                    matchedNodes.push(newNode || currentNode);\n\t                }\n\t\n\t                currentTextIndex += currentNode.nodeValue.length;\n\t                if (newNode !== null) {\n\t                    currentTextIndex += newNode.nodeValue.length;\n\t                    // Skip the newNode as we'll already have pushed it to the matches\n\t                    treeWalker.nextNode();\n\t                }\n\t                newNode = null;\n\t            }\n\t            return matchedNodes;\n\t        },\n\t\n\t        createLink: function (textNodes, href) {\n\t            var shouldNotLink = false;\n\t            for (var i = 0; i < textNodes.length && shouldNotLink === false; i++) {\n\t                // Do not link if the text node is either inside an anchor or inside span[data-auto-link]\n\t                shouldNotLink = !!Util.traverseUp(textNodes[i], function (node) {\n\t                    return node.nodeName.toLowerCase() === 'a' ||\n\t                        (node.getAttribute && node.getAttribute('data-auto-link') === 'true');\n\t                });\n\t            }\n\t            if (shouldNotLink) {\n\t                return false;\n\t            }\n\t\n\t            var anchor = this.document.createElement('a'),\n\t                span = this.document.createElement('span'),\n\t                hrefWithProtocol = Util.ensureUrlHasProtocol(href);\n\t            Util.moveTextRangeIntoElement(textNodes[0], textNodes[textNodes.length - 1], span);\n\t            span.setAttribute('data-auto-link', 'true');\n\t            span.setAttribute('data-href', hrefWithProtocol);\n\t            anchor.setAttribute('href', hrefWithProtocol);\n\t            span.parentNode.insertBefore(anchor, span);\n\t            anchor.appendChild(span);\n\t            return true;\n\t        }\n\t    });\n\t}());\n\tvar ImageDragging;\n\t\n\t(function () {\n\t    'use strict';\n\t\n\t    ImageDragging = Extension.extend({\n\t        init: function () {\n\t            this.subscribe('editableDrag', this.handleDrag.bind(this));\n\t            this.subscribe('editableDrop', this.handleDrop.bind(this));\n\t        },\n\t\n\t        handleDrag: function (event) {\n\t            var className = 'medium-editor-dragover';\n\t            event.preventDefault();\n\t            event.dataTransfer.dropEffect = 'copy';\n\t\n\t            if (event.type === 'dragover') {\n\t                event.target.classList.add(className);\n\t            } else if (event.type === 'dragleave') {\n\t                event.target.classList.remove(className);\n\t            }\n\t        },\n\t\n\t        handleDrop: function (event) {\n\t            var className = 'medium-editor-dragover',\n\t                files;\n\t            event.preventDefault();\n\t            event.stopPropagation();\n\t\n\t            // IE9 does not support the File API, so prevent file from opening in a new window\n\t            // but also don't try to actually get the file\n\t            if (event.dataTransfer.files) {\n\t                files = Array.prototype.slice.call(event.dataTransfer.files, 0);\n\t                files.some(function (file) {\n\t                    if (file.type.match('image')) {\n\t                        var fileReader, id;\n\t                        fileReader = new FileReader();\n\t                        fileReader.readAsDataURL(file);\n\t\n\t                        id = 'medium-img-' + (+new Date());\n\t                        Util.insertHTMLCommand(this.document, '<img class=\"medium-image-loading\" id=\"' + id + '\" />');\n\t\n\t                        fileReader.onload = function () {\n\t                            var img = this.document.getElementById(id);\n\t                            if (img) {\n\t                                img.removeAttribute('id');\n\t                                img.removeAttribute('class');\n\t                                img.src = fileReader.result;\n\t                            }\n\t                        }.bind(this);\n\t                    }\n\t                }.bind(this));\n\t            }\n\t            event.target.classList.remove(className);\n\t        }\n\t    });\n\t}());\n\t\n\tvar FontSizeForm;\n\t(function () {\n\t    'use strict';\n\t\n\t    /*global FormExtension, Selection, Util */\n\t\n\t    FontSizeForm = FormExtension.extend({\n\t\n\t        name: 'fontsize',\n\t        action: 'fontSize',\n\t        aria: 'increase/decrease font size',\n\t        contentDefault: '&#xB1;', // ±\n\t        contentFA: '<i class=\"fa fa-text-height\"></i>',\n\t\n\t        // Called when the button the toolbar is clicked\n\t        // Overrides ButtonExtension.handleClick\n\t        handleClick: function (evt) {\n\t            evt.preventDefault();\n\t            evt.stopPropagation();\n\t\n\t            if (!this.isDisplayed()) {\n\t                // Get fontsize of current selection (convert to string since IE returns this as number)\n\t                var fontSize = this.document.queryCommandValue('fontSize') + '';\n\t                this.showForm(fontSize);\n\t            }\n\t\n\t            return false;\n\t        },\n\t\n\t        // Called by medium-editor to append form to the toolbar\n\t        getForm: function () {\n\t            if (!this.form) {\n\t                this.form = this.createForm();\n\t            }\n\t            return this.form;\n\t        },\n\t\n\t        // Used by medium-editor when the default toolbar is to be displayed\n\t        isDisplayed: function () {\n\t            return this.getForm().style.display === 'block';\n\t        },\n\t\n\t        hideForm: function () {\n\t            this.getForm().style.display = 'none';\n\t            this.getInput().value = '';\n\t        },\n\t\n\t        showForm: function (fontSize) {\n\t            var input = this.getInput();\n\t\n\t            this.base.saveSelection();\n\t            this.base.hideToolbarDefaultActions();\n\t            this.getForm().style.display = 'block';\n\t            this.base.setToolbarPosition();\n\t\n\t            input.value = fontSize || '';\n\t            input.focus();\n\t        },\n\t\n\t        // Called by core when tearing down medium-editor (destroy)\n\t        destroy: function () {\n\t            if (!this.form) {\n\t                return false;\n\t            }\n\t\n\t            if (this.form.parentNode) {\n\t                this.form.parentNode.removeChild(this.form);\n\t            }\n\t\n\t            delete this.form;\n\t        },\n\t\n\t        // TODO: deprecate\n\t        deactivate: function () {\n\t            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n\t        },\n\t\n\t        // core methods\n\t\n\t        doFormSave: function () {\n\t            this.base.restoreSelection();\n\t            this.base.checkSelection();\n\t        },\n\t\n\t        doFormCancel: function () {\n\t            this.base.restoreSelection();\n\t            this.clearFontSize();\n\t            this.base.checkSelection();\n\t        },\n\t\n\t        // form creation and event handling\n\t        createForm: function () {\n\t            var doc = this.document,\n\t                form = doc.createElement('div'),\n\t                input = doc.createElement('input'),\n\t                close = doc.createElement('a'),\n\t                save = doc.createElement('a');\n\t\n\t            // Font Size Form (div)\n\t            form.className = 'medium-editor-toolbar-form';\n\t            form.id = 'medium-editor-toolbar-form-fontsize-' + this.getEditorId();\n\t\n\t            // Handle clicks on the form itself\n\t            this.on(form, 'click', this.handleFormClick.bind(this));\n\t\n\t            // Add font size slider\n\t            input.setAttribute('type', 'range');\n\t            input.setAttribute('min', '1');\n\t            input.setAttribute('max', '7');\n\t            input.className = 'medium-editor-toolbar-input';\n\t            form.appendChild(input);\n\t\n\t            // Handle typing in the textbox\n\t            this.on(input, 'change', this.handleSliderChange.bind(this));\n\t\n\t            // Add save buton\n\t            save.setAttribute('href', '#');\n\t            save.className = 'medium-editor-toobar-save';\n\t            save.innerHTML = this.getEditorOption('buttonLabels') === 'fontawesome' ?\n\t                             '<i class=\"fa fa-check\"></i>' :\n\t                             '&#10003;';\n\t            form.appendChild(save);\n\t\n\t            // Handle save button clicks (capture)\n\t            this.on(save, 'click', this.handleSaveClick.bind(this), true);\n\t\n\t            // Add close button\n\t            close.setAttribute('href', '#');\n\t            close.className = 'medium-editor-toobar-close';\n\t            close.innerHTML = this.getEditorOption('buttonLabels') === 'fontawesome' ?\n\t                              '<i class=\"fa fa-times\"></i>' :\n\t                              '&times;';\n\t            form.appendChild(close);\n\t\n\t            // Handle close button clicks\n\t            this.on(close, 'click', this.handleCloseClick.bind(this));\n\t\n\t            return form;\n\t        },\n\t\n\t        getInput: function () {\n\t            return this.getForm().querySelector('input.medium-editor-toolbar-input');\n\t        },\n\t\n\t        clearFontSize: function () {\n\t            Selection.getSelectedElements(this.document).forEach(function (el) {\n\t                if (el.tagName === 'FONT' && el.hasAttribute('size')) {\n\t                    el.removeAttribute('size');\n\t                }\n\t            });\n\t        },\n\t\n\t        handleSliderChange: function () {\n\t            var size = this.getInput().value;\n\t            if (size === '4') {\n\t                this.clearFontSize();\n\t            } else {\n\t                this.execAction('fontSize', { size: size });\n\t            }\n\t        },\n\t\n\t        handleFormClick: function (event) {\n\t            // make sure not to hide form when clicking inside the form\n\t            event.stopPropagation();\n\t        },\n\t\n\t        handleSaveClick: function (event) {\n\t            // Clicking Save -> create the font size\n\t            event.preventDefault();\n\t            this.doFormSave();\n\t        },\n\t\n\t        handleCloseClick: function (event) {\n\t            // Click Close -> close the form\n\t            event.preventDefault();\n\t            this.doFormCancel();\n\t        }\n\t    });\n\t}());\n\tvar PasteHandler;\n\t\n\t(function () {\n\t    'use strict';\n\t    /*jslint regexp: true*/\n\t    /*\n\t        jslint does not allow character negation, because the negation\n\t        will not match any unicode characters. In the regexes in this\n\t        block, negation is used specifically to match the end of an html\n\t        tag, and in fact unicode characters *should* be allowed.\n\t    */\n\t    function createReplacements() {\n\t        return [\n\t\n\t            // replace two bogus tags that begin pastes from google docs\n\t            [new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi), ''],\n\t            [new RegExp(/<\\/b>(<br[^>]*>)?$/gi), ''],\n\t\n\t             // un-html spaces and newlines inserted by OS X\n\t            [new RegExp(/<span class=\"Apple-converted-space\">\\s+<\\/span>/g), ' '],\n\t            [new RegExp(/<br class=\"Apple-interchange-newline\">/g), '<br>'],\n\t\n\t            // replace google docs italics+bold with a span to be replaced once the html is inserted\n\t            [new RegExp(/<span[^>]*(font-style:italic;font-weight:bold|font-weight:bold;font-style:italic)[^>]*>/gi), '<span class=\"replace-with italic bold\">'],\n\t\n\t            // replace google docs italics with a span to be replaced once the html is inserted\n\t            [new RegExp(/<span[^>]*font-style:italic[^>]*>/gi), '<span class=\"replace-with italic\">'],\n\t\n\t            //[replace google docs bolds with a span to be replaced once the html is inserted\n\t            [new RegExp(/<span[^>]*font-weight:bold[^>]*>/gi), '<span class=\"replace-with bold\">'],\n\t\n\t             // replace manually entered b/i/a tags with real ones\n\t            [new RegExp(/&lt;(\\/?)(i|b|a)&gt;/gi), '<$1$2>'],\n\t\n\t             // replace manually a tags with real ones, converting smart-quotes from google docs\n\t            [new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|\"|“|”)(((?!&quot;|&rdquo;|&ldquo;|\"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|\"|“|”)(?:(?!&gt;).)*&gt;/gi), '<a href=\"$1\">'],\n\t\n\t            // Newlines between paragraphs in html have no syntactic value,\n\t            // but then have a tendency to accidentally become additional paragraphs down the line\n\t            [new RegExp(/<\\/p>\\n+/gi), '</p>'],\n\t            [new RegExp(/\\n+<p/gi), '<p'],\n\t\n\t            // Microsoft Word makes these odd tags, like <o:p></o:p>\n\t            [new RegExp(/<\\/?o:[a-z]*>/gi), '']\n\t        ];\n\t    }\n\t    /*jslint regexp: false*/\n\t\n\t    PasteHandler = Extension.extend({\n\t        /* Paste Options */\n\t\n\t        /* forcePlainText: [boolean]\n\t         * Forces pasting as plain text.\n\t         */\n\t        forcePlainText: true,\n\t\n\t        /* cleanPastedHTML: [boolean]\n\t         * cleans pasted content from different sources, like google docs etc.\n\t         */\n\t        cleanPastedHTML: false,\n\t\n\t        /* cleanReplacements: [Array]\n\t         * custom pairs (2 element arrays) of RegExp and replacement text to use during paste when\n\t         * __forcePlainText__ or __cleanPastedHTML__ are `true` OR when calling `cleanPaste(text)` helper method.\n\t         */\n\t        cleanReplacements: [],\n\t\n\t        /* cleanAttrs:: [Array]\n\t         * list of element attributes to remove during paste when __cleanPastedHTML__ is `true` or when\n\t         * calling `cleanPaste(text)` or `pasteHTML(html, options)` helper methods.\n\t         */\n\t        cleanAttrs: ['class', 'style', 'dir'],\n\t\n\t        /* cleanTags: [Array]\n\t         * list of element tag names to remove during paste when __cleanPastedHTML__ is `true` or when\n\t         * calling `cleanPaste(text)` or `pasteHTML(html, options)` helper methods.\n\t         */\n\t        cleanTags: ['meta'],\n\t\n\t        /* ----- internal options needed from base ----- */\n\t        targetBlank: false, // deprecated (should use .getEditorOption() instead)\n\t        disableReturn: false, // deprecated (should use .getEditorOption() instead)\n\t\n\t        init: function () {\n\t            if (this.forcePlainText || this.cleanPastedHTML) {\n\t                this.subscribe('editablePaste', this.handlePaste.bind(this));\n\t            }\n\t        },\n\t\n\t        handlePaste: function (event, element) {\n\t            var paragraphs,\n\t                html = '',\n\t                p,\n\t                dataFormatHTML = 'text/html',\n\t                dataFormatPlain = 'text/plain',\n\t                pastedHTML,\n\t                pastedPlain;\n\t\n\t            if (this.window.clipboardData && event.clipboardData === undefined) {\n\t                event.clipboardData = this.window.clipboardData;\n\t                // If window.clipboardData exists, but event.clipboardData doesn't exist,\n\t                // we're probably in IE. IE only has two possibilities for clipboard\n\t                // data format: 'Text' and 'URL'.\n\t                //\n\t                // Of the two, we want 'Text':\n\t                dataFormatHTML = 'Text';\n\t                dataFormatPlain = 'Text';\n\t            }\n\t\n\t            if (event.clipboardData &&\n\t                    event.clipboardData.getData &&\n\t                    !event.defaultPrevented) {\n\t                event.preventDefault();\n\t\n\t                pastedHTML = event.clipboardData.getData(dataFormatHTML);\n\t                pastedPlain = event.clipboardData.getData(dataFormatPlain);\n\t\n\t                if (this.cleanPastedHTML && pastedHTML) {\n\t                    return this.cleanPaste(pastedHTML);\n\t                }\n\t\n\t                if (!(this.disableReturn || element.getAttribute('data-disable-return'))) {\n\t                    paragraphs = pastedPlain.split(/[\\r\\n]+/g);\n\t                    // If there are no \\r\\n in data, don't wrap in <p>\n\t                    if (paragraphs.length > 1) {\n\t                        for (p = 0; p < paragraphs.length; p += 1) {\n\t                            if (paragraphs[p] !== '') {\n\t                                html += '<p>' + Util.htmlEntities(paragraphs[p]) + '</p>';\n\t                            }\n\t                        }\n\t                    } else {\n\t                        html = Util.htmlEntities(paragraphs[0]);\n\t                    }\n\t                } else {\n\t                    html = Util.htmlEntities(pastedPlain);\n\t                }\n\t                Util.insertHTMLCommand(this.document, html);\n\t            }\n\t        },\n\t\n\t        cleanPaste: function (text) {\n\t            var i, elList,\n\t                multiline = /<p|<br|<div/.test(text),\n\t                replacements = createReplacements().concat(this.cleanReplacements || []);\n\t\n\t            for (i = 0; i < replacements.length; i += 1) {\n\t                text = text.replace(replacements[i][0], replacements[i][1]);\n\t            }\n\t\n\t            if (!multiline) {\n\t                return this.pasteHTML(text);\n\t            }\n\t\n\t            // double br's aren't converted to p tags, but we want paragraphs.\n\t            elList = text.split('<br><br>');\n\t\n\t            this.pasteHTML('<p>' + elList.join('</p><p>') + '</p>');\n\t        },\n\t\n\t        pasteHTML: function (html, options) {\n\t            options = Util.defaults({}, options, {\n\t                cleanAttrs: this.cleanAttrs,\n\t                cleanTags: this.cleanTags\n\t            });\n\t\n\t            var elList, workEl, i, fragmentBody, pasteBlock = this.document.createDocumentFragment();\n\t\n\t            pasteBlock.appendChild(this.document.createElement('body'));\n\t\n\t            fragmentBody = pasteBlock.querySelector('body');\n\t            fragmentBody.innerHTML = html;\n\t\n\t            this.cleanupSpans(fragmentBody);\n\t\n\t            elList = fragmentBody.querySelectorAll('*');\n\t            for (i = 0; i < elList.length; i += 1) {\n\t                workEl = elList[i];\n\t\n\t                if ('a' === workEl.tagName.toLowerCase() && this.targetBlank) {\n\t                    Util.setTargetBlank(workEl);\n\t                }\n\t\n\t                Util.cleanupAttrs(workEl, options.cleanAttrs);\n\t                Util.cleanupTags(workEl, options.cleanTags);\n\t            }\n\t\n\t            // block element cleanup\n\t            elList = fragmentBody.querySelectorAll('a,p,div,br');\n\t            for (i = 0; i < elList.length; i += 1) {\n\t                workEl = elList[i];\n\t\n\t                // Microsoft Word replaces some spaces with newlines.\n\t                // While newlines between block elements are meaningless, newlines within\n\t                // elements are sometimes actually spaces.\n\t                workEl.innerHTML = workEl.innerHTML.replace(/\\n/gi, ' ');\n\t\n\t                switch (workEl.nodeName.toLowerCase()) {\n\t                    case 'p':\n\t                    case 'div':\n\t                        this.filterCommonBlocks(workEl);\n\t                        break;\n\t                    case 'br':\n\t                        this.filterLineBreak(workEl);\n\t                        break;\n\t                }\n\t            }\n\t\n\t            Util.insertHTMLCommand(this.document, fragmentBody.innerHTML.replace(/&nbsp;/g, ' '));\n\t        },\n\t\n\t        isCommonBlock: function (el) {\n\t            return (el && (el.tagName.toLowerCase() === 'p' || el.tagName.toLowerCase() === 'div'));\n\t        },\n\t\n\t        filterCommonBlocks: function (el) {\n\t            if (/^\\s*$/.test(el.textContent) && el.parentNode) {\n\t                el.parentNode.removeChild(el);\n\t            }\n\t        },\n\t\n\t        filterLineBreak: function (el) {\n\t            if (this.isCommonBlock(el.previousElementSibling)) {\n\t                // remove stray br's following common block elements\n\t                this.removeWithParent(el);\n\t            } else if (this.isCommonBlock(el.parentNode) && (el.parentNode.firstChild === el || el.parentNode.lastChild === el)) {\n\t                // remove br's just inside open or close tags of a div/p\n\t                this.removeWithParent(el);\n\t            } else if (el.parentNode && el.parentNode.childElementCount === 1 && el.parentNode.textContent === '') {\n\t                // and br's that are the only child of elements other than div/p\n\t                this.removeWithParent(el);\n\t            }\n\t        },\n\t\n\t        // remove an element, including its parent, if it is the only element within its parent\n\t        removeWithParent: function (el) {\n\t            if (el && el.parentNode) {\n\t                if (el.parentNode.parentNode && el.parentNode.childElementCount === 1) {\n\t                    el.parentNode.parentNode.removeChild(el.parentNode);\n\t                } else {\n\t                    el.parentNode.removeChild(el);\n\t                }\n\t            }\n\t        },\n\t\n\t        cleanupSpans: function (containerEl) {\n\t            var i,\n\t                el,\n\t                newEl,\n\t                spans = containerEl.querySelectorAll('.replace-with'),\n\t                isCEF = function (el) {\n\t                    return (el && el.nodeName !== '#text' && el.getAttribute('contenteditable') === 'false');\n\t                };\n\t\n\t            for (i = 0; i < spans.length; i += 1) {\n\t                el = spans[i];\n\t                newEl = this.document.createElement(el.classList.contains('bold') ? 'b' : 'i');\n\t\n\t                if (el.classList.contains('bold') && el.classList.contains('italic')) {\n\t                    // add an i tag as well if this has both italics and bold\n\t                    newEl.innerHTML = '<i>' + el.innerHTML + '</i>';\n\t                } else {\n\t                    newEl.innerHTML = el.innerHTML;\n\t                }\n\t                el.parentNode.replaceChild(newEl, el);\n\t            }\n\t\n\t            spans = containerEl.querySelectorAll('span');\n\t            for (i = 0; i < spans.length; i += 1) {\n\t                el = spans[i];\n\t\n\t                // bail if span is in contenteditable = false\n\t                if (Util.traverseUp(el, isCEF)) {\n\t                    return false;\n\t                }\n\t\n\t                // remove empty spans, replace others with their contents\n\t                Util.unwrap(el, this.document);\n\t            }\n\t        }\n\t    });\n\t}());\n\t\n\tvar Placeholder;\n\t\n\t(function () {\n\t    'use strict';\n\t\n\t    /*global Extension */\n\t\n\t    Placeholder = Extension.extend({\n\t        name: 'placeholder',\n\t\n\t        /* Placeholder Options */\n\t\n\t        /* text: [string]\n\t         * Text to display in the placeholder\n\t         */\n\t        text: 'Type your text',\n\t\n\t        /* hideOnClick: [boolean]\n\t         * Should we hide the placeholder on click (true) or when user starts typing (false)\n\t         */\n\t        hideOnClick: true,\n\t\n\t        init: function () {\n\t            this.initPlaceholders();\n\t            this.attachEventHandlers();\n\t        },\n\t\n\t        initPlaceholders: function () {\n\t            this.getEditorElements().forEach(function (el) {\n\t                if (!el.getAttribute('data-placeholder')) {\n\t                    el.setAttribute('data-placeholder', this.text);\n\t                }\n\t                this.updatePlaceholder(el);\n\t            }, this);\n\t        },\n\t\n\t        destroy: function () {\n\t            this.getEditorElements().forEach(function (el) {\n\t                if (el.getAttribute('data-placeholder') === this.text) {\n\t                    el.removeAttribute('data-placeholder');\n\t                }\n\t            }, this);\n\t        },\n\t\n\t        showPlaceholder: function (el) {\n\t            if (el) {\n\t                el.classList.add('medium-editor-placeholder');\n\t            }\n\t        },\n\t\n\t        hidePlaceholder: function (el) {\n\t            if (el) {\n\t                el.classList.remove('medium-editor-placeholder');\n\t            }\n\t        },\n\t\n\t        updatePlaceholder: function (el) {\n\t            // if one of these element ('img, blockquote, ul, ol') are found inside the given element, we won't display the placeholder\n\t            if (!(el.querySelector('img, blockquote, ul, ol')) && el.textContent.replace(/^\\s+|\\s+$/g, '') === '') {\n\t                return this.showPlaceholder(el);\n\t            }\n\t\n\t            this.hidePlaceholder(el);\n\t        },\n\t\n\t        attachEventHandlers: function () {\n\t            // Custom events\n\t            this.subscribe('blur', this.handleExternalInteraction.bind(this));\n\t\n\t            // Check placeholder on blur\n\t            this.subscribe('editableBlur', this.handleBlur.bind(this));\n\t\n\t            // if we don't want the placeholder to be removed on click but when user start typing\n\t            if (this.hideOnClick) {\n\t                this.subscribe('editableClick', this.handleHidePlaceholderEvent.bind(this));\n\t            } else {\n\t                this.subscribe('editableKeyup', this.handleBlur.bind(this));\n\t            }\n\t\n\t            // Events where we always hide the placeholder\n\t            this.subscribe('editableKeypress', this.handleHidePlaceholderEvent.bind(this));\n\t            this.subscribe('editablePaste', this.handleHidePlaceholderEvent.bind(this));\n\t        },\n\t\n\t        handleHidePlaceholderEvent: function (event, element) {\n\t            // Events where we hide the placeholder\n\t            this.hidePlaceholder(element);\n\t        },\n\t\n\t        handleBlur: function (event, element) {\n\t            // Update placeholder for element that lost focus\n\t            this.updatePlaceholder(element);\n\t        },\n\t\n\t        handleExternalInteraction: function () {\n\t            // Update all placeholders\n\t            this.initPlaceholders();\n\t        }\n\t    });\n\t}());\n\t\n\tvar Toolbar;\n\t\n\t(function () {\n\t    'use strict';\n\t\n\t    Toolbar = function (instance) {\n\t        this.base = instance;\n\t        this.options = instance.options;\n\t\n\t        this.initThrottledMethods();\n\t    };\n\t\n\t    Toolbar.prototype = {\n\t        // Toolbar creation/deletion\n\t\n\t        createToolbar: function () {\n\t            var toolbar = this.base.options.ownerDocument.createElement('div');\n\t\n\t            toolbar.id = 'medium-editor-toolbar-' + this.base.id;\n\t            toolbar.className = 'medium-editor-toolbar';\n\t\n\t            if (this.options.staticToolbar) {\n\t                toolbar.className += ' static-toolbar';\n\t            } else {\n\t                toolbar.className += ' stalker-toolbar';\n\t            }\n\t\n\t            toolbar.appendChild(this.createToolbarButtons());\n\t\n\t            // Add any forms that extensions may have\n\t            this.base.commands.forEach(function (extension) {\n\t                if (extension.hasForm) {\n\t                    toolbar.appendChild(extension.getForm());\n\t                }\n\t            });\n\t\n\t            this.attachEventHandlers();\n\t\n\t            return toolbar;\n\t        },\n\t\n\t        createToolbarButtons: function () {\n\t            var ul = this.base.options.ownerDocument.createElement('ul'),\n\t                li,\n\t                btn,\n\t                buttons,\n\t                extension;\n\t\n\t            ul.id = 'medium-editor-toolbar-actions' + this.base.id;\n\t            ul.className = 'medium-editor-toolbar-actions clearfix';\n\t            ul.style.display = 'block';\n\t\n\t            this.base.options.buttons.forEach(function (button) {\n\t                extension = this.base.getExtensionByName(button);\n\t                if (typeof extension.getButton === 'function') {\n\t                    btn = extension.getButton(this.base);\n\t                    li = this.base.options.ownerDocument.createElement('li');\n\t                    if (Util.isElement(btn)) {\n\t                        li.appendChild(btn);\n\t                    } else {\n\t                        li.innerHTML = btn;\n\t                    }\n\t                    ul.appendChild(li);\n\t                }\n\t            }.bind(this));\n\t\n\t            buttons = ul.querySelectorAll('button');\n\t            if (buttons.length > 0) {\n\t                buttons[0].classList.add(this.options.firstButtonClass);\n\t                buttons[buttons.length - 1].classList.add(this.options.lastButtonClass);\n\t            }\n\t\n\t            return ul;\n\t        },\n\t\n\t        destroy: function () {\n\t            if (this.toolbar) {\n\t                if (this.toolbar.parentNode) {\n\t                    this.toolbar.parentNode.removeChild(this.toolbar);\n\t                }\n\t                delete this.toolbar;\n\t            }\n\t        },\n\t\n\t        // TODO: deprecate\n\t        deactivate: function () {\n\t            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n\t        },\n\t\n\t        // Toolbar accessors\n\t\n\t        getToolbarElement: function () {\n\t            if (!this.toolbar) {\n\t                this.toolbar = this.createToolbar();\n\t            }\n\t\n\t            return this.toolbar;\n\t        },\n\t\n\t        getToolbarActionsElement: function () {\n\t            return this.getToolbarElement().querySelector('.medium-editor-toolbar-actions');\n\t        },\n\t\n\t        // Toolbar event handlers\n\t\n\t        initThrottledMethods: function () {\n\t            // throttledPositionToolbar is throttled because:\n\t            // - It will be called when the browser is resizing, which can fire many times very quickly\n\t            // - For some event (like resize) a slight lag in UI responsiveness is OK and provides performance benefits\n\t            this.throttledPositionToolbar = Util.throttle(function () {\n\t                if (this.base.isActive) {\n\t                    this.positionToolbarIfShown();\n\t                }\n\t            }.bind(this));\n\t        },\n\t\n\t        attachEventHandlers: function () {\n\t            // MediumEditor custom events for when user beings and ends interaction with a contenteditable and its elements\n\t            this.base.subscribe('blur', this.handleBlur.bind(this));\n\t            this.base.subscribe('focus', this.handleFocus.bind(this));\n\t\n\t            // Updating the state of the toolbar as things change\n\t            this.base.subscribe('editableClick', this.handleEditableClick.bind(this));\n\t            this.base.subscribe('editableKeyup', this.handleEditableKeyup.bind(this));\n\t\n\t            // Handle mouseup on document for updating the selection in the toolbar\n\t            this.base.on(this.options.ownerDocument.documentElement, 'mouseup', this.handleDocumentMouseup.bind(this));\n\t\n\t            // Add a scroll event for sticky toolbar\n\t            if (this.options.staticToolbar && this.options.stickyToolbar) {\n\t                // On scroll (capture), re-position the toolbar\n\t                this.base.on(this.options.contentWindow, 'scroll', this.handleWindowScroll.bind(this), true);\n\t            }\n\t\n\t            // On resize, re-position the toolbar\n\t            this.base.on(this.options.contentWindow, 'resize', this.handleWindowResize.bind(this));\n\t        },\n\t\n\t        handleWindowScroll: function () {\n\t            this.positionToolbarIfShown();\n\t        },\n\t\n\t        handleWindowResize: function () {\n\t            this.throttledPositionToolbar();\n\t        },\n\t\n\t        handleDocumentMouseup: function (event) {\n\t            // Do not trigger checkState when mouseup fires over the toolbar\n\t            if (event &&\n\t                    event.target &&\n\t                    Util.isDescendant(this.getToolbarElement(), event.target)) {\n\t                return false;\n\t            }\n\t            this.checkState();\n\t        },\n\t\n\t        handleEditableClick: function () {\n\t            // Delay the call to checkState to handle bug where selection is empty\n\t            // immediately after clicking inside a pre-existing selection\n\t            setTimeout(function () {\n\t                this.checkState();\n\t            }.bind(this), 0);\n\t        },\n\t\n\t        handleEditableKeyup: function () {\n\t            this.checkState();\n\t        },\n\t\n\t        handleBlur: function () {\n\t            // Kill any previously delayed calls to hide the toolbar\n\t            clearTimeout(this.hideTimeout);\n\t\n\t            // Blur may fire even if we have a selection, so we want to prevent any delayed showToolbar\n\t            // calls from happening in this specific case\n\t            clearTimeout(this.delayShowTimeout);\n\t\n\t            // Delay the call to hideToolbar to handle bug with multiple editors on the page at once\n\t            this.hideTimeout = setTimeout(function () {\n\t                this.hideToolbar();\n\t            }.bind(this), 1);\n\t        },\n\t\n\t        handleFocus: function () {\n\t            this.checkState();\n\t        },\n\t\n\t        // Hiding/showing toolbar\n\t\n\t        isDisplayed: function () {\n\t            return this.getToolbarElement().classList.contains('medium-editor-toolbar-active');\n\t        },\n\t\n\t        showToolbar: function () {\n\t            clearTimeout(this.hideTimeout);\n\t            if (!this.isDisplayed()) {\n\t                this.getToolbarElement().classList.add('medium-editor-toolbar-active');\n\t                this.base.trigger('showToolbar', {}, this.base.getFocusedElement());\n\t\n\t                if (typeof this.options.onShowToolbar === 'function') {\n\t                    Util.deprecated('onShowToolbar', 'the showToolbar custom event', 'v5.0.0');\n\t                    this.options.onShowToolbar();\n\t                }\n\t            }\n\t        },\n\t\n\t        hideToolbar: function () {\n\t            if (this.isDisplayed()) {\n\t                this.getToolbarElement().classList.remove('medium-editor-toolbar-active');\n\t                this.base.trigger('hideToolbar', {}, this.base.getFocusedElement());\n\t\n\t                this.base.commands.forEach(function (extension) {\n\t                    if (typeof extension.onHide === 'function') {\n\t                        Util.deprecated('onHide', 'the hideToolbar custom event', 'v5.0.0');\n\t                        extension.onHide();\n\t                    }\n\t                });\n\t\n\t                if (typeof this.options.onHideToolbar === 'function') {\n\t                    Util.deprecated('onHideToolbar', 'the hideToolbar custom event', 'v5.0.0');\n\t                    this.options.onHideToolbar();\n\t                }\n\t            }\n\t        },\n\t\n\t        isToolbarDefaultActionsDisplayed: function () {\n\t            return this.getToolbarActionsElement().style.display === 'block';\n\t        },\n\t\n\t        hideToolbarDefaultActions: function () {\n\t            if (this.isToolbarDefaultActionsDisplayed()) {\n\t                this.getToolbarActionsElement().style.display = 'none';\n\t            }\n\t        },\n\t\n\t        showToolbarDefaultActions: function () {\n\t            this.hideExtensionForms();\n\t\n\t            if (!this.isToolbarDefaultActionsDisplayed()) {\n\t                this.getToolbarActionsElement().style.display = 'block';\n\t            }\n\t\n\t            // Using setTimeout + options.delay because:\n\t            // We will actually be displaying the toolbar, which should be controlled by options.delay\n\t            this.delayShowTimeout = this.base.delay(function () {\n\t                this.showToolbar();\n\t            }.bind(this));\n\t        },\n\t\n\t        hideExtensionForms: function () {\n\t            // Hide all extension forms\n\t            this.base.commands.forEach(function (extension) {\n\t                if (extension.hasForm && extension.isDisplayed()) {\n\t                    extension.hideForm();\n\t                }\n\t            });\n\t        },\n\t\n\t        // Responding to changes in user selection\n\t\n\t        // Checks for existance of multiple block elements in the current selection\n\t        multipleBlockElementsSelected: function () {\n\t            var regexEmptyHTMLTags = /<[^\\/>][^>]*><\\/[^>]+>/gim, // http://stackoverflow.com/questions/3129738/remove-empty-tags-using-regex\n\t                regexBlockElements = new RegExp('<(' + Util.parentElements.join('|') + ')[^>]*>', 'g'),\n\t                selectionHTML = Selection.getSelectionHtml.call(this).replace(regexEmptyHTMLTags, ''), // Filter out empty blocks from selection\n\t                hasMultiParagraphs = selectionHTML.match(regexBlockElements); // Find how many block elements are within the html\n\t\n\t            return !!hasMultiParagraphs && hasMultiParagraphs.length > 1;\n\t        },\n\t\n\t        modifySelection: function () {\n\t            var selection = this.options.contentWindow.getSelection(),\n\t                selectionRange = selection.getRangeAt(0);\n\t\n\t            /*\n\t            * In firefox, there are cases (ie doubleclick of a word) where the selectionRange start\n\t            * will be at the very end of an element.  In other browsers, the selectionRange start\n\t            * would instead be at the very beginning of an element that actually has content.\n\t            * example:\n\t            *   <span>foo</span><span>bar</span>\n\t            *\n\t            * If the text 'bar' is selected, most browsers will have the selectionRange start at the beginning\n\t            * of the 'bar' span.  However, there are cases where firefox will have the selectionRange start\n\t            * at the end of the 'foo' span.  The contenteditable behavior will be ok, but if there are any\n\t            * properties on the 'bar' span, they won't be reflected accurately in the toolbar\n\t            * (ie 'Bold' button wouldn't be active)\n\t            *\n\t            * So, for cases where the selectionRange start is at the end of an element/node, find the next\n\t            * adjacent text node that actually has content in it, and move the selectionRange start there.\n\t            */\n\t            if (this.options.standardizeSelectionStart &&\n\t                    selectionRange.startContainer.nodeValue &&\n\t                    (selectionRange.startOffset === selectionRange.startContainer.nodeValue.length)) {\n\t                var adjacentNode = Util.findAdjacentTextNodeWithContent(Selection.getSelectionElement(this.options.contentWindow), selectionRange.startContainer, this.options.ownerDocument);\n\t                if (adjacentNode) {\n\t                    var offset = 0;\n\t                    while (adjacentNode.nodeValue.substr(offset, 1).trim().length === 0) {\n\t                        offset = offset + 1;\n\t                    }\n\t                    var newRange = this.options.ownerDocument.createRange();\n\t                    newRange.setStart(adjacentNode, offset);\n\t                    newRange.setEnd(selectionRange.endContainer, selectionRange.endOffset);\n\t                    selection.removeAllRanges();\n\t                    selection.addRange(newRange);\n\t                    selectionRange = newRange;\n\t                }\n\t            }\n\t        },\n\t\n\t        checkState: function () {\n\t            if (this.base.preventSelectionUpdates) {\n\t                return;\n\t            }\n\t\n\t            // If no editable has focus OR selection is inside contenteditable = false\n\t            // hide toolbar\n\t            if (!this.base.getFocusedElement() ||\n\t                    Selection.selectionInContentEditableFalse(this.options.contentWindow)) {\n\t                return this.hideToolbar();\n\t            }\n\t\n\t            // If there's no selection element, selection element doesn't belong to this editor\n\t            // or toolbar is disabled for this selection element\n\t            // hide toolbar\n\t            var selectionElement = Selection.getSelectionElement(this.options.contentWindow);\n\t            if (!selectionElement ||\n\t                    this.base.elements.indexOf(selectionElement) === -1 ||\n\t                    selectionElement.getAttribute('data-disable-toolbar')) {\n\t                return this.hideToolbar();\n\t            }\n\t\n\t            // Now we know there's a focused editable with a selection\n\t\n\t            // If the updateOnEmptySelection option is true, show the toolbar\n\t            if (this.options.updateOnEmptySelection && this.options.staticToolbar) {\n\t                return this.showAndUpdateToolbar();\n\t            }\n\t\n\t            // If we don't have a 'valid' selection -> hide toolbar\n\t            if (this.options.contentWindow.getSelection().toString().trim() === '' ||\n\t                (this.options.allowMultiParagraphSelection === false && this.multipleBlockElementsSelected())) {\n\t                return this.hideToolbar();\n\t            }\n\t\n\t            this.showAndUpdateToolbar();\n\t        },\n\t\n\t        // leaving here backward compatibility / statics\n\t        getFocusedElement: function () {\n\t            return this.base.getFocusedElement();\n\t        },\n\t\n\t        // Updating the toolbar\n\t\n\t        showAndUpdateToolbar: function () {\n\t            this.modifySelection();\n\t            this.setToolbarButtonStates();\n\t            this.base.trigger('positionToolbar', {}, this.base.getFocusedElement());\n\t            this.showToolbarDefaultActions();\n\t            this.setToolbarPosition();\n\t        },\n\t\n\t        setToolbarButtonStates: function () {\n\t            this.base.commands.forEach(function (extension) {\n\t                if (typeof extension.isActive === 'function' &&\n\t                    typeof extension.setInactive === 'function') {\n\t                    extension.setInactive();\n\t                }\n\t            }.bind(this));\n\t\n\t            this.checkActiveButtons();\n\t        },\n\t\n\t        checkActiveButtons: function () {\n\t            var manualStateChecks = [],\n\t                queryState = null,\n\t                selectionRange = Selection.getSelectionRange(this.options.ownerDocument),\n\t                parentNode,\n\t                updateExtensionState = function (extension) {\n\t                    if (typeof extension.checkState === 'function') {\n\t                        extension.checkState(parentNode);\n\t                    } else if (typeof extension.isActive === 'function' &&\n\t                               typeof extension.isAlreadyApplied === 'function' &&\n\t                               typeof extension.setActive === 'function') {\n\t                        if (!extension.isActive() && extension.isAlreadyApplied(parentNode)) {\n\t                            extension.setActive();\n\t                        }\n\t                    }\n\t                };\n\t\n\t            if (!selectionRange) {\n\t                return;\n\t            }\n\t\n\t            parentNode = Selection.getSelectedParentElement(selectionRange);\n\t\n\t            // Loop through all commands\n\t            this.base.commands.forEach(function (command) {\n\t                // For those commands where we can use document.queryCommandState(), do so\n\t                if (typeof command.queryCommandState === 'function') {\n\t                    queryState = command.queryCommandState();\n\t                    // If queryCommandState returns a valid value, we can trust the browser\n\t                    // and don't need to do our manual checks\n\t                    if (queryState !== null) {\n\t                        if (queryState && typeof command.setActive === 'function') {\n\t                            command.setActive();\n\t                        }\n\t                        return;\n\t                    }\n\t                }\n\t                // We can't use queryCommandState for this command, so add to manualStateChecks\n\t                manualStateChecks.push(command);\n\t            });\n\t\n\t            // Climb up the DOM and do manual checks for whether a certain command is currently enabled for this node\n\t            while (parentNode.tagName !== undefined && Util.parentElements.indexOf(parentNode.tagName.toLowerCase) === -1) {\n\t                manualStateChecks.forEach(updateExtensionState);\n\t\n\t                // we can abort the search upwards if we leave the contentEditable element\n\t                if (this.base.elements.indexOf(parentNode) !== -1) {\n\t                    break;\n\t                }\n\t                parentNode = parentNode.parentNode;\n\t            }\n\t        },\n\t\n\t        // Positioning toolbar\n\t\n\t        positionToolbarIfShown: function () {\n\t            if (this.isDisplayed()) {\n\t                this.setToolbarPosition();\n\t            }\n\t        },\n\t\n\t        setToolbarPosition: function () {\n\t            var container = this.base.getFocusedElement(),\n\t                selection = this.options.contentWindow.getSelection(),\n\t                anchorPreview;\n\t\n\t            // If there isn't a valid selection, bail\n\t            if (!container) {\n\t                return this;\n\t            }\n\t\n\t            if (this.options.staticToolbar) {\n\t                this.showToolbar();\n\t                this.positionStaticToolbar(container);\n\t            } else if (!selection.isCollapsed) {\n\t                this.showToolbar();\n\t                this.positionToolbar(selection);\n\t            }\n\t\n\t            anchorPreview = this.base.getExtensionByName('anchor-preview');\n\t\n\t            if (anchorPreview && typeof anchorPreview.hidePreview === 'function') {\n\t                anchorPreview.hidePreview();\n\t            }\n\t        },\n\t\n\t        positionStaticToolbar: function (container) {\n\t            // position the toolbar at left 0, so we can get the real width of the toolbar\n\t            this.getToolbarElement().style.left = '0';\n\t\n\t            // document.documentElement for IE 9\n\t            var scrollTop = (this.options.ownerDocument.documentElement && this.options.ownerDocument.documentElement.scrollTop) || this.options.ownerDocument.body.scrollTop,\n\t                windowWidth = this.options.contentWindow.innerWidth,\n\t                toolbarElement = this.getToolbarElement(),\n\t                containerRect = container.getBoundingClientRect(),\n\t                containerTop = containerRect.top + scrollTop,\n\t                containerCenter = (containerRect.left + (containerRect.width / 2)),\n\t                toolbarHeight = toolbarElement.offsetHeight,\n\t                toolbarWidth = toolbarElement.offsetWidth,\n\t                halfOffsetWidth = toolbarWidth / 2,\n\t                targetLeft;\n\t\n\t            if (this.options.stickyToolbar) {\n\t                // If it's beyond the height of the editor, position it at the bottom of the editor\n\t                if (scrollTop > (containerTop + container.offsetHeight - toolbarHeight)) {\n\t                    toolbarElement.style.top = (containerTop + container.offsetHeight - toolbarHeight) + 'px';\n\t                    toolbarElement.classList.remove('sticky-toolbar');\n\t\n\t                // Stick the toolbar to the top of the window\n\t                } else if (scrollTop > (containerTop - toolbarHeight)) {\n\t                    toolbarElement.classList.add('sticky-toolbar');\n\t                    toolbarElement.style.top = '0px';\n\t\n\t                // Normal static toolbar position\n\t                } else {\n\t                    toolbarElement.classList.remove('sticky-toolbar');\n\t                    toolbarElement.style.top = containerTop - toolbarHeight + 'px';\n\t                }\n\t            } else {\n\t                toolbarElement.style.top = containerTop - toolbarHeight + 'px';\n\t            }\n\t\n\t            switch (this.options.toolbarAlign) {\n\t                case 'left':\n\t                    targetLeft = containerRect.left;\n\t                    break;\n\t\n\t                case 'right':\n\t                    targetLeft = containerRect.right - toolbarWidth;\n\t                    break;\n\t\n\t                case 'center':\n\t                    targetLeft = containerCenter - halfOffsetWidth;\n\t                    break;\n\t            }\n\t\n\t            if (targetLeft < 0) {\n\t                targetLeft = 0;\n\t            } else if ((targetLeft + toolbarWidth) > windowWidth) {\n\t                targetLeft = (windowWidth - Math.ceil(toolbarWidth) - 1);\n\t            }\n\t\n\t            toolbarElement.style.left = targetLeft + 'px';\n\t        },\n\t\n\t        positionToolbar: function (selection) {\n\t            // position the toolbar at left 0, so we can get the real width of the toolbar\n\t            this.getToolbarElement().style.left = '0';\n\t\n\t            var windowWidth = this.options.contentWindow.innerWidth,\n\t                range = selection.getRangeAt(0),\n\t                boundary = range.getBoundingClientRect(),\n\t                middleBoundary = (boundary.left + boundary.right) / 2,\n\t                toolbarElement = this.getToolbarElement(),\n\t                toolbarHeight = toolbarElement.offsetHeight,\n\t                toolbarWidth = toolbarElement.offsetWidth,\n\t                halfOffsetWidth = toolbarWidth / 2,\n\t                buttonHeight = 50,\n\t                defaultLeft = this.options.diffLeft - halfOffsetWidth;\n\t\n\t            if (boundary.top < buttonHeight) {\n\t                toolbarElement.classList.add('medium-toolbar-arrow-over');\n\t                toolbarElement.classList.remove('medium-toolbar-arrow-under');\n\t                toolbarElement.style.top = buttonHeight + boundary.bottom - this.options.diffTop + this.options.contentWindow.pageYOffset - toolbarHeight + 'px';\n\t            } else {\n\t                toolbarElement.classList.add('medium-toolbar-arrow-under');\n\t                toolbarElement.classList.remove('medium-toolbar-arrow-over');\n\t                toolbarElement.style.top = boundary.top + this.options.diffTop + this.options.contentWindow.pageYOffset - toolbarHeight + 'px';\n\t            }\n\t\n\t            if (middleBoundary < halfOffsetWidth) {\n\t                toolbarElement.style.left = defaultLeft + halfOffsetWidth + 'px';\n\t            } else if ((windowWidth - middleBoundary) < halfOffsetWidth) {\n\t                toolbarElement.style.left = windowWidth + defaultLeft - halfOffsetWidth + 'px';\n\t            } else {\n\t                toolbarElement.style.left = defaultLeft + middleBoundary + 'px';\n\t            }\n\t        }\n\t    };\n\t}());\n\t\n\tvar extensionDefaults;\n\t(function () {\n\t    // for now this is empty because nothing interally uses an Extension default.\n\t    // as they are converted, provide them here.\n\t    extensionDefaults = {\n\t        button: Button,\n\t        form: FormExtension,\n\t\n\t        anchor: AnchorForm,\n\t        anchorPreview: AnchorPreview,\n\t        autoLink: AutoLink,\n\t        fontSize: FontSizeForm,\n\t        imageDragging: ImageDragging,\n\t        paste: PasteHandler,\n\t        placeholder: Placeholder\n\t    };\n\t})();\n\t\n\tfunction MediumEditor(elements, options) {\n\t    'use strict';\n\t    return this.init(elements, options);\n\t}\n\t\n\t(function () {\n\t    'use strict';\n\t\n\t    // Event handlers that shouldn't be exposed externally\n\t\n\t    function handleDisabledEnterKeydown(event, element) {\n\t        if (this.options.disableReturn || element.getAttribute('data-disable-return')) {\n\t            event.preventDefault();\n\t        } else if (this.options.disableDoubleReturn || element.getAttribute('data-disable-double-return')) {\n\t            var node = Selection.getSelectionStart(this.options.ownerDocument);\n\t\n\t            // if current text selection is empty OR previous sibling text is empty\n\t            if ((node && node.textContent.trim() === '') ||\n\t                (node.previousElementSibling && node.previousElementSibling.textContent.trim() === '')) {\n\t                event.preventDefault();\n\t            }\n\t        }\n\t    }\n\t\n\t    function handleTabKeydown(event) {\n\t        // Override tab only for pre nodes\n\t        var node = Selection.getSelectionStart(this.options.ownerDocument),\n\t            tag = node && node.tagName.toLowerCase();\n\t\n\t        if (tag === 'pre') {\n\t            event.preventDefault();\n\t            Util.insertHTMLCommand(this.options.ownerDocument, '    ');\n\t        }\n\t\n\t        // Tab to indent list structures!\n\t        if (Util.isListItem(node)) {\n\t            event.preventDefault();\n\t\n\t            // If Shift is down, outdent, otherwise indent\n\t            if (event.shiftKey) {\n\t                this.options.ownerDocument.execCommand('outdent', false, null);\n\t            } else {\n\t                this.options.ownerDocument.execCommand('indent', false, null);\n\t            }\n\t        }\n\t    }\n\t\n\t    function handleBlockDeleteKeydowns(event) {\n\t        var p, node = Selection.getSelectionStart(this.options.ownerDocument),\n\t            tagName = node.tagName.toLowerCase(),\n\t            isEmpty = /^(\\s+|<br\\/?>)?$/i,\n\t            isHeader = /h\\d/i;\n\t\n\t        if (Util.isKey(event, [Util.keyCode.BACKSPACE, Util.keyCode.ENTER]) &&\n\t                // has a preceeding sibling\n\t                node.previousElementSibling &&\n\t                // in a header\n\t                isHeader.test(tagName) &&\n\t                // at the very end of the block\n\t                Selection.getCaretOffsets(node).left === 0) {\n\t            if (Util.isKey(event, Util.keyCode.BACKSPACE) && isEmpty.test(node.previousElementSibling.innerHTML)) {\n\t                // backspacing the begining of a header into an empty previous element will\n\t                // change the tagName of the current node to prevent one\n\t                // instead delete previous node and cancel the event.\n\t                node.previousElementSibling.parentNode.removeChild(node.previousElementSibling);\n\t                event.preventDefault();\n\t            } else if (Util.isKey(event, Util.keyCode.ENTER)) {\n\t                // hitting return in the begining of a header will create empty header elements before the current one\n\t                // instead, make \"<p><br></p>\" element, which are what happens if you hit return in an empty paragraph\n\t                p = this.options.ownerDocument.createElement('p');\n\t                p.innerHTML = '<br>';\n\t                node.previousElementSibling.parentNode.insertBefore(p, node);\n\t                event.preventDefault();\n\t            }\n\t        } else if (Util.isKey(event, Util.keyCode.DELETE) &&\n\t                    // between two sibling elements\n\t                    node.nextElementSibling &&\n\t                    node.previousElementSibling &&\n\t                    // not in a header\n\t                    !isHeader.test(tagName) &&\n\t                    // in an empty tag\n\t                    isEmpty.test(node.innerHTML) &&\n\t                    // when the next tag *is* a header\n\t                    isHeader.test(node.nextElementSibling.tagName)) {\n\t            // hitting delete in an empty element preceding a header, ex:\n\t            //  <p>[CURSOR]</p><h1>Header</h1>\n\t            // Will cause the h1 to become a paragraph.\n\t            // Instead, delete the paragraph node and move the cursor to the begining of the h1\n\t\n\t            // remove node and move cursor to start of header\n\t            Selection.moveCursor(this.options.ownerDocument, node.nextElementSibling);\n\t\n\t            node.previousElementSibling.parentNode.removeChild(node);\n\t\n\t            event.preventDefault();\n\t        } else if (Util.isKey(event, Util.keyCode.BACKSPACE) &&\n\t                tagName === 'li' &&\n\t                // hitting backspace inside an empty li\n\t                isEmpty.test(node.innerHTML) &&\n\t                // is first element (no preceeding siblings)\n\t                !node.previousElementSibling &&\n\t                // parent also does not have a sibling\n\t                !node.parentElement.previousElementSibling &&\n\t                // is not the only li in a list\n\t                node.nextElementSibling &&\n\t                node.nextElementSibling.tagName.toLowerCase() === 'li') {\n\t            // backspacing in an empty first list element in the first list (with more elements) ex:\n\t            //  <ul><li>[CURSOR]</li><li>List Item 2</li></ul>\n\t            // will remove the first <li> but add some extra element before (varies based on browser)\n\t            // Instead, this will:\n\t            // 1) remove the list element\n\t            // 2) create a paragraph before the list\n\t            // 3) move the cursor into the paragraph\n\t\n\t            // create a paragraph before the list\n\t            p = this.options.ownerDocument.createElement('p');\n\t            p.innerHTML = '<br>';\n\t            node.parentElement.parentElement.insertBefore(p, node.parentElement);\n\t\n\t            // move the cursor into the new paragraph\n\t            Selection.moveCursor(this.options.ownerDocument, p);\n\t\n\t            // remove the list element\n\t            node.parentElement.removeChild(node);\n\t\n\t            event.preventDefault();\n\t        }\n\t    }\n\t\n\t    function handleKeyup(event) {\n\t        var node = Selection.getSelectionStart(this.options.ownerDocument),\n\t            tagName;\n\t\n\t        if (!node) {\n\t            return;\n\t        }\n\t\n\t        if (node.getAttribute('data-medium-element') && node.children.length === 0) {\n\t            this.options.ownerDocument.execCommand('formatBlock', false, 'p');\n\t        }\n\t\n\t        if (Util.isKey(event, Util.keyCode.ENTER) && !Util.isListItem(node)) {\n\t            tagName = node.tagName.toLowerCase();\n\t            // For anchor tags, unlink\n\t            if (tagName === 'a') {\n\t                this.options.ownerDocument.execCommand('unlink', false, null);\n\t            } else if (!event.shiftKey && !event.ctrlKey) {\n\t                // only format block if this is not a header tag\n\t                if (!/h\\d/.test(tagName)) {\n\t                    this.options.ownerDocument.execCommand('formatBlock', false, 'p');\n\t                }\n\t            }\n\t        }\n\t    }\n\t\n\t    // Internal helper methods which shouldn't be exposed externally\n\t\n\t    function createElementsArray(selector) {\n\t        if (!selector) {\n\t            selector = [];\n\t        }\n\t        // If string, use as query selector\n\t        if (typeof selector === 'string') {\n\t            selector = this.options.ownerDocument.querySelectorAll(selector);\n\t        }\n\t        // If element, put into array\n\t        if (Util.isElement(selector)) {\n\t            selector = [selector];\n\t        }\n\t        // Convert NodeList (or other array like object) into an array\n\t        var elements = Array.prototype.slice.apply(selector);\n\t\n\t        // Loop through elements and convert textarea's into divs\n\t        this.elements = [];\n\t        elements.forEach(function (element, index) {\n\t            if (element.tagName.toLowerCase() === 'textarea') {\n\t                this.elements.push(createContentEditable.call(this, element, index));\n\t            } else {\n\t                this.elements.push(element);\n\t            }\n\t        }, this);\n\t    }\n\t\n\t    function setExtensionDefaults(extension, defaults) {\n\t        Object.keys(defaults).forEach(function (prop) {\n\t            if (extension[prop] === undefined) {\n\t                extension[prop] = defaults[prop];\n\t            }\n\t        });\n\t        return extension;\n\t    }\n\t\n\t    function initExtension(extension, name, instance) {\n\t        if (typeof extension.parent !== 'undefined') {\n\t            Util.warn('Extension .parent property has been deprecated.  ' +\n\t                'The .base property for extensions will always be set to MediumEditor in version 5.0.0');\n\t        }\n\t        var extensionDefaults = {\n\t            'window': instance.options.contentWindow,\n\t            'document': instance.options.ownerDocument\n\t        };\n\t        // TODO: Deprecated (Remove .parent check in v5.0.0)\n\t        if (extension.parent !== false) {\n\t            extensionDefaults.base = instance;\n\t        }\n\t        // Add default options into the extension\n\t        extension = setExtensionDefaults(extension, extensionDefaults);\n\t\n\t        // Call init on the extension\n\t        if (typeof extension.init === 'function') {\n\t            // Passing instance into init() will be deprecated in v5.0.0\n\t            extension.init(instance);\n\t        }\n\t\n\t        // Set extension name (if not already set)\n\t        if (!extension.name) {\n\t            extension.name = name;\n\t        }\n\t        return extension;\n\t    }\n\t\n\t    function shouldAddDefaultAnchorPreview() {\n\t        var i,\n\t            shouldAdd = false;\n\t\n\t        // TODO: deprecated\n\t        // If anchor-preview is disabled, don't add\n\t        if (this.options.disableAnchorPreview) {\n\t            return false;\n\t        }\n\t        // If anchor-preview is disabled, don't add\n\t        if (this.options.anchorPreview === false) {\n\t            return false;\n\t        }\n\t        // If anchor-preview extension has been overriden, don't add\n\t        if (this.options.extensions['anchor-preview']) {\n\t            return false;\n\t        }\n\t        // If toolbar is disabled, don't add\n\t        if (this.options.disableToolbar) {\n\t            return false;\n\t        }\n\t        // If all elements have 'data-disable-toolbar' attribute, don't add\n\t        for (i = 0; i < this.elements.length; i += 1) {\n\t            if (!this.elements[i].getAttribute('data-disable-toolbar')) {\n\t                shouldAdd = true;\n\t                break;\n\t            }\n\t        }\n\t\n\t        return shouldAdd;\n\t    }\n\t\n\t    function shouldAddDefaultPlaceholder() {\n\t        if (this.options.extensions['placeholder']) {\n\t            return false;\n\t        }\n\t\n\t        // TODO: deprecated\n\t        if (this.options.disablePlaceholders) {\n\t            return false;\n\t        }\n\t\n\t        return this.options.placeholder !== false;\n\t    }\n\t\n\t    function shouldAddDefaultAutoLink() {\n\t        if (this.options.extensions['auto-link']) {\n\t            return false;\n\t        }\n\t\n\t        return this.options.autoLink !== false;\n\t    }\n\t\n\t    function shouldAddDefaultImageDragging() {\n\t        if (this.options.extensions['image-dragging']) {\n\t            return false;\n\t        }\n\t\n\t        return this.options.imageDragging !== false;\n\t    }\n\t\n\t    function createContentEditable(textarea, id) {\n\t        var div = this.options.ownerDocument.createElement('div'),\n\t            uniqueId = 'medium-editor-' + Date.now() + '-' + id,\n\t            attributesToClone = [\n\t                'data-disable-editing',\n\t                'data-disable-toolbar',\n\t                'data-placeholder',\n\t                'data-disable-return',\n\t                'data-disable-double-return',\n\t                'data-disable-preview',\n\t                'spellcheck'\n\t            ];\n\t\n\t        div.className = textarea.className;\n\t        div.id = uniqueId;\n\t        div.innerHTML = textarea.value;\n\t        div.setAttribute('medium-editor-textarea-id', id);\n\t        attributesToClone.forEach(function (attr) {\n\t            if (textarea.hasAttribute(attr)) {\n\t                div.setAttribute(attr, textarea.getAttribute(attr));\n\t            }\n\t        });\n\t\n\t        textarea.classList.add('medium-editor-hidden');\n\t        textarea.setAttribute('medium-editor-textarea-id', id);\n\t        textarea.parentNode.insertBefore(\n\t            div,\n\t            textarea\n\t        );\n\t\n\t        return div;\n\t    }\n\t\n\t    function initElements() {\n\t        this.elements.forEach(function (element, index) {\n\t            if (!this.options.disableEditing && !element.getAttribute('data-disable-editing')) {\n\t                element.setAttribute('contentEditable', true);\n\t                element.setAttribute('spellcheck', this.options.spellcheck);\n\t            }\n\t            element.setAttribute('data-medium-element', true);\n\t            element.setAttribute('role', 'textbox');\n\t            element.setAttribute('aria-multiline', true);\n\t            element.setAttribute('medium-editor-index', index);\n\t\n\t            if (element.hasAttribute('medium-editor-textarea-id')) {\n\t                this.on(element, 'input', function (event) {\n\t                    var target = event.target,\n\t                        textarea = target.parentNode.querySelector('textarea[medium-editor-textarea-id=\"' + target.getAttribute('medium-editor-textarea-id') + '\"]');\n\t                    if (textarea) {\n\t                        textarea.value = this.serialize()[target.id].value;\n\t                    }\n\t                }.bind(this));\n\t            }\n\t        }, this);\n\t    }\n\t\n\t    function initToolbar() {\n\t        if (this.toolbar || this.options.disableToolbar) {\n\t            return false;\n\t        }\n\t\n\t        var addToolbar = this.elements.some(function (element) {\n\t            return !element.getAttribute('data-disable-toolbar');\n\t        });\n\t\n\t        if (addToolbar) {\n\t            this.toolbar = new Toolbar(this);\n\t            this.options.elementsContainer.appendChild(this.toolbar.getToolbarElement());\n\t        }\n\t    }\n\t\n\t    function attachHandlers() {\n\t        var i;\n\t\n\t        // attach to tabs\n\t        this.subscribe('editableKeydownTab', handleTabKeydown.bind(this));\n\t\n\t        // Bind keys which can create or destroy a block element: backspace, delete, return\n\t        this.subscribe('editableKeydownDelete', handleBlockDeleteKeydowns.bind(this));\n\t        this.subscribe('editableKeydownEnter', handleBlockDeleteKeydowns.bind(this));\n\t\n\t        // disabling return or double return\n\t        if (this.options.disableReturn || this.options.disableDoubleReturn) {\n\t            this.subscribe('editableKeydownEnter', handleDisabledEnterKeydown.bind(this));\n\t        } else {\n\t            for (i = 0; i < this.elements.length; i += 1) {\n\t                if (this.elements[i].getAttribute('data-disable-return') || this.elements[i].getAttribute('data-disable-double-return')) {\n\t                    this.subscribe('editableKeydownEnter', handleDisabledEnterKeydown.bind(this));\n\t                    break;\n\t                }\n\t            }\n\t        }\n\t\n\t        // if we're not disabling return, add a handler to help handle cleanup\n\t        // for certain cases when enter is pressed\n\t        if (!this.options.disableReturn) {\n\t            this.elements.forEach(function (element) {\n\t                if (!element.getAttribute('data-disable-return')) {\n\t                    this.on(element, 'keyup', handleKeyup.bind(this));\n\t                }\n\t            }, this);\n\t        }\n\t    }\n\t\n\t    function initPlaceholder(options) {\n\t        // Backwards compatability\n\t        var defaultsBC = {\n\t            text: (typeof this.options.placeholder === 'string') ? this.options.placeholder : undefined // deprecated\n\t        };\n\t\n\t        return new MediumEditor.extensions.placeholder(\n\t            Util.extend({}, options, defaultsBC)\n\t        );\n\t    }\n\t\n\t    function initAnchorPreview(options) {\n\t        // Backwards compatability\n\t        var defaultsBC = {\n\t            hideDelay: this.options.anchorPreviewHideDelay, // deprecated\n\t            diffLeft: this.options.diffLeft, // deprecated (should use .getEditorOption() instead)\n\t            diffTop: this.options.diffTop, // deprecated (should use .getEditorOption() instead)\n\t            elementsContainer: this.options.elementsContainer // deprecated (should use .getEditorOption() instead)\n\t        };\n\t\n\t        return new MediumEditor.extensions.anchorPreview(\n\t            Util.extend({}, options, defaultsBC)\n\t        );\n\t    }\n\t\n\t    function initAnchorForm(options) {\n\t        // Backwards compatability\n\t        var defaultsBC = {\n\t            customClassOption: this.options.anchorButton ? (this.options.anchorButtonClass || 'btn') : undefined, // deprecated\n\t            linkValidation: this.options.checkLinkFormat, //deprecated\n\t            placeholderText: this.options.anchorInputPlaceholder, // deprecated\n\t            targetCheckbox: this.options.anchorTarget, // deprecated\n\t            targetCheckboxText: this.options.anchorInputCheckboxLabel // deprecated\n\t        };\n\t\n\t        return new MediumEditor.extensions.anchor(\n\t            Util.extend({}, options, defaultsBC)\n\t        );\n\t    }\n\t\n\t    function initPasteHandler(options) {\n\t        // Backwards compatability\n\t        var defaultsBC = {\n\t            forcePlainText: this.options.forcePlainText, // deprecated\n\t            cleanPastedHTML: this.options.cleanPastedHTML, // deprecated\n\t            disableReturn: this.options.disableReturn, // deprecated (should use .getEditorOption() instead)\n\t            targetBlank: this.options.targetBlank // deprecated (should use .getEditorOption() instead)\n\t        };\n\t\n\t        return new MediumEditor.extensions.paste(\n\t            Util.extend({}, options, defaultsBC)\n\t        );\n\t    }\n\t\n\t    function initCommands() {\n\t        var buttons = this.options.buttons,\n\t            extensions = this.options.extensions,\n\t            ext,\n\t            name;\n\t        this.commands = [];\n\t\n\t        buttons.forEach(function (buttonName) {\n\t            if (extensions[buttonName]) {\n\t                ext = initExtension(extensions[buttonName], buttonName, this);\n\t                this.commands.push(ext);\n\t            } else if (buttonName === 'anchor') {\n\t                ext = initExtension(initAnchorForm.call(this, this.options.anchor), 'anchor', this);\n\t                this.commands.push(ext);\n\t            } else if (buttonName === 'fontsize') {\n\t                ext = initExtension(new MediumEditor.extensions.fontSize(), buttonName, this);\n\t                this.commands.push(ext);\n\t            } else if (ButtonsData.hasOwnProperty(buttonName)) {\n\t                ext = initExtension(new MediumEditor.extensions.button(ButtonsData[buttonName]), buttonName, this);\n\t                this.commands.push(ext);\n\t            }\n\t        }, this);\n\t\n\t        for (name in extensions) {\n\t            if (extensions.hasOwnProperty(name) && buttons.indexOf(name) === -1) {\n\t                ext = initExtension(extensions[name], name, this);\n\t                this.commands.push(ext);\n\t            }\n\t        }\n\t\n\t        // Only add default paste extension if it wasn't overriden\n\t        if (!this.options.extensions['paste']) {\n\t            this.commands.push(initExtension(initPasteHandler.call(this, this.options.paste), 'paste', this));\n\t        }\n\t\n\t        // Add AnchorPreview as extension if needed\n\t        if (shouldAddDefaultAnchorPreview.call(this)) {\n\t            this.commands.push(initExtension(initAnchorPreview.call(this, this.options.anchorPreview), 'anchor-preview', this));\n\t        }\n\t\n\t        if (shouldAddDefaultAutoLink.call(this)) {\n\t            this.commands.push(initExtension(new MediumEditor.extensions.autoLink(), 'auto-link', this));\n\t        }\n\t\n\t        if (shouldAddDefaultImageDragging.call(this)) {\n\t            this.commands.push(initExtension(new MediumEditor.extensions.imageDragging(), 'image-dragging', this));\n\t        }\n\t\n\t        if (shouldAddDefaultPlaceholder.call(this)) {\n\t            var placeholderOpts = (typeof this.options.placeholder === 'string') ? {} : this.options.placeholder;\n\t            this.commands.push(initExtension(initPlaceholder.call(this, placeholderOpts), 'placeholder', this));\n\t        }\n\t    }\n\t\n\t    function mergeOptions(defaults, options) {\n\t        var deprecatedProperties = [\n\t            ['forcePlainText', 'paste.forcePlainText'],\n\t            ['cleanPastedHTML', 'paste.cleanPastedHTML'],\n\t            ['anchorInputPlaceholder', 'anchor.placeholderText'],\n\t            ['checkLinkFormat', 'anchor.linkValidation'],\n\t            ['anchorButton', 'anchor.customClassOption'],\n\t            ['anchorButtonClass', 'anchor.customClassOption'],\n\t            ['anchorTarget', 'anchor.targetCheckbox'],\n\t            ['anchorInputCheckboxLabel', 'anchor.targetCheckboxText'],\n\t            ['anchorPreviewHideDelay', 'anchorPreview.hideDelay'],\n\t            ['disableAnchorPreview', 'anchorPreview: false'],\n\t            ['disablePlaceholders', 'placeholder: false'],\n\t            ['onShowToolbar', 'showToolbar custom event'],\n\t            ['onHideToolbar', 'hideToolbar custom event']\n\t        ];\n\t        // warn about using deprecated properties\n\t        if (options) {\n\t            deprecatedProperties.forEach(function (pair) {\n\t                if (options.hasOwnProperty(pair[0]) && options[pair[0]] !== undefined) {\n\t                    Util.deprecated(pair[0], pair[1], 'v5.0.0');\n\t                }\n\t            });\n\t\n\t            if (options.hasOwnProperty('placeholder') && typeof options.placeholder === 'string') {\n\t                Util.deprecated('placeholder', 'placeholder.text', 'v5.0.0');\n\t            }\n\t        }\n\t\n\t        return Util.defaults({}, options, defaults);\n\t    }\n\t\n\t    function execActionInternal(action, opts) {\n\t        /*jslint regexp: true*/\n\t        var appendAction = /^append-(.+)$/gi,\n\t            match;\n\t        /*jslint regexp: false*/\n\t\n\t        // Actions starting with 'append-' should attempt to format a block of text ('formatBlock') using a specific\n\t        // type of block element (ie append-blockquote, append-h1, append-pre, etc.)\n\t        match = appendAction.exec(action);\n\t        if (match) {\n\t            return Util.execFormatBlock(this.options.ownerDocument, match[1]);\n\t        }\n\t\n\t        if (action === 'fontSize') {\n\t            return this.options.ownerDocument.execCommand('fontSize', false, opts.size);\n\t        }\n\t\n\t        if (action === 'createLink') {\n\t            return this.createLink(opts);\n\t        }\n\t\n\t        if (action === 'image') {\n\t            return this.options.ownerDocument.execCommand('insertImage', false, this.options.contentWindow.getSelection());\n\t        }\n\t\n\t        return this.options.ownerDocument.execCommand(action, false, null);\n\t    }\n\t\n\t    // deprecate\n\t    MediumEditor.statics = {\n\t        ButtonsData: ButtonsData,\n\t        DefaultButton: DefaultButton,\n\t        AnchorExtension: AnchorExtension,\n\t        FontSizeExtension: FontSizeExtension,\n\t        Toolbar: Toolbar,\n\t        AnchorPreview: AnchorPreviewDeprecated\n\t    };\n\t\n\t    MediumEditor.Extension = Extension;\n\t\n\t    MediumEditor.extensions = extensionDefaults;\n\t    MediumEditor.util = Util;\n\t    MediumEditor.selection = Selection;\n\t\n\t    MediumEditor.prototype = {\n\t        defaults: editorDefaults,\n\t\n\t        // NOT DOCUMENTED - exposed for backwards compatability\n\t        init: function (elements, options) {\n\t            var uniqueId = 1;\n\t\n\t            this.options = mergeOptions.call(this, this.defaults, options);\n\t            this.origElements = elements;\n\t\n\t            if (!this.options.elementsContainer) {\n\t                this.options.elementsContainer = this.options.ownerDocument.body;\n\t            }\n\t\n\t            while (this.options.elementsContainer.querySelector('#medium-editor-toolbar-' + uniqueId)) {\n\t                uniqueId = uniqueId + 1;\n\t            }\n\t\n\t            this.id = uniqueId;\n\t\n\t            return this.setup();\n\t        },\n\t\n\t        setup: function () {\n\t            if (this.isActive) {\n\t                return;\n\t            }\n\t\n\t            createElementsArray.call(this, this.origElements);\n\t            if (this.elements.length === 0) {\n\t                return;\n\t            }\n\t\n\t            this.events = new Events(this);\n\t            this.isActive = true;\n\t\n\t            // Call initialization helpers\n\t            initElements.call(this);\n\t            initCommands.call(this);\n\t            initToolbar.call(this);\n\t            attachHandlers.call(this);\n\t        },\n\t\n\t        destroy: function () {\n\t            if (!this.isActive) {\n\t                return;\n\t            }\n\t\n\t            this.isActive = false;\n\t\n\t            this.commands.forEach(function (extension) {\n\t                if (typeof extension.destroy === 'function') {\n\t                    extension.destroy();\n\t                } else if (typeof extension.deactivate === 'function') {\n\t                    Util.warn('Extension .deactivate() function has been deprecated. Use .destroy() instead. This will be removed in version 5.0.0');\n\t                    extension.deactivate();\n\t                }\n\t            }, this);\n\t\n\t            if (this.toolbar !== undefined) {\n\t                this.toolbar.destroy();\n\t                delete this.toolbar;\n\t            }\n\t\n\t            this.events.destroy();\n\t\n\t            this.elements.forEach(function (element) {\n\t                // Reset elements content, fix for issue where after editor destroyed the red underlines on spelling errors are left\n\t                if (this.options.spellcheck) {\n\t                    element.innerHTML = element.innerHTML;\n\t                }\n\t\n\t                element.removeAttribute('contentEditable');\n\t                element.removeAttribute('spellcheck');\n\t                element.removeAttribute('data-medium-element');\n\t                element.removeAttribute('medium-editor-index');\n\t                element.removeAttribute('role');\n\t                element.removeAttribute('aria-multiline');\n\t\n\t                // Remove any elements created for textareas\n\t                if (element.hasAttribute('medium-editor-textarea-id')) {\n\t                    var textarea = element.parentNode.querySelector('textarea[medium-editor-textarea-id=\"' + element.getAttribute('medium-editor-textarea-id') + '\"]');\n\t                    if (textarea) {\n\t                        // Un-hide the textarea\n\t                        textarea.classList.remove('medium-editor-hidden');\n\t                    }\n\t                    if (element.parentNode) {\n\t                        element.parentNode.removeChild(element);\n\t                    }\n\t                }\n\t            }, this);\n\t            this.elements = [];\n\t        },\n\t\n\t        on: function (target, event, listener, useCapture) {\n\t            this.events.attachDOMEvent(target, event, listener, useCapture);\n\t        },\n\t\n\t        off: function (target, event, listener, useCapture) {\n\t            this.events.detachDOMEvent(target, event, listener, useCapture);\n\t        },\n\t\n\t        subscribe: function (event, listener) {\n\t            this.events.attachCustomEvent(event, listener);\n\t        },\n\t\n\t        unsubscribe: function (event, listener) {\n\t            this.events.detachCustomEvent(event, listener);\n\t        },\n\t\n\t        createEvent: function () {\n\t            Util.warn('.createEvent() has been deprecated and is no longer needed. ' +\n\t                'You can attach and trigger custom events without calling this method.  This will be removed in v5.0.0');\n\t        },\n\t\n\t        trigger: function (name, data, editable) {\n\t            this.events.triggerCustomEvent(name, data, editable);\n\t        },\n\t\n\t        delay: function (fn) {\n\t            var self = this;\n\t            return setTimeout(function () {\n\t                if (self.isActive) {\n\t                    fn();\n\t                }\n\t            }, this.options.delay);\n\t        },\n\t\n\t        serialize: function () {\n\t            var i,\n\t                elementid,\n\t                content = {};\n\t            for (i = 0; i < this.elements.length; i += 1) {\n\t                elementid = (this.elements[i].id !== '') ? this.elements[i].id : 'element-' + i;\n\t                content[elementid] = {\n\t                    value: this.elements[i].innerHTML.trim()\n\t                };\n\t            }\n\t            return content;\n\t        },\n\t\n\t        getExtensionByName: function (name) {\n\t            var extension;\n\t            if (this.commands && this.commands.length) {\n\t                this.commands.some(function (ext) {\n\t                    if (ext.name === name) {\n\t                        extension = ext;\n\t                        return true;\n\t                    }\n\t                    return false;\n\t                });\n\t            }\n\t            return extension;\n\t        },\n\t\n\t        /**\n\t         * NOT DOCUMENTED - exposed for backwards compatability\n\t         * Helper function to call a method with a number of parameters on all registered extensions.\n\t         * The function assures that the function exists before calling.\n\t         *\n\t         * @param {string} funcName name of the function to call\n\t         * @param [args] arguments passed into funcName\n\t         */\n\t        callExtensions: function (funcName) {\n\t            if (arguments.length < 1) {\n\t                return;\n\t            }\n\t\n\t            var args = Array.prototype.slice.call(arguments, 1),\n\t                ext,\n\t                name;\n\t\n\t            for (name in this.options.extensions) {\n\t                if (this.options.extensions.hasOwnProperty(name)) {\n\t                    ext = this.options.extensions[name];\n\t                    if (ext[funcName] !== undefined) {\n\t                        ext[funcName].apply(ext, args);\n\t                    }\n\t                }\n\t            }\n\t            return this;\n\t        },\n\t\n\t        stopSelectionUpdates: function () {\n\t            this.preventSelectionUpdates = true;\n\t        },\n\t\n\t        startSelectionUpdates: function () {\n\t            this.preventSelectionUpdates = false;\n\t        },\n\t\n\t        checkSelection: function () {\n\t            if (this.toolbar) {\n\t                this.toolbar.checkState();\n\t            }\n\t            return this;\n\t        },\n\t\n\t        // Wrapper around document.queryCommandState for checking whether an action has already\n\t        // been applied to the current selection\n\t        queryCommandState: function (action) {\n\t            var fullAction = /^full-(.+)$/gi,\n\t                match,\n\t                queryState = null;\n\t\n\t            // Actions starting with 'full-' need to be modified since this is a medium-editor concept\n\t            match = fullAction.exec(action);\n\t            if (match) {\n\t                action = match[1];\n\t            }\n\t\n\t            try {\n\t                queryState = this.options.ownerDocument.queryCommandState(action);\n\t            } catch (exc) {\n\t                queryState = null;\n\t            }\n\t\n\t            return queryState;\n\t        },\n\t\n\t        execAction: function (action, opts) {\n\t            /*jslint regexp: true*/\n\t            var fullAction = /^full-(.+)$/gi,\n\t                match,\n\t                result;\n\t            /*jslint regexp: false*/\n\t\n\t            // Actions starting with 'full-' should be applied to to the entire contents of the editable element\n\t            // (ie full-bold, full-append-pre, etc.)\n\t            match = fullAction.exec(action);\n\t            if (match) {\n\t                // Store the current selection to be restored after applying the action\n\t                this.saveSelection();\n\t                // Select all of the contents before calling the action\n\t                this.selectAllContents();\n\t                result = execActionInternal.call(this, match[1], opts);\n\t                // Restore the previous selection\n\t                this.restoreSelection();\n\t            } else {\n\t                result = execActionInternal.call(this, action, opts);\n\t            }\n\t\n\t            // do some DOM clean-up for known browser issues after the action\n\t            if (action === 'insertunorderedlist' || action === 'insertorderedlist') {\n\t                Util.cleanListDOM(this.options.ownerDocument, this.getSelectedParentElement());\n\t            }\n\t\n\t            this.checkSelection();\n\t            return result;\n\t        },\n\t\n\t        getSelectedParentElement: function (range) {\n\t            if (range === undefined) {\n\t                range = this.options.contentWindow.getSelection().getRangeAt(0);\n\t            }\n\t            return Selection.getSelectedParentElement(range);\n\t        },\n\t\n\t        // NOT DOCUMENTED - exposed as extension helper\n\t        hideToolbarDefaultActions: function () {\n\t            if (this.toolbar) {\n\t                this.toolbar.hideToolbarDefaultActions();\n\t            }\n\t            return this;\n\t        },\n\t\n\t        // NOT DOCUMENTED - exposed as extension helper and for backwards compatability\n\t        setToolbarPosition: function () {\n\t            if (this.toolbar) {\n\t                this.toolbar.setToolbarPosition();\n\t            }\n\t        },\n\t\n\t        selectAllContents: function () {\n\t            var currNode = Selection.getSelectionElement(this.options.contentWindow);\n\t\n\t            if (currNode) {\n\t                // Move to the lowest descendant node that still selects all of the contents\n\t                while (currNode.children.length === 1) {\n\t                    currNode = currNode.children[0];\n\t                }\n\t\n\t                this.selectElement(currNode);\n\t            }\n\t        },\n\t\n\t        selectElement: function (element) {\n\t            Selection.selectNode(element, this.options.ownerDocument);\n\t\n\t            var selElement = Selection.getSelectionElement(this.options.contentWindow);\n\t            if (selElement) {\n\t                this.events.focusElement(selElement);\n\t            }\n\t        },\n\t\n\t        getFocusedElement: function () {\n\t            var focused;\n\t            this.elements.some(function (element) {\n\t                // Find the element that has focus\n\t                if (!focused && element.getAttribute('data-medium-focused')) {\n\t                    focused = element;\n\t                }\n\t\n\t                // bail if we found the element that had focus\n\t                return !!focused;\n\t            }, this);\n\t\n\t            return focused;\n\t        },\n\t\n\t        // http://stackoverflow.com/questions/17678843/cant-restore-selection-after-html-modify-even-if-its-the-same-html\n\t        // Tim Down\n\t        // TODO: move to selection.js and clean up old methods there\n\t        exportSelection: function () {\n\t            var selectionState = null,\n\t                selection = this.options.contentWindow.getSelection(),\n\t                range,\n\t                preSelectionRange,\n\t                start,\n\t                editableElementIndex = -1;\n\t\n\t            if (selection.rangeCount > 0) {\n\t                range = selection.getRangeAt(0);\n\t                preSelectionRange = range.cloneRange();\n\t\n\t                // Find element current selection is inside\n\t                this.elements.some(function (el, index) {\n\t                    if (el === range.startContainer || Util.isDescendant(el, range.startContainer)) {\n\t                        editableElementIndex = index;\n\t                        return true;\n\t                    }\n\t                    return false;\n\t                });\n\t\n\t                if (editableElementIndex > -1) {\n\t                    preSelectionRange.selectNodeContents(this.elements[editableElementIndex]);\n\t                    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n\t                    start = preSelectionRange.toString().length;\n\t\n\t                    selectionState = {\n\t                        start: start,\n\t                        end: start + range.toString().length,\n\t                        editableElementIndex: editableElementIndex\n\t                    };\n\t                    // If start = 0 there may still be an empty paragraph before it, but we don't care.\n\t                    if (start !== 0) {\n\t                        var emptyBlocksIndex = Selection.getIndexRelativeToAdjacentEmptyBlocks(\n\t                                this.options.ownerDocument,\n\t                                this.elements[editableElementIndex],\n\t                                range.startContainer,\n\t                                range.startOffset);\n\t                        if (emptyBlocksIndex !== 0) {\n\t                            selectionState.emptyBlocksIndex = emptyBlocksIndex;\n\t                        }\n\t                    }\n\t                }\n\t            }\n\t\n\t            if (selectionState !== null && selectionState.editableElementIndex === 0) {\n\t                delete selectionState.editableElementIndex;\n\t            }\n\t\n\t            return selectionState;\n\t        },\n\t\n\t        saveSelection: function () {\n\t            this.selectionState = this.exportSelection();\n\t        },\n\t\n\t        // http://stackoverflow.com/questions/17678843/cant-restore-selection-after-html-modify-even-if-its-the-same-html\n\t        // Tim Down\n\t        // TODO: move to selection.js and clean up old methods there\n\t        //\n\t        // {object} inSelectionState - the selection to import\n\t        // {boolean} [favorLaterSelectionAnchor] - defaults to false. If true, import the cursor immediately\n\t        //      subsequent to an anchor tag if it would otherwise be placed right at the trailing edge inside the\n\t        //      anchor. This cursor positioning, even though visually equivalent to the user, can affect behavior\n\t        //      in MS IE.\n\t        importSelection: function (inSelectionState, favorLaterSelectionAnchor) {\n\t            if (!inSelectionState) {\n\t                return;\n\t            }\n\t\n\t            var editableElementIndex = inSelectionState.editableElementIndex === undefined ?\n\t                                                0 : inSelectionState.editableElementIndex,\n\t                selectionState = {\n\t                    editableElementIndex: editableElementIndex,\n\t                    start: inSelectionState.start,\n\t                    end: inSelectionState.end\n\t                },\n\t                editableElement = this.elements[selectionState.editableElementIndex],\n\t                charIndex = 0,\n\t                range = this.options.ownerDocument.createRange(),\n\t                nodeStack = [editableElement],\n\t                node,\n\t                foundStart = false,\n\t                stop = false,\n\t                i,\n\t                sel,\n\t                nextCharIndex;\n\t\n\t            range.setStart(editableElement, 0);\n\t            range.collapse(true);\n\t\n\t            node = nodeStack.pop();\n\t            while (!stop && node) {\n\t                if (node.nodeType === 3) {\n\t                    nextCharIndex = charIndex + node.length;\n\t                    if (!foundStart && selectionState.start >= charIndex && selectionState.start <= nextCharIndex) {\n\t                        range.setStart(node, selectionState.start - charIndex);\n\t                        foundStart = true;\n\t                    }\n\t                    if (foundStart && selectionState.end >= charIndex && selectionState.end <= nextCharIndex) {\n\t                        range.setEnd(node, selectionState.end - charIndex);\n\t                        stop = true;\n\t                    }\n\t                    charIndex = nextCharIndex;\n\t                } else {\n\t                    i = node.childNodes.length - 1;\n\t                    while (i >= 0) {\n\t                        nodeStack.push(node.childNodes[i]);\n\t                        i -= 1;\n\t                    }\n\t                }\n\t                if (!stop) {\n\t                    node = nodeStack.pop();\n\t                }\n\t            }\n\t\n\t            if (inSelectionState.emptyBlocksIndex) {\n\t                var targetNode = Util.getBlockContainer(range.startContainer),\n\t                    index = 0;\n\t                // Skip over empty blocks until we hit the block we want the selection to be in\n\t                while (index < inSelectionState.emptyBlocksIndex && targetNode.nextSibling) {\n\t                    targetNode = targetNode.nextSibling;\n\t                    index++;\n\t                    // If we find a non-empty block, ignore the emptyBlocksIndex and just put selection here\n\t                    if (targetNode.textContent.length > 0) {\n\t                        break;\n\t                    }\n\t                }\n\t\n\t                // We're selecting a high-level block node, so make sure the cursor gets moved into the deepest\n\t                // element at the beginning of the block\n\t                range.setStart(Util.getFirstSelectableLeafNode(targetNode), 0);\n\t            }\n\t\n\t            // If the selection is right at the ending edge of a link, put it outside the anchor tag instead of inside.\n\t            if (favorLaterSelectionAnchor) {\n\t                range = Selection.importSelectionMoveCursorPastAnchor(selectionState, range);\n\t            }\n\t            sel = this.options.contentWindow.getSelection();\n\t            sel.removeAllRanges();\n\t            sel.addRange(range);\n\t        },\n\t\n\t        restoreSelection: function () {\n\t            this.importSelection(this.selectionState);\n\t        },\n\t\n\t        createLink: function (opts) {\n\t            var customEvent,\n\t                i;\n\t\n\t            if (opts.url && opts.url.trim().length > 0) {\n\t                this.options.ownerDocument.execCommand('createLink', false, opts.url);\n\t\n\t                if (this.options.targetBlank || opts.target === '_blank') {\n\t                    Util.setTargetBlank(Selection.getSelectionStart(this.options.ownerDocument), opts.url);\n\t                }\n\t\n\t                if (opts.buttonClass) {\n\t                    Util.addClassToAnchors(Selection.getSelectionStart(this.options.ownerDocument), opts.buttonClass);\n\t                }\n\t            }\n\t\n\t            if (this.options.targetBlank || opts.target === '_blank' || opts.buttonClass) {\n\t                customEvent = this.options.ownerDocument.createEvent('HTMLEvents');\n\t                customEvent.initEvent('input', true, true, this.options.contentWindow);\n\t                for (i = 0; i < this.elements.length; i += 1) {\n\t                    this.elements[i].dispatchEvent(customEvent);\n\t                }\n\t            }\n\t        },\n\t\n\t        // alias for setup - keeping for backwards compatability\n\t        activate: function () {\n\t            Util.deprecatedMethod.call(this, 'activate', 'setup', arguments, 'v5.0.0');\n\t        },\n\t\n\t        // alias for destroy - keeping for backwards compatability\n\t        deactivate: function () {\n\t            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n\t        },\n\t\n\t        cleanPaste: function (text) {\n\t            this.getExtensionByName('paste').cleanPaste(text);\n\t        },\n\t\n\t        pasteHTML: function (html, options) {\n\t            this.getExtensionByName('paste').pasteHTML(html, options);\n\t        }\n\t    };\n\t}());\n\t\n\tMediumEditor.version = (function (major, minor, revision) {\n\t    return {\n\t        major: parseInt(major, 10),\n\t        minor: parseInt(minor, 10),\n\t        revision: parseInt(revision, 10),\n\t        toString: function () {\n\t            return [major, minor, revision].join('.');\n\t        }\n\t    };\n\t}).apply(this, ({\n\t    // grunt-bump looks for this:\n\t    'version': '4.12.7'\n\t}).version.split('.'));\n\t\n\t    return MediumEditor;\n\t}()));\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(5);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(2)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../node_modules/css-loader/index.js!./app.css\", function() {\n\t\t\t\tvar newContent = require(\"!!./../node_modules/css-loader/index.js!./app.css\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(6);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(2)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../../css-loader/index.js!./medium-editor.css\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../../css-loader/index.js!./medium-editor.css\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(7);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(2)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../../../css-loader/index.js!./default.css\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../../../css-loader/index.js!./default.css\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** bundle.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/example/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d9fa0ce0075d37910b41\n **/","require('medium-editor/dist/css/medium-editor.css');\nrequire('medium-editor/dist/css/themes/default.css');\nrequire('./app.css');\n\nvar React = require('react');\nvar Editor = require('../lib/editor');\n\nvar App = React.createClass({\n  getInitialState() {\n    return {text: 'Fusce dapibus, tellus ac cursus commodo'}\n  },\n\n  render() {\n    return (\n      <div className=\"app\">\n        <h1>react-medium-editor</h1>\n        <h3>Html content</h3>\n        <div>{this.state.text}</div>\n\n        <h3>Editor #1 (&lt;pre&gt; tag)</h3>\n        <Editor\n          tag=\"pre\"\n          text={this.state.text}\n          onChange={this.handleChange}\n          options={{buttons: ['bold', 'italic', 'underline']}}\n        />\n        <h3>Editor #2</h3>\n        <Editor\n          text={this.state.text}\n          onChange={this.handleChange}\n        />\n      </div>\n    );\n  },\n\n  handleChange(text) {\n    this.setState({text: text});\n  }\n});\n\nReact.render(<App/>, document.getElementById('app'));\n\n\n\n/** WEBPACK FOOTER **\n ** ./example/app.js\n **/","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n// css base code, injected by the css-loader\r\nmodule.exports = function() {\r\n\tvar list = [];\r\n\r\n\t// return the list of modules as css string\r\n\tlist.toString = function toString() {\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar item = this[i];\r\n\t\t\tif(item[2]) {\r\n\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t} else {\r\n\t\t\t\tresult.push(item[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result.join(\"\");\r\n\t};\r\n\r\n\t// import a list of modules into the list\r\n\tlist.i = function(modules, mediaQuery) {\r\n\t\tif(typeof modules === \"string\")\r\n\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\tvar alreadyImportedModules = {};\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar id = this[i][0];\r\n\t\t\tif(typeof id === \"number\")\r\n\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t}\r\n\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\tvar item = modules[i];\r\n\t\t\t// skip already imported module\r\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(item);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn list;\r\n};\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader/lib/css-base.js\n ** module id = 1\n ** module chunks = 0\n **/","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar stylesInDom = {},\r\n\tmemoize = function(fn) {\r\n\t\tvar memo;\r\n\t\treturn function () {\r\n\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\r\n\t\t\treturn memo;\r\n\t\t};\r\n\t},\r\n\tisOldIE = memoize(function() {\r\n\t\treturn /msie [6-9]\\b/.test(window.navigator.userAgent.toLowerCase());\r\n\t}),\r\n\tgetHeadElement = memoize(function () {\r\n\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\r\n\t}),\r\n\tsingletonElement = null,\r\n\tsingletonCounter = 0;\r\n\r\nmodule.exports = function(list, options) {\r\n\tif(typeof DEBUG !== \"undefined\" && DEBUG) {\r\n\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\r\n\t}\r\n\r\n\toptions = options || {};\r\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\r\n\t// tags it will allow on a page\r\n\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\r\n\r\n\tvar styles = listToStyles(list);\r\n\taddStylesToDom(styles, options);\r\n\r\n\treturn function update(newList) {\r\n\t\tvar mayRemove = [];\r\n\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\tvar item = styles[i];\r\n\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\tdomStyle.refs--;\r\n\t\t\tmayRemove.push(domStyle);\r\n\t\t}\r\n\t\tif(newList) {\r\n\t\t\tvar newStyles = listToStyles(newList);\r\n\t\t\taddStylesToDom(newStyles, options);\r\n\t\t}\r\n\t\tfor(var i = 0; i < mayRemove.length; i++) {\r\n\t\t\tvar domStyle = mayRemove[i];\r\n\t\t\tif(domStyle.refs === 0) {\r\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\r\n\t\t\t\t\tdomStyle.parts[j]();\r\n\t\t\t\tdelete stylesInDom[domStyle.id];\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction addStylesToDom(styles, options) {\r\n\tfor(var i = 0; i < styles.length; i++) {\r\n\t\tvar item = styles[i];\r\n\t\tvar domStyle = stylesInDom[item.id];\r\n\t\tif(domStyle) {\r\n\t\t\tdomStyle.refs++;\r\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\r\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\r\n\t\t\t}\r\n\t\t\tfor(; j < item.parts.length; j++) {\r\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar parts = [];\r\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\r\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\r\n\t\t\t}\r\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction listToStyles(list) {\r\n\tvar styles = [];\r\n\tvar newStyles = {};\r\n\tfor(var i = 0; i < list.length; i++) {\r\n\t\tvar item = list[i];\r\n\t\tvar id = item[0];\r\n\t\tvar css = item[1];\r\n\t\tvar media = item[2];\r\n\t\tvar sourceMap = item[3];\r\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\r\n\t\tif(!newStyles[id])\r\n\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\r\n\t\telse\r\n\t\t\tnewStyles[id].parts.push(part);\r\n\t}\r\n\treturn styles;\r\n}\r\n\r\nfunction createStyleElement() {\r\n\tvar styleElement = document.createElement(\"style\");\r\n\tvar head = getHeadElement();\r\n\tstyleElement.type = \"text/css\";\r\n\thead.appendChild(styleElement);\r\n\treturn styleElement;\r\n}\r\n\r\nfunction createLinkElement() {\r\n\tvar linkElement = document.createElement(\"link\");\r\n\tvar head = getHeadElement();\r\n\tlinkElement.rel = \"stylesheet\";\r\n\thead.appendChild(linkElement);\r\n\treturn linkElement;\r\n}\r\n\r\nfunction addStyle(obj, options) {\r\n\tvar styleElement, update, remove;\r\n\r\n\tif (options.singleton) {\r\n\t\tvar styleIndex = singletonCounter++;\r\n\t\tstyleElement = singletonElement || (singletonElement = createStyleElement());\r\n\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\r\n\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\r\n\t} else if(obj.sourceMap &&\r\n\t\ttypeof URL === \"function\" &&\r\n\t\ttypeof URL.createObjectURL === \"function\" &&\r\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\r\n\t\ttypeof Blob === \"function\" &&\r\n\t\ttypeof btoa === \"function\") {\r\n\t\tstyleElement = createLinkElement();\r\n\t\tupdate = updateLink.bind(null, styleElement);\r\n\t\tremove = function() {\r\n\t\t\tstyleElement.parentNode.removeChild(styleElement);\r\n\t\t\tif(styleElement.href)\r\n\t\t\t\tURL.revokeObjectURL(styleElement.href);\r\n\t\t};\r\n\t} else {\r\n\t\tstyleElement = createStyleElement();\r\n\t\tupdate = applyToTag.bind(null, styleElement);\r\n\t\tremove = function() {\r\n\t\t\tstyleElement.parentNode.removeChild(styleElement);\r\n\t\t};\r\n\t}\r\n\r\n\tupdate(obj);\r\n\r\n\treturn function updateStyle(newObj) {\r\n\t\tif(newObj) {\r\n\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\r\n\t\t\t\treturn;\r\n\t\t\tupdate(obj = newObj);\r\n\t\t} else {\r\n\t\t\tremove();\r\n\t\t}\r\n\t};\r\n}\r\n\r\nvar replaceText = (function () {\r\n\tvar textStore = [];\r\n\r\n\treturn function (index, replacement) {\r\n\t\ttextStore[index] = replacement;\r\n\t\treturn textStore.filter(Boolean).join('\\n');\r\n\t};\r\n})();\r\n\r\nfunction applyToSingletonTag(styleElement, index, remove, obj) {\r\n\tvar css = remove ? \"\" : obj.css;\r\n\r\n\tif (styleElement.styleSheet) {\r\n\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\r\n\t} else {\r\n\t\tvar cssNode = document.createTextNode(css);\r\n\t\tvar childNodes = styleElement.childNodes;\r\n\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\r\n\t\tif (childNodes.length) {\r\n\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\r\n\t\t} else {\r\n\t\t\tstyleElement.appendChild(cssNode);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction applyToTag(styleElement, obj) {\r\n\tvar css = obj.css;\r\n\tvar media = obj.media;\r\n\tvar sourceMap = obj.sourceMap;\r\n\r\n\tif(media) {\r\n\t\tstyleElement.setAttribute(\"media\", media)\r\n\t}\r\n\r\n\tif(styleElement.styleSheet) {\r\n\t\tstyleElement.styleSheet.cssText = css;\r\n\t} else {\r\n\t\twhile(styleElement.firstChild) {\r\n\t\t\tstyleElement.removeChild(styleElement.firstChild);\r\n\t\t}\r\n\t\tstyleElement.appendChild(document.createTextNode(css));\r\n\t}\r\n}\r\n\r\nfunction updateLink(linkElement, obj) {\r\n\tvar css = obj.css;\r\n\tvar media = obj.media;\r\n\tvar sourceMap = obj.sourceMap;\r\n\r\n\tif(sourceMap) {\r\n\t\t// http://stackoverflow.com/a/26603875\r\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\r\n\t}\r\n\r\n\tvar blob = new Blob([css], { type: \"text/css\" });\r\n\r\n\tvar oldSrc = linkElement.href;\r\n\r\n\tlinkElement.href = URL.createObjectURL(blob);\r\n\r\n\tif(oldSrc)\r\n\t\tURL.revokeObjectURL(oldSrc);\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/style-loader/addStyles.js\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = React;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"React\"\n ** module id = 3\n ** module chunks = 0\n **/","var React = require('react');\nvar MediumEditor = require('medium-editor');\n\nmodule.exports = React.createClass({\n  displayName: 'MediumEditor',\n\n  getInitialState() {\n    return {\n      text: this.props.text\n    };\n  },\n\n  getDefaultProps() {\n    return {\n      tag: 'div'\n    };\n  },\n\n  componentDidMount() {\n    var dom = this.getDOMNode();\n    this.medium = new MediumEditor(dom, this.props.options);\n    this.medium.subscribe('editableInput', (e) => {\n      this._updated = true;\n      this.change(dom.innerHTML);\n    });\n  },\n\n  componentWillUnmount() {\n    this.medium.destroy();\n  },\n\n  componentWillReceiveProps(nextProps) {\n    if(nextProps.text !== this.state.text && !this._updated) {\n      this.setState({text: nextProps.text});\n    }\n\n    if(this._updated) this._updated = false;\n  },\n\n  render() {\n    return React.createElement(this.props.tag, {\n      className: this.props.className,\n      contentEditable: true,\n      dangerouslySetInnerHTML: {__html: this.state.text}\n    });\n  },\n\n  change(text) {\n    if(this.props.onChange) this.props.onChange(text);\n  }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/editor.js\n **/","exports = module.exports = require(\"./../node_modules/css-loader/lib/css-base.js\")();\nexports.push([module.id, \"*{box-sizing:border-box}body{margin:0;padding:0}.app{max-width:500px;margin:0 auto}[contenteditable=true]{padding:5px 9px;background-color:#eaeaea;border-radius:4px;outline:0}\", \"\"]);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader!./example/app.css\n ** module id = 5\n ** module chunks = 0\n **/","exports = module.exports = require(\"./../../../css-loader/lib/css-base.js\")();\nexports.push([module.id, \".clearfix:after{display:block;visibility:hidden;clear:both;height:0;content:\\\" \\\";font-size:0}@-webkit-keyframes pop-upwards{0%{-webkit-transform:matrix(.97,0,0,1,0,12);transform:matrix(.97,0,0,1,0,12);opacity:0}20%{-webkit-transform:matrix(.99,0,0,1,0,2);transform:matrix(.99,0,0,1,0,2);opacity:.7}40%{-webkit-transform:matrix(1,0,0,1,0,-1);transform:matrix(1,0,0,1,0,-1);opacity:1}100%,70%{-webkit-transform:matrix(1,0,0,1,0,0);transform:matrix(1,0,0,1,0,0);opacity:1}}@keyframes pop-upwards{0%{-webkit-transform:matrix(.97,0,0,1,0,12);transform:matrix(.97,0,0,1,0,12);opacity:0}20%{-webkit-transform:matrix(.99,0,0,1,0,2);transform:matrix(.99,0,0,1,0,2);opacity:.7}40%{-webkit-transform:matrix(1,0,0,1,0,-1);transform:matrix(1,0,0,1,0,-1);opacity:1}100%,70%{-webkit-transform:matrix(1,0,0,1,0,0);transform:matrix(1,0,0,1,0,0);opacity:1}}.data-medium-element sup{vertical-align:super}.data-medium-element sub{vertical-align:sub}.data-medium-element img{max-width:100%}.medium-editor-hidden{display:none}.medium-toolbar-arrow-over:before,.medium-toolbar-arrow-under:after{position:absolute;left:50%;display:block;margin-left:-8px;width:0;height:0;border-style:solid;content:\\\"\\\"}.medium-toolbar-arrow-under:after{border-width:8px 8px 0}.medium-toolbar-arrow-over:before{top:-8px;border-width:0 8px 8px}.medium-editor-anchor-preview,.medium-editor-toolbar{position:absolute;top:0;left:0;z-index:2000;visibility:hidden;font-size:16px;font-family:HelveticaNeue,Helvetica,Arial,sans-serif}.medium-editor-anchor-preview ul,.medium-editor-toolbar ul{margin:0;padding:0}.medium-editor-anchor-preview li,.medium-editor-toolbar li{float:left;margin:0;padding:0;list-style:none}.medium-editor-anchor-preview li button,.medium-editor-toolbar li button{display:block;margin:0;padding:15px;cursor:pointer;font-size:14px;line-height:1.33;text-decoration:none;box-sizing:border-box}.medium-editor-anchor-preview li button:focus,.medium-editor-toolbar li button:focus{outline:0}.medium-editor-anchor-preview li .medium-editor-action-underline,.medium-editor-toolbar li .medium-editor-action-underline{text-decoration:underline}.medium-editor-anchor-preview li .medium-editor-action-pre,.medium-editor-toolbar li .medium-editor-action-pre{padding:15px 0;font-weight:100;font-size:12px;font-family:Menlo,monospace}.medium-editor-anchor-preview{max-width:280px;word-break:break-all;word-wrap:break-word;text-align:center;line-height:1.4}.medium-editor-anchor-preview a{display:inline-block;margin:5px 5px 5px 10px;color:#fff}.medium-editor-anchor-preview-active,.medium-editor-toolbar-active{visibility:visible}.sticky-toolbar{position:fixed;top:1px}.medium-editor-toolbar-active.stalker-toolbar{-webkit-animation:pop-upwards 160ms forwards linear;animation:pop-upwards 160ms forwards linear}.medium-editor-action-bold{font-weight:bolder}.medium-editor-action-italic{font-style:italic}.medium-editor-toolbar-form{display:none}.medium-editor-toolbar-form a,.medium-editor-toolbar-form input{font-family:HelveticaNeue,Helvetica,Arial,sans-serif}.medium-editor-toolbar-form .medium-editor-toolbar-input,.medium-editor-toolbar-form label{margin:0;padding:6px;width:316px;border:none;font-size:14px;box-sizing:border-box}.medium-editor-toolbar-form .medium-editor-toolbar-input:focus,.medium-editor-toolbar-form label:focus{outline:0;border:none;box-shadow:none;appearance:none}.medium-editor-toolbar-form label{display:block}.medium-editor-toolbar-form a{display:inline-block;margin:0 10px;text-decoration:none;font-weight:bolder;font-size:24px}.medium-editor-placeholder{position:relative}.medium-editor-placeholder:after{position:absolute;top:0;left:0;content:attr(data-placeholder)!important;font-style:italic;white-space:pre}.medium-editor-dragover{background:#ddd}.medium-image-loading{width:40px;height:40px;background-color:#333;display:inline-block;border-radius:100%;-webkit-animation:medium-image-loading-animation 1s infinite ease-in-out;animation:medium-image-loading-animation 1s infinite ease-in-out}@-webkit-keyframes medium-image-loading-animation{0%{-webkit-transform:scale(0);transform:scale(0)}100%{-webkit-transform:scale(1);transform:scale(1);opacity:0}}@keyframes medium-image-loading-animation{0%{-webkit-transform:scale(0);transform:scale(0)}100%{-webkit-transform:scale(1);transform:scale(1);opacity:0}}\", \"\"]);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader!./~/medium-editor/dist/css/medium-editor.css\n ** module id = 6\n ** module chunks = 0\n **/","exports = module.exports = require(\"./../../../../css-loader/lib/css-base.js\")();\nexports.push([module.id, \".medium-toolbar-arrow-under:after{top:50px;border-color:#242424 transparent transparent}.medium-toolbar-arrow-over:before{top:-8px;border-color:transparent transparent #242424}.medium-editor-toolbar{border:1px solid #000;background-color:#242424;background:-webkit-linear-gradient(top,#242424,rgba(36,36,36,.75));background:linear-gradient(to bottom,#242424,rgba(36,36,36,.75));border-radius:5px;box-shadow:0 0 3px #000}.medium-editor-toolbar li button{min-width:50px;height:50px;border:0;border-right:1px solid #000;border-left:1px solid #333;border-left:1px solid rgba(255,255,255,.1);background-color:#242424;color:#fff;background:-webkit-linear-gradient(top,#242424,rgba(36,36,36,.89));background:linear-gradient(to bottom,#242424,rgba(36,36,36,.89));box-shadow:0 2px 2px rgba(0,0,0,.3);-webkit-transition:background-color .2s ease-in;transition:background-color .2s ease-in}.medium-editor-toolbar li button:hover{background-color:#000;color:#ff0}.medium-editor-toolbar li .medium-editor-button-first{border-top-left-radius:5px;border-bottom-left-radius:5px}.medium-editor-toolbar li .medium-editor-button-last{border-top-right-radius:5px;border-bottom-right-radius:5px}.medium-editor-toolbar li .medium-editor-button-active{background-color:#000;color:#fff;background:-webkit-linear-gradient(top,#242424,rgba(0,0,0,.89));background:linear-gradient(to bottom,#242424,rgba(0,0,0,.89))}.medium-editor-toolbar-form{background:#242424;color:#999;border-radius:5px}.medium-editor-toolbar-form .medium-editor-toolbar-input{height:50px;background:#242424;color:#ccc;box-sizing:border-box}.medium-editor-toolbar-form a{color:#fff}.medium-editor-toolbar-anchor-preview{background:#242424;color:#fff;border-radius:5px}.medium-editor-placeholder:after{color:#b3b3b1}\", \"\"]);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader!./~/medium-editor/dist/css/themes/default.css\n ** module id = 7\n ** module chunks = 0\n **/","/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\n// Full polyfill for browsers with no classList support\nif (!(\"classList\" in document.createElement(\"_\"))) {\n  (function (view) {\n\n  \"use strict\";\n\n  if (!('Element' in view)) return;\n\n  var\n      classListProp = \"classList\"\n    , protoProp = \"prototype\"\n    , elemCtrProto = view.Element[protoProp]\n    , objCtr = Object\n    , strTrim = String[protoProp].trim || function () {\n      return this.replace(/^\\s+|\\s+$/g, \"\");\n    }\n    , arrIndexOf = Array[protoProp].indexOf || function (item) {\n      var\n          i = 0\n        , len = this.length\n      ;\n      for (; i < len; i++) {\n        if (i in this && this[i] === item) {\n          return i;\n        }\n      }\n      return -1;\n    }\n    // Vendors: please allow content code to instantiate DOMExceptions\n    , DOMEx = function (type, message) {\n      this.name = type;\n      this.code = DOMException[type];\n      this.message = message;\n    }\n    , checkTokenAndGetIndex = function (classList, token) {\n      if (token === \"\") {\n        throw new DOMEx(\n            \"SYNTAX_ERR\"\n          , \"An invalid or illegal string was specified\"\n        );\n      }\n      if (/\\s/.test(token)) {\n        throw new DOMEx(\n            \"INVALID_CHARACTER_ERR\"\n          , \"String contains an invalid character\"\n        );\n      }\n      return arrIndexOf.call(classList, token);\n    }\n    , ClassList = function (elem) {\n      var\n          trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n        , classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n        , i = 0\n        , len = classes.length\n      ;\n      for (; i < len; i++) {\n        this.push(classes[i]);\n      }\n      this._updateClassName = function () {\n        elem.setAttribute(\"class\", this.toString());\n      };\n    }\n    , classListProto = ClassList[protoProp] = []\n    , classListGetter = function () {\n      return new ClassList(this);\n    }\n  ;\n  // Most DOMException implementations don't allow calling DOMException's toString()\n  // on non-DOMExceptions. Error's toString() is sufficient here.\n  DOMEx[protoProp] = Error[protoProp];\n  classListProto.item = function (i) {\n    return this[i] || null;\n  };\n  classListProto.contains = function (token) {\n    token += \"\";\n    return checkTokenAndGetIndex(this, token) !== -1;\n  };\n  classListProto.add = function () {\n    var\n        tokens = arguments\n      , i = 0\n      , l = tokens.length\n      , token\n      , updated = false\n    ;\n    do {\n      token = tokens[i] + \"\";\n      if (checkTokenAndGetIndex(this, token) === -1) {\n        this.push(token);\n        updated = true;\n      }\n    }\n    while (++i < l);\n\n    if (updated) {\n      this._updateClassName();\n    }\n  };\n  classListProto.remove = function () {\n    var\n        tokens = arguments\n      , i = 0\n      , l = tokens.length\n      , token\n      , updated = false\n      , index\n    ;\n    do {\n      token = tokens[i] + \"\";\n      index = checkTokenAndGetIndex(this, token);\n      while (index !== -1) {\n        this.splice(index, 1);\n        updated = true;\n        index = checkTokenAndGetIndex(this, token);\n      }\n    }\n    while (++i < l);\n\n    if (updated) {\n      this._updateClassName();\n    }\n  };\n  classListProto.toggle = function (token, force) {\n    token += \"\";\n\n    var\n        result = this.contains(token)\n      , method = result ?\n        force !== true && \"remove\"\n      :\n        force !== false && \"add\"\n    ;\n\n    if (method) {\n      this[method](token);\n    }\n\n    if (force === true || force === false) {\n      return force;\n    } else {\n      return !result;\n    }\n  };\n  classListProto.toString = function () {\n    return this.join(\" \");\n  };\n\n  if (objCtr.defineProperty) {\n    var classListPropDesc = {\n        get: classListGetter\n      , enumerable: true\n      , configurable: true\n    };\n    try {\n      objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n    } catch (ex) { // IE 8 doesn't support enumerable:true\n      if (ex.number === -0x7FF5EC54) {\n        classListPropDesc.enumerable = false;\n        objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n      }\n    }\n  } else if (objCtr[protoProp].__defineGetter__) {\n    elemCtrProto.__defineGetter__(classListProp, classListGetter);\n  }\n\n  }(self));\n}\n\n/* Blob.js\n * A Blob implementation.\n * 2014-07-24\n *\n * By Eli Grey, http://eligrey.com\n * By Devin Samarin, https://github.com/dsamarin\n * License: X11/MIT\n *   See https://github.com/eligrey/Blob.js/blob/master/LICENSE.md\n */\n\n/*global self, unescape */\n/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,\n  plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */\n\n(function (view) {\n  \"use strict\";\n\n  view.URL = view.URL || view.webkitURL;\n\n  if (view.Blob && view.URL) {\n    try {\n      new Blob;\n      return;\n    } catch (e) {}\n  }\n\n  // Internally we use a BlobBuilder implementation to base Blob off of\n  // in order to support older browsers that only have BlobBuilder\n  var BlobBuilder = view.BlobBuilder || view.WebKitBlobBuilder || view.MozBlobBuilder || (function(view) {\n    var\n        get_class = function(object) {\n        return Object.prototype.toString.call(object).match(/^\\[object\\s(.*)\\]$/)[1];\n      }\n      , FakeBlobBuilder = function BlobBuilder() {\n        this.data = [];\n      }\n      , FakeBlob = function Blob(data, type, encoding) {\n        this.data = data;\n        this.size = data.length;\n        this.type = type;\n        this.encoding = encoding;\n      }\n      , FBB_proto = FakeBlobBuilder.prototype\n      , FB_proto = FakeBlob.prototype\n      , FileReaderSync = view.FileReaderSync\n      , FileException = function(type) {\n        this.code = this[this.name = type];\n      }\n      , file_ex_codes = (\n          \"NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR \"\n        + \"NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR\"\n      ).split(\" \")\n      , file_ex_code = file_ex_codes.length\n      , real_URL = view.URL || view.webkitURL || view\n      , real_create_object_URL = real_URL.createObjectURL\n      , real_revoke_object_URL = real_URL.revokeObjectURL\n      , URL = real_URL\n      , btoa = view.btoa\n      , atob = view.atob\n\n      , ArrayBuffer = view.ArrayBuffer\n      , Uint8Array = view.Uint8Array\n\n      , origin = /^[\\w-]+:\\/*\\[?[\\w\\.:-]+\\]?(?::[0-9]+)?/\n    ;\n    FakeBlob.fake = FB_proto.fake = true;\n    while (file_ex_code--) {\n      FileException.prototype[file_ex_codes[file_ex_code]] = file_ex_code + 1;\n    }\n    // Polyfill URL\n    if (!real_URL.createObjectURL) {\n      URL = view.URL = function(uri) {\n        var\n            uri_info = document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n          , uri_origin\n        ;\n        uri_info.href = uri;\n        if (!(\"origin\" in uri_info)) {\n          if (uri_info.protocol.toLowerCase() === \"data:\") {\n            uri_info.origin = null;\n          } else {\n            uri_origin = uri.match(origin);\n            uri_info.origin = uri_origin && uri_origin[1];\n          }\n        }\n        return uri_info;\n      };\n    }\n    URL.createObjectURL = function(blob) {\n      var\n          type = blob.type\n        , data_URI_header\n      ;\n      if (type === null) {\n        type = \"application/octet-stream\";\n      }\n      if (blob instanceof FakeBlob) {\n        data_URI_header = \"data:\" + type;\n        if (blob.encoding === \"base64\") {\n          return data_URI_header + \";base64,\" + blob.data;\n        } else if (blob.encoding === \"URI\") {\n          return data_URI_header + \",\" + decodeURIComponent(blob.data);\n        } if (btoa) {\n          return data_URI_header + \";base64,\" + btoa(blob.data);\n        } else {\n          return data_URI_header + \",\" + encodeURIComponent(blob.data);\n        }\n      } else if (real_create_object_URL) {\n        return real_create_object_URL.call(real_URL, blob);\n      }\n    };\n    URL.revokeObjectURL = function(object_URL) {\n      if (object_URL.substring(0, 5) !== \"data:\" && real_revoke_object_URL) {\n        real_revoke_object_URL.call(real_URL, object_URL);\n      }\n    };\n    FBB_proto.append = function(data/*, endings*/) {\n      var bb = this.data;\n      // decode data to a binary string\n      if (Uint8Array && (data instanceof ArrayBuffer || data instanceof Uint8Array)) {\n        var\n            str = \"\"\n          , buf = new Uint8Array(data)\n          , i = 0\n          , buf_len = buf.length\n        ;\n        for (; i < buf_len; i++) {\n          str += String.fromCharCode(buf[i]);\n        }\n        bb.push(str);\n      } else if (get_class(data) === \"Blob\" || get_class(data) === \"File\") {\n        if (FileReaderSync) {\n          var fr = new FileReaderSync;\n          bb.push(fr.readAsBinaryString(data));\n        } else {\n          // async FileReader won't work as BlobBuilder is sync\n          throw new FileException(\"NOT_READABLE_ERR\");\n        }\n      } else if (data instanceof FakeBlob) {\n        if (data.encoding === \"base64\" && atob) {\n          bb.push(atob(data.data));\n        } else if (data.encoding === \"URI\") {\n          bb.push(decodeURIComponent(data.data));\n        } else if (data.encoding === \"raw\") {\n          bb.push(data.data);\n        }\n      } else {\n        if (typeof data !== \"string\") {\n          data += \"\"; // convert unsupported types to strings\n        }\n        // decode UTF-16 to binary string\n        bb.push(unescape(encodeURIComponent(data)));\n      }\n    };\n    FBB_proto.getBlob = function(type) {\n      if (!arguments.length) {\n        type = null;\n      }\n      return new FakeBlob(this.data.join(\"\"), type, \"raw\");\n    };\n    FBB_proto.toString = function() {\n      return \"[object BlobBuilder]\";\n    };\n    FB_proto.slice = function(start, end, type) {\n      var args = arguments.length;\n      if (args < 3) {\n        type = null;\n      }\n      return new FakeBlob(\n          this.data.slice(start, args > 1 ? end : this.data.length)\n        , type\n        , this.encoding\n      );\n    };\n    FB_proto.toString = function() {\n      return \"[object Blob]\";\n    };\n    FB_proto.close = function() {\n      this.size = 0;\n      delete this.data;\n    };\n    return FakeBlobBuilder;\n  }(view));\n\n  view.Blob = function(blobParts, options) {\n    var type = options ? (options.type || \"\") : \"\";\n    var builder = new BlobBuilder();\n    if (blobParts) {\n      for (var i = 0, len = blobParts.length; i < len; i++) {\n        if (Uint8Array && blobParts[i] instanceof Uint8Array) {\n          builder.append(blobParts[i].buffer);\n        }\n        else {\n          builder.append(blobParts[i]);\n        }\n      }\n    }\n    var blob = builder.getBlob(type);\n    if (!blob.slice && blob.webkitSlice) {\n      blob.slice = blob.webkitSlice;\n    }\n    return blob;\n  };\n\n  var getPrototypeOf = Object.getPrototypeOf || function(object) {\n    return object.__proto__;\n  };\n  view.Blob.prototype = getPrototypeOf(new view.Blob());\n}(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content || this));\n\n(function (root, factory) {\n    'use strict';\n    if (typeof module === 'object') {\n        module.exports = factory;\n    } else if (typeof define === 'function' && define.amd) {\n        define(function () {\n            return factory;\n        });\n    } else {\n        root.MediumEditor = factory;\n    }\n}(this, function () {\n\n    'use strict';\n\nvar Util;\n\n(function (window) {\n    'use strict';\n\n    // Params: Array, Boolean, Object\n    function getProp(parts, create, context) {\n        if (!context) {\n            context = window;\n        }\n\n        try {\n            for (var i = 0; i < parts.length; i++) {\n                var p = parts[i];\n                if (!(p in context)) {\n                    if (create) {\n                        context[p] = {};\n                    } else {\n                        return;\n                    }\n                }\n                context = context[p];\n            }\n            return context;\n        } catch (e) {\n            // 'p in context' throws an exception when context is a number, boolean, etc. rather than an object,\n            // so in that corner case just return undefined (by having no return statement)\n        }\n    }\n\n    function copyInto(overwrite, dest) {\n        var prop,\n            sources = Array.prototype.slice.call(arguments, 2);\n        dest = dest || {};\n        for (var i = 0; i < sources.length; i++) {\n            var source = sources[i];\n            if (source) {\n                for (prop in source) {\n                    if (source.hasOwnProperty(prop) &&\n                        typeof source[prop] !== 'undefined' &&\n                        (overwrite || dest.hasOwnProperty(prop) === false)) {\n                        dest[prop] = source[prop];\n                    }\n                }\n            }\n        }\n        return dest;\n    }\n\n    Util = {\n\n        // http://stackoverflow.com/questions/17907445/how-to-detect-ie11#comment30165888_17907562\n        // by rg89\n        isIE: ((navigator.appName === 'Microsoft Internet Explorer') || ((navigator.appName === 'Netscape') && (new RegExp('Trident/.*rv:([0-9]{1,}[.0-9]{0,})').exec(navigator.userAgent) !== null))),\n\n        // http://stackoverflow.com/a/11752084/569101\n        isMac: (window.navigator.platform.toUpperCase().indexOf('MAC') >= 0),\n\n        // https://github.com/jashkenas/underscore\n        keyCode: {\n            BACKSPACE: 8,\n            TAB: 9,\n            ENTER: 13,\n            ESCAPE: 27,\n            SPACE: 32,\n            DELETE: 46\n        },\n\n        /**\n         * Returns true if it's metaKey on Mac, or ctrlKey on non-Mac.\n         * See #591\n         */\n        isMetaCtrlKey: function (event) {\n            if ((this.isMac && event.metaKey) || (!this.isMac && event.ctrlKey)) {\n                return true;\n            }\n\n            return false;\n        },\n\n        /**\n         * Returns true if the key associated to the event is inside keys array\n         *\n         * @see : https://github.com/jquery/jquery/blob/0705be475092aede1eddae01319ec931fb9c65fc/src/event.js#L473-L484\n         * @see : http://stackoverflow.com/q/4471582/569101\n         */\n        isKey: function (event, keys) {\n            var keyCode = event.which;\n\n            // getting the key code from event\n            if (null === keyCode) {\n                keyCode = event.charCode !== null ? event.charCode : event.keyCode;\n            }\n\n            // it's not an array let's just compare strings!\n            if (false === Array.isArray(keys)) {\n                return keyCode === keys;\n            }\n\n            if (-1 === keys.indexOf(keyCode)) {\n                return false;\n            }\n\n            return true;\n        },\n\n        parentElements: ['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre'],\n\n        extend: function extend(/* dest, source1, source2, ...*/) {\n            var args = [true].concat(Array.prototype.slice.call(arguments));\n            return copyInto.apply(this, args);\n        },\n\n        defaults: function defaults(/*dest, source1, source2, ...*/) {\n            var args = [false].concat(Array.prototype.slice.call(arguments));\n            return copyInto.apply(this, args);\n        },\n\n        derives: function derives(base, derived) {\n            var origPrototype = derived.prototype;\n            function Proto() { }\n            Proto.prototype = base.prototype;\n            derived.prototype = new Proto();\n            derived.prototype.constructor = base;\n            derived.prototype = copyInto(false, derived.prototype, origPrototype);\n            return derived;\n        },\n\n        // Find the next node in the DOM tree that represents any text that is being\n        // displayed directly next to the targetNode (passed as an argument)\n        // Text that appears directly next to the current node can be:\n        //  - A sibling text node\n        //  - A descendant of a sibling element\n        //  - A sibling text node of an ancestor\n        //  - A descendant of a sibling element of an ancestor\n        findAdjacentTextNodeWithContent: function findAdjacentTextNodeWithContent(rootNode, targetNode, ownerDocument) {\n            var pastTarget = false,\n                nextNode,\n                nodeIterator = ownerDocument.createNodeIterator(rootNode, NodeFilter.SHOW_TEXT, null, false);\n\n            // Use a native NodeIterator to iterate over all the text nodes that are descendants\n            // of the rootNode.  Once past the targetNode, choose the first non-empty text node\n            nextNode = nodeIterator.nextNode();\n            while (nextNode) {\n                if (nextNode === targetNode) {\n                    pastTarget = true;\n                } else if (pastTarget) {\n                    if (nextNode.nodeType === 3 && nextNode.nodeValue && nextNode.nodeValue.trim().length > 0) {\n                        break;\n                    }\n                }\n                nextNode = nodeIterator.nextNode();\n            }\n\n            return nextNode;\n        },\n\n        isDescendant: function isDescendant(parent, child, checkEquality) {\n            if (!parent || !child) {\n                return false;\n            }\n            if (checkEquality && parent === child) {\n                return true;\n            }\n            var node = child.parentNode;\n            while (node !== null) {\n                if (node === parent) {\n                    return true;\n                }\n                node = node.parentNode;\n            }\n            return false;\n        },\n\n        // https://github.com/jashkenas/underscore\n        isElement: function isElement(obj) {\n            return !!(obj && obj.nodeType === 1);\n        },\n\n        now: Date.now,\n\n        // https://github.com/jashkenas/underscore\n        throttle: function (func, wait) {\n            var THROTTLE_INTERVAL = 50,\n                context,\n                args,\n                result,\n                timeout = null,\n                previous = 0,\n                later = function () {\n                    previous = Date.now();\n                    timeout = null;\n                    result = func.apply(context, args);\n                    if (!timeout) {\n                        context = args = null;\n                    }\n                };\n\n            if (!wait && wait !== 0) {\n                wait = THROTTLE_INTERVAL;\n            }\n\n            return function () {\n                var now = Date.now(),\n                    remaining = wait - (now - previous);\n\n                context = this;\n                args = arguments;\n                if (remaining <= 0 || remaining > wait) {\n                    if (timeout) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                    }\n                    previous = now;\n                    result = func.apply(context, args);\n                    if (!timeout) {\n                        context = args = null;\n                    }\n                } else if (!timeout) {\n                    timeout = setTimeout(later, remaining);\n                }\n                return result;\n            };\n        },\n\n        traverseUp: function (current, testElementFunction) {\n            if (!current) {\n                return false;\n            }\n\n            do {\n                if (current.nodeType === 1) {\n                    if (testElementFunction(current)) {\n                        return current;\n                    }\n                    // do not traverse upwards past the nearest containing editor\n                    if (current.getAttribute('data-medium-element')) {\n                        return false;\n                    }\n                }\n\n                current = current.parentNode;\n            } while (current);\n\n            return false;\n        },\n\n        htmlEntities: function (str) {\n            // converts special characters (like <) into their escaped/encoded values (like &lt;).\n            // This allows you to show to display the string without the browser reading it as HTML.\n            return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n        },\n\n        // http://stackoverflow.com/questions/6690752/insert-html-at-caret-in-a-contenteditable-div\n        insertHTMLCommand: function (doc, html) {\n            var selection, range, el, fragment, node, lastNode, toReplace;\n\n            if (doc.queryCommandSupported('insertHTML')) {\n                try {\n                    return doc.execCommand('insertHTML', false, html);\n                } catch (ignore) {}\n            }\n\n            selection = doc.defaultView.getSelection();\n            if (selection.getRangeAt && selection.rangeCount) {\n                range = selection.getRangeAt(0);\n                toReplace = range.commonAncestorContainer;\n                // Ensure range covers maximum amount of nodes as possible\n                // By moving up the DOM and selecting ancestors whose only child is the range\n                if ((toReplace.nodeType === 3 && toReplace.nodeValue === range.toString()) ||\n                        (toReplace.nodeType !== 3 && toReplace.innerHTML === range.toString())) {\n                    while (toReplace.parentNode &&\n                            toReplace.parentNode.childNodes.length === 1 &&\n                            !toReplace.parentNode.getAttribute('data-medium-element')) {\n                        toReplace = toReplace.parentNode;\n                    }\n                    range.selectNode(toReplace);\n                }\n                range.deleteContents();\n\n                el = doc.createElement('div');\n                el.innerHTML = html;\n                fragment = doc.createDocumentFragment();\n                while (el.firstChild) {\n                    node = el.firstChild;\n                    lastNode = fragment.appendChild(node);\n                }\n                range.insertNode(fragment);\n\n                // Preserve the selection:\n                if (lastNode) {\n                    range = range.cloneRange();\n                    range.setStartAfter(lastNode);\n                    range.collapse(true);\n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                }\n            }\n        },\n\n        getSelectionRange: function (ownerDocument) {\n            this.deprecated('Util.getSelectionRange', 'Selection.getSelectionRange', 'v5.0.0');\n\n            return Selection.getSelectionRange(ownerDocument);\n        },\n\n        getSelectionStart: function (ownerDocument) {\n            this.deprecated('Util.getSelectionStart', 'Selection.getSelectionStart', 'v5.0.0');\n\n            return Selection.getSelectionStart(ownerDocument);\n        },\n\n        getSelectionData: function (el) {\n            this.deprecated('Util.getSelectionData', 'Selection.getSelectionData', 'v5.0.0');\n\n            return Selection.getSelectionData(el);\n        },\n\n        execFormatBlock: function (doc, tagName) {\n            var selectionData = Selection.getSelectionData(Selection.getSelectionStart(doc));\n            // FF handles blockquote differently on formatBlock\n            // allowing nesting, we need to use outdent\n            // https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla\n            if (tagName === 'blockquote' && selectionData.el &&\n                    selectionData.el.parentNode.tagName.toLowerCase() === 'blockquote') {\n                return doc.execCommand('outdent', false, null);\n            }\n            if (selectionData.tagName === tagName) {\n                tagName = 'p';\n            }\n            // When IE we need to add <> to heading elements and\n            //  blockquote needs to be called as indent\n            // http://stackoverflow.com/questions/10741831/execcommand-formatblock-headings-in-ie\n            // http://stackoverflow.com/questions/1816223/rich-text-editor-with-blockquote-function/1821777#1821777\n            if (this.isIE) {\n                if (tagName === 'blockquote') {\n                    return doc.execCommand('indent', false, tagName);\n                }\n                tagName = '<' + tagName + '>';\n            }\n            return doc.execCommand('formatBlock', false, tagName);\n        },\n\n        /**\n         * Set target to blank on the given el element\n         *\n         * TODO: not sure if this should be here\n         *\n         * When creating a link (using core -> createLink) the selection returned by Firefox will be the parent of the created link\n         * instead of the created link itself (as it is for Chrome for example), so we retrieve all \"a\" children to grab the good one by\n         * using `anchorUrl` to ensure that we are adding target=\"_blank\" on the good one.\n         * This isn't a bulletproof solution anyway ..\n         */\n        setTargetBlank: function (el, anchorUrl) {\n            var i, url = anchorUrl || false;\n            if (el.tagName.toLowerCase() === 'a') {\n                el.target = '_blank';\n            } else {\n                el = el.getElementsByTagName('a');\n\n                for (i = 0; i < el.length; i += 1) {\n                    if (false === url || url === el[i].attributes.href.value) {\n                        el[i].target = '_blank';\n                    }\n                }\n            }\n        },\n\n        addClassToAnchors: function (el, buttonClass) {\n            var classes = buttonClass.split(' '),\n                i,\n                j;\n            if (el.tagName.toLowerCase() === 'a') {\n                for (j = 0; j < classes.length; j += 1) {\n                    el.classList.add(classes[j]);\n                }\n            } else {\n                el = el.getElementsByTagName('a');\n                for (i = 0; i < el.length; i += 1) {\n                    for (j = 0; j < classes.length; j += 1) {\n                        el[i].classList.add(classes[j]);\n                    }\n                }\n            }\n        },\n\n        isListItem: function (node) {\n            if (!node) {\n                return false;\n            }\n            if (node.tagName.toLowerCase() === 'li') {\n                return true;\n            }\n\n            var parentNode = node.parentNode,\n                tagName = parentNode.tagName.toLowerCase();\n            while (!this.isBlockContainer(parentNode) && tagName !== 'div') {\n                if (tagName === 'li') {\n                    return true;\n                }\n                parentNode = parentNode.parentNode;\n                if (parentNode && parentNode.tagName) {\n                    tagName = parentNode.tagName.toLowerCase();\n                } else {\n                    return false;\n                }\n            }\n            return false;\n        },\n\n        cleanListDOM: function (ownerDocument, element) {\n            if (element.tagName.toLowerCase() !== 'li') {\n                return;\n            }\n\n            var list = element.parentElement;\n\n            if (list.parentElement.tagName.toLowerCase() === 'p') { // yes we need to clean up\n                this.unwrap(list.parentElement, ownerDocument);\n\n                // move cursor at the end of the text inside the list\n                // for some unknown reason, the cursor is moved to end of the \"visual\" line\n                Selection.moveCursor(ownerDocument, element.firstChild, element.firstChild.textContent.length);\n            }\n        },\n\n        unwrapElement: function (element) {\n            this.deprecated('unwrapElement', 'unwrap', 'v5.0.0');\n\n            this.unwrap(element, element.ownerDocument);\n        },\n\n        /* splitDOMTree\n         *\n         * Given a root element some descendant element, split the root element\n         * into its own element containing the descendant element and all elements\n         * on the left or right side of the descendant ('right' is default)\n         *\n         * example:\n         *\n         *         <div>\n         *      /    |   \\\n         *  <span> <span> <span>\n         *   / \\    / \\    / \\\n         *  1   2  3   4  5   6\n         *\n         *  If I wanted to split this tree given the <div> as the root and \"4\" as the leaf\n         *  the result would be (the prime ' marks indicates nodes that are created as clones):\n         *\n         *   SPLITTING OFF 'RIGHT' TREE       SPLITTING OFF 'LEFT' TREE\n         *\n         *     <div>            <div>'              <div>'      <div>\n         *      / \\              / \\                 / \\          |\n         * <span> <span>   <span>' <span>       <span> <span>   <span>\n         *   / \\    |        |      / \\           /\\     /\\       /\\\n         *  1   2   3        4     5   6         1  2   3  4     5  6\n         *\n         *  The above example represents splitting off the 'right' or 'left' part of a tree, where\n         *  the <div>' would be returned as an element not appended to the DOM, and the <div>\n         *  would remain in place where it was\n         *\n        */\n        splitOffDOMTree: function (rootNode, leafNode, splitLeft) {\n            var splitOnNode = leafNode,\n                createdNode = null,\n                splitRight = !splitLeft;\n\n            // loop until we hit the root\n            while (splitOnNode !== rootNode) {\n                var currParent = splitOnNode.parentNode,\n                    newParent = currParent.cloneNode(false),\n                    targetNode = (splitRight ? splitOnNode : currParent.firstChild),\n                    appendLast;\n\n                // Create a new parent element which is a clone of the current parent\n                if (createdNode) {\n                    if (splitRight) {\n                        // If we're splitting right, add previous created element before siblings\n                        newParent.appendChild(createdNode);\n                    } else {\n                        // If we're splitting left, add previous created element last\n                        appendLast = createdNode;\n                    }\n                }\n                createdNode = newParent;\n\n                while (targetNode) {\n                    var sibling = targetNode.nextSibling;\n                    // Special handling for the 'splitNode'\n                    if (targetNode === splitOnNode) {\n                        if (!targetNode.hasChildNodes()) {\n                            targetNode.parentNode.removeChild(targetNode);\n                        } else {\n                            // For the node we're splitting on, if it has children, we need to clone it\n                            // and not just move it\n                            targetNode = targetNode.cloneNode(false);\n                        }\n                        // If the resulting split node has content, add it\n                        if (targetNode.textContent) {\n                            createdNode.appendChild(targetNode);\n                        }\n\n                        targetNode = (splitRight ? sibling : null);\n                    } else {\n                        // For general case, just remove the element and only\n                        // add it to the split tree if it contains something\n                        targetNode.parentNode.removeChild(targetNode);\n                        if (targetNode.hasChildNodes() || targetNode.textContent) {\n                            createdNode.appendChild(targetNode);\n                        }\n\n                        targetNode = sibling;\n                    }\n                }\n\n                // If we had an element we wanted to append at the end, do that now\n                if (appendLast) {\n                    createdNode.appendChild(appendLast);\n                }\n\n                splitOnNode = currParent;\n            }\n\n            return createdNode;\n        },\n\n        moveTextRangeIntoElement: function (startNode, endNode, newElement) {\n            if (!startNode || !endNode) {\n                return false;\n            }\n\n            var rootNode = this.findCommonRoot(startNode, endNode);\n            if (!rootNode) {\n                return false;\n            }\n\n            if (endNode === startNode) {\n                var temp = startNode.parentNode,\n                    sibling = startNode.nextSibling;\n                temp.removeChild(startNode);\n                newElement.appendChild(startNode);\n                if (sibling) {\n                    temp.insertBefore(newElement, sibling);\n                } else {\n                    temp.appendChild(newElement);\n                }\n                return newElement.hasChildNodes();\n            }\n\n            // create rootChildren array which includes all the children\n            // we care about\n            var rootChildren = [],\n                firstChild,\n                lastChild,\n                nextNode;\n            for (var i = 0; i < rootNode.childNodes.length; i++) {\n                nextNode = rootNode.childNodes[i];\n                if (!firstChild) {\n                    if (this.isDescendant(nextNode, startNode, true)) {\n                        firstChild = nextNode;\n                    }\n                } else {\n                    if (this.isDescendant(nextNode, endNode, true)) {\n                        lastChild = nextNode;\n                        break;\n                    } else {\n                        rootChildren.push(nextNode);\n                    }\n                }\n            }\n\n            var afterLast = lastChild.nextSibling,\n                fragment = rootNode.ownerDocument.createDocumentFragment();\n\n            // build up fragment on startNode side of tree\n            if (firstChild === startNode) {\n                firstChild.parentNode.removeChild(firstChild);\n                fragment.appendChild(firstChild);\n            } else {\n                fragment.appendChild(this.splitOffDOMTree(firstChild, startNode));\n            }\n\n            // add any elements between firstChild & lastChild\n            rootChildren.forEach(function (element) {\n                element.parentNode.removeChild(element);\n                fragment.appendChild(element);\n            });\n\n            // build up fragment on endNode side of the tree\n            if (lastChild === endNode) {\n                lastChild.parentNode.removeChild(lastChild);\n                fragment.appendChild(lastChild);\n            } else {\n                fragment.appendChild(this.splitOffDOMTree(lastChild, endNode, true));\n            }\n\n            // Add fragment into passed in element\n            newElement.appendChild(fragment);\n\n            if (lastChild.parentNode === rootNode) {\n                // If last child is in the root, insert newElement in front of it\n                rootNode.insertBefore(newElement, lastChild);\n            } else if (afterLast) {\n                // If last child was removed, but it had a sibling, insert in front of it\n                rootNode.insertBefore(newElement, afterLast);\n            } else {\n                // lastChild was removed and was the last actual element just append\n                rootNode.appendChild(newElement);\n            }\n\n            return newElement.hasChildNodes();\n        },\n\n        /* based on http://stackoverflow.com/a/6183069 */\n        depthOfNode: function (inNode) {\n            var theDepth = 0,\n                node = inNode;\n            while (node.parentNode !== null) {\n                node = node.parentNode;\n                theDepth++;\n            }\n            return theDepth;\n        },\n\n        findCommonRoot: function (inNode1, inNode2) {\n            var depth1 = this.depthOfNode(inNode1),\n                depth2 = this.depthOfNode(inNode2),\n                node1 = inNode1,\n                node2 = inNode2;\n\n            while (depth1 !== depth2) {\n                if (depth1 > depth2) {\n                    node1 = node1.parentNode;\n                    depth1 -= 1;\n                } else {\n                    node2 = node2.parentNode;\n                    depth2 -= 1;\n                }\n            }\n\n            while (node1 !== node2) {\n                node1 = node1.parentNode;\n                node2 = node2.parentNode;\n            }\n\n            return node1;\n        },\n        /* END - based on http://stackoverflow.com/a/6183069 */\n\n        isElementAtBeginningOfBlock: function (node) {\n            var textVal,\n                sibling;\n            while (!this.isBlockContainer(node) && !this.isMediumEditorElement(node)) {\n                sibling = node;\n                while (sibling = sibling.previousSibling) {\n                    textVal = sibling.nodeType === 3 ? sibling.nodeValue : sibling.textContent;\n                    if (textVal.length > 0) {\n                        return false;\n                    }\n                }\n                node = node.parentNode;\n            }\n            return true;\n        },\n\n        isMediumEditorElement: function (element) {\n            return element && element.nodeType !== 3 && !!element.getAttribute('data-medium-element');\n        },\n\n        isBlockContainer: function (element) {\n            return element && element.nodeType !== 3 && this.parentElements.indexOf(element.nodeName.toLowerCase()) !== -1;\n        },\n\n        getBlockContainer: function (element) {\n            return this.traverseUp(element, function (el) {\n                return Util.isBlockContainer(el) && !Util.isBlockContainer(el.parentNode);\n            });\n        },\n\n        getFirstSelectableLeafNode: function (element) {\n            while (element && element.firstChild) {\n                element = element.firstChild;\n            }\n            var emptyElements = ['br', 'col', 'colgroup', 'hr', 'img', 'input', 'source', 'wbr'];\n            while (emptyElements.indexOf(element.nodeName.toLowerCase()) !== -1) {\n                // We don't want to set the selection to an element that can't have children, this messes up Gecko.\n                element = element.parentNode;\n            }\n            // Selecting at the beginning of a table doesn't work in PhantomJS.\n            if (element.nodeName.toLowerCase() === 'table') {\n                var firstCell = element.querySelector('th, td');\n                if (firstCell) {\n                    element = firstCell;\n                }\n            }\n            return element;\n        },\n\n        getFirstTextNode: function (element) {\n            if (element.nodeType === 3) {\n                return element;\n            }\n\n            for (var i = 0; i < element.childNodes.length; i++) {\n                var textNode = this.getFirstTextNode(element.childNodes[i]);\n                if (textNode !== null) {\n                    return textNode;\n                }\n            }\n            return null;\n        },\n\n        ensureUrlHasProtocol: function (url) {\n            if (url.indexOf('://') === -1) {\n                return 'http://' + url;\n            }\n            return url;\n        },\n\n        warn: function () {\n            if (window.console !== undefined && typeof window.console.warn === 'function') {\n                window.console.warn.apply(window.console, arguments);\n            }\n        },\n\n        deprecated: function (oldName, newName, version) {\n            // simple deprecation warning mechanism.\n            var m = oldName + ' is deprecated, please use ' + newName + ' instead.';\n            if (version) {\n                m += ' Will be removed in ' + version;\n            }\n            Util.warn(m);\n        },\n\n        deprecatedMethod: function (oldName, newName, args, version) {\n            // run the replacement and warn when someone calls a deprecated method\n            Util.deprecated(oldName, newName, version);\n            if (typeof this[newName] === 'function') {\n                this[newName].apply(this, args);\n            }\n        },\n\n        cleanupAttrs: function (el, attrs) {\n            attrs.forEach(function (attr) {\n                el.removeAttribute(attr);\n            });\n        },\n\n        cleanupTags: function (el, tags) {\n            tags.forEach(function (tag) {\n                if (el.tagName.toLowerCase() === tag) {\n                    el.parentNode.removeChild(el);\n                }\n            }, this);\n        },\n\n        // get the closest parent\n        getClosestTag: function (el, tag) {\n            return this.traverseUp(el, function (element) {\n                return element.tagName.toLowerCase() === tag.toLowerCase();\n            });\n        },\n\n        unwrap: function (el, doc) {\n            var fragment = doc.createDocumentFragment(),\n                nodes = Array.prototype.slice.call(el.childNodes);\n\n            // cast nodeList to array since appending child\n            // to a different node will alter length of el.childNodes\n            for (var i = 0; i < nodes.length; i++) {\n                fragment.appendChild(nodes[i]);\n            }\n\n            if (fragment.childNodes.length) {\n                el.parentNode.replaceChild(fragment, el);\n            } else {\n                el.parentNode.removeChild(el);\n            }\n        },\n\n        setObject: function (name, value, context) {\n            // summary:\n            //      Set a property from a dot-separated string, such as 'A.B.C'\n            var parts = name.split('.'),\n                p = parts.pop(),\n                obj = getProp(parts, true, context);\n            return obj && p ? (obj[p] = value) : undefined; // Object\n        },\n\n        getObject: function (name, create, context) {\n            // summary:\n            //      Get a property from a dot-separated string, such as 'A.B.C'\n            return getProp(name ? name.split('.') : [], create, context); // Object\n        }\n\n    };\n}(window));\n\nvar ButtonsData;\n(function () {\n    'use strict';\n\n    ButtonsData = {\n        'bold': {\n            name: 'bold',\n            action: 'bold',\n            aria: 'bold',\n            tagNames: ['b', 'strong'],\n            style: {\n                prop: 'font-weight',\n                value: '700|bold'\n            },\n            useQueryState: true,\n            contentDefault: '<b>B</b>',\n            contentFA: '<i class=\"fa fa-bold\"></i>',\n            key: 'B'\n        },\n        'italic': {\n            name: 'italic',\n            action: 'italic',\n            aria: 'italic',\n            tagNames: ['i', 'em'],\n            style: {\n                prop: 'font-style',\n                value: 'italic'\n            },\n            useQueryState: true,\n            contentDefault: '<b><i>I</i></b>',\n            contentFA: '<i class=\"fa fa-italic\"></i>',\n            key: 'I'\n        },\n        'underline': {\n            name: 'underline',\n            action: 'underline',\n            aria: 'underline',\n            tagNames: ['u'],\n            style: {\n                prop: 'text-decoration',\n                value: 'underline'\n            },\n            useQueryState: true,\n            contentDefault: '<b><u>U</u></b>',\n            contentFA: '<i class=\"fa fa-underline\"></i>',\n            key: 'U'\n        },\n        'strikethrough': {\n            name: 'strikethrough',\n            action: 'strikethrough',\n            aria: 'strike through',\n            tagNames: ['strike'],\n            style: {\n                prop: 'text-decoration',\n                value: 'line-through'\n            },\n            useQueryState: true,\n            contentDefault: '<s>A</s>',\n            contentFA: '<i class=\"fa fa-strikethrough\"></i>'\n        },\n        'superscript': {\n            name: 'superscript',\n            action: 'superscript',\n            aria: 'superscript',\n            tagNames: ['sup'],\n            /* firefox doesn't behave the way we want it to, so we CAN'T use queryCommandState for superscript\n               https://github.com/guardian/scribe/blob/master/BROWSERINCONSISTENCIES.md#documentquerycommandstate */\n            // useQueryState: true\n            contentDefault: '<b>x<sup>1</sup></b>',\n            contentFA: '<i class=\"fa fa-superscript\"></i>'\n        },\n        'subscript': {\n            name: 'subscript',\n            action: 'subscript',\n            aria: 'subscript',\n            tagNames: ['sub'],\n            /* firefox doesn't behave the way we want it to, so we CAN'T use queryCommandState for subscript\n               https://github.com/guardian/scribe/blob/master/BROWSERINCONSISTENCIES.md#documentquerycommandstate */\n            // useQueryState: true\n            contentDefault: '<b>x<sub>1</sub></b>',\n            contentFA: '<i class=\"fa fa-subscript\"></i>'\n        },\n        'image': {\n            name: 'image',\n            action: 'image',\n            aria: 'image',\n            tagNames: ['img'],\n            contentDefault: '<b>image</b>',\n            contentFA: '<i class=\"fa fa-picture-o\"></i>'\n        },\n        'quote': {\n            name: 'quote',\n            action: 'append-blockquote',\n            aria: 'blockquote',\n            tagNames: ['blockquote'],\n            contentDefault: '<b>&ldquo;</b>',\n            contentFA: '<i class=\"fa fa-quote-right\"></i>'\n        },\n        'orderedlist': {\n            name: 'orderedlist',\n            action: 'insertorderedlist',\n            aria: 'ordered list',\n            tagNames: ['ol'],\n            useQueryState: true,\n            contentDefault: '<b>1.</b>',\n            contentFA: '<i class=\"fa fa-list-ol\"></i>'\n        },\n        'unorderedlist': {\n            name: 'unorderedlist',\n            action: 'insertunorderedlist',\n            aria: 'unordered list',\n            tagNames: ['ul'],\n            useQueryState: true,\n            contentDefault: '<b>&bull;</b>',\n            contentFA: '<i class=\"fa fa-list-ul\"></i>'\n        },\n        'pre': {\n            name: 'pre',\n            action: 'append-pre',\n            aria: 'preformatted text',\n            tagNames: ['pre'],\n            contentDefault: '<b>0101</b>',\n            contentFA: '<i class=\"fa fa-code fa-lg\"></i>'\n        },\n        'indent': {\n            name: 'indent',\n            action: 'indent',\n            aria: 'indent',\n            tagNames: [],\n            contentDefault: '<b>&rarr;</b>',\n            contentFA: '<i class=\"fa fa-indent\"></i>'\n        },\n        'outdent': {\n            name: 'outdent',\n            action: 'outdent',\n            aria: 'outdent',\n            tagNames: [],\n            contentDefault: '<b>&larr;</b>',\n            contentFA: '<i class=\"fa fa-outdent\"></i>'\n        },\n        'justifyCenter': {\n            name: 'justifyCenter',\n            action: 'justifyCenter',\n            aria: 'center justify',\n            tagNames: [],\n            style: {\n                prop: 'text-align',\n                value: 'center'\n            },\n            contentDefault: '<b>C</b>',\n            contentFA: '<i class=\"fa fa-align-center\"></i>'\n        },\n        'justifyFull': {\n            name: 'justifyFull',\n            action: 'justifyFull',\n            aria: 'full justify',\n            tagNames: [],\n            style: {\n                prop: 'text-align',\n                value: 'justify'\n            },\n            contentDefault: '<b>J</b>',\n            contentFA: '<i class=\"fa fa-align-justify\"></i>'\n        },\n        'justifyLeft': {\n            name: 'justifyLeft',\n            action: 'justifyLeft',\n            aria: 'left justify',\n            tagNames: [],\n            style: {\n                prop: 'text-align',\n                value: 'left'\n            },\n            contentDefault: '<b>L</b>',\n            contentFA: '<i class=\"fa fa-align-left\"></i>'\n        },\n        'justifyRight': {\n            name: 'justifyRight',\n            action: 'justifyRight',\n            aria: 'right justify',\n            tagNames: [],\n            style: {\n                prop: 'text-align',\n                value: 'right'\n            },\n            contentDefault: '<b>R</b>',\n            contentFA: '<i class=\"fa fa-align-right\"></i>'\n        },\n        'header1': {\n            name: 'header1',\n            action: function (options) {\n                return 'append-' + options.firstHeader;\n            },\n            aria: function (options) {\n                return options.firstHeader;\n            },\n            tagNames: function (options) {\n                return [options.firstHeader];\n            },\n            contentDefault: '<b>H1</b>'\n        },\n        'header2': {\n            name: 'header2',\n            action: function (options) {\n                return 'append-' + options.secondHeader;\n            },\n            aria: function (options) {\n                return options.secondHeader;\n            },\n            tagNames: function (options) {\n                return [options.secondHeader];\n            },\n            contentDefault: '<b>H2</b>'\n        },\n        // Known inline elements that are not removed, or not removed consistantly across browsers:\n        // <span>, <label>, <br>\n        'removeFormat': {\n            name: 'removeFormat',\n            aria: 'remove formatting',\n            action: 'removeFormat',\n            contentDefault: '<b>X</b>',\n            contentFA: '<i class=\"fa fa-eraser\"></i>'\n        }\n    };\n\n})();\nvar editorDefaults;\n(function () {\n    // summary: The default options hash used by the Editor\n\n    editorDefaults = {\n        allowMultiParagraphSelection: true,\n        buttons: ['bold', 'italic', 'underline', 'anchor', 'header1', 'header2', 'quote'],\n        buttonLabels: false,\n        delay: 0,\n        diffLeft: 0,\n        diffTop: -10,\n        disableReturn: false,\n        disableDoubleReturn: false,\n        disableToolbar: false,\n        disableEditing: false,\n        autoLink: false,\n        toolbarAlign: 'center',\n        elementsContainer: false,\n        imageDragging: true,\n        standardizeSelectionStart: false,\n        contentWindow: window,\n        ownerDocument: document,\n        firstHeader: 'h3',\n        secondHeader: 'h4',\n        targetBlank: false,\n        extensions: {},\n        activeButtonClass: 'medium-editor-button-active',\n        firstButtonClass: 'medium-editor-button-first',\n        lastButtonClass: 'medium-editor-button-last',\n        spellcheck: true\n    };\n})();\n\nvar Extension;\n(function () {\n    'use strict';\n\n    /* global Util */\n\n    Extension = function (options) {\n        Util.extend(this, options);\n    };\n\n    Extension.extend = function (protoProps) {\n        // magic extender thinger. mostly borrowed from backbone/goog.inherits\n        // place this function on some thing you want extend-able.\n        //\n        // example:\n        //\n        //      function Thing(args){\n        //          this.options = args;\n        //      }\n        //\n        //      Thing.prototype = { foo: \"bar\" };\n        //      Thing.extend = extenderify;\n        //\n        //      var ThingTwo = Thing.extend({ foo: \"baz\" });\n        //\n        //      var thingOne = new Thing(); // foo === \"bar\"\n        //      var thingTwo = new ThingTwo(); // foo === \"baz\"\n        //\n        //      which seems like some simply shallow copy nonsense\n        //      at first, but a lot more is going on there.\n        //\n        //      passing a `constructor` to the extend props\n        //      will cause the instance to instantiate through that\n        //      instead of the parent's constructor.\n\n        var parent = this,\n            child;\n\n        // The constructor function for the new subclass is either defined by you\n        // (the \"constructor\" property in your `extend` definition), or defaulted\n        // by us to simply call the parent's constructor.\n\n        if (protoProps && protoProps.hasOwnProperty('constructor')) {\n            child = protoProps.constructor;\n        } else {\n            child = function () {\n                return parent.apply(this, arguments);\n            };\n        }\n\n        // das statics (.extend comes over, so your subclass can have subclasses too)\n        Util.extend(child, parent);\n\n        // Set the prototype chain to inherit from `parent`, without calling\n        // `parent`'s constructor function.\n        var Surrogate = function () {\n            this.constructor = child;\n        };\n        Surrogate.prototype = parent.prototype;\n        child.prototype = new Surrogate();\n\n        if (protoProps) {\n            Util.extend(child.prototype, protoProps);\n        }\n\n        // todo: $super?\n\n        return child;\n    };\n\n    Extension.prototype = {\n        /* init: [function]\n         *\n         * Called by MediumEditor during initialization.\n         * The .base property will already have been set to\n         * current instance of MediumEditor when this is called.\n         * All helper methods will exist as well\n         */\n        init: function () {},\n\n        /* base: [MediumEditor instance]\n         *\n         * If not overriden, this will be set to the current instance\n         * of MediumEditor, before the init method is called\n         */\n        base: undefined,\n\n        /* name: [string]\n         *\n         * 'name' of the extension, used for retrieving the extension.\n         * If not set, MediumEditor will set this to be the key\n         * used when passing the extension into MediumEditor via the\n         * 'extensions' option\n         */\n        name: undefined,\n\n        /* checkState: [function (node)]\n         *\n         * If implemented, this function will be called one or more times\n         * the state of the editor & toolbar are updated.\n         * When the state is updated, the editor does the following:\n         *\n         * 1) Find the parent node containing the current selection\n         * 2) Call checkState on the extension, passing the node as an argument\n         * 3) Get the parent node of the previous node\n         * 4) Repeat steps #2 and #3 until we move outside the parent contenteditable\n         */\n        checkState: undefined,\n\n        /* destroy: [function ()]\n         *\n         * This method should remove any created html, custom event handlers\n         * or any other cleanup tasks that should be performed.\n         * If implemented, this function will be called when MediumEditor's\n         * destroy method has been called.\n         */\n        destroy: undefined,\n\n        /* As alternatives to checkState, these functions provide a more structured\n         * path to updating the state of an extension (usually a button) whenever\n         * the state of the editor & toolbar are updated.\n         */\n\n        /* queryCommandState: [function ()]\n         *\n         * If implemented, this function will be called once on each extension\n         * when the state of the editor/toolbar is being updated.\n         *\n         * If this function returns a non-null value, the extension will\n         * be ignored as the code climbs the dom tree.\n         *\n         * If this function returns true, and the setActive() function is defined\n         * setActive() will be called\n         */\n        queryCommandState: undefined,\n\n        /* isActive: [function ()]\n         *\n         * If implemented, this function will be called when MediumEditor\n         * has determined that this extension is 'active' for the current selection.\n         * This may be called when the editor & toolbar are being updated,\n         * but only if queryCommandState() or isAlreadyApplied() functions\n         * are implemented, and when called, return true.\n         */\n        isActive: undefined,\n\n        /* isAlreadyApplied: [function (node)]\n         *\n         * If implemented, this function is similar to checkState() in\n         * that it will be called repeatedly as MediumEditor moves up\n         * the DOM to update the editor & toolbar after a state change.\n         *\n         * NOTE: This function will NOT be called if checkState() has\n         * been implemented. This function will NOT be called if\n         * queryCommandState() is implemented and returns a non-null\n         * value when called\n         */\n        isAlreadyApplied: undefined,\n\n        /* setActive: [function ()]\n         *\n         * If implemented, this function is called when MediumEditor knows\n         * that this extension is currently enabled.  Currently, this\n         * function is called when updating the editor & toolbar, and\n         * only if queryCommandState() or isAlreadyApplied(node) return\n         * true when called\n         */\n        setActive: undefined,\n\n        /* setInactive: [function ()]\n         *\n         * If implemented, this function is called when MediumEditor knows\n         * that this extension is currently disabled.  Curently, this\n         * is called at the beginning of each state change for\n         * the editor & toolbar. After calling this, MediumEditor\n         * will attempt to update the extension, either via checkState()\n         * or the combination of queryCommandState(), isAlreadyApplied(node),\n         * isActive(), and setActive()\n         */\n        setInactive: undefined,\n\n        /************************ Helpers ************************\n         * The following are helpers that are either set by MediumEditor\n         * during initialization, or are helper methods which either\n         * route calls to the MediumEditor instance or provide common\n         * functionality for all extensions\n         *********************************************************/\n\n        /* window: [Window]\n         *\n         * If not overriden, this will be set to the window object\n         * to be used by MediumEditor and its extensions.  This is\n         * passed via the 'contentWindow' option to MediumEditor\n         * and is the global 'window' object by default\n         */\n        'window': undefined,\n\n        /* document: [Document]\n         *\n         * If not overriden, this will be set to the document object\n         * to be used by MediumEditor and its extensions. This is\n         * passed via the 'ownerDocument' optin to MediumEditor\n         * and is the global 'document' object by default\n         */\n        'document': undefined,\n\n        /* getEditorElements: [function ()]\n         *\n         * Helper function which returns an array containing\n         * all the contenteditable elements for this instance\n         * of MediumEditor\n         */\n        getEditorElements: function () {\n            return this.base.elements;\n        },\n\n        /* getEditorId: [function ()]\n         *\n         * Helper function which returns a unique identifier\n         * for this instance of MediumEditor\n         */\n        getEditorId: function () {\n            return this.base.id;\n        },\n\n        /* getEditorOptions: [function (option)]\n         *\n         * Helper function which returns the value of an option\n         * used to initialize this instance of MediumEditor\n         */\n        getEditorOption: function (option) {\n            return this.base.options[option];\n        }\n    };\n\n    /* List of method names to add to the prototype of Extension\n     * Each of these methods will be defined as helpers that\n     * just call directly into the MediumEditor instance.\n     *\n     * example for 'on' method:\n     * Extension.prototype.on = function () {\n     *     return this.base.on.apply(this.base, arguments);\n     * }\n     */\n    [\n        // general helpers\n        'execAction',\n\n        // event handling\n        'on',\n        'off',\n        'subscribe'\n\n    ].forEach(function (helper) {\n        Extension.prototype[helper] = function () {\n            return this.base[helper].apply(this.base, arguments);\n        };\n    });\n})();\n\nvar Selection;\n\n(function () {\n    'use strict';\n\n    function filterOnlyParentElements(node) {\n        if (Util.isBlockContainer(node)) {\n            return NodeFilter.FILTER_ACCEPT;\n        } else {\n            return NodeFilter.FILTER_SKIP;\n        }\n    }\n\n    Selection = {\n        findMatchingSelectionParent: function (testElementFunction, contentWindow) {\n            var selection = contentWindow.getSelection(),\n                range,\n                current;\n\n            if (selection.rangeCount === 0) {\n                return false;\n            }\n\n            range = selection.getRangeAt(0);\n            current = range.commonAncestorContainer;\n\n            return Util.traverseUp(current, testElementFunction);\n        },\n\n        getSelectionElement: function (contentWindow) {\n            return this.findMatchingSelectionParent(function (el) {\n                return el.getAttribute('data-medium-element');\n            }, contentWindow);\n        },\n\n        // Utility method called from importSelection only\n        importSelectionMoveCursorPastAnchor: function (selectionState, range) {\n            var nodeInsideAnchorTagFunction = function (node) {\n                return node.nodeName.toLowerCase() === 'a';\n            };\n            if (selectionState.start === selectionState.end &&\n                    range.startContainer.nodeType === 3 &&\n                    range.startOffset === range.startContainer.nodeValue.length &&\n                    Util.traverseUp(range.startContainer, nodeInsideAnchorTagFunction)) {\n                var prevNode = range.startContainer,\n                    currentNode = range.startContainer.parentNode;\n                while (currentNode !== null && currentNode.nodeName.toLowerCase() !== 'a') {\n                    if (currentNode.childNodes[currentNode.childNodes.length - 1] !== prevNode) {\n                        currentNode = null;\n                    } else {\n                        prevNode = currentNode;\n                        currentNode = currentNode.parentNode;\n                    }\n                }\n                if (currentNode !== null && currentNode.nodeName.toLowerCase() === 'a') {\n                    var currentNodeIndex = null;\n                    for (var i = 0; currentNodeIndex === null && i < currentNode.parentNode.childNodes.length; i++) {\n                        if (currentNode.parentNode.childNodes[i] === currentNode) {\n                            currentNodeIndex = i;\n                        }\n                    }\n                    range.setStart(currentNode.parentNode, currentNodeIndex + 1);\n                    range.collapse(true);\n                }\n            }\n            return range;\n        },\n\n        // Returns 0 unless the cursor is within or preceded by empty paragraphs/blocks,\n        // in which case it returns the count of such preceding paragraphs, including\n        // the empty paragraph in which the cursor itself may be embedded.\n        getIndexRelativeToAdjacentEmptyBlocks: function (doc, root, cursorContainer, cursorOffset) {\n            // If there is text in front of the cursor, that means there isn't only empty blocks before it\n            if (cursorContainer.nodeType === 3 && cursorOffset > 0) {\n                return 0;\n            }\n\n            // Check if the block that contains the cursor has any other text in front of the cursor\n            var node = cursorContainer;\n            if (node.nodeType !== 3) {\n                //node = cursorContainer.childNodes.length === cursorOffset ? null : cursorContainer.childNodes[cursorOffset];\n                node = cursorContainer.childNodes[cursorOffset];\n            }\n            if (node && !Util.isElementAtBeginningOfBlock(node)) {\n                return 0;\n            }\n\n            // Walk over block elements, counting number of empty blocks between last piece of text\n            // and the block the cursor is in\n            var treeWalker = doc.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, filterOnlyParentElements, false),\n                emptyBlocksCount = 0;\n            while (treeWalker.nextNode()) {\n                var blockIsEmpty = treeWalker.currentNode.textContent === '';\n                if (blockIsEmpty || emptyBlocksCount > 0) {\n                    emptyBlocksCount += 1;\n                }\n                if (Util.isDescendant(treeWalker.currentNode, cursorContainer, true)) {\n                    return emptyBlocksCount;\n                }\n                if (!blockIsEmpty) {\n                    emptyBlocksCount = 0;\n                }\n            }\n\n            return emptyBlocksCount;\n        },\n\n        selectionInContentEditableFalse: function (contentWindow) {\n            // determine if the current selection is exclusively inside\n            // a contenteditable=\"false\", though treat the case of an\n            // explicit contenteditable=\"true\" inside a \"false\" as false.\n            var sawtrue,\n                sawfalse = this.findMatchingSelectionParent(function (el) {\n                    var ce = el && el.getAttribute('contenteditable');\n                    if (ce === 'true') {\n                        sawtrue = true;\n                    }\n                    return el.nodeName !== '#text' && ce === 'false';\n                }, contentWindow);\n\n            return !sawtrue && sawfalse;\n        },\n\n        // http://stackoverflow.com/questions/4176923/html-of-selected-text\n        // by Tim Down\n        getSelectionHtml: function getSelectionHtml() {\n            var i,\n                html = '',\n                sel = this.options.contentWindow.getSelection(),\n                len,\n                container;\n            if (sel.rangeCount) {\n                container = this.options.ownerDocument.createElement('div');\n                for (i = 0, len = sel.rangeCount; i < len; i += 1) {\n                    container.appendChild(sel.getRangeAt(i).cloneContents());\n                }\n                html = container.innerHTML;\n            }\n            return html;\n        },\n\n        /**\n         *  Find the caret position within an element irrespective of any inline tags it may contain.\n         *\n         *  @param {DOMElement} An element containing the cursor to find offsets relative to.\n         *  @param {Range} A Range representing cursor position. Will window.getSelection if none is passed.\n         *  @return {Object} 'left' and 'right' attributes contain offsets from begining and end of Element\n         */\n        getCaretOffsets: function getCaretOffsets(element, range) {\n            var preCaretRange, postCaretRange;\n\n            if (!range) {\n                range = window.getSelection().getRangeAt(0);\n            }\n\n            preCaretRange = range.cloneRange();\n            postCaretRange = range.cloneRange();\n\n            preCaretRange.selectNodeContents(element);\n            preCaretRange.setEnd(range.endContainer, range.endOffset);\n\n            postCaretRange.selectNodeContents(element);\n            postCaretRange.setStart(range.endContainer, range.endOffset);\n\n            return {\n                left: preCaretRange.toString().length,\n                right: postCaretRange.toString().length\n            };\n        },\n\n        // http://stackoverflow.com/questions/15867542/range-object-get-selection-parent-node-chrome-vs-firefox\n        rangeSelectsSingleNode: function (range) {\n            var startNode = range.startContainer;\n            return startNode === range.endContainer &&\n                startNode.hasChildNodes() &&\n                range.endOffset === range.startOffset + 1;\n        },\n\n        getSelectedParentElement: function (range) {\n            if (!range) {\n                return null;\n            }\n\n            // Selection encompasses a single element\n            if (this.rangeSelectsSingleNode(range) && range.startContainer.childNodes[range.startOffset].nodeType !== 3) {\n                return range.startContainer.childNodes[range.startOffset];\n            }\n\n            // Selection range starts inside a text node, so get its parent\n            if (range.startContainer.nodeType === 3) {\n                return range.startContainer.parentNode;\n            }\n\n            // Selection starts inside an element\n            return range.startContainer;\n        },\n\n        getSelectedElements: function (doc) {\n            var selection = doc.getSelection(),\n                range,\n                toRet,\n                currNode;\n\n            if (!selection.rangeCount || selection.isCollapsed || !selection.getRangeAt(0).commonAncestorContainer) {\n                return [];\n            }\n\n            range = selection.getRangeAt(0);\n\n            if (range.commonAncestorContainer.nodeType === 3) {\n                toRet = [];\n                currNode = range.commonAncestorContainer;\n                while (currNode.parentNode && currNode.parentNode.childNodes.length === 1) {\n                    toRet.push(currNode.parentNode);\n                    currNode = currNode.parentNode;\n                }\n\n                return toRet;\n            }\n\n            return [].filter.call(range.commonAncestorContainer.getElementsByTagName('*'), function (el) {\n                return (typeof selection.containsNode === 'function') ? selection.containsNode(el, true) : true;\n            });\n        },\n\n        selectNode: function (node, doc) {\n            var range = doc.createRange(),\n                sel = doc.getSelection();\n\n            range.selectNodeContents(node);\n            sel.removeAllRanges();\n            sel.addRange(range);\n        },\n\n        select: function (doc, startNode, startOffset, endNode, endOffset) {\n            doc.getSelection().removeAllRanges();\n            var range = doc.createRange();\n            range.setStart(startNode, startOffset);\n            if (endNode) {\n                range.setEnd(endNode, endOffset);\n            } else {\n                range.collapse(true);\n            }\n            doc.getSelection().addRange(range);\n            return range;\n        },\n\n        /**\n         * Move cursor to the given node with the given offset.\n         *\n         * @param  {DomDocument} doc     Current document\n         * @param  {DomElement}  node    Element where to jump\n         * @param  {integer}     offset  Where in the element should we jump, 0 by default\n         */\n        moveCursor: function (doc, node, offset) {\n            var range, sel,\n                startOffset = offset || 0;\n\n            range = doc.createRange();\n            sel = doc.getSelection();\n\n            range.setStart(node, startOffset);\n            range.collapse(true);\n\n            sel.removeAllRanges();\n            sel.addRange(range);\n        },\n\n        getSelectionRange: function (ownerDocument) {\n            var selection = ownerDocument.getSelection();\n            if (selection.rangeCount === 0) {\n                return null;\n            }\n            return selection.getRangeAt(0);\n        },\n\n        // http://stackoverflow.com/questions/1197401/how-can-i-get-the-element-the-caret-is-in-with-javascript-when-using-contentedi\n        // by You\n        getSelectionStart: function (ownerDocument) {\n            var node = ownerDocument.getSelection().anchorNode,\n                startNode = (node && node.nodeType === 3 ? node.parentNode : node);\n\n            return startNode;\n        },\n\n        getSelectionData: function (el) {\n            var tagName;\n\n            if (el && el.tagName) {\n                tagName = el.tagName.toLowerCase();\n            }\n\n            while (el && !Util.isBlockContainer(el)) {\n                el = el.parentNode;\n                if (el && el.tagName) {\n                    tagName = el.tagName.toLowerCase();\n                }\n            }\n\n            return {\n                el: el,\n                tagName: tagName\n            };\n        }\n    };\n}());\n\nvar Events;\n\n(function () {\n    'use strict';\n\n    Events = function (instance) {\n        this.base = instance;\n        this.options = this.base.options;\n        this.events = [];\n        this.customEvents = {};\n        this.listeners = {};\n    };\n\n    Events.prototype = {\n        InputEventOnContenteditableSupported: !Util.isIE,\n\n        // Helpers for event handling\n\n        attachDOMEvent: function (target, event, listener, useCapture) {\n            target.addEventListener(event, listener, useCapture);\n            this.events.push([target, event, listener, useCapture]);\n        },\n\n        detachDOMEvent: function (target, event, listener, useCapture) {\n            var index = this.indexOfListener(target, event, listener, useCapture),\n                e;\n            if (index !== -1) {\n                e = this.events.splice(index, 1)[0];\n                e[0].removeEventListener(e[1], e[2], e[3]);\n            }\n        },\n\n        indexOfListener: function (target, event, listener, useCapture) {\n            var i, n, item;\n            for (i = 0, n = this.events.length; i < n; i = i + 1) {\n                item = this.events[i];\n                if (item[0] === target && item[1] === event && item[2] === listener && item[3] === useCapture) {\n                    return i;\n                }\n            }\n            return -1;\n        },\n\n        detachAllDOMEvents: function () {\n            var e = this.events.pop();\n            while (e) {\n                e[0].removeEventListener(e[1], e[2], e[3]);\n                e = this.events.pop();\n            }\n        },\n\n        // custom events\n        attachCustomEvent: function (event, listener) {\n            this.setupListener(event);\n            if (!this.customEvents[event]) {\n                this.customEvents[event] = [];\n            }\n            this.customEvents[event].push(listener);\n        },\n\n        detachCustomEvent: function (event, listener) {\n            var index = this.indexOfCustomListener(event, listener);\n            if (index !== -1) {\n                this.customEvents[event].splice(index, 1);\n                // TODO: If array is empty, should detach internal listeners via destroyListener()\n            }\n        },\n\n        indexOfCustomListener: function (event, listener) {\n            if (!this.customEvents[event] || !this.customEvents[event].length) {\n                return -1;\n            }\n\n            return this.customEvents[event].indexOf(listener);\n        },\n\n        detachAllCustomEvents: function () {\n            this.customEvents = {};\n            // TODO: Should detach internal listeners here via destroyListener()\n        },\n\n        triggerCustomEvent: function (name, data, editable) {\n            if (this.customEvents[name]) {\n                this.customEvents[name].forEach(function (listener) {\n                    listener(data, editable);\n                });\n            }\n        },\n\n        // Cleaning up\n\n        destroy: function () {\n            this.detachAllDOMEvents();\n            this.detachAllCustomEvents();\n            this.detachExecCommand();\n\n            if (this.base.elements) {\n                this.base.elements.forEach(function (element) {\n                    element.removeAttribute('data-medium-focused');\n                });\n            }\n        },\n\n        // Listening to calls to document.execCommand\n\n        // Attach a listener to be notified when document.execCommand is called\n        attachToExecCommand: function () {\n            if (this.execCommandListener) {\n                return;\n            }\n\n            // Store an instance of the listener so:\n            // 1) We only attach to execCommand once\n            // 2) We can remove the listener later\n            this.execCommandListener = function (execInfo) {\n                this.handleDocumentExecCommand(execInfo);\n            }.bind(this);\n\n            // Ensure that execCommand has been wrapped correctly\n            this.wrapExecCommand();\n\n            // Add listener to list of execCommand listeners\n            this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener);\n        },\n\n        // Remove our listener for calls to document.execCommand\n        detachExecCommand: function () {\n            var doc = this.options.ownerDocument;\n            if (!this.execCommandListener || !doc.execCommand.listeners) {\n                return;\n            }\n\n            // Find the index of this listener in the array of listeners so it can be removed\n            var index = doc.execCommand.listeners.indexOf(this.execCommandListener);\n            if (index !== -1) {\n                doc.execCommand.listeners.splice(index, 1);\n            }\n\n            // If the list of listeners is now empty, put execCommand back to its original state\n            if (!doc.execCommand.listeners.length) {\n                this.unwrapExecCommand();\n            }\n        },\n\n        // Wrap document.execCommand in a custom method so we can listen to calls to it\n        wrapExecCommand: function () {\n            var doc = this.options.ownerDocument;\n\n            // Ensure all instance of MediumEditor only wrap execCommand once\n            if (doc.execCommand.listeners) {\n                return;\n            }\n\n            // Create a wrapper method for execCommand which will:\n            // 1) Call document.execCommand with the correct arguments\n            // 2) Loop through any listeners and notify them that execCommand was called\n            //    passing extra info on the call\n            // 3) Return the result\n            var wrapper = function (aCommandName, aShowDefaultUI, aValueArgument) {\n                var result = doc.execCommand.orig.apply(this, arguments);\n\n                if (!doc.execCommand.listeners) {\n                    return result;\n                }\n\n                var args = Array.prototype.slice.call(arguments);\n                doc.execCommand.listeners.forEach(function (listener) {\n                    listener({\n                        command: aCommandName,\n                        value: aValueArgument,\n                        args: args,\n                        result: result\n                    });\n                });\n\n                return result;\n            };\n\n            // Store a reference to the original execCommand\n            wrapper.orig = doc.execCommand;\n\n            // Attach an array for storing listeners\n            wrapper.listeners = [];\n\n            // Overwrite execCommand\n            doc.execCommand = wrapper;\n        },\n\n        // Revert document.execCommand back to its original self\n        unwrapExecCommand: function () {\n            var doc = this.options.ownerDocument;\n            if (!doc.execCommand.orig) {\n                return;\n            }\n\n            // Use the reference to the original execCommand to revert back\n            doc.execCommand = doc.execCommand.orig;\n        },\n\n        // Listening to browser events to emit events medium-editor cares about\n        setupListener: function (name) {\n            if (this.listeners[name]) {\n                return;\n            }\n\n            switch (name) {\n                case 'externalInteraction':\n                    // Detecting when user has interacted with elements outside of MediumEditor\n                    this.attachDOMEvent(this.options.ownerDocument.body, 'mousedown', this.handleBodyMousedown.bind(this), true);\n                    this.attachDOMEvent(this.options.ownerDocument.body, 'click', this.handleBodyClick.bind(this), true);\n                    this.attachDOMEvent(this.options.ownerDocument.body, 'focus', this.handleBodyFocus.bind(this), true);\n                    break;\n                case 'blur':\n                    // Detecting when focus is lost\n                    this.setupListener('externalInteraction');\n                    break;\n                case 'focus':\n                    // Detecting when focus moves into some part of MediumEditor\n                    this.setupListener('externalInteraction');\n                    break;\n                case 'editableInput':\n                    // setup cache for knowing when the content has changed\n                    this.contentCache = [];\n                    this.base.elements.forEach(function (element) {\n                        this.contentCache[element.getAttribute('medium-editor-index')] = element.innerHTML;\n\n                        // Attach to the 'oninput' event, handled correctly by most browsers\n                        if (this.InputEventOnContenteditableSupported) {\n                            this.attachDOMEvent(element, 'input', this.handleInput.bind(this));\n                        }\n                    }.bind(this));\n\n                    // For browsers which don't support the input event on contenteditable (IE)\n                    // we'll attach to 'selectionchange' on the document and 'keypress' on the editables\n                    if (!this.InputEventOnContenteditableSupported) {\n                        this.setupListener('editableKeypress');\n                        this.keypressUpdateInput = true;\n                        this.attachDOMEvent(document, 'selectionchange', this.handleDocumentSelectionChange.bind(this));\n                        // Listen to calls to execCommand\n                        this.attachToExecCommand();\n                    }\n                    break;\n                case 'editableClick':\n                    // Detecting click in the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'click', this.handleClick.bind(this));\n                    }.bind(this));\n                    break;\n                case 'editableBlur':\n                    // Detecting blur in the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'blur', this.handleBlur.bind(this));\n                    }.bind(this));\n                    break;\n                case 'editableKeypress':\n                    // Detecting keypress in the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'keypress', this.handleKeypress.bind(this));\n                    }.bind(this));\n                    break;\n                case 'editableKeyup':\n                    // Detecting keyup in the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'keyup', this.handleKeyup.bind(this));\n                    }.bind(this));\n                    break;\n                case 'editableKeydown':\n                    // Detecting keydown on the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'keydown', this.handleKeydown.bind(this));\n                    }.bind(this));\n                    break;\n                case 'editableKeydownEnter':\n                    // Detecting keydown for ENTER on the contenteditables\n                    this.setupListener('editableKeydown');\n                    break;\n                case 'editableKeydownTab':\n                    // Detecting keydown for TAB on the contenteditable\n                    this.setupListener('editableKeydown');\n                    break;\n                case 'editableKeydownDelete':\n                    // Detecting keydown for DELETE/BACKSPACE on the contenteditables\n                    this.setupListener('editableKeydown');\n                    break;\n                case 'editableMouseover':\n                    // Detecting mouseover on the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'mouseover', this.handleMouseover.bind(this));\n                    }, this);\n                    break;\n                case 'editableDrag':\n                    // Detecting dragover and dragleave on the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'dragover', this.handleDragging.bind(this));\n                        this.attachDOMEvent(element, 'dragleave', this.handleDragging.bind(this));\n                    }, this);\n                    break;\n                case 'editableDrop':\n                    // Detecting drop on the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'drop', this.handleDrop.bind(this));\n                    }, this);\n                    break;\n                case 'editablePaste':\n                    // Detecting paste on the contenteditables\n                    this.base.elements.forEach(function (element) {\n                        this.attachDOMEvent(element, 'paste', this.handlePaste.bind(this));\n                    }, this);\n                    break;\n            }\n            this.listeners[name] = true;\n        },\n\n        focusElement: function (element) {\n            element.focus();\n            this.updateFocus(element, { target: element, type: 'focus' });\n        },\n\n        updateFocus: function (target, eventObj) {\n            var toolbarEl = this.base.toolbar ? this.base.toolbar.getToolbarElement() : null,\n                anchorPreview = this.base.getExtensionByName('anchor-preview'),\n                previewEl = (anchorPreview && anchorPreview.getPreviewElement) ? anchorPreview.getPreviewElement() : null,\n                hadFocus = this.base.getFocusedElement(),\n                toFocus;\n\n            // For clicks, we need to know if the mousedown that caused the click happened inside the existing focused element.\n            // If so, we don't want to focus another element\n            if (hadFocus &&\n                    eventObj.type === 'click' &&\n                    this.lastMousedownTarget &&\n                    (Util.isDescendant(hadFocus, this.lastMousedownTarget, true) ||\n                     Util.isDescendant(toolbarEl, this.lastMousedownTarget, true) ||\n                     Util.isDescendant(previewEl, this.lastMousedownTarget, true))) {\n                toFocus = hadFocus;\n            }\n\n            if (!toFocus) {\n                this.base.elements.some(function (element) {\n                    // If the target is part of an editor element, this is the element getting focus\n                    if (!toFocus && (Util.isDescendant(element, target, true))) {\n                        toFocus = element;\n                    }\n\n                    // bail if we found an element that's getting focus\n                    return !!toFocus;\n                }, this);\n            }\n\n            // Check if the target is external (not part of the editor, toolbar, or anchorpreview)\n            var externalEvent = !Util.isDescendant(hadFocus, target, true) &&\n                                !Util.isDescendant(toolbarEl, target, true) &&\n                                !Util.isDescendant(previewEl, target, true);\n\n            if (toFocus !== hadFocus) {\n                // If element has focus, and focus is going outside of editor\n                // Don't blur focused element if clicking on editor, toolbar, or anchorpreview\n                if (hadFocus && externalEvent) {\n                    // Trigger blur on the editable that has lost focus\n                    hadFocus.removeAttribute('data-medium-focused');\n                    this.triggerCustomEvent('blur', eventObj, hadFocus);\n                }\n\n                // If focus is going into an editor element\n                if (toFocus) {\n                    // Trigger focus on the editable that now has focus\n                    toFocus.setAttribute('data-medium-focused', true);\n                    this.triggerCustomEvent('focus', eventObj, toFocus);\n                }\n            }\n\n            if (externalEvent) {\n                this.triggerCustomEvent('externalInteraction', eventObj);\n            }\n        },\n\n        updateInput: function (target, eventObj) {\n            // An event triggered which signifies that the user may have changed someting\n            // Look in our cache of input for the contenteditables to see if something changed\n            var index = target.getAttribute('medium-editor-index');\n            if (target.innerHTML !== this.contentCache[index]) {\n                // The content has changed since the last time we checked, fire the event\n                this.triggerCustomEvent('editableInput', eventObj, target);\n            }\n            this.contentCache[index] = target.innerHTML;\n        },\n\n        handleDocumentSelectionChange: function (event) {\n            // When selectionchange fires, target and current target are set\n            // to document, since this is where the event is handled\n            // However, currentTarget will have an 'activeElement' property\n            // which will point to whatever element has focus.\n            if (event.currentTarget && event.currentTarget.activeElement) {\n                var activeElement = event.currentTarget.activeElement,\n                    currentTarget;\n                // We can look at the 'activeElement' to determine if the selectionchange has\n                // happened within a contenteditable owned by this instance of MediumEditor\n                this.base.elements.some(function (element) {\n                    if (Util.isDescendant(element, activeElement, true)) {\n                        currentTarget = element;\n                        return true;\n                    }\n                    return false;\n                }, this);\n\n                // We know selectionchange fired within one of our contenteditables\n                if (currentTarget) {\n                    this.updateInput(currentTarget, { target: activeElement, currentTarget: currentTarget });\n                }\n            }\n        },\n\n        handleDocumentExecCommand: function () {\n            // document.execCommand has been called\n            // If one of our contenteditables currently has focus, we should\n            // attempt to trigger the 'editableInput' event\n            var target = this.base.getFocusedElement();\n            if (target) {\n                this.updateInput(target, { target: target, currentTarget: target });\n            }\n        },\n\n        handleBodyClick: function (event) {\n            this.updateFocus(event.target, event);\n        },\n\n        handleBodyFocus: function (event) {\n            this.updateFocus(event.target, event);\n        },\n\n        handleBodyMousedown: function (event) {\n            this.lastMousedownTarget = event.target;\n        },\n\n        handleInput: function (event) {\n            this.updateInput(event.currentTarget, event);\n        },\n\n        handleClick: function (event) {\n            this.triggerCustomEvent('editableClick', event, event.currentTarget);\n        },\n\n        handleBlur: function (event) {\n            this.triggerCustomEvent('editableBlur', event, event.currentTarget);\n        },\n\n        handleKeypress: function (event) {\n            this.triggerCustomEvent('editableKeypress', event, event.currentTarget);\n\n            // If we're doing manual detection of the editableInput event we need\n            // to check for input changes during 'keypress'\n            if (this.keypressUpdateInput) {\n                var eventObj = { target: event.target, currentTarget: event.currentTarget };\n\n                // In IE, we need to let the rest of the event stack complete before we detect\n                // changes to input, so using setTimeout here\n                setTimeout(function () {\n                    this.updateInput(eventObj.currentTarget, eventObj);\n                }.bind(this), 0);\n            }\n        },\n\n        handleKeyup: function (event) {\n            this.triggerCustomEvent('editableKeyup', event, event.currentTarget);\n        },\n\n        handleMouseover: function (event) {\n            this.triggerCustomEvent('editableMouseover', event, event.currentTarget);\n        },\n\n        handleDragging: function (event) {\n            this.triggerCustomEvent('editableDrag', event, event.currentTarget);\n        },\n\n        handleDrop: function (event) {\n            this.triggerCustomEvent('editableDrop', event, event.currentTarget);\n        },\n\n        handlePaste: function (event) {\n            this.triggerCustomEvent('editablePaste', event, event.currentTarget);\n        },\n\n        handleKeydown: function (event) {\n            this.triggerCustomEvent('editableKeydown', event, event.currentTarget);\n\n            if (Util.isKey(event, Util.keyCode.ENTER)) {\n                return this.triggerCustomEvent('editableKeydownEnter', event, event.currentTarget);\n            }\n\n            if (Util.isKey(event, Util.keyCode.TAB)) {\n                return this.triggerCustomEvent('editableKeydownTab', event, event.currentTarget);\n            }\n\n            if (Util.isKey(event, [Util.keyCode.DELETE, Util.keyCode.BACKSPACE])) {\n                return this.triggerCustomEvent('editableKeydownDelete', event, event.currentTarget);\n            }\n        }\n    };\n}());\n\n/* istanbul ignore next */\nvar DefaultButton;\n\n/* istanbul ignore next */\n(function () {\n    'use strict';\n\n    DefaultButton = function (options, instance) {\n        Util.deprecated('MediumEditor.statics.DefaultButton', 'MediumEditor.extensions.button', 'v5.0.0');\n\n        this.options = options;\n        this.name = options.name;\n        this.init(instance);\n    };\n\n    DefaultButton.prototype = {\n        init: function (instance) {\n            this.base = instance;\n\n            this.button = this.createButton();\n            this.base.on(this.button, 'click', this.handleClick.bind(this));\n            if (this.options.key) {\n                this.base.subscribe('editableKeydown', this.handleKeydown.bind(this));\n            }\n        },\n        getButton: function () {\n            return this.button;\n        },\n        getAction: function () {\n            return (typeof this.options.action === 'function') ? this.options.action(this.base.options) : this.options.action;\n        },\n        getAria: function () {\n            return (typeof this.options.aria === 'function') ? this.options.aria(this.base.options) : this.options.aria;\n        },\n        getTagNames: function () {\n            return (typeof this.options.tagNames === 'function') ? this.options.tagNames(this.base.options) : this.options.tagNames;\n        },\n        createButton: function () {\n            var button = this.base.options.ownerDocument.createElement('button'),\n                content = this.options.contentDefault,\n                ariaLabel = this.getAria();\n            button.classList.add('medium-editor-action');\n            button.classList.add('medium-editor-action-' + this.name);\n            button.setAttribute('data-action', this.getAction());\n            if (ariaLabel) {\n                button.setAttribute('title', ariaLabel);\n                button.setAttribute('aria-label', ariaLabel);\n            }\n            if (this.base.options.buttonLabels) {\n                if (this.base.options.buttonLabels === 'fontawesome' && this.options.contentFA) {\n                    content = this.options.contentFA;\n                } else if (typeof this.base.options.buttonLabels === 'object' && this.base.options.buttonLabels[this.name]) {\n                    content = this.base.options.buttonLabels[this.options.name];\n                }\n            }\n            button.innerHTML = content;\n            return button;\n        },\n        handleKeydown: function (evt) {\n            var key = String.fromCharCode(evt.which || evt.keyCode).toLowerCase(),\n                action;\n\n            if (this.options.key === key && Util.isMetaCtrlKey(evt)) {\n                evt.preventDefault();\n                evt.stopPropagation();\n\n                action = this.getAction();\n                if (action) {\n                    this.base.execAction(action);\n                }\n            }\n        },\n        handleClick: function (evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n\n            var action = this.getAction();\n\n            if (action) {\n                this.base.execAction(action);\n            }\n        },\n        isActive: function () {\n            return this.button.classList.contains(this.base.options.activeButtonClass);\n        },\n        setInactive: function () {\n            this.button.classList.remove(this.base.options.activeButtonClass);\n            delete this.knownState;\n        },\n        setActive: function () {\n            this.button.classList.add(this.base.options.activeButtonClass);\n            delete this.knownState;\n        },\n        queryCommandState: function () {\n            var queryState = null;\n            if (this.options.useQueryState) {\n                queryState = this.base.queryCommandState(this.getAction());\n            }\n            return queryState;\n        },\n        isAlreadyApplied: function (node) {\n            var isMatch = false,\n                tagNames = this.getTagNames(),\n                styleVals,\n                computedStyle;\n\n            if (this.knownState === false || this.knownState === true) {\n                return this.knownState;\n            }\n\n            if (tagNames && tagNames.length > 0 && node.tagName) {\n                isMatch = tagNames.indexOf(node.tagName.toLowerCase()) !== -1;\n            }\n\n            if (!isMatch && this.options.style) {\n                styleVals = this.options.style.value.split('|');\n                computedStyle = this.base.options.contentWindow.getComputedStyle(node, null).getPropertyValue(this.options.style.prop);\n                styleVals.forEach(function (val) {\n                    if (!this.knownState) {\n                        isMatch = (computedStyle.indexOf(val) !== -1);\n                        // text-decoration is not inherited by default\n                        // so if the computed style for text-decoration doesn't match\n                        // don't write to knownState so we can fallback to other checks\n                        if (isMatch || this.options.style.prop !== 'text-decoration') {\n                            this.knownState = isMatch;\n                        }\n                    }\n                }, this);\n            }\n\n            return isMatch;\n        }\n    };\n}());\n/* istanbul ignore next */\nvar AnchorExtension;\n\n/* istanbul ignore next */\n(function () {\n    'use strict';\n\n    function AnchorDerived() {\n        Util.deprecated('MediumEditor.statics.AnchorExtension', 'MediumEditor.extensions.anchor', 'v5.0.0');\n        this.parent = true;\n        this.options = {\n            name: 'anchor',\n            action: 'createLink',\n            aria: 'link',\n            tagNames: ['a'],\n            contentDefault: '<b>#</b>',\n            contentFA: '<i class=\"fa fa-link\"></i>',\n            key: 'k'\n        };\n        this.name = 'anchor';\n        this.hasForm = true;\n    }\n\n    AnchorDerived.prototype = {\n\n        // Button and Extension handling\n\n        // labels for the anchor-edit form buttons\n        formSaveLabel: '&#10003;',\n        formCloseLabel: '&times;',\n\n        // Called when the button the toolbar is clicked\n        // Overrides DefaultButton.handleClick\n        handleClick: function (evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n\n            var selectedParentElement = Selection.getSelectedParentElement(Selection.getSelectionRange(this.base.options.ownerDocument));\n            if (selectedParentElement.tagName &&\n                    selectedParentElement.tagName.toLowerCase() === 'a') {\n                return this.base.execAction('unlink');\n            }\n\n            if (!this.isDisplayed()) {\n                this.showForm();\n            }\n\n            return false;\n        },\n\n        // Called when user hits the defined shortcut (CTRL / COMMAND + K)\n        // Overrides DefaultButton.handleKeydown\n        handleKeydown: function (evt) {\n            var key = String.fromCharCode(evt.which || evt.keyCode).toLowerCase();\n\n            if (this.options.key === key && Util.isMetaCtrlKey(evt)) {\n                evt.preventDefault();\n                evt.stopPropagation();\n\n                this.handleClick(evt);\n            }\n        },\n\n        // Called by medium-editor to append form to the toolbar\n        getForm: function () {\n            if (!this.form) {\n                this.form = this.createForm();\n            }\n            return this.form;\n        },\n\n        getTemplate: function () {\n\n            var template = [\n                '<input type=\"text\" class=\"medium-editor-toolbar-input\" placeholder=\"', this.base.options.anchorInputPlaceholder, '\">'\n            ];\n\n            template.push(\n                '<a href=\"#\" class=\"medium-editor-toolbar-save\">',\n                this.base.options.buttonLabels === 'fontawesome' ? '<i class=\"fa fa-check\"></i>' : this.formSaveLabel,\n                '</a>'\n            );\n\n            template.push('<a href=\"#\" class=\"medium-editor-toolbar-close\">',\n                this.base.options.buttonLabels === 'fontawesome' ? '<i class=\"fa fa-times\"></i>' : this.formCloseLabel,\n                '</a>');\n\n            // both of these options are slightly moot with the ability to\n            // override the various form buildup/serialize functions.\n\n            if (this.base.options.anchorTarget) {\n                // fixme: ideally, this options.anchorInputCheckboxLabel would be a formLabel too,\n                // figure out how to deprecate? also consider `fa-` icon default implcations.\n                template.push(\n                    '<input type=\"checkbox\" class=\"medium-editor-toolbar-anchor-target\">',\n                    '<label>',\n                    this.base.options.anchorInputCheckboxLabel,\n                    '</label>'\n                );\n            }\n\n            if (this.base.options.anchorButton) {\n                // fixme: expose this `Button` text as a formLabel property, too\n                // and provide similar access to a `fa-` icon default.\n                template.push(\n                    '<input type=\"checkbox\" class=\"medium-editor-toolbar-anchor-button\">',\n                    '<label>Button</label>'\n                );\n            }\n\n            return template.join('');\n\n        },\n\n        // Used by medium-editor when the default toolbar is to be displayed\n        isDisplayed: function () {\n            return this.getForm().style.display === 'block';\n        },\n\n        hideForm: function () {\n            this.getForm().style.display = 'none';\n            this.getInput().value = '';\n        },\n\n        showForm: function (linkValue) {\n            var input = this.getInput();\n\n            this.base.saveSelection();\n            this.base.hideToolbarDefaultActions();\n            this.getForm().style.display = 'block';\n            this.base.setToolbarPosition();\n\n            input.value = linkValue || '';\n            input.focus();\n        },\n\n        // Called by core when tearing down medium-editor (deactivate)\n        deactivate: function () {\n            if (!this.form) {\n                return false;\n            }\n\n            if (this.form.parentNode) {\n                this.form.parentNode.removeChild(this.form);\n            }\n\n            delete this.form;\n        },\n\n        // core methods\n\n        getFormOpts: function () {\n            // no notion of private functions? wanted `_getFormOpts`\n            var targetCheckbox = this.getForm().querySelector('.medium-editor-toolbar-anchor-target'),\n                buttonCheckbox = this.getForm().querySelector('.medium-editor-toolbar-anchor-button'),\n                opts = {\n                    url: this.getInput().value\n                };\n\n            if (this.base.options.checkLinkFormat) {\n                opts.url = this.checkLinkFormat(opts.url);\n            }\n\n            if (targetCheckbox && targetCheckbox.checked) {\n                opts.target = '_blank';\n            } else {\n                opts.target = '_self';\n            }\n\n            if (buttonCheckbox && buttonCheckbox.checked) {\n                opts.buttonClass = this.base.options.anchorButtonClass;\n            }\n\n            return opts;\n        },\n\n        doFormSave: function () {\n            var opts = this.getFormOpts();\n            this.completeFormSave(opts);\n        },\n\n        completeFormSave: function (opts) {\n            this.base.restoreSelection();\n            this.base.createLink(opts);\n            this.base.checkSelection();\n        },\n\n        checkLinkFormat: function (value) {\n            var re = /^(https?|ftps?|rtmpt?):\\/\\/|mailto:/;\n            return (re.test(value) ? '' : 'http://') + value;\n        },\n\n        doFormCancel: function () {\n            this.base.restoreSelection();\n            this.base.checkSelection();\n        },\n\n        // form creation and event handling\n\n        attachFormEvents: function (form) {\n            var close = form.querySelector('.medium-editor-toolbar-close'),\n                save = form.querySelector('.medium-editor-toolbar-save'),\n                input = form.querySelector('.medium-editor-toolbar-input');\n\n            // Handle clicks on the form itself\n            this.base.on(form, 'click', this.handleFormClick.bind(this));\n\n            // Handle typing in the textbox\n            this.base.on(input, 'keyup', this.handleTextboxKeyup.bind(this));\n\n            // Handle close button clicks\n            this.base.on(close, 'click', this.handleCloseClick.bind(this));\n\n            // Handle save button clicks (capture)\n            this.base.on(save, 'click', this.handleSaveClick.bind(this), true);\n\n        },\n\n        createForm: function () {\n            var doc = this.base.options.ownerDocument,\n                form = doc.createElement('div');\n\n            // Anchor Form (div)\n            form.className = 'medium-editor-toolbar-form';\n            form.id = 'medium-editor-toolbar-form-anchor-' + this.base.id;\n            form.innerHTML = this.getTemplate();\n            this.attachFormEvents(form);\n\n            return form;\n        },\n\n        getInput: function () {\n            return this.getForm().querySelector('input.medium-editor-toolbar-input');\n        },\n\n        handleTextboxKeyup: function (event) {\n            // For ENTER -> create the anchor\n            if (event.keyCode === Util.keyCode.ENTER) {\n                event.preventDefault();\n                this.doFormSave();\n                return;\n            }\n\n            // For ESCAPE -> close the form\n            if (event.keyCode === Util.keyCode.ESCAPE) {\n                event.preventDefault();\n                this.doFormCancel();\n            }\n        },\n\n        handleFormClick: function (event) {\n            // make sure not to hide form when clicking inside the form\n            event.stopPropagation();\n        },\n\n        handleSaveClick: function (event) {\n            // Clicking Save -> create the anchor\n            event.preventDefault();\n            this.doFormSave();\n        },\n\n        handleCloseClick: function (event) {\n            // Click Close -> close the form\n            event.preventDefault();\n            this.doFormCancel();\n        }\n    };\n\n    AnchorExtension = Util.derives(DefaultButton, AnchorDerived);\n\n}());\n/* istanbul ignore next */\nvar AnchorPreviewDeprecated;\n\n/* istanbul ignore next */\n(function () {\n    'use strict';\n\n    AnchorPreviewDeprecated = function () {\n        Util.deprecated('MediumEditor.statics.AnchorPreview', 'MediumEditor.extensions.anchorPreview', 'v5.0.0');\n        this.parent = true;\n        this.name = 'anchor-preview';\n    };\n\n    AnchorPreviewDeprecated.prototype = {\n\n        // the default selector to locate where to\n        // put the activeAnchor value in the preview\n        previewValueSelector: 'a',\n\n        init: function () {\n\n            this.anchorPreview = this.createPreview();\n            this.base.options.elementsContainer.appendChild(this.anchorPreview);\n\n            this.attachToEditables();\n        },\n\n        getPreviewElement: function () {\n            return this.anchorPreview;\n        },\n\n        createPreview: function () {\n            var el = this.base.options.ownerDocument.createElement('div');\n\n            el.id = 'medium-editor-anchor-preview-' + this.base.id;\n            el.className = 'medium-editor-anchor-preview';\n            el.innerHTML = this.getTemplate();\n\n            this.base.on(el, 'click', this.handleClick.bind(this));\n\n            return el;\n        },\n\n        getTemplate: function () {\n            return '<div class=\"medium-editor-toolbar-anchor-preview\" id=\"medium-editor-toolbar-anchor-preview\">' +\n                '    <a class=\"medium-editor-toolbar-anchor-preview-inner\"></a>' +\n                '</div>';\n        },\n\n        deactivate: function () {\n            if (this.anchorPreview) {\n                if (this.anchorPreview.parentNode) {\n                    this.anchorPreview.parentNode.removeChild(this.anchorPreview);\n                }\n                delete this.anchorPreview;\n            }\n        },\n\n        hidePreview: function () {\n            this.anchorPreview.classList.remove('medium-editor-anchor-preview-active');\n            this.activeAnchor = null;\n        },\n\n        showPreview: function (anchorEl) {\n            if (this.anchorPreview.classList.contains('medium-editor-anchor-preview-active') ||\n                    anchorEl.getAttribute('data-disable-preview')) {\n                return true;\n            }\n\n            if (this.previewValueSelector) {\n                this.anchorPreview.querySelector(this.previewValueSelector).textContent = anchorEl.attributes.href.value;\n                this.anchorPreview.querySelector(this.previewValueSelector).href = anchorEl.attributes.href.value;\n            }\n\n            this.anchorPreview.classList.add('medium-toolbar-arrow-over');\n            this.anchorPreview.classList.remove('medium-toolbar-arrow-under');\n\n            if (!this.anchorPreview.classList.contains('medium-editor-anchor-preview-active')) {\n                this.anchorPreview.classList.add('medium-editor-anchor-preview-active');\n            }\n\n            this.activeAnchor = anchorEl;\n\n            this.positionPreview();\n            this.attachPreviewHandlers();\n\n            return this;\n        },\n\n        positionPreview: function () {\n            var buttonHeight = this.anchorPreview.offsetHeight,\n                boundary = this.activeAnchor.getBoundingClientRect(),\n                middleBoundary = (boundary.left + boundary.right) / 2,\n                halfOffsetWidth,\n                defaultLeft;\n\n            halfOffsetWidth = this.anchorPreview.offsetWidth / 2;\n            defaultLeft = this.base.options.diffLeft - halfOffsetWidth;\n\n            this.anchorPreview.style.top = Math.round(buttonHeight + boundary.bottom - this.base.options.diffTop + this.base.options.contentWindow.pageYOffset - this.anchorPreview.offsetHeight) + 'px';\n            if (middleBoundary < halfOffsetWidth) {\n                this.anchorPreview.style.left = defaultLeft + halfOffsetWidth + 'px';\n            } else if ((this.base.options.contentWindow.innerWidth - middleBoundary) < halfOffsetWidth) {\n                this.anchorPreview.style.left = this.base.options.contentWindow.innerWidth + defaultLeft - halfOffsetWidth + 'px';\n            } else {\n                this.anchorPreview.style.left = defaultLeft + middleBoundary + 'px';\n            }\n        },\n\n        attachToEditables: function () {\n            this.base.subscribe('editableMouseover', this.handleEditableMouseover.bind(this));\n        },\n\n        handleClick: function (event) {\n            var anchorExtension = this.base.getExtensionByName('anchor'),\n                activeAnchor = this.activeAnchor;\n\n            if (anchorExtension && activeAnchor) {\n                event.preventDefault();\n\n                this.base.selectElement(this.activeAnchor);\n\n                // Using setTimeout + options.delay because:\n                // We may actually be displaying the anchor form, which should be controlled by options.delay\n                this.base.delay(function () {\n                    if (activeAnchor) {\n                        anchorExtension.showForm(activeAnchor.attributes.href.value);\n                        activeAnchor = null;\n                    }\n                }.bind(this));\n            }\n\n            this.hidePreview();\n        },\n\n        handleAnchorMouseout: function () {\n            this.anchorToPreview = null;\n            this.base.off(this.activeAnchor, 'mouseout', this.instanceHandleAnchorMouseout);\n            this.instanceHandleAnchorMouseout = null;\n        },\n\n        handleEditableMouseover: function (event) {\n            var target = Util.getClosestTag(event.target, 'a');\n\n            if (target) {\n\n                // Detect empty href attributes\n                // The browser will make href=\"\" or href=\"#top\"\n                // into absolute urls when accessed as event.targed.href, so check the html\n                if (!/href=[\"']\\S+[\"']/.test(target.outerHTML) || /href=[\"']#\\S+[\"']/.test(target.outerHTML)) {\n                    return true;\n                }\n\n                // only show when hovering on anchors\n                if (this.base.toolbar && this.base.toolbar.isDisplayed()) {\n                    // only show when toolbar is not present\n                    return true;\n                }\n\n                // detach handler for other anchor in case we hovered multiple anchors quickly\n                if (this.activeAnchor && this.activeAnchor !== target) {\n                    this.detachPreviewHandlers();\n                }\n\n                this.anchorToPreview = target;\n\n                this.instanceHandleAnchorMouseout = this.handleAnchorMouseout.bind(this);\n                this.base.on(this.anchorToPreview, 'mouseout', this.instanceHandleAnchorMouseout);\n                // Using setTimeout + options.delay because:\n                // - We're going to show the anchor preview according to the configured delay\n                //   if the mouse has not left the anchor tag in that time\n                this.base.delay(function () {\n                    if (this.anchorToPreview) {\n                        //this.activeAnchor = this.anchorToPreview;\n                        this.showPreview(this.anchorToPreview);\n                    }\n                }.bind(this));\n            }\n        },\n\n        handlePreviewMouseover: function () {\n            this.lastOver = (new Date()).getTime();\n            this.hovering = true;\n        },\n\n        handlePreviewMouseout: function (event) {\n            if (!event.relatedTarget || !/anchor-preview/.test(event.relatedTarget.className)) {\n                this.hovering = false;\n            }\n        },\n\n        updatePreview: function () {\n            if (this.hovering) {\n                return true;\n            }\n            var durr = (new Date()).getTime() - this.lastOver;\n            if (durr > this.base.options.anchorPreviewHideDelay) {\n                // hide the preview 1/2 second after mouse leaves the link\n                this.detachPreviewHandlers();\n            }\n        },\n\n        detachPreviewHandlers: function () {\n            // cleanup\n            clearInterval(this.intervalTimer);\n            if (this.instanceHandlePreviewMouseover) {\n                this.base.off(this.anchorPreview, 'mouseover', this.instanceHandlePreviewMouseover);\n                this.base.off(this.anchorPreview, 'mouseout', this.instanceHandlePreviewMouseout);\n                if (this.activeAnchor) {\n                    this.base.off(this.activeAnchor, 'mouseover', this.instanceHandlePreviewMouseover);\n                    this.base.off(this.activeAnchor, 'mouseout', this.instanceHandlePreviewMouseout);\n                }\n            }\n\n            this.hidePreview();\n\n            this.hovering = this.instanceHandlePreviewMouseover = this.instanceHandlePreviewMouseout = null;\n        },\n\n        // TODO: break up method and extract out handlers\n        attachPreviewHandlers: function () {\n            this.lastOver = (new Date()).getTime();\n            this.hovering = true;\n\n            this.instanceHandlePreviewMouseover = this.handlePreviewMouseover.bind(this);\n            this.instanceHandlePreviewMouseout = this.handlePreviewMouseout.bind(this);\n\n            this.intervalTimer = setInterval(this.updatePreview.bind(this), 200);\n\n            this.base.on(this.anchorPreview, 'mouseover', this.instanceHandlePreviewMouseover);\n            this.base.on(this.anchorPreview, 'mouseout', this.instanceHandlePreviewMouseout);\n            this.base.on(this.activeAnchor, 'mouseover', this.instanceHandlePreviewMouseover);\n            this.base.on(this.activeAnchor, 'mouseout', this.instanceHandlePreviewMouseout);\n        }\n    };\n}());\n\n/* istanbul ignore next */\nvar FontSizeExtension;\n\n/* istanbul ignore next */\n(function () {\n    'use strict';\n\n    function FontSizeDerived() {\n        Util.deprecated('MediumEditor.statics.FontSizeExtension', 'MediumEditor.extensions.fontSize', 'v5.0.0');\n        this.parent = true;\n        this.options = {\n            name: 'fontsize',\n            action: 'fontSize',\n            aria: 'increase/decrease font size',\n            contentDefault: '&#xB1;', // ±\n            contentFA: '<i class=\"fa fa-text-height\"></i>'\n        };\n        this.name = 'fontsize';\n        this.hasForm = true;\n    }\n\n    FontSizeDerived.prototype = {\n\n        // Button and Extension handling\n\n        // Called when the button the toolbar is clicked\n        // Overrides DefaultButton.handleClick\n        handleClick: function (evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n\n            if (!this.isDisplayed()) {\n                // Get fontsize of current selection (convert to string since IE returns this as number)\n                var fontSize = this.base.options.ownerDocument.queryCommandValue('fontSize') + '';\n                this.showForm(fontSize);\n            }\n\n            return false;\n        },\n\n        // Called by medium-editor to append form to the toolbar\n        getForm: function () {\n            if (!this.form) {\n                this.form = this.createForm();\n            }\n            return this.form;\n        },\n\n        // Used by medium-editor when the default toolbar is to be displayed\n        isDisplayed: function () {\n            return this.getForm().style.display === 'block';\n        },\n\n        hideForm: function () {\n            this.getForm().style.display = 'none';\n            this.getInput().value = '';\n        },\n\n        showForm: function (fontSize) {\n            var input = this.getInput();\n\n            this.base.saveSelection();\n            this.base.hideToolbarDefaultActions();\n            this.getForm().style.display = 'block';\n            this.base.setToolbarPosition();\n\n            input.value = fontSize || '';\n            input.focus();\n        },\n\n        // Called by core when tearing down medium-editor (deactivate)\n        deactivate: function () {\n            if (!this.form) {\n                return false;\n            }\n\n            if (this.form.parentNode) {\n                this.form.parentNode.removeChild(this.form);\n            }\n\n            delete this.form;\n        },\n\n        // core methods\n\n        doFormSave: function () {\n            this.base.restoreSelection();\n            this.base.checkSelection();\n        },\n\n        doFormCancel: function () {\n            this.base.restoreSelection();\n            this.clearFontSize();\n            this.base.checkSelection();\n        },\n\n        // form creation and event handling\n\n        createForm: function () {\n            var doc = this.base.options.ownerDocument,\n                form = doc.createElement('div'),\n                input = doc.createElement('input'),\n                close = doc.createElement('a'),\n                save = doc.createElement('a');\n\n            // Font Size Form (div)\n            form.className = 'medium-editor-toolbar-form';\n            form.id = 'medium-editor-toolbar-form-fontsize-' + this.base.id;\n\n            // Handle clicks on the form itself\n            this.base.on(form, 'click', this.handleFormClick.bind(this));\n\n            // Add font size slider\n            input.setAttribute('type', 'range');\n            input.setAttribute('min', '1');\n            input.setAttribute('max', '7');\n            input.className = 'medium-editor-toolbar-input';\n            form.appendChild(input);\n\n            // Handle typing in the textbox\n            this.base.on(input, 'change', this.handleSliderChange.bind(this));\n\n            // Add save buton\n            save.setAttribute('href', '#');\n            save.className = 'medium-editor-toobar-save';\n            save.innerHTML = this.base.options.buttonLabels === 'fontawesome' ?\n                             '<i class=\"fa fa-check\"></i>' :\n                             '&#10003;';\n            form.appendChild(save);\n\n            // Handle save button clicks (capture)\n            this.base.on(save, 'click', this.handleSaveClick.bind(this), true);\n\n            // Add close button\n            close.setAttribute('href', '#');\n            close.className = 'medium-editor-toobar-close';\n            close.innerHTML = this.base.options.buttonLabels === 'fontawesome' ?\n                              '<i class=\"fa fa-times\"></i>' :\n                              '&times;';\n            form.appendChild(close);\n\n            // Handle close button clicks\n            this.base.on(close, 'click', this.handleCloseClick.bind(this));\n\n            return form;\n        },\n\n        getInput: function () {\n            return this.getForm().querySelector('input.medium-editor-toolbar-input');\n        },\n\n        clearFontSize: function () {\n            Selection.getSelectedElements(this.base.options.ownerDocument).forEach(function (el) {\n                if (el.tagName === 'FONT' && el.hasAttribute('size')) {\n                    el.removeAttribute('size');\n                }\n            });\n        },\n\n        handleSliderChange: function () {\n            var size = this.getInput().value;\n            if (size === '4') {\n                this.clearFontSize();\n            } else {\n                this.base.execAction('fontSize', { size: size });\n            }\n        },\n\n        handleFormClick: function (event) {\n            // make sure not to hide form when clicking inside the form\n            event.stopPropagation();\n        },\n\n        handleSaveClick: function (event) {\n            // Clicking Save -> create the font size\n            event.preventDefault();\n            this.doFormSave();\n        },\n\n        handleCloseClick: function (event) {\n            // Click Close -> close the form\n            event.preventDefault();\n            this.doFormCancel();\n        }\n    };\n\n    FontSizeExtension = Util.derives(DefaultButton, FontSizeDerived);\n}());\nvar Button;\n(function () {\n    'use strict';\n\n    /*global Util, Extension */\n\n    Button = Extension.extend({\n        init: function () {\n            this.button = this.createButton();\n            this.on(this.button, 'click', this.handleClick.bind(this));\n            if (this.key) {\n                this.subscribe('editableKeydown', this.handleKeydown.bind(this));\n            }\n        },\n\n        /* getButton: [function ()]\n         *\n         * If implemented, this function will be called when\n         * the toolbar is being created.  The DOM Element returned\n         * by this function will be appended to the toolbar along\n         * with any other buttons.\n         */\n        getButton: function () {\n            return this.button;\n        },\n\n        getAction: function () {\n            return (typeof this.action === 'function') ? this.action(this.base.options) : this.action;\n        },\n\n        getAria: function () {\n            return (typeof this.aria === 'function') ? this.aria(this.base.options) : this.aria;\n        },\n\n        getTagNames: function () {\n            return (typeof this.tagNames === 'function') ? this.tagNames(this.base.options) : this.tagNames;\n        },\n\n        createButton: function () {\n            var button = this.document.createElement('button'),\n                content = this.contentDefault,\n                ariaLabel = this.getAria(),\n                buttonLabels = this.getEditorOption('buttonLabels');\n            button.classList.add('medium-editor-action');\n            button.classList.add('medium-editor-action-' + this.name);\n            button.setAttribute('data-action', this.getAction());\n            if (ariaLabel) {\n                button.setAttribute('title', ariaLabel);\n                button.setAttribute('aria-label', ariaLabel);\n            }\n            if (buttonLabels) {\n                if (buttonLabels === 'fontawesome' && this.contentFA) {\n                    content = this.contentFA;\n                } else if (typeof buttonLabels === 'object' && buttonLabels[this.name]) {\n                    content = buttonLabels[this.name];\n                }\n            }\n            button.innerHTML = content;\n            return button;\n        },\n\n        handleKeydown: function (event) {\n            var action;\n\n            if (Util.isKey(event, this.key.charCodeAt(0)) && Util.isMetaCtrlKey(event) && !event.shiftKey) {\n                event.preventDefault();\n                event.stopPropagation();\n\n                action = this.getAction();\n                if (action) {\n                    this.execAction(action);\n                }\n            }\n        },\n\n        handleClick: function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var action = this.getAction();\n\n            if (action) {\n                this.execAction(action);\n            }\n        },\n\n        isActive: function () {\n            return this.button.classList.contains(this.getEditorOption('activeButtonClass'));\n        },\n\n        setInactive: function () {\n            this.button.classList.remove(this.getEditorOption('activeButtonClass'));\n            delete this.knownState;\n        },\n\n        setActive: function () {\n            this.button.classList.add(this.getEditorOption('activeButtonClass'));\n            delete this.knownState;\n        },\n\n        queryCommandState: function () {\n            var queryState = null;\n            if (this.useQueryState) {\n                queryState = this.base.queryCommandState(this.getAction());\n            }\n            return queryState;\n        },\n\n        isAlreadyApplied: function (node) {\n            var isMatch = false,\n                tagNames = this.getTagNames(),\n                styleVals,\n                computedStyle;\n\n            if (this.knownState === false || this.knownState === true) {\n                return this.knownState;\n            }\n\n            if (tagNames && tagNames.length > 0 && node.tagName) {\n                isMatch = tagNames.indexOf(node.tagName.toLowerCase()) !== -1;\n            }\n\n            if (!isMatch && this.style) {\n                styleVals = this.style.value.split('|');\n                computedStyle = this.window.getComputedStyle(node, null).getPropertyValue(this.style.prop);\n                styleVals.forEach(function (val) {\n                    if (!this.knownState) {\n                        isMatch = (computedStyle.indexOf(val) !== -1);\n                        // text-decoration is not inherited by default\n                        // so if the computed style for text-decoration doesn't match\n                        // don't write to knownState so we can fallback to other checks\n                        if (isMatch || this.style.prop !== 'text-decoration') {\n                            this.knownState = isMatch;\n                        }\n                    }\n                }, this);\n            }\n\n            return isMatch;\n        }\n    });\n}());\n\nvar FormExtension;\n(function () {\n    'use strict';\n\n    /* global Button */\n\n    var noop = function () {};\n\n    /* Base functionality for an extension whcih will display\n     * a 'form' inside the toolbar\n     */\n    FormExtension = Button.extend({\n        // default labels for the form buttons\n        formSaveLabel: '&#10003;',\n        formCloseLabel: '&times;',\n\n        /* hasForm: [boolean]\n         *\n         * Setting this to true will cause getForm() to be called\n         * when the toolbar is created, so the form can be appended\n         * inside the toolbar container\n         */\n        hasForm: true,\n\n        /* getForm: [function ()]\n         *\n         * When hasForm is true, this function must be implemented\n         * and return a DOM Element which will be appended to\n         * the toolbar container. The form should start hidden, and\n         * the extension can choose when to hide/show it\n         */\n        getForm: noop,\n\n        /* isDisplayed: [function ()]\n         *\n         * This function should return true/false reflecting\n         * whether the form is currently displayed\n         */\n        isDisplayed: noop,\n\n        /* hideForm: [function ()]\n         *\n         * This function should hide the form element inside\n         * the toolbar container\n         */\n        hideForm: noop\n    });\n})();\nvar AnchorForm;\n(function () {\n    'use strict';\n\n    /*global Util, Selection, FormExtension */\n\n    AnchorForm = FormExtension.extend({\n        /* Anchor Form Options */\n\n        /* customClassOption: [string]  (previously options.anchorButton + options.anchorButtonClass)\n         * Custom class name the user can optionally have added to their created links (ie 'button').\n         * If passed as a non-empty string, a checkbox will be displayed allowing the user to choose\n         * whether to have the class added to the created link or not.\n         */\n        customClassOption: null,\n\n        /* customClassOptionText: [string]\n         * text to be shown in the checkbox when the __customClassOption__ is being used.\n         */\n        customClassOptionText: 'Button',\n\n        /* linkValidation: [boolean]  (previously options.checkLinkFormat)\n         * enables/disables check for common URL protocols on anchor links.\n         */\n        linkValidation: false,\n\n        /* placeholderText: [string]  (previously options.anchorInputPlaceholder)\n         * text to be shown as placeholder of the anchor input.\n         */\n        placeholderText: 'Paste or type a link',\n\n        /* targetCheckbox: [boolean]  (previously options.anchorTarget)\n         * enables/disables displaying a \"Open in new window\" checkbox, which when checked\n         * changes the `target` attribute of the created link.\n         */\n        targetCheckbox: false,\n\n        /* targetCheckboxText: [string]  (previously options.anchorInputCheckboxLabel)\n         * text to be shown in the checkbox enabled via the __targetCheckbox__ option.\n         */\n        targetCheckboxText: 'Open in new window',\n\n        // Options for the Button base class\n        name: 'anchor',\n        action: 'createLink',\n        aria: 'link',\n        tagNames: ['a'],\n        contentDefault: '<b>#</b>',\n        contentFA: '<i class=\"fa fa-link\"></i>',\n        key: 'K',\n\n        // Called when the button the toolbar is clicked\n        // Overrides ButtonExtension.handleClick\n        handleClick: function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var range = Selection.getSelectionRange(this.document);\n\n            if (range.startContainer.nodeName.toLowerCase() === 'a' ||\n                range.endContainer.nodeName.toLowerCase() === 'a' ||\n                Util.getClosestTag(Selection.getSelectedParentElement(range), 'a')) {\n                return this.execAction('unlink');\n            }\n\n            if (!this.isDisplayed()) {\n                this.showForm();\n            }\n\n            return false;\n        },\n\n        // Called when user hits the defined shortcut (CTRL / COMMAND + K)\n        // Overrides Button.handleKeydown\n        handleKeydown: function (event) {\n            if (Util.isKey(event, this.key.charCodeAt(0)) && Util.isMetaCtrlKey(event)) {\n                this.handleClick(event);\n            }\n        },\n\n        // Called by medium-editor to append form to the toolbar\n        getForm: function () {\n            if (!this.form) {\n                this.form = this.createForm();\n            }\n            return this.form;\n        },\n\n        getTemplate: function () {\n            var template = [\n                '<input type=\"text\" class=\"medium-editor-toolbar-input\" placeholder=\"', this.placeholderText, '\">'\n            ];\n\n            template.push(\n                '<a href=\"#\" class=\"medium-editor-toolbar-save\">',\n                this.getEditorOption('buttonLabels') === 'fontawesome' ? '<i class=\"fa fa-check\"></i>' : this.formSaveLabel,\n                '</a>'\n            );\n\n            template.push('<a href=\"#\" class=\"medium-editor-toolbar-close\">',\n                this.getEditorOption('buttonLabels') === 'fontawesome' ? '<i class=\"fa fa-times\"></i>' : this.formCloseLabel,\n                '</a>');\n\n            // both of these options are slightly moot with the ability to\n            // override the various form buildup/serialize functions.\n\n            if (this.targetCheckbox) {\n                // fixme: ideally, this targetCheckboxText would be a formLabel too,\n                // figure out how to deprecate? also consider `fa-` icon default implcations.\n                template.push(\n                    '<input type=\"checkbox\" class=\"medium-editor-toolbar-anchor-target\">',\n                    '<label>',\n                    this.targetCheckboxText,\n                    '</label>'\n                );\n            }\n\n            if (this.customClassOption) {\n                // fixme: expose this `Button` text as a formLabel property, too\n                // and provide similar access to a `fa-` icon default.\n                template.push(\n                    '<input type=\"checkbox\" class=\"medium-editor-toolbar-anchor-button\">',\n                    '<label>',\n                    this.customClassOptionText,\n                    '</label>'\n                );\n            }\n\n            return template.join('');\n\n        },\n\n        // Used by medium-editor when the default toolbar is to be displayed\n        isDisplayed: function () {\n            return this.getForm().style.display === 'block';\n        },\n\n        hideForm: function () {\n            this.getForm().style.display = 'none';\n            this.getInput().value = '';\n        },\n\n        showForm: function (linkValue) {\n            var input = this.getInput();\n\n            this.base.saveSelection();\n            this.base.hideToolbarDefaultActions();\n            this.getForm().style.display = 'block';\n            this.base.setToolbarPosition();\n\n            input.value = linkValue || '';\n            input.focus();\n        },\n\n        // Called by core when tearing down medium-editor (destroy)\n        destroy: function () {\n            if (!this.form) {\n                return false;\n            }\n\n            if (this.form.parentNode) {\n                this.form.parentNode.removeChild(this.form);\n            }\n\n            delete this.form;\n        },\n\n        // TODO: deprecate\n        deactivate: function () {\n            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n        },\n\n        // core methods\n\n        getFormOpts: function () {\n            // no notion of private functions? wanted `_getFormOpts`\n            var targetCheckbox = this.getForm().querySelector('.medium-editor-toolbar-anchor-target'),\n                buttonCheckbox = this.getForm().querySelector('.medium-editor-toolbar-anchor-button'),\n                opts = {\n                    url: this.getInput().value\n                };\n\n            if (this.linkValidation) {\n                opts.url = this.checkLinkFormat(opts.url);\n            }\n\n            opts.target = '_self';\n            if (targetCheckbox && targetCheckbox.checked) {\n                opts.target = '_blank';\n            }\n\n            if (buttonCheckbox && buttonCheckbox.checked) {\n                opts.buttonClass = this.customClassOption;\n            }\n\n            return opts;\n        },\n\n        doFormSave: function () {\n            var opts = this.getFormOpts();\n            this.completeFormSave(opts);\n        },\n\n        completeFormSave: function (opts) {\n            this.base.restoreSelection();\n            this.execAction(this.action, opts);\n            this.base.checkSelection();\n        },\n\n        checkLinkFormat: function (value) {\n            var re = /^(https?|ftps?|rtmpt?):\\/\\/|mailto:/;\n            return (re.test(value) ? '' : 'http://') + value;\n        },\n\n        doFormCancel: function () {\n            this.base.restoreSelection();\n            this.base.checkSelection();\n        },\n\n        // form creation and event handling\n        attachFormEvents: function (form) {\n            var close = form.querySelector('.medium-editor-toolbar-close'),\n                save = form.querySelector('.medium-editor-toolbar-save'),\n                input = form.querySelector('.medium-editor-toolbar-input');\n\n            // Handle clicks on the form itself\n            this.on(form, 'click', this.handleFormClick.bind(this));\n\n            // Handle typing in the textbox\n            this.on(input, 'keyup', this.handleTextboxKeyup.bind(this));\n\n            // Handle close button clicks\n            this.on(close, 'click', this.handleCloseClick.bind(this));\n\n            // Handle save button clicks (capture)\n            this.on(save, 'click', this.handleSaveClick.bind(this), true);\n\n        },\n\n        createForm: function () {\n            var doc = this.document,\n                form = doc.createElement('div');\n\n            // Anchor Form (div)\n            form.className = 'medium-editor-toolbar-form';\n            form.id = 'medium-editor-toolbar-form-anchor-' + this.getEditorId();\n            form.innerHTML = this.getTemplate();\n            this.attachFormEvents(form);\n\n            return form;\n        },\n\n        getInput: function () {\n            return this.getForm().querySelector('input.medium-editor-toolbar-input');\n        },\n\n        handleTextboxKeyup: function (event) {\n            // For ENTER -> create the anchor\n            if (event.keyCode === Util.keyCode.ENTER) {\n                event.preventDefault();\n                this.doFormSave();\n                return;\n            }\n\n            // For ESCAPE -> close the form\n            if (event.keyCode === Util.keyCode.ESCAPE) {\n                event.preventDefault();\n                this.doFormCancel();\n            }\n        },\n\n        handleFormClick: function (event) {\n            // make sure not to hide form when clicking inside the form\n            event.stopPropagation();\n        },\n\n        handleSaveClick: function (event) {\n            // Clicking Save -> create the anchor\n            event.preventDefault();\n            this.doFormSave();\n        },\n\n        handleCloseClick: function (event) {\n            // Click Close -> close the form\n            event.preventDefault();\n            this.doFormCancel();\n        }\n    });\n}());\nvar AnchorPreview;\n(function () {\n    'use strict';\n\n    /*global Util, Extension */\n\n    AnchorPreview = Extension.extend({\n        name: 'anchor-preview',\n\n        // Anchor Preview Options\n\n        /* hideDelay: [number]  (previously options.anchorPreviewHideDelay)\n         * time in milliseconds to show the anchor tag preview after the mouse has left the anchor tag.\n         */\n        hideDelay: 500,\n\n        /* previewValueSelector: [string]\n         * the default selector to locate where to put the activeAnchor value in the preview\n         */\n        previewValueSelector: 'a',\n\n        /* ----- internal options needed from base ----- */\n        diffLeft: 0, // deprecated (should use .getEditorOption() instead)\n        diffTop: -10, // deprecated (should use .getEditorOption() instead)\n        elementsContainer: false, // deprecated (should use .getEditorOption() instead)\n\n        init: function () {\n            this.anchorPreview = this.createPreview();\n\n            if (!this.elementsContainer) {\n                this.elementsContainer = this.document.body;\n            }\n            this.elementsContainer.appendChild(this.anchorPreview);\n\n            this.attachToEditables();\n        },\n\n        getPreviewElement: function () {\n            return this.anchorPreview;\n        },\n\n        createPreview: function () {\n            var el = this.document.createElement('div');\n\n            el.id = 'medium-editor-anchor-preview-' + this.getEditorId();\n            el.className = 'medium-editor-anchor-preview';\n            el.innerHTML = this.getTemplate();\n\n            this.on(el, 'click', this.handleClick.bind(this));\n\n            return el;\n        },\n\n        getTemplate: function () {\n            return '<div class=\"medium-editor-toolbar-anchor-preview\" id=\"medium-editor-toolbar-anchor-preview\">' +\n                '    <a class=\"medium-editor-toolbar-anchor-preview-inner\"></a>' +\n                '</div>';\n        },\n\n        destroy: function () {\n            if (this.anchorPreview) {\n                if (this.anchorPreview.parentNode) {\n                    this.anchorPreview.parentNode.removeChild(this.anchorPreview);\n                }\n                delete this.anchorPreview;\n            }\n        },\n\n        // TODO: deprecate\n        deactivate: function () {\n            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n        },\n\n        hidePreview: function () {\n            this.anchorPreview.classList.remove('medium-editor-anchor-preview-active');\n            this.activeAnchor = null;\n        },\n\n        showPreview: function (anchorEl) {\n            if (this.anchorPreview.classList.contains('medium-editor-anchor-preview-active') ||\n                    anchorEl.getAttribute('data-disable-preview')) {\n                return true;\n            }\n\n            if (this.previewValueSelector) {\n                this.anchorPreview.querySelector(this.previewValueSelector).textContent = anchorEl.attributes.href.value;\n                this.anchorPreview.querySelector(this.previewValueSelector).href = anchorEl.attributes.href.value;\n            }\n\n            this.anchorPreview.classList.add('medium-toolbar-arrow-over');\n            this.anchorPreview.classList.remove('medium-toolbar-arrow-under');\n\n            if (!this.anchorPreview.classList.contains('medium-editor-anchor-preview-active')) {\n                this.anchorPreview.classList.add('medium-editor-anchor-preview-active');\n            }\n\n            this.activeAnchor = anchorEl;\n\n            this.positionPreview();\n            this.attachPreviewHandlers();\n\n            return this;\n        },\n\n        positionPreview: function () {\n            var buttonHeight = this.anchorPreview.offsetHeight,\n                boundary = this.activeAnchor.getBoundingClientRect(),\n                middleBoundary = (boundary.left + boundary.right) / 2,\n                halfOffsetWidth,\n                defaultLeft;\n\n            halfOffsetWidth = this.anchorPreview.offsetWidth / 2;\n            defaultLeft = this.diffLeft - halfOffsetWidth;\n\n            this.anchorPreview.style.top = Math.round(buttonHeight + boundary.bottom - this.diffTop + this.window.pageYOffset - this.anchorPreview.offsetHeight) + 'px';\n            if (middleBoundary < halfOffsetWidth) {\n                this.anchorPreview.style.left = defaultLeft + halfOffsetWidth + 'px';\n            } else if ((this.window.innerWidth - middleBoundary) < halfOffsetWidth) {\n                this.anchorPreview.style.left = this.window.innerWidth + defaultLeft - halfOffsetWidth + 'px';\n            } else {\n                this.anchorPreview.style.left = defaultLeft + middleBoundary + 'px';\n            }\n        },\n\n        attachToEditables: function () {\n            this.subscribe('editableMouseover', this.handleEditableMouseover.bind(this));\n        },\n\n        handleClick: function (event) {\n            var anchorExtension = this.base.getExtensionByName('anchor'),\n                activeAnchor = this.activeAnchor;\n\n            if (anchorExtension && activeAnchor) {\n                event.preventDefault();\n\n                this.base.selectElement(this.activeAnchor);\n\n                // Using setTimeout + delay because:\n                // We may actually be displaying the anchor form, which should be controlled by delay\n                this.base.delay(function () {\n                    if (activeAnchor) {\n                        anchorExtension.showForm(activeAnchor.attributes.href.value);\n                        activeAnchor = null;\n                    }\n                }.bind(this));\n            }\n\n            this.hidePreview();\n        },\n\n        handleAnchorMouseout: function () {\n            this.anchorToPreview = null;\n            this.off(this.activeAnchor, 'mouseout', this.instanceHandleAnchorMouseout);\n            this.instanceHandleAnchorMouseout = null;\n        },\n\n        handleEditableMouseover: function (event) {\n            var target = Util.getClosestTag(event.target, 'a');\n\n            if (false === target) {\n                return;\n            }\n\n            // Detect empty href attributes\n            // The browser will make href=\"\" or href=\"#top\"\n            // into absolute urls when accessed as event.targed.href, so check the html\n            if (!/href=[\"']\\S+[\"']/.test(target.outerHTML) || /href=[\"']#\\S+[\"']/.test(target.outerHTML)) {\n                return true;\n            }\n\n            // only show when hovering on anchors\n            if (this.base.toolbar && this.base.toolbar.isDisplayed()) {\n                // only show when toolbar is not present\n                return true;\n            }\n\n            // detach handler for other anchor in case we hovered multiple anchors quickly\n            if (this.activeAnchor && this.activeAnchor !== target) {\n                this.detachPreviewHandlers();\n            }\n\n            this.anchorToPreview = target;\n\n            this.instanceHandleAnchorMouseout = this.handleAnchorMouseout.bind(this);\n            this.on(this.anchorToPreview, 'mouseout', this.instanceHandleAnchorMouseout);\n            // Using setTimeout + delay because:\n            // - We're going to show the anchor preview according to the configured delay\n            //   if the mouse has not left the anchor tag in that time\n            this.base.delay(function () {\n                if (this.anchorToPreview) {\n                    //this.activeAnchor = this.anchorToPreview;\n                    this.showPreview(this.anchorToPreview);\n                }\n            }.bind(this));\n        },\n\n        handlePreviewMouseover: function () {\n            this.lastOver = (new Date()).getTime();\n            this.hovering = true;\n        },\n\n        handlePreviewMouseout: function (event) {\n            if (!event.relatedTarget || !/anchor-preview/.test(event.relatedTarget.className)) {\n                this.hovering = false;\n            }\n        },\n\n        updatePreview: function () {\n            if (this.hovering) {\n                return true;\n            }\n            var durr = (new Date()).getTime() - this.lastOver;\n            if (durr > this.hideDelay) {\n                // hide the preview 1/2 second after mouse leaves the link\n                this.detachPreviewHandlers();\n            }\n        },\n\n        detachPreviewHandlers: function () {\n            // cleanup\n            clearInterval(this.intervalTimer);\n            if (this.instanceHandlePreviewMouseover) {\n                this.off(this.anchorPreview, 'mouseover', this.instanceHandlePreviewMouseover);\n                this.off(this.anchorPreview, 'mouseout', this.instanceHandlePreviewMouseout);\n                if (this.activeAnchor) {\n                    this.off(this.activeAnchor, 'mouseover', this.instanceHandlePreviewMouseover);\n                    this.off(this.activeAnchor, 'mouseout', this.instanceHandlePreviewMouseout);\n                }\n            }\n\n            this.hidePreview();\n\n            this.hovering = this.instanceHandlePreviewMouseover = this.instanceHandlePreviewMouseout = null;\n        },\n\n        // TODO: break up method and extract out handlers\n        attachPreviewHandlers: function () {\n            this.lastOver = (new Date()).getTime();\n            this.hovering = true;\n\n            this.instanceHandlePreviewMouseover = this.handlePreviewMouseover.bind(this);\n            this.instanceHandlePreviewMouseout = this.handlePreviewMouseout.bind(this);\n\n            this.intervalTimer = setInterval(this.updatePreview.bind(this), 200);\n\n            this.on(this.anchorPreview, 'mouseover', this.instanceHandlePreviewMouseover);\n            this.on(this.anchorPreview, 'mouseout', this.instanceHandlePreviewMouseout);\n            this.on(this.activeAnchor, 'mouseover', this.instanceHandlePreviewMouseover);\n            this.on(this.activeAnchor, 'mouseout', this.instanceHandlePreviewMouseout);\n        }\n    });\n}());\n\nvar AutoLink,\n    WHITESPACE_CHARS,\n    KNOWN_TLDS_FRAGMENT,\n    LINK_REGEXP_TEXT;\n\nWHITESPACE_CHARS = [' ', '\\t', '\\n', '\\r', '\\u00A0', '\\u2000', '\\u2001', '\\u2002', '\\u2003',\n                                    '\\u2028', '\\u2029'];\nKNOWN_TLDS_FRAGMENT = 'com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|' +\n    'xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|' +\n    'bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|' +\n    'fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|' +\n    'is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|' +\n    'mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|' +\n    'pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|' +\n    'tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw';\nLINK_REGEXP_TEXT =\n    '(' +\n    // Version of Gruber URL Regexp optimized for JS: http://stackoverflow.com/a/17733640\n    '((?:(https?://|ftps?://|nntp://)|www\\\\d{0,3}[.]|[a-z0-9.\\\\-]+[.](' + KNOWN_TLDS_FRAGMENT + ')\\\\\\/)\\\\S+(?:[^\\\\s`!\\\\[\\\\]{};:\\'\\\".,?\\u00AB\\u00BB\\u201C\\u201D\\u2018\\u2019]))' +\n    // Addition to above Regexp to support bare domains/one level subdomains with common non-i18n TLDs and without www prefix:\n    ')|(([a-z0-9\\\\-]+\\\\.)?[a-z0-9\\\\-]+\\\\.(' + KNOWN_TLDS_FRAGMENT + '))';\n\n(function () {\n    'use strict';\n\n    var KNOWN_TLDS_REGEXP = new RegExp('^(' + KNOWN_TLDS_FRAGMENT + ')$', 'i');\n\n    function nodeIsNotInsideAnchorTag(node) {\n        return !Util.getClosestTag(node, 'a');\n    }\n\n    AutoLink = Extension.extend({\n        init: function () {\n            this.disableEventHandling = false;\n            this.subscribe('editableKeypress', this.onKeypress.bind(this));\n            this.subscribe('editableBlur', this.onBlur.bind(this));\n            // MS IE has it's own auto-URL detect feature but ours is better in some ways. Be consistent.\n            this.document.execCommand('AutoUrlDetect', false, false);\n        },\n\n        destroy: function () {\n            // Turn AutoUrlDetect back on\n            if (this.document.queryCommandSupported('AutoUrlDetect')) {\n                this.document.execCommand('AutoUrlDetect', false, true);\n            }\n        },\n\n        onBlur: function (blurEvent, editable) {\n            this.performLinking(editable);\n        },\n\n        onKeypress: function (keyPressEvent) {\n            if (this.disableEventHandling) {\n                return;\n            }\n\n            if (Util.isKey(keyPressEvent, [Util.keyCode.SPACE, Util.keyCode.ENTER])) {\n                clearTimeout(this.performLinkingTimeout);\n                // Saving/restoring the selection in the middle of a keypress doesn't work well...\n                this.performLinkingTimeout = setTimeout(function () {\n                    try {\n                        var sel = this.base.exportSelection();\n                        if (this.performLinking(keyPressEvent.target)) {\n                            // pass true for favorLaterSelectionAnchor - this is needed for links at the end of a\n                            // paragraph in MS IE, or MS IE causes the link to be deleted right after adding it.\n                            this.base.importSelection(sel, true);\n                        }\n                    } catch (e) {\n                        if (window.console) {\n                            window.console.error('Failed to perform linking', e);\n                        }\n                        this.disableEventHandling = true;\n                    }\n                }.bind(this), 0);\n            }\n        },\n\n        performLinking: function (contenteditable) {\n            // Perform linking on a paragraph level basis as otherwise the detection can wrongly find the end\n            // of one paragraph and the beginning of another paragraph to constitute a link, such as a paragraph ending\n            // \"link.\" and the next paragraph beginning with \"my\" is interpreted into \"link.my\" and the code tries to create\n            // a link across paragraphs - which doesn't work and is terrible.\n            // (Medium deletes the spaces/returns between P tags so the textContent ends up without paragraph spacing)\n            var paragraphs = contenteditable.querySelectorAll('p'),\n                documentModified = false;\n            if (paragraphs.length === 0) {\n                paragraphs = [contenteditable];\n            }\n            for (var i = 0; i < paragraphs.length; i++) {\n                documentModified = this.removeObsoleteAutoLinkSpans(paragraphs[i]) || documentModified;\n                documentModified = this.performLinkingWithinElement(paragraphs[i]) || documentModified;\n            }\n            return documentModified;\n        },\n\n        splitStartNodeIfNeeded: function (currentNode, matchStartIndex, currentTextIndex) {\n            if (matchStartIndex !== currentTextIndex) {\n                return currentNode.splitText(matchStartIndex - currentTextIndex);\n            }\n            return null;\n        },\n\n        splitEndNodeIfNeeded: function (currentNode, newNode, matchEndIndex, currentTextIndex) {\n            var textIndexOfEndOfFarthestNode,\n                endSplitPoint;\n            textIndexOfEndOfFarthestNode = currentTextIndex + (newNode || currentNode).nodeValue.length +\n                    (newNode ? currentNode.nodeValue.length : 0) -\n                    1;\n            endSplitPoint = (newNode || currentNode).nodeValue.length -\n                    (textIndexOfEndOfFarthestNode + 1 - matchEndIndex);\n            if (textIndexOfEndOfFarthestNode >= matchEndIndex &&\n                    currentTextIndex !== textIndexOfEndOfFarthestNode &&\n                    endSplitPoint !== 0) {\n                (newNode || currentNode).splitText(endSplitPoint);\n            }\n        },\n\n        removeObsoleteAutoLinkSpans: function (element) {\n            var spans = element.querySelectorAll('span[data-auto-link=\"true\"]'),\n                documentModified = false;\n\n            for (var i = 0; i < spans.length; i++) {\n                var textContent = spans[i].textContent;\n                if (textContent.indexOf('://') === -1) {\n                    textContent = Util.ensureUrlHasProtocol(textContent);\n                }\n                if (spans[i].getAttribute('data-href') !== textContent && nodeIsNotInsideAnchorTag(spans[i])) {\n                    documentModified = true;\n                    var trimmedTextContent = textContent.replace(/\\s+$/, '');\n                    if (spans[i].getAttribute('data-href') === trimmedTextContent) {\n                        var charactersTrimmed = textContent.length - trimmedTextContent.length,\n                            subtree = Util.splitOffDOMTree(spans[i], this.splitTextBeforeEnd(spans[i], charactersTrimmed));\n                        spans[i].parentNode.insertBefore(subtree, spans[i].nextSibling);\n                    } else {\n                        // Some editing has happened to the span, so just remove it entirely. The user can put it back\n                        // around just the href content if they need to prevent it from linking\n                        Util.unwrap(spans[i], this.document);\n                    }\n                }\n            }\n            return documentModified;\n        },\n\n        splitTextBeforeEnd: function (element, characterCount) {\n            var treeWalker = this.document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, false),\n                lastChildNotExhausted = true;\n\n            // Start the tree walker at the last descendant of the span\n            while (lastChildNotExhausted) {\n                lastChildNotExhausted = treeWalker.lastChild() !== null;\n            }\n\n            var currentNode,\n                currentNodeValue,\n                previousNode;\n            while (characterCount > 0 && previousNode !== null) {\n                currentNode = treeWalker.currentNode;\n                currentNodeValue = currentNode.nodeValue;\n                if (currentNodeValue.length > characterCount) {\n                    previousNode = currentNode.splitText(currentNodeValue.length - characterCount);\n                    characterCount = 0;\n                } else {\n                    previousNode = treeWalker.previousNode();\n                    characterCount -= currentNodeValue.length;\n                }\n            }\n            return previousNode;\n        },\n\n        performLinkingWithinElement: function (element) {\n            var matches = this.findLinkableText(element),\n                linkCreated = false;\n\n            for (var matchIndex = 0; matchIndex < matches.length; matchIndex++) {\n                linkCreated = this.createLink(this.findOrCreateMatchingTextNodes(element, matches[matchIndex]),\n                    matches[matchIndex].href) || linkCreated;\n            }\n            return linkCreated;\n        },\n\n        findLinkableText: function (contenteditable) {\n            var linkRegExp = new RegExp(LINK_REGEXP_TEXT, 'gi'),\n                textContent = contenteditable.textContent,\n                match = null,\n                matches = [];\n\n            while ((match = linkRegExp.exec(textContent)) !== null) {\n                var matchOk = true,\n                    matchEnd = match.index + match[0].length;\n                // If the regexp detected something as a link that has text immediately preceding/following it, bail out.\n                matchOk = (match.index === 0 || WHITESPACE_CHARS.indexOf(textContent[match.index - 1]) !== -1) &&\n                    (matchEnd === textContent.length || WHITESPACE_CHARS.indexOf(textContent[matchEnd]) !== -1);\n                // If the regexp detected a bare domain that doesn't use one of our expected TLDs, bail out.\n                matchOk = matchOk && (match[0].indexOf('/') !== -1 ||\n                    KNOWN_TLDS_REGEXP.test(match[0].split('.').pop().split('?').shift()));\n\n                if (matchOk) {\n                    matches.push({\n                        href: match[0],\n                        start: match.index,\n                        end: matchEnd\n                    });\n                }\n            }\n            return matches;\n        },\n\n        findOrCreateMatchingTextNodes: function (element, match) {\n            var treeWalker = this.document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, false),\n                matchedNodes = [],\n                currentTextIndex = 0,\n                startReached = false,\n                currentNode = null,\n                newNode = null;\n\n            while ((currentNode = treeWalker.nextNode()) !== null) {\n                if (!startReached && match.start < (currentTextIndex + currentNode.nodeValue.length)) {\n                    startReached = true;\n                    newNode = this.splitStartNodeIfNeeded(currentNode, match.start, currentTextIndex);\n                }\n                if (startReached) {\n                    this.splitEndNodeIfNeeded(currentNode, newNode, match.end, currentTextIndex);\n                }\n                if (startReached && currentTextIndex === match.end) {\n                    break; // Found the node(s) corresponding to the link. Break out and move on to the next.\n                } else if (startReached && currentTextIndex > (match.end + 1)) {\n                    throw new Error('PerformLinking overshot the target!'); // should never happen...\n                }\n\n                if (startReached) {\n                    matchedNodes.push(newNode || currentNode);\n                }\n\n                currentTextIndex += currentNode.nodeValue.length;\n                if (newNode !== null) {\n                    currentTextIndex += newNode.nodeValue.length;\n                    // Skip the newNode as we'll already have pushed it to the matches\n                    treeWalker.nextNode();\n                }\n                newNode = null;\n            }\n            return matchedNodes;\n        },\n\n        createLink: function (textNodes, href) {\n            var shouldNotLink = false;\n            for (var i = 0; i < textNodes.length && shouldNotLink === false; i++) {\n                // Do not link if the text node is either inside an anchor or inside span[data-auto-link]\n                shouldNotLink = !!Util.traverseUp(textNodes[i], function (node) {\n                    return node.nodeName.toLowerCase() === 'a' ||\n                        (node.getAttribute && node.getAttribute('data-auto-link') === 'true');\n                });\n            }\n            if (shouldNotLink) {\n                return false;\n            }\n\n            var anchor = this.document.createElement('a'),\n                span = this.document.createElement('span'),\n                hrefWithProtocol = Util.ensureUrlHasProtocol(href);\n            Util.moveTextRangeIntoElement(textNodes[0], textNodes[textNodes.length - 1], span);\n            span.setAttribute('data-auto-link', 'true');\n            span.setAttribute('data-href', hrefWithProtocol);\n            anchor.setAttribute('href', hrefWithProtocol);\n            span.parentNode.insertBefore(anchor, span);\n            anchor.appendChild(span);\n            return true;\n        }\n    });\n}());\nvar ImageDragging;\n\n(function () {\n    'use strict';\n\n    ImageDragging = Extension.extend({\n        init: function () {\n            this.subscribe('editableDrag', this.handleDrag.bind(this));\n            this.subscribe('editableDrop', this.handleDrop.bind(this));\n        },\n\n        handleDrag: function (event) {\n            var className = 'medium-editor-dragover';\n            event.preventDefault();\n            event.dataTransfer.dropEffect = 'copy';\n\n            if (event.type === 'dragover') {\n                event.target.classList.add(className);\n            } else if (event.type === 'dragleave') {\n                event.target.classList.remove(className);\n            }\n        },\n\n        handleDrop: function (event) {\n            var className = 'medium-editor-dragover',\n                files;\n            event.preventDefault();\n            event.stopPropagation();\n\n            // IE9 does not support the File API, so prevent file from opening in a new window\n            // but also don't try to actually get the file\n            if (event.dataTransfer.files) {\n                files = Array.prototype.slice.call(event.dataTransfer.files, 0);\n                files.some(function (file) {\n                    if (file.type.match('image')) {\n                        var fileReader, id;\n                        fileReader = new FileReader();\n                        fileReader.readAsDataURL(file);\n\n                        id = 'medium-img-' + (+new Date());\n                        Util.insertHTMLCommand(this.document, '<img class=\"medium-image-loading\" id=\"' + id + '\" />');\n\n                        fileReader.onload = function () {\n                            var img = this.document.getElementById(id);\n                            if (img) {\n                                img.removeAttribute('id');\n                                img.removeAttribute('class');\n                                img.src = fileReader.result;\n                            }\n                        }.bind(this);\n                    }\n                }.bind(this));\n            }\n            event.target.classList.remove(className);\n        }\n    });\n}());\n\nvar FontSizeForm;\n(function () {\n    'use strict';\n\n    /*global FormExtension, Selection, Util */\n\n    FontSizeForm = FormExtension.extend({\n\n        name: 'fontsize',\n        action: 'fontSize',\n        aria: 'increase/decrease font size',\n        contentDefault: '&#xB1;', // ±\n        contentFA: '<i class=\"fa fa-text-height\"></i>',\n\n        // Called when the button the toolbar is clicked\n        // Overrides ButtonExtension.handleClick\n        handleClick: function (evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n\n            if (!this.isDisplayed()) {\n                // Get fontsize of current selection (convert to string since IE returns this as number)\n                var fontSize = this.document.queryCommandValue('fontSize') + '';\n                this.showForm(fontSize);\n            }\n\n            return false;\n        },\n\n        // Called by medium-editor to append form to the toolbar\n        getForm: function () {\n            if (!this.form) {\n                this.form = this.createForm();\n            }\n            return this.form;\n        },\n\n        // Used by medium-editor when the default toolbar is to be displayed\n        isDisplayed: function () {\n            return this.getForm().style.display === 'block';\n        },\n\n        hideForm: function () {\n            this.getForm().style.display = 'none';\n            this.getInput().value = '';\n        },\n\n        showForm: function (fontSize) {\n            var input = this.getInput();\n\n            this.base.saveSelection();\n            this.base.hideToolbarDefaultActions();\n            this.getForm().style.display = 'block';\n            this.base.setToolbarPosition();\n\n            input.value = fontSize || '';\n            input.focus();\n        },\n\n        // Called by core when tearing down medium-editor (destroy)\n        destroy: function () {\n            if (!this.form) {\n                return false;\n            }\n\n            if (this.form.parentNode) {\n                this.form.parentNode.removeChild(this.form);\n            }\n\n            delete this.form;\n        },\n\n        // TODO: deprecate\n        deactivate: function () {\n            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n        },\n\n        // core methods\n\n        doFormSave: function () {\n            this.base.restoreSelection();\n            this.base.checkSelection();\n        },\n\n        doFormCancel: function () {\n            this.base.restoreSelection();\n            this.clearFontSize();\n            this.base.checkSelection();\n        },\n\n        // form creation and event handling\n        createForm: function () {\n            var doc = this.document,\n                form = doc.createElement('div'),\n                input = doc.createElement('input'),\n                close = doc.createElement('a'),\n                save = doc.createElement('a');\n\n            // Font Size Form (div)\n            form.className = 'medium-editor-toolbar-form';\n            form.id = 'medium-editor-toolbar-form-fontsize-' + this.getEditorId();\n\n            // Handle clicks on the form itself\n            this.on(form, 'click', this.handleFormClick.bind(this));\n\n            // Add font size slider\n            input.setAttribute('type', 'range');\n            input.setAttribute('min', '1');\n            input.setAttribute('max', '7');\n            input.className = 'medium-editor-toolbar-input';\n            form.appendChild(input);\n\n            // Handle typing in the textbox\n            this.on(input, 'change', this.handleSliderChange.bind(this));\n\n            // Add save buton\n            save.setAttribute('href', '#');\n            save.className = 'medium-editor-toobar-save';\n            save.innerHTML = this.getEditorOption('buttonLabels') === 'fontawesome' ?\n                             '<i class=\"fa fa-check\"></i>' :\n                             '&#10003;';\n            form.appendChild(save);\n\n            // Handle save button clicks (capture)\n            this.on(save, 'click', this.handleSaveClick.bind(this), true);\n\n            // Add close button\n            close.setAttribute('href', '#');\n            close.className = 'medium-editor-toobar-close';\n            close.innerHTML = this.getEditorOption('buttonLabels') === 'fontawesome' ?\n                              '<i class=\"fa fa-times\"></i>' :\n                              '&times;';\n            form.appendChild(close);\n\n            // Handle close button clicks\n            this.on(close, 'click', this.handleCloseClick.bind(this));\n\n            return form;\n        },\n\n        getInput: function () {\n            return this.getForm().querySelector('input.medium-editor-toolbar-input');\n        },\n\n        clearFontSize: function () {\n            Selection.getSelectedElements(this.document).forEach(function (el) {\n                if (el.tagName === 'FONT' && el.hasAttribute('size')) {\n                    el.removeAttribute('size');\n                }\n            });\n        },\n\n        handleSliderChange: function () {\n            var size = this.getInput().value;\n            if (size === '4') {\n                this.clearFontSize();\n            } else {\n                this.execAction('fontSize', { size: size });\n            }\n        },\n\n        handleFormClick: function (event) {\n            // make sure not to hide form when clicking inside the form\n            event.stopPropagation();\n        },\n\n        handleSaveClick: function (event) {\n            // Clicking Save -> create the font size\n            event.preventDefault();\n            this.doFormSave();\n        },\n\n        handleCloseClick: function (event) {\n            // Click Close -> close the form\n            event.preventDefault();\n            this.doFormCancel();\n        }\n    });\n}());\nvar PasteHandler;\n\n(function () {\n    'use strict';\n    /*jslint regexp: true*/\n    /*\n        jslint does not allow character negation, because the negation\n        will not match any unicode characters. In the regexes in this\n        block, negation is used specifically to match the end of an html\n        tag, and in fact unicode characters *should* be allowed.\n    */\n    function createReplacements() {\n        return [\n\n            // replace two bogus tags that begin pastes from google docs\n            [new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi), ''],\n            [new RegExp(/<\\/b>(<br[^>]*>)?$/gi), ''],\n\n             // un-html spaces and newlines inserted by OS X\n            [new RegExp(/<span class=\"Apple-converted-space\">\\s+<\\/span>/g), ' '],\n            [new RegExp(/<br class=\"Apple-interchange-newline\">/g), '<br>'],\n\n            // replace google docs italics+bold with a span to be replaced once the html is inserted\n            [new RegExp(/<span[^>]*(font-style:italic;font-weight:bold|font-weight:bold;font-style:italic)[^>]*>/gi), '<span class=\"replace-with italic bold\">'],\n\n            // replace google docs italics with a span to be replaced once the html is inserted\n            [new RegExp(/<span[^>]*font-style:italic[^>]*>/gi), '<span class=\"replace-with italic\">'],\n\n            //[replace google docs bolds with a span to be replaced once the html is inserted\n            [new RegExp(/<span[^>]*font-weight:bold[^>]*>/gi), '<span class=\"replace-with bold\">'],\n\n             // replace manually entered b/i/a tags with real ones\n            [new RegExp(/&lt;(\\/?)(i|b|a)&gt;/gi), '<$1$2>'],\n\n             // replace manually a tags with real ones, converting smart-quotes from google docs\n            [new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|\"|“|”)(((?!&quot;|&rdquo;|&ldquo;|\"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|\"|“|”)(?:(?!&gt;).)*&gt;/gi), '<a href=\"$1\">'],\n\n            // Newlines between paragraphs in html have no syntactic value,\n            // but then have a tendency to accidentally become additional paragraphs down the line\n            [new RegExp(/<\\/p>\\n+/gi), '</p>'],\n            [new RegExp(/\\n+<p/gi), '<p'],\n\n            // Microsoft Word makes these odd tags, like <o:p></o:p>\n            [new RegExp(/<\\/?o:[a-z]*>/gi), '']\n        ];\n    }\n    /*jslint regexp: false*/\n\n    PasteHandler = Extension.extend({\n        /* Paste Options */\n\n        /* forcePlainText: [boolean]\n         * Forces pasting as plain text.\n         */\n        forcePlainText: true,\n\n        /* cleanPastedHTML: [boolean]\n         * cleans pasted content from different sources, like google docs etc.\n         */\n        cleanPastedHTML: false,\n\n        /* cleanReplacements: [Array]\n         * custom pairs (2 element arrays) of RegExp and replacement text to use during paste when\n         * __forcePlainText__ or __cleanPastedHTML__ are `true` OR when calling `cleanPaste(text)` helper method.\n         */\n        cleanReplacements: [],\n\n        /* cleanAttrs:: [Array]\n         * list of element attributes to remove during paste when __cleanPastedHTML__ is `true` or when\n         * calling `cleanPaste(text)` or `pasteHTML(html, options)` helper methods.\n         */\n        cleanAttrs: ['class', 'style', 'dir'],\n\n        /* cleanTags: [Array]\n         * list of element tag names to remove during paste when __cleanPastedHTML__ is `true` or when\n         * calling `cleanPaste(text)` or `pasteHTML(html, options)` helper methods.\n         */\n        cleanTags: ['meta'],\n\n        /* ----- internal options needed from base ----- */\n        targetBlank: false, // deprecated (should use .getEditorOption() instead)\n        disableReturn: false, // deprecated (should use .getEditorOption() instead)\n\n        init: function () {\n            if (this.forcePlainText || this.cleanPastedHTML) {\n                this.subscribe('editablePaste', this.handlePaste.bind(this));\n            }\n        },\n\n        handlePaste: function (event, element) {\n            var paragraphs,\n                html = '',\n                p,\n                dataFormatHTML = 'text/html',\n                dataFormatPlain = 'text/plain',\n                pastedHTML,\n                pastedPlain;\n\n            if (this.window.clipboardData && event.clipboardData === undefined) {\n                event.clipboardData = this.window.clipboardData;\n                // If window.clipboardData exists, but event.clipboardData doesn't exist,\n                // we're probably in IE. IE only has two possibilities for clipboard\n                // data format: 'Text' and 'URL'.\n                //\n                // Of the two, we want 'Text':\n                dataFormatHTML = 'Text';\n                dataFormatPlain = 'Text';\n            }\n\n            if (event.clipboardData &&\n                    event.clipboardData.getData &&\n                    !event.defaultPrevented) {\n                event.preventDefault();\n\n                pastedHTML = event.clipboardData.getData(dataFormatHTML);\n                pastedPlain = event.clipboardData.getData(dataFormatPlain);\n\n                if (this.cleanPastedHTML && pastedHTML) {\n                    return this.cleanPaste(pastedHTML);\n                }\n\n                if (!(this.disableReturn || element.getAttribute('data-disable-return'))) {\n                    paragraphs = pastedPlain.split(/[\\r\\n]+/g);\n                    // If there are no \\r\\n in data, don't wrap in <p>\n                    if (paragraphs.length > 1) {\n                        for (p = 0; p < paragraphs.length; p += 1) {\n                            if (paragraphs[p] !== '') {\n                                html += '<p>' + Util.htmlEntities(paragraphs[p]) + '</p>';\n                            }\n                        }\n                    } else {\n                        html = Util.htmlEntities(paragraphs[0]);\n                    }\n                } else {\n                    html = Util.htmlEntities(pastedPlain);\n                }\n                Util.insertHTMLCommand(this.document, html);\n            }\n        },\n\n        cleanPaste: function (text) {\n            var i, elList,\n                multiline = /<p|<br|<div/.test(text),\n                replacements = createReplacements().concat(this.cleanReplacements || []);\n\n            for (i = 0; i < replacements.length; i += 1) {\n                text = text.replace(replacements[i][0], replacements[i][1]);\n            }\n\n            if (!multiline) {\n                return this.pasteHTML(text);\n            }\n\n            // double br's aren't converted to p tags, but we want paragraphs.\n            elList = text.split('<br><br>');\n\n            this.pasteHTML('<p>' + elList.join('</p><p>') + '</p>');\n        },\n\n        pasteHTML: function (html, options) {\n            options = Util.defaults({}, options, {\n                cleanAttrs: this.cleanAttrs,\n                cleanTags: this.cleanTags\n            });\n\n            var elList, workEl, i, fragmentBody, pasteBlock = this.document.createDocumentFragment();\n\n            pasteBlock.appendChild(this.document.createElement('body'));\n\n            fragmentBody = pasteBlock.querySelector('body');\n            fragmentBody.innerHTML = html;\n\n            this.cleanupSpans(fragmentBody);\n\n            elList = fragmentBody.querySelectorAll('*');\n            for (i = 0; i < elList.length; i += 1) {\n                workEl = elList[i];\n\n                if ('a' === workEl.tagName.toLowerCase() && this.targetBlank) {\n                    Util.setTargetBlank(workEl);\n                }\n\n                Util.cleanupAttrs(workEl, options.cleanAttrs);\n                Util.cleanupTags(workEl, options.cleanTags);\n            }\n\n            // block element cleanup\n            elList = fragmentBody.querySelectorAll('a,p,div,br');\n            for (i = 0; i < elList.length; i += 1) {\n                workEl = elList[i];\n\n                // Microsoft Word replaces some spaces with newlines.\n                // While newlines between block elements are meaningless, newlines within\n                // elements are sometimes actually spaces.\n                workEl.innerHTML = workEl.innerHTML.replace(/\\n/gi, ' ');\n\n                switch (workEl.nodeName.toLowerCase()) {\n                    case 'p':\n                    case 'div':\n                        this.filterCommonBlocks(workEl);\n                        break;\n                    case 'br':\n                        this.filterLineBreak(workEl);\n                        break;\n                }\n            }\n\n            Util.insertHTMLCommand(this.document, fragmentBody.innerHTML.replace(/&nbsp;/g, ' '));\n        },\n\n        isCommonBlock: function (el) {\n            return (el && (el.tagName.toLowerCase() === 'p' || el.tagName.toLowerCase() === 'div'));\n        },\n\n        filterCommonBlocks: function (el) {\n            if (/^\\s*$/.test(el.textContent) && el.parentNode) {\n                el.parentNode.removeChild(el);\n            }\n        },\n\n        filterLineBreak: function (el) {\n            if (this.isCommonBlock(el.previousElementSibling)) {\n                // remove stray br's following common block elements\n                this.removeWithParent(el);\n            } else if (this.isCommonBlock(el.parentNode) && (el.parentNode.firstChild === el || el.parentNode.lastChild === el)) {\n                // remove br's just inside open or close tags of a div/p\n                this.removeWithParent(el);\n            } else if (el.parentNode && el.parentNode.childElementCount === 1 && el.parentNode.textContent === '') {\n                // and br's that are the only child of elements other than div/p\n                this.removeWithParent(el);\n            }\n        },\n\n        // remove an element, including its parent, if it is the only element within its parent\n        removeWithParent: function (el) {\n            if (el && el.parentNode) {\n                if (el.parentNode.parentNode && el.parentNode.childElementCount === 1) {\n                    el.parentNode.parentNode.removeChild(el.parentNode);\n                } else {\n                    el.parentNode.removeChild(el);\n                }\n            }\n        },\n\n        cleanupSpans: function (containerEl) {\n            var i,\n                el,\n                newEl,\n                spans = containerEl.querySelectorAll('.replace-with'),\n                isCEF = function (el) {\n                    return (el && el.nodeName !== '#text' && el.getAttribute('contenteditable') === 'false');\n                };\n\n            for (i = 0; i < spans.length; i += 1) {\n                el = spans[i];\n                newEl = this.document.createElement(el.classList.contains('bold') ? 'b' : 'i');\n\n                if (el.classList.contains('bold') && el.classList.contains('italic')) {\n                    // add an i tag as well if this has both italics and bold\n                    newEl.innerHTML = '<i>' + el.innerHTML + '</i>';\n                } else {\n                    newEl.innerHTML = el.innerHTML;\n                }\n                el.parentNode.replaceChild(newEl, el);\n            }\n\n            spans = containerEl.querySelectorAll('span');\n            for (i = 0; i < spans.length; i += 1) {\n                el = spans[i];\n\n                // bail if span is in contenteditable = false\n                if (Util.traverseUp(el, isCEF)) {\n                    return false;\n                }\n\n                // remove empty spans, replace others with their contents\n                Util.unwrap(el, this.document);\n            }\n        }\n    });\n}());\n\nvar Placeholder;\n\n(function () {\n    'use strict';\n\n    /*global Extension */\n\n    Placeholder = Extension.extend({\n        name: 'placeholder',\n\n        /* Placeholder Options */\n\n        /* text: [string]\n         * Text to display in the placeholder\n         */\n        text: 'Type your text',\n\n        /* hideOnClick: [boolean]\n         * Should we hide the placeholder on click (true) or when user starts typing (false)\n         */\n        hideOnClick: true,\n\n        init: function () {\n            this.initPlaceholders();\n            this.attachEventHandlers();\n        },\n\n        initPlaceholders: function () {\n            this.getEditorElements().forEach(function (el) {\n                if (!el.getAttribute('data-placeholder')) {\n                    el.setAttribute('data-placeholder', this.text);\n                }\n                this.updatePlaceholder(el);\n            }, this);\n        },\n\n        destroy: function () {\n            this.getEditorElements().forEach(function (el) {\n                if (el.getAttribute('data-placeholder') === this.text) {\n                    el.removeAttribute('data-placeholder');\n                }\n            }, this);\n        },\n\n        showPlaceholder: function (el) {\n            if (el) {\n                el.classList.add('medium-editor-placeholder');\n            }\n        },\n\n        hidePlaceholder: function (el) {\n            if (el) {\n                el.classList.remove('medium-editor-placeholder');\n            }\n        },\n\n        updatePlaceholder: function (el) {\n            // if one of these element ('img, blockquote, ul, ol') are found inside the given element, we won't display the placeholder\n            if (!(el.querySelector('img, blockquote, ul, ol')) && el.textContent.replace(/^\\s+|\\s+$/g, '') === '') {\n                return this.showPlaceholder(el);\n            }\n\n            this.hidePlaceholder(el);\n        },\n\n        attachEventHandlers: function () {\n            // Custom events\n            this.subscribe('blur', this.handleExternalInteraction.bind(this));\n\n            // Check placeholder on blur\n            this.subscribe('editableBlur', this.handleBlur.bind(this));\n\n            // if we don't want the placeholder to be removed on click but when user start typing\n            if (this.hideOnClick) {\n                this.subscribe('editableClick', this.handleHidePlaceholderEvent.bind(this));\n            } else {\n                this.subscribe('editableKeyup', this.handleBlur.bind(this));\n            }\n\n            // Events where we always hide the placeholder\n            this.subscribe('editableKeypress', this.handleHidePlaceholderEvent.bind(this));\n            this.subscribe('editablePaste', this.handleHidePlaceholderEvent.bind(this));\n        },\n\n        handleHidePlaceholderEvent: function (event, element) {\n            // Events where we hide the placeholder\n            this.hidePlaceholder(element);\n        },\n\n        handleBlur: function (event, element) {\n            // Update placeholder for element that lost focus\n            this.updatePlaceholder(element);\n        },\n\n        handleExternalInteraction: function () {\n            // Update all placeholders\n            this.initPlaceholders();\n        }\n    });\n}());\n\nvar Toolbar;\n\n(function () {\n    'use strict';\n\n    Toolbar = function (instance) {\n        this.base = instance;\n        this.options = instance.options;\n\n        this.initThrottledMethods();\n    };\n\n    Toolbar.prototype = {\n        // Toolbar creation/deletion\n\n        createToolbar: function () {\n            var toolbar = this.base.options.ownerDocument.createElement('div');\n\n            toolbar.id = 'medium-editor-toolbar-' + this.base.id;\n            toolbar.className = 'medium-editor-toolbar';\n\n            if (this.options.staticToolbar) {\n                toolbar.className += ' static-toolbar';\n            } else {\n                toolbar.className += ' stalker-toolbar';\n            }\n\n            toolbar.appendChild(this.createToolbarButtons());\n\n            // Add any forms that extensions may have\n            this.base.commands.forEach(function (extension) {\n                if (extension.hasForm) {\n                    toolbar.appendChild(extension.getForm());\n                }\n            });\n\n            this.attachEventHandlers();\n\n            return toolbar;\n        },\n\n        createToolbarButtons: function () {\n            var ul = this.base.options.ownerDocument.createElement('ul'),\n                li,\n                btn,\n                buttons,\n                extension;\n\n            ul.id = 'medium-editor-toolbar-actions' + this.base.id;\n            ul.className = 'medium-editor-toolbar-actions clearfix';\n            ul.style.display = 'block';\n\n            this.base.options.buttons.forEach(function (button) {\n                extension = this.base.getExtensionByName(button);\n                if (typeof extension.getButton === 'function') {\n                    btn = extension.getButton(this.base);\n                    li = this.base.options.ownerDocument.createElement('li');\n                    if (Util.isElement(btn)) {\n                        li.appendChild(btn);\n                    } else {\n                        li.innerHTML = btn;\n                    }\n                    ul.appendChild(li);\n                }\n            }.bind(this));\n\n            buttons = ul.querySelectorAll('button');\n            if (buttons.length > 0) {\n                buttons[0].classList.add(this.options.firstButtonClass);\n                buttons[buttons.length - 1].classList.add(this.options.lastButtonClass);\n            }\n\n            return ul;\n        },\n\n        destroy: function () {\n            if (this.toolbar) {\n                if (this.toolbar.parentNode) {\n                    this.toolbar.parentNode.removeChild(this.toolbar);\n                }\n                delete this.toolbar;\n            }\n        },\n\n        // TODO: deprecate\n        deactivate: function () {\n            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n        },\n\n        // Toolbar accessors\n\n        getToolbarElement: function () {\n            if (!this.toolbar) {\n                this.toolbar = this.createToolbar();\n            }\n\n            return this.toolbar;\n        },\n\n        getToolbarActionsElement: function () {\n            return this.getToolbarElement().querySelector('.medium-editor-toolbar-actions');\n        },\n\n        // Toolbar event handlers\n\n        initThrottledMethods: function () {\n            // throttledPositionToolbar is throttled because:\n            // - It will be called when the browser is resizing, which can fire many times very quickly\n            // - For some event (like resize) a slight lag in UI responsiveness is OK and provides performance benefits\n            this.throttledPositionToolbar = Util.throttle(function () {\n                if (this.base.isActive) {\n                    this.positionToolbarIfShown();\n                }\n            }.bind(this));\n        },\n\n        attachEventHandlers: function () {\n            // MediumEditor custom events for when user beings and ends interaction with a contenteditable and its elements\n            this.base.subscribe('blur', this.handleBlur.bind(this));\n            this.base.subscribe('focus', this.handleFocus.bind(this));\n\n            // Updating the state of the toolbar as things change\n            this.base.subscribe('editableClick', this.handleEditableClick.bind(this));\n            this.base.subscribe('editableKeyup', this.handleEditableKeyup.bind(this));\n\n            // Handle mouseup on document for updating the selection in the toolbar\n            this.base.on(this.options.ownerDocument.documentElement, 'mouseup', this.handleDocumentMouseup.bind(this));\n\n            // Add a scroll event for sticky toolbar\n            if (this.options.staticToolbar && this.options.stickyToolbar) {\n                // On scroll (capture), re-position the toolbar\n                this.base.on(this.options.contentWindow, 'scroll', this.handleWindowScroll.bind(this), true);\n            }\n\n            // On resize, re-position the toolbar\n            this.base.on(this.options.contentWindow, 'resize', this.handleWindowResize.bind(this));\n        },\n\n        handleWindowScroll: function () {\n            this.positionToolbarIfShown();\n        },\n\n        handleWindowResize: function () {\n            this.throttledPositionToolbar();\n        },\n\n        handleDocumentMouseup: function (event) {\n            // Do not trigger checkState when mouseup fires over the toolbar\n            if (event &&\n                    event.target &&\n                    Util.isDescendant(this.getToolbarElement(), event.target)) {\n                return false;\n            }\n            this.checkState();\n        },\n\n        handleEditableClick: function () {\n            // Delay the call to checkState to handle bug where selection is empty\n            // immediately after clicking inside a pre-existing selection\n            setTimeout(function () {\n                this.checkState();\n            }.bind(this), 0);\n        },\n\n        handleEditableKeyup: function () {\n            this.checkState();\n        },\n\n        handleBlur: function () {\n            // Kill any previously delayed calls to hide the toolbar\n            clearTimeout(this.hideTimeout);\n\n            // Blur may fire even if we have a selection, so we want to prevent any delayed showToolbar\n            // calls from happening in this specific case\n            clearTimeout(this.delayShowTimeout);\n\n            // Delay the call to hideToolbar to handle bug with multiple editors on the page at once\n            this.hideTimeout = setTimeout(function () {\n                this.hideToolbar();\n            }.bind(this), 1);\n        },\n\n        handleFocus: function () {\n            this.checkState();\n        },\n\n        // Hiding/showing toolbar\n\n        isDisplayed: function () {\n            return this.getToolbarElement().classList.contains('medium-editor-toolbar-active');\n        },\n\n        showToolbar: function () {\n            clearTimeout(this.hideTimeout);\n            if (!this.isDisplayed()) {\n                this.getToolbarElement().classList.add('medium-editor-toolbar-active');\n                this.base.trigger('showToolbar', {}, this.base.getFocusedElement());\n\n                if (typeof this.options.onShowToolbar === 'function') {\n                    Util.deprecated('onShowToolbar', 'the showToolbar custom event', 'v5.0.0');\n                    this.options.onShowToolbar();\n                }\n            }\n        },\n\n        hideToolbar: function () {\n            if (this.isDisplayed()) {\n                this.getToolbarElement().classList.remove('medium-editor-toolbar-active');\n                this.base.trigger('hideToolbar', {}, this.base.getFocusedElement());\n\n                this.base.commands.forEach(function (extension) {\n                    if (typeof extension.onHide === 'function') {\n                        Util.deprecated('onHide', 'the hideToolbar custom event', 'v5.0.0');\n                        extension.onHide();\n                    }\n                });\n\n                if (typeof this.options.onHideToolbar === 'function') {\n                    Util.deprecated('onHideToolbar', 'the hideToolbar custom event', 'v5.0.0');\n                    this.options.onHideToolbar();\n                }\n            }\n        },\n\n        isToolbarDefaultActionsDisplayed: function () {\n            return this.getToolbarActionsElement().style.display === 'block';\n        },\n\n        hideToolbarDefaultActions: function () {\n            if (this.isToolbarDefaultActionsDisplayed()) {\n                this.getToolbarActionsElement().style.display = 'none';\n            }\n        },\n\n        showToolbarDefaultActions: function () {\n            this.hideExtensionForms();\n\n            if (!this.isToolbarDefaultActionsDisplayed()) {\n                this.getToolbarActionsElement().style.display = 'block';\n            }\n\n            // Using setTimeout + options.delay because:\n            // We will actually be displaying the toolbar, which should be controlled by options.delay\n            this.delayShowTimeout = this.base.delay(function () {\n                this.showToolbar();\n            }.bind(this));\n        },\n\n        hideExtensionForms: function () {\n            // Hide all extension forms\n            this.base.commands.forEach(function (extension) {\n                if (extension.hasForm && extension.isDisplayed()) {\n                    extension.hideForm();\n                }\n            });\n        },\n\n        // Responding to changes in user selection\n\n        // Checks for existance of multiple block elements in the current selection\n        multipleBlockElementsSelected: function () {\n            var regexEmptyHTMLTags = /<[^\\/>][^>]*><\\/[^>]+>/gim, // http://stackoverflow.com/questions/3129738/remove-empty-tags-using-regex\n                regexBlockElements = new RegExp('<(' + Util.parentElements.join('|') + ')[^>]*>', 'g'),\n                selectionHTML = Selection.getSelectionHtml.call(this).replace(regexEmptyHTMLTags, ''), // Filter out empty blocks from selection\n                hasMultiParagraphs = selectionHTML.match(regexBlockElements); // Find how many block elements are within the html\n\n            return !!hasMultiParagraphs && hasMultiParagraphs.length > 1;\n        },\n\n        modifySelection: function () {\n            var selection = this.options.contentWindow.getSelection(),\n                selectionRange = selection.getRangeAt(0);\n\n            /*\n            * In firefox, there are cases (ie doubleclick of a word) where the selectionRange start\n            * will be at the very end of an element.  In other browsers, the selectionRange start\n            * would instead be at the very beginning of an element that actually has content.\n            * example:\n            *   <span>foo</span><span>bar</span>\n            *\n            * If the text 'bar' is selected, most browsers will have the selectionRange start at the beginning\n            * of the 'bar' span.  However, there are cases where firefox will have the selectionRange start\n            * at the end of the 'foo' span.  The contenteditable behavior will be ok, but if there are any\n            * properties on the 'bar' span, they won't be reflected accurately in the toolbar\n            * (ie 'Bold' button wouldn't be active)\n            *\n            * So, for cases where the selectionRange start is at the end of an element/node, find the next\n            * adjacent text node that actually has content in it, and move the selectionRange start there.\n            */\n            if (this.options.standardizeSelectionStart &&\n                    selectionRange.startContainer.nodeValue &&\n                    (selectionRange.startOffset === selectionRange.startContainer.nodeValue.length)) {\n                var adjacentNode = Util.findAdjacentTextNodeWithContent(Selection.getSelectionElement(this.options.contentWindow), selectionRange.startContainer, this.options.ownerDocument);\n                if (adjacentNode) {\n                    var offset = 0;\n                    while (adjacentNode.nodeValue.substr(offset, 1).trim().length === 0) {\n                        offset = offset + 1;\n                    }\n                    var newRange = this.options.ownerDocument.createRange();\n                    newRange.setStart(adjacentNode, offset);\n                    newRange.setEnd(selectionRange.endContainer, selectionRange.endOffset);\n                    selection.removeAllRanges();\n                    selection.addRange(newRange);\n                    selectionRange = newRange;\n                }\n            }\n        },\n\n        checkState: function () {\n            if (this.base.preventSelectionUpdates) {\n                return;\n            }\n\n            // If no editable has focus OR selection is inside contenteditable = false\n            // hide toolbar\n            if (!this.base.getFocusedElement() ||\n                    Selection.selectionInContentEditableFalse(this.options.contentWindow)) {\n                return this.hideToolbar();\n            }\n\n            // If there's no selection element, selection element doesn't belong to this editor\n            // or toolbar is disabled for this selection element\n            // hide toolbar\n            var selectionElement = Selection.getSelectionElement(this.options.contentWindow);\n            if (!selectionElement ||\n                    this.base.elements.indexOf(selectionElement) === -1 ||\n                    selectionElement.getAttribute('data-disable-toolbar')) {\n                return this.hideToolbar();\n            }\n\n            // Now we know there's a focused editable with a selection\n\n            // If the updateOnEmptySelection option is true, show the toolbar\n            if (this.options.updateOnEmptySelection && this.options.staticToolbar) {\n                return this.showAndUpdateToolbar();\n            }\n\n            // If we don't have a 'valid' selection -> hide toolbar\n            if (this.options.contentWindow.getSelection().toString().trim() === '' ||\n                (this.options.allowMultiParagraphSelection === false && this.multipleBlockElementsSelected())) {\n                return this.hideToolbar();\n            }\n\n            this.showAndUpdateToolbar();\n        },\n\n        // leaving here backward compatibility / statics\n        getFocusedElement: function () {\n            return this.base.getFocusedElement();\n        },\n\n        // Updating the toolbar\n\n        showAndUpdateToolbar: function () {\n            this.modifySelection();\n            this.setToolbarButtonStates();\n            this.base.trigger('positionToolbar', {}, this.base.getFocusedElement());\n            this.showToolbarDefaultActions();\n            this.setToolbarPosition();\n        },\n\n        setToolbarButtonStates: function () {\n            this.base.commands.forEach(function (extension) {\n                if (typeof extension.isActive === 'function' &&\n                    typeof extension.setInactive === 'function') {\n                    extension.setInactive();\n                }\n            }.bind(this));\n\n            this.checkActiveButtons();\n        },\n\n        checkActiveButtons: function () {\n            var manualStateChecks = [],\n                queryState = null,\n                selectionRange = Selection.getSelectionRange(this.options.ownerDocument),\n                parentNode,\n                updateExtensionState = function (extension) {\n                    if (typeof extension.checkState === 'function') {\n                        extension.checkState(parentNode);\n                    } else if (typeof extension.isActive === 'function' &&\n                               typeof extension.isAlreadyApplied === 'function' &&\n                               typeof extension.setActive === 'function') {\n                        if (!extension.isActive() && extension.isAlreadyApplied(parentNode)) {\n                            extension.setActive();\n                        }\n                    }\n                };\n\n            if (!selectionRange) {\n                return;\n            }\n\n            parentNode = Selection.getSelectedParentElement(selectionRange);\n\n            // Loop through all commands\n            this.base.commands.forEach(function (command) {\n                // For those commands where we can use document.queryCommandState(), do so\n                if (typeof command.queryCommandState === 'function') {\n                    queryState = command.queryCommandState();\n                    // If queryCommandState returns a valid value, we can trust the browser\n                    // and don't need to do our manual checks\n                    if (queryState !== null) {\n                        if (queryState && typeof command.setActive === 'function') {\n                            command.setActive();\n                        }\n                        return;\n                    }\n                }\n                // We can't use queryCommandState for this command, so add to manualStateChecks\n                manualStateChecks.push(command);\n            });\n\n            // Climb up the DOM and do manual checks for whether a certain command is currently enabled for this node\n            while (parentNode.tagName !== undefined && Util.parentElements.indexOf(parentNode.tagName.toLowerCase) === -1) {\n                manualStateChecks.forEach(updateExtensionState);\n\n                // we can abort the search upwards if we leave the contentEditable element\n                if (this.base.elements.indexOf(parentNode) !== -1) {\n                    break;\n                }\n                parentNode = parentNode.parentNode;\n            }\n        },\n\n        // Positioning toolbar\n\n        positionToolbarIfShown: function () {\n            if (this.isDisplayed()) {\n                this.setToolbarPosition();\n            }\n        },\n\n        setToolbarPosition: function () {\n            var container = this.base.getFocusedElement(),\n                selection = this.options.contentWindow.getSelection(),\n                anchorPreview;\n\n            // If there isn't a valid selection, bail\n            if (!container) {\n                return this;\n            }\n\n            if (this.options.staticToolbar) {\n                this.showToolbar();\n                this.positionStaticToolbar(container);\n            } else if (!selection.isCollapsed) {\n                this.showToolbar();\n                this.positionToolbar(selection);\n            }\n\n            anchorPreview = this.base.getExtensionByName('anchor-preview');\n\n            if (anchorPreview && typeof anchorPreview.hidePreview === 'function') {\n                anchorPreview.hidePreview();\n            }\n        },\n\n        positionStaticToolbar: function (container) {\n            // position the toolbar at left 0, so we can get the real width of the toolbar\n            this.getToolbarElement().style.left = '0';\n\n            // document.documentElement for IE 9\n            var scrollTop = (this.options.ownerDocument.documentElement && this.options.ownerDocument.documentElement.scrollTop) || this.options.ownerDocument.body.scrollTop,\n                windowWidth = this.options.contentWindow.innerWidth,\n                toolbarElement = this.getToolbarElement(),\n                containerRect = container.getBoundingClientRect(),\n                containerTop = containerRect.top + scrollTop,\n                containerCenter = (containerRect.left + (containerRect.width / 2)),\n                toolbarHeight = toolbarElement.offsetHeight,\n                toolbarWidth = toolbarElement.offsetWidth,\n                halfOffsetWidth = toolbarWidth / 2,\n                targetLeft;\n\n            if (this.options.stickyToolbar) {\n                // If it's beyond the height of the editor, position it at the bottom of the editor\n                if (scrollTop > (containerTop + container.offsetHeight - toolbarHeight)) {\n                    toolbarElement.style.top = (containerTop + container.offsetHeight - toolbarHeight) + 'px';\n                    toolbarElement.classList.remove('sticky-toolbar');\n\n                // Stick the toolbar to the top of the window\n                } else if (scrollTop > (containerTop - toolbarHeight)) {\n                    toolbarElement.classList.add('sticky-toolbar');\n                    toolbarElement.style.top = '0px';\n\n                // Normal static toolbar position\n                } else {\n                    toolbarElement.classList.remove('sticky-toolbar');\n                    toolbarElement.style.top = containerTop - toolbarHeight + 'px';\n                }\n            } else {\n                toolbarElement.style.top = containerTop - toolbarHeight + 'px';\n            }\n\n            switch (this.options.toolbarAlign) {\n                case 'left':\n                    targetLeft = containerRect.left;\n                    break;\n\n                case 'right':\n                    targetLeft = containerRect.right - toolbarWidth;\n                    break;\n\n                case 'center':\n                    targetLeft = containerCenter - halfOffsetWidth;\n                    break;\n            }\n\n            if (targetLeft < 0) {\n                targetLeft = 0;\n            } else if ((targetLeft + toolbarWidth) > windowWidth) {\n                targetLeft = (windowWidth - Math.ceil(toolbarWidth) - 1);\n            }\n\n            toolbarElement.style.left = targetLeft + 'px';\n        },\n\n        positionToolbar: function (selection) {\n            // position the toolbar at left 0, so we can get the real width of the toolbar\n            this.getToolbarElement().style.left = '0';\n\n            var windowWidth = this.options.contentWindow.innerWidth,\n                range = selection.getRangeAt(0),\n                boundary = range.getBoundingClientRect(),\n                middleBoundary = (boundary.left + boundary.right) / 2,\n                toolbarElement = this.getToolbarElement(),\n                toolbarHeight = toolbarElement.offsetHeight,\n                toolbarWidth = toolbarElement.offsetWidth,\n                halfOffsetWidth = toolbarWidth / 2,\n                buttonHeight = 50,\n                defaultLeft = this.options.diffLeft - halfOffsetWidth;\n\n            if (boundary.top < buttonHeight) {\n                toolbarElement.classList.add('medium-toolbar-arrow-over');\n                toolbarElement.classList.remove('medium-toolbar-arrow-under');\n                toolbarElement.style.top = buttonHeight + boundary.bottom - this.options.diffTop + this.options.contentWindow.pageYOffset - toolbarHeight + 'px';\n            } else {\n                toolbarElement.classList.add('medium-toolbar-arrow-under');\n                toolbarElement.classList.remove('medium-toolbar-arrow-over');\n                toolbarElement.style.top = boundary.top + this.options.diffTop + this.options.contentWindow.pageYOffset - toolbarHeight + 'px';\n            }\n\n            if (middleBoundary < halfOffsetWidth) {\n                toolbarElement.style.left = defaultLeft + halfOffsetWidth + 'px';\n            } else if ((windowWidth - middleBoundary) < halfOffsetWidth) {\n                toolbarElement.style.left = windowWidth + defaultLeft - halfOffsetWidth + 'px';\n            } else {\n                toolbarElement.style.left = defaultLeft + middleBoundary + 'px';\n            }\n        }\n    };\n}());\n\nvar extensionDefaults;\n(function () {\n    // for now this is empty because nothing interally uses an Extension default.\n    // as they are converted, provide them here.\n    extensionDefaults = {\n        button: Button,\n        form: FormExtension,\n\n        anchor: AnchorForm,\n        anchorPreview: AnchorPreview,\n        autoLink: AutoLink,\n        fontSize: FontSizeForm,\n        imageDragging: ImageDragging,\n        paste: PasteHandler,\n        placeholder: Placeholder\n    };\n})();\n\nfunction MediumEditor(elements, options) {\n    'use strict';\n    return this.init(elements, options);\n}\n\n(function () {\n    'use strict';\n\n    // Event handlers that shouldn't be exposed externally\n\n    function handleDisabledEnterKeydown(event, element) {\n        if (this.options.disableReturn || element.getAttribute('data-disable-return')) {\n            event.preventDefault();\n        } else if (this.options.disableDoubleReturn || element.getAttribute('data-disable-double-return')) {\n            var node = Selection.getSelectionStart(this.options.ownerDocument);\n\n            // if current text selection is empty OR previous sibling text is empty\n            if ((node && node.textContent.trim() === '') ||\n                (node.previousElementSibling && node.previousElementSibling.textContent.trim() === '')) {\n                event.preventDefault();\n            }\n        }\n    }\n\n    function handleTabKeydown(event) {\n        // Override tab only for pre nodes\n        var node = Selection.getSelectionStart(this.options.ownerDocument),\n            tag = node && node.tagName.toLowerCase();\n\n        if (tag === 'pre') {\n            event.preventDefault();\n            Util.insertHTMLCommand(this.options.ownerDocument, '    ');\n        }\n\n        // Tab to indent list structures!\n        if (Util.isListItem(node)) {\n            event.preventDefault();\n\n            // If Shift is down, outdent, otherwise indent\n            if (event.shiftKey) {\n                this.options.ownerDocument.execCommand('outdent', false, null);\n            } else {\n                this.options.ownerDocument.execCommand('indent', false, null);\n            }\n        }\n    }\n\n    function handleBlockDeleteKeydowns(event) {\n        var p, node = Selection.getSelectionStart(this.options.ownerDocument),\n            tagName = node.tagName.toLowerCase(),\n            isEmpty = /^(\\s+|<br\\/?>)?$/i,\n            isHeader = /h\\d/i;\n\n        if (Util.isKey(event, [Util.keyCode.BACKSPACE, Util.keyCode.ENTER]) &&\n                // has a preceeding sibling\n                node.previousElementSibling &&\n                // in a header\n                isHeader.test(tagName) &&\n                // at the very end of the block\n                Selection.getCaretOffsets(node).left === 0) {\n            if (Util.isKey(event, Util.keyCode.BACKSPACE) && isEmpty.test(node.previousElementSibling.innerHTML)) {\n                // backspacing the begining of a header into an empty previous element will\n                // change the tagName of the current node to prevent one\n                // instead delete previous node and cancel the event.\n                node.previousElementSibling.parentNode.removeChild(node.previousElementSibling);\n                event.preventDefault();\n            } else if (Util.isKey(event, Util.keyCode.ENTER)) {\n                // hitting return in the begining of a header will create empty header elements before the current one\n                // instead, make \"<p><br></p>\" element, which are what happens if you hit return in an empty paragraph\n                p = this.options.ownerDocument.createElement('p');\n                p.innerHTML = '<br>';\n                node.previousElementSibling.parentNode.insertBefore(p, node);\n                event.preventDefault();\n            }\n        } else if (Util.isKey(event, Util.keyCode.DELETE) &&\n                    // between two sibling elements\n                    node.nextElementSibling &&\n                    node.previousElementSibling &&\n                    // not in a header\n                    !isHeader.test(tagName) &&\n                    // in an empty tag\n                    isEmpty.test(node.innerHTML) &&\n                    // when the next tag *is* a header\n                    isHeader.test(node.nextElementSibling.tagName)) {\n            // hitting delete in an empty element preceding a header, ex:\n            //  <p>[CURSOR]</p><h1>Header</h1>\n            // Will cause the h1 to become a paragraph.\n            // Instead, delete the paragraph node and move the cursor to the begining of the h1\n\n            // remove node and move cursor to start of header\n            Selection.moveCursor(this.options.ownerDocument, node.nextElementSibling);\n\n            node.previousElementSibling.parentNode.removeChild(node);\n\n            event.preventDefault();\n        } else if (Util.isKey(event, Util.keyCode.BACKSPACE) &&\n                tagName === 'li' &&\n                // hitting backspace inside an empty li\n                isEmpty.test(node.innerHTML) &&\n                // is first element (no preceeding siblings)\n                !node.previousElementSibling &&\n                // parent also does not have a sibling\n                !node.parentElement.previousElementSibling &&\n                // is not the only li in a list\n                node.nextElementSibling &&\n                node.nextElementSibling.tagName.toLowerCase() === 'li') {\n            // backspacing in an empty first list element in the first list (with more elements) ex:\n            //  <ul><li>[CURSOR]</li><li>List Item 2</li></ul>\n            // will remove the first <li> but add some extra element before (varies based on browser)\n            // Instead, this will:\n            // 1) remove the list element\n            // 2) create a paragraph before the list\n            // 3) move the cursor into the paragraph\n\n            // create a paragraph before the list\n            p = this.options.ownerDocument.createElement('p');\n            p.innerHTML = '<br>';\n            node.parentElement.parentElement.insertBefore(p, node.parentElement);\n\n            // move the cursor into the new paragraph\n            Selection.moveCursor(this.options.ownerDocument, p);\n\n            // remove the list element\n            node.parentElement.removeChild(node);\n\n            event.preventDefault();\n        }\n    }\n\n    function handleKeyup(event) {\n        var node = Selection.getSelectionStart(this.options.ownerDocument),\n            tagName;\n\n        if (!node) {\n            return;\n        }\n\n        if (node.getAttribute('data-medium-element') && node.children.length === 0) {\n            this.options.ownerDocument.execCommand('formatBlock', false, 'p');\n        }\n\n        if (Util.isKey(event, Util.keyCode.ENTER) && !Util.isListItem(node)) {\n            tagName = node.tagName.toLowerCase();\n            // For anchor tags, unlink\n            if (tagName === 'a') {\n                this.options.ownerDocument.execCommand('unlink', false, null);\n            } else if (!event.shiftKey && !event.ctrlKey) {\n                // only format block if this is not a header tag\n                if (!/h\\d/.test(tagName)) {\n                    this.options.ownerDocument.execCommand('formatBlock', false, 'p');\n                }\n            }\n        }\n    }\n\n    // Internal helper methods which shouldn't be exposed externally\n\n    function createElementsArray(selector) {\n        if (!selector) {\n            selector = [];\n        }\n        // If string, use as query selector\n        if (typeof selector === 'string') {\n            selector = this.options.ownerDocument.querySelectorAll(selector);\n        }\n        // If element, put into array\n        if (Util.isElement(selector)) {\n            selector = [selector];\n        }\n        // Convert NodeList (or other array like object) into an array\n        var elements = Array.prototype.slice.apply(selector);\n\n        // Loop through elements and convert textarea's into divs\n        this.elements = [];\n        elements.forEach(function (element, index) {\n            if (element.tagName.toLowerCase() === 'textarea') {\n                this.elements.push(createContentEditable.call(this, element, index));\n            } else {\n                this.elements.push(element);\n            }\n        }, this);\n    }\n\n    function setExtensionDefaults(extension, defaults) {\n        Object.keys(defaults).forEach(function (prop) {\n            if (extension[prop] === undefined) {\n                extension[prop] = defaults[prop];\n            }\n        });\n        return extension;\n    }\n\n    function initExtension(extension, name, instance) {\n        if (typeof extension.parent !== 'undefined') {\n            Util.warn('Extension .parent property has been deprecated.  ' +\n                'The .base property for extensions will always be set to MediumEditor in version 5.0.0');\n        }\n        var extensionDefaults = {\n            'window': instance.options.contentWindow,\n            'document': instance.options.ownerDocument\n        };\n        // TODO: Deprecated (Remove .parent check in v5.0.0)\n        if (extension.parent !== false) {\n            extensionDefaults.base = instance;\n        }\n        // Add default options into the extension\n        extension = setExtensionDefaults(extension, extensionDefaults);\n\n        // Call init on the extension\n        if (typeof extension.init === 'function') {\n            // Passing instance into init() will be deprecated in v5.0.0\n            extension.init(instance);\n        }\n\n        // Set extension name (if not already set)\n        if (!extension.name) {\n            extension.name = name;\n        }\n        return extension;\n    }\n\n    function shouldAddDefaultAnchorPreview() {\n        var i,\n            shouldAdd = false;\n\n        // TODO: deprecated\n        // If anchor-preview is disabled, don't add\n        if (this.options.disableAnchorPreview) {\n            return false;\n        }\n        // If anchor-preview is disabled, don't add\n        if (this.options.anchorPreview === false) {\n            return false;\n        }\n        // If anchor-preview extension has been overriden, don't add\n        if (this.options.extensions['anchor-preview']) {\n            return false;\n        }\n        // If toolbar is disabled, don't add\n        if (this.options.disableToolbar) {\n            return false;\n        }\n        // If all elements have 'data-disable-toolbar' attribute, don't add\n        for (i = 0; i < this.elements.length; i += 1) {\n            if (!this.elements[i].getAttribute('data-disable-toolbar')) {\n                shouldAdd = true;\n                break;\n            }\n        }\n\n        return shouldAdd;\n    }\n\n    function shouldAddDefaultPlaceholder() {\n        if (this.options.extensions['placeholder']) {\n            return false;\n        }\n\n        // TODO: deprecated\n        if (this.options.disablePlaceholders) {\n            return false;\n        }\n\n        return this.options.placeholder !== false;\n    }\n\n    function shouldAddDefaultAutoLink() {\n        if (this.options.extensions['auto-link']) {\n            return false;\n        }\n\n        return this.options.autoLink !== false;\n    }\n\n    function shouldAddDefaultImageDragging() {\n        if (this.options.extensions['image-dragging']) {\n            return false;\n        }\n\n        return this.options.imageDragging !== false;\n    }\n\n    function createContentEditable(textarea, id) {\n        var div = this.options.ownerDocument.createElement('div'),\n            uniqueId = 'medium-editor-' + Date.now() + '-' + id,\n            attributesToClone = [\n                'data-disable-editing',\n                'data-disable-toolbar',\n                'data-placeholder',\n                'data-disable-return',\n                'data-disable-double-return',\n                'data-disable-preview',\n                'spellcheck'\n            ];\n\n        div.className = textarea.className;\n        div.id = uniqueId;\n        div.innerHTML = textarea.value;\n        div.setAttribute('medium-editor-textarea-id', id);\n        attributesToClone.forEach(function (attr) {\n            if (textarea.hasAttribute(attr)) {\n                div.setAttribute(attr, textarea.getAttribute(attr));\n            }\n        });\n\n        textarea.classList.add('medium-editor-hidden');\n        textarea.setAttribute('medium-editor-textarea-id', id);\n        textarea.parentNode.insertBefore(\n            div,\n            textarea\n        );\n\n        return div;\n    }\n\n    function initElements() {\n        this.elements.forEach(function (element, index) {\n            if (!this.options.disableEditing && !element.getAttribute('data-disable-editing')) {\n                element.setAttribute('contentEditable', true);\n                element.setAttribute('spellcheck', this.options.spellcheck);\n            }\n            element.setAttribute('data-medium-element', true);\n            element.setAttribute('role', 'textbox');\n            element.setAttribute('aria-multiline', true);\n            element.setAttribute('medium-editor-index', index);\n\n            if (element.hasAttribute('medium-editor-textarea-id')) {\n                this.on(element, 'input', function (event) {\n                    var target = event.target,\n                        textarea = target.parentNode.querySelector('textarea[medium-editor-textarea-id=\"' + target.getAttribute('medium-editor-textarea-id') + '\"]');\n                    if (textarea) {\n                        textarea.value = this.serialize()[target.id].value;\n                    }\n                }.bind(this));\n            }\n        }, this);\n    }\n\n    function initToolbar() {\n        if (this.toolbar || this.options.disableToolbar) {\n            return false;\n        }\n\n        var addToolbar = this.elements.some(function (element) {\n            return !element.getAttribute('data-disable-toolbar');\n        });\n\n        if (addToolbar) {\n            this.toolbar = new Toolbar(this);\n            this.options.elementsContainer.appendChild(this.toolbar.getToolbarElement());\n        }\n    }\n\n    function attachHandlers() {\n        var i;\n\n        // attach to tabs\n        this.subscribe('editableKeydownTab', handleTabKeydown.bind(this));\n\n        // Bind keys which can create or destroy a block element: backspace, delete, return\n        this.subscribe('editableKeydownDelete', handleBlockDeleteKeydowns.bind(this));\n        this.subscribe('editableKeydownEnter', handleBlockDeleteKeydowns.bind(this));\n\n        // disabling return or double return\n        if (this.options.disableReturn || this.options.disableDoubleReturn) {\n            this.subscribe('editableKeydownEnter', handleDisabledEnterKeydown.bind(this));\n        } else {\n            for (i = 0; i < this.elements.length; i += 1) {\n                if (this.elements[i].getAttribute('data-disable-return') || this.elements[i].getAttribute('data-disable-double-return')) {\n                    this.subscribe('editableKeydownEnter', handleDisabledEnterKeydown.bind(this));\n                    break;\n                }\n            }\n        }\n\n        // if we're not disabling return, add a handler to help handle cleanup\n        // for certain cases when enter is pressed\n        if (!this.options.disableReturn) {\n            this.elements.forEach(function (element) {\n                if (!element.getAttribute('data-disable-return')) {\n                    this.on(element, 'keyup', handleKeyup.bind(this));\n                }\n            }, this);\n        }\n    }\n\n    function initPlaceholder(options) {\n        // Backwards compatability\n        var defaultsBC = {\n            text: (typeof this.options.placeholder === 'string') ? this.options.placeholder : undefined // deprecated\n        };\n\n        return new MediumEditor.extensions.placeholder(\n            Util.extend({}, options, defaultsBC)\n        );\n    }\n\n    function initAnchorPreview(options) {\n        // Backwards compatability\n        var defaultsBC = {\n            hideDelay: this.options.anchorPreviewHideDelay, // deprecated\n            diffLeft: this.options.diffLeft, // deprecated (should use .getEditorOption() instead)\n            diffTop: this.options.diffTop, // deprecated (should use .getEditorOption() instead)\n            elementsContainer: this.options.elementsContainer // deprecated (should use .getEditorOption() instead)\n        };\n\n        return new MediumEditor.extensions.anchorPreview(\n            Util.extend({}, options, defaultsBC)\n        );\n    }\n\n    function initAnchorForm(options) {\n        // Backwards compatability\n        var defaultsBC = {\n            customClassOption: this.options.anchorButton ? (this.options.anchorButtonClass || 'btn') : undefined, // deprecated\n            linkValidation: this.options.checkLinkFormat, //deprecated\n            placeholderText: this.options.anchorInputPlaceholder, // deprecated\n            targetCheckbox: this.options.anchorTarget, // deprecated\n            targetCheckboxText: this.options.anchorInputCheckboxLabel // deprecated\n        };\n\n        return new MediumEditor.extensions.anchor(\n            Util.extend({}, options, defaultsBC)\n        );\n    }\n\n    function initPasteHandler(options) {\n        // Backwards compatability\n        var defaultsBC = {\n            forcePlainText: this.options.forcePlainText, // deprecated\n            cleanPastedHTML: this.options.cleanPastedHTML, // deprecated\n            disableReturn: this.options.disableReturn, // deprecated (should use .getEditorOption() instead)\n            targetBlank: this.options.targetBlank // deprecated (should use .getEditorOption() instead)\n        };\n\n        return new MediumEditor.extensions.paste(\n            Util.extend({}, options, defaultsBC)\n        );\n    }\n\n    function initCommands() {\n        var buttons = this.options.buttons,\n            extensions = this.options.extensions,\n            ext,\n            name;\n        this.commands = [];\n\n        buttons.forEach(function (buttonName) {\n            if (extensions[buttonName]) {\n                ext = initExtension(extensions[buttonName], buttonName, this);\n                this.commands.push(ext);\n            } else if (buttonName === 'anchor') {\n                ext = initExtension(initAnchorForm.call(this, this.options.anchor), 'anchor', this);\n                this.commands.push(ext);\n            } else if (buttonName === 'fontsize') {\n                ext = initExtension(new MediumEditor.extensions.fontSize(), buttonName, this);\n                this.commands.push(ext);\n            } else if (ButtonsData.hasOwnProperty(buttonName)) {\n                ext = initExtension(new MediumEditor.extensions.button(ButtonsData[buttonName]), buttonName, this);\n                this.commands.push(ext);\n            }\n        }, this);\n\n        for (name in extensions) {\n            if (extensions.hasOwnProperty(name) && buttons.indexOf(name) === -1) {\n                ext = initExtension(extensions[name], name, this);\n                this.commands.push(ext);\n            }\n        }\n\n        // Only add default paste extension if it wasn't overriden\n        if (!this.options.extensions['paste']) {\n            this.commands.push(initExtension(initPasteHandler.call(this, this.options.paste), 'paste', this));\n        }\n\n        // Add AnchorPreview as extension if needed\n        if (shouldAddDefaultAnchorPreview.call(this)) {\n            this.commands.push(initExtension(initAnchorPreview.call(this, this.options.anchorPreview), 'anchor-preview', this));\n        }\n\n        if (shouldAddDefaultAutoLink.call(this)) {\n            this.commands.push(initExtension(new MediumEditor.extensions.autoLink(), 'auto-link', this));\n        }\n\n        if (shouldAddDefaultImageDragging.call(this)) {\n            this.commands.push(initExtension(new MediumEditor.extensions.imageDragging(), 'image-dragging', this));\n        }\n\n        if (shouldAddDefaultPlaceholder.call(this)) {\n            var placeholderOpts = (typeof this.options.placeholder === 'string') ? {} : this.options.placeholder;\n            this.commands.push(initExtension(initPlaceholder.call(this, placeholderOpts), 'placeholder', this));\n        }\n    }\n\n    function mergeOptions(defaults, options) {\n        var deprecatedProperties = [\n            ['forcePlainText', 'paste.forcePlainText'],\n            ['cleanPastedHTML', 'paste.cleanPastedHTML'],\n            ['anchorInputPlaceholder', 'anchor.placeholderText'],\n            ['checkLinkFormat', 'anchor.linkValidation'],\n            ['anchorButton', 'anchor.customClassOption'],\n            ['anchorButtonClass', 'anchor.customClassOption'],\n            ['anchorTarget', 'anchor.targetCheckbox'],\n            ['anchorInputCheckboxLabel', 'anchor.targetCheckboxText'],\n            ['anchorPreviewHideDelay', 'anchorPreview.hideDelay'],\n            ['disableAnchorPreview', 'anchorPreview: false'],\n            ['disablePlaceholders', 'placeholder: false'],\n            ['onShowToolbar', 'showToolbar custom event'],\n            ['onHideToolbar', 'hideToolbar custom event']\n        ];\n        // warn about using deprecated properties\n        if (options) {\n            deprecatedProperties.forEach(function (pair) {\n                if (options.hasOwnProperty(pair[0]) && options[pair[0]] !== undefined) {\n                    Util.deprecated(pair[0], pair[1], 'v5.0.0');\n                }\n            });\n\n            if (options.hasOwnProperty('placeholder') && typeof options.placeholder === 'string') {\n                Util.deprecated('placeholder', 'placeholder.text', 'v5.0.0');\n            }\n        }\n\n        return Util.defaults({}, options, defaults);\n    }\n\n    function execActionInternal(action, opts) {\n        /*jslint regexp: true*/\n        var appendAction = /^append-(.+)$/gi,\n            match;\n        /*jslint regexp: false*/\n\n        // Actions starting with 'append-' should attempt to format a block of text ('formatBlock') using a specific\n        // type of block element (ie append-blockquote, append-h1, append-pre, etc.)\n        match = appendAction.exec(action);\n        if (match) {\n            return Util.execFormatBlock(this.options.ownerDocument, match[1]);\n        }\n\n        if (action === 'fontSize') {\n            return this.options.ownerDocument.execCommand('fontSize', false, opts.size);\n        }\n\n        if (action === 'createLink') {\n            return this.createLink(opts);\n        }\n\n        if (action === 'image') {\n            return this.options.ownerDocument.execCommand('insertImage', false, this.options.contentWindow.getSelection());\n        }\n\n        return this.options.ownerDocument.execCommand(action, false, null);\n    }\n\n    // deprecate\n    MediumEditor.statics = {\n        ButtonsData: ButtonsData,\n        DefaultButton: DefaultButton,\n        AnchorExtension: AnchorExtension,\n        FontSizeExtension: FontSizeExtension,\n        Toolbar: Toolbar,\n        AnchorPreview: AnchorPreviewDeprecated\n    };\n\n    MediumEditor.Extension = Extension;\n\n    MediumEditor.extensions = extensionDefaults;\n    MediumEditor.util = Util;\n    MediumEditor.selection = Selection;\n\n    MediumEditor.prototype = {\n        defaults: editorDefaults,\n\n        // NOT DOCUMENTED - exposed for backwards compatability\n        init: function (elements, options) {\n            var uniqueId = 1;\n\n            this.options = mergeOptions.call(this, this.defaults, options);\n            this.origElements = elements;\n\n            if (!this.options.elementsContainer) {\n                this.options.elementsContainer = this.options.ownerDocument.body;\n            }\n\n            while (this.options.elementsContainer.querySelector('#medium-editor-toolbar-' + uniqueId)) {\n                uniqueId = uniqueId + 1;\n            }\n\n            this.id = uniqueId;\n\n            return this.setup();\n        },\n\n        setup: function () {\n            if (this.isActive) {\n                return;\n            }\n\n            createElementsArray.call(this, this.origElements);\n            if (this.elements.length === 0) {\n                return;\n            }\n\n            this.events = new Events(this);\n            this.isActive = true;\n\n            // Call initialization helpers\n            initElements.call(this);\n            initCommands.call(this);\n            initToolbar.call(this);\n            attachHandlers.call(this);\n        },\n\n        destroy: function () {\n            if (!this.isActive) {\n                return;\n            }\n\n            this.isActive = false;\n\n            this.commands.forEach(function (extension) {\n                if (typeof extension.destroy === 'function') {\n                    extension.destroy();\n                } else if (typeof extension.deactivate === 'function') {\n                    Util.warn('Extension .deactivate() function has been deprecated. Use .destroy() instead. This will be removed in version 5.0.0');\n                    extension.deactivate();\n                }\n            }, this);\n\n            if (this.toolbar !== undefined) {\n                this.toolbar.destroy();\n                delete this.toolbar;\n            }\n\n            this.events.destroy();\n\n            this.elements.forEach(function (element) {\n                // Reset elements content, fix for issue where after editor destroyed the red underlines on spelling errors are left\n                if (this.options.spellcheck) {\n                    element.innerHTML = element.innerHTML;\n                }\n\n                element.removeAttribute('contentEditable');\n                element.removeAttribute('spellcheck');\n                element.removeAttribute('data-medium-element');\n                element.removeAttribute('medium-editor-index');\n                element.removeAttribute('role');\n                element.removeAttribute('aria-multiline');\n\n                // Remove any elements created for textareas\n                if (element.hasAttribute('medium-editor-textarea-id')) {\n                    var textarea = element.parentNode.querySelector('textarea[medium-editor-textarea-id=\"' + element.getAttribute('medium-editor-textarea-id') + '\"]');\n                    if (textarea) {\n                        // Un-hide the textarea\n                        textarea.classList.remove('medium-editor-hidden');\n                    }\n                    if (element.parentNode) {\n                        element.parentNode.removeChild(element);\n                    }\n                }\n            }, this);\n            this.elements = [];\n        },\n\n        on: function (target, event, listener, useCapture) {\n            this.events.attachDOMEvent(target, event, listener, useCapture);\n        },\n\n        off: function (target, event, listener, useCapture) {\n            this.events.detachDOMEvent(target, event, listener, useCapture);\n        },\n\n        subscribe: function (event, listener) {\n            this.events.attachCustomEvent(event, listener);\n        },\n\n        unsubscribe: function (event, listener) {\n            this.events.detachCustomEvent(event, listener);\n        },\n\n        createEvent: function () {\n            Util.warn('.createEvent() has been deprecated and is no longer needed. ' +\n                'You can attach and trigger custom events without calling this method.  This will be removed in v5.0.0');\n        },\n\n        trigger: function (name, data, editable) {\n            this.events.triggerCustomEvent(name, data, editable);\n        },\n\n        delay: function (fn) {\n            var self = this;\n            return setTimeout(function () {\n                if (self.isActive) {\n                    fn();\n                }\n            }, this.options.delay);\n        },\n\n        serialize: function () {\n            var i,\n                elementid,\n                content = {};\n            for (i = 0; i < this.elements.length; i += 1) {\n                elementid = (this.elements[i].id !== '') ? this.elements[i].id : 'element-' + i;\n                content[elementid] = {\n                    value: this.elements[i].innerHTML.trim()\n                };\n            }\n            return content;\n        },\n\n        getExtensionByName: function (name) {\n            var extension;\n            if (this.commands && this.commands.length) {\n                this.commands.some(function (ext) {\n                    if (ext.name === name) {\n                        extension = ext;\n                        return true;\n                    }\n                    return false;\n                });\n            }\n            return extension;\n        },\n\n        /**\n         * NOT DOCUMENTED - exposed for backwards compatability\n         * Helper function to call a method with a number of parameters on all registered extensions.\n         * The function assures that the function exists before calling.\n         *\n         * @param {string} funcName name of the function to call\n         * @param [args] arguments passed into funcName\n         */\n        callExtensions: function (funcName) {\n            if (arguments.length < 1) {\n                return;\n            }\n\n            var args = Array.prototype.slice.call(arguments, 1),\n                ext,\n                name;\n\n            for (name in this.options.extensions) {\n                if (this.options.extensions.hasOwnProperty(name)) {\n                    ext = this.options.extensions[name];\n                    if (ext[funcName] !== undefined) {\n                        ext[funcName].apply(ext, args);\n                    }\n                }\n            }\n            return this;\n        },\n\n        stopSelectionUpdates: function () {\n            this.preventSelectionUpdates = true;\n        },\n\n        startSelectionUpdates: function () {\n            this.preventSelectionUpdates = false;\n        },\n\n        checkSelection: function () {\n            if (this.toolbar) {\n                this.toolbar.checkState();\n            }\n            return this;\n        },\n\n        // Wrapper around document.queryCommandState for checking whether an action has already\n        // been applied to the current selection\n        queryCommandState: function (action) {\n            var fullAction = /^full-(.+)$/gi,\n                match,\n                queryState = null;\n\n            // Actions starting with 'full-' need to be modified since this is a medium-editor concept\n            match = fullAction.exec(action);\n            if (match) {\n                action = match[1];\n            }\n\n            try {\n                queryState = this.options.ownerDocument.queryCommandState(action);\n            } catch (exc) {\n                queryState = null;\n            }\n\n            return queryState;\n        },\n\n        execAction: function (action, opts) {\n            /*jslint regexp: true*/\n            var fullAction = /^full-(.+)$/gi,\n                match,\n                result;\n            /*jslint regexp: false*/\n\n            // Actions starting with 'full-' should be applied to to the entire contents of the editable element\n            // (ie full-bold, full-append-pre, etc.)\n            match = fullAction.exec(action);\n            if (match) {\n                // Store the current selection to be restored after applying the action\n                this.saveSelection();\n                // Select all of the contents before calling the action\n                this.selectAllContents();\n                result = execActionInternal.call(this, match[1], opts);\n                // Restore the previous selection\n                this.restoreSelection();\n            } else {\n                result = execActionInternal.call(this, action, opts);\n            }\n\n            // do some DOM clean-up for known browser issues after the action\n            if (action === 'insertunorderedlist' || action === 'insertorderedlist') {\n                Util.cleanListDOM(this.options.ownerDocument, this.getSelectedParentElement());\n            }\n\n            this.checkSelection();\n            return result;\n        },\n\n        getSelectedParentElement: function (range) {\n            if (range === undefined) {\n                range = this.options.contentWindow.getSelection().getRangeAt(0);\n            }\n            return Selection.getSelectedParentElement(range);\n        },\n\n        // NOT DOCUMENTED - exposed as extension helper\n        hideToolbarDefaultActions: function () {\n            if (this.toolbar) {\n                this.toolbar.hideToolbarDefaultActions();\n            }\n            return this;\n        },\n\n        // NOT DOCUMENTED - exposed as extension helper and for backwards compatability\n        setToolbarPosition: function () {\n            if (this.toolbar) {\n                this.toolbar.setToolbarPosition();\n            }\n        },\n\n        selectAllContents: function () {\n            var currNode = Selection.getSelectionElement(this.options.contentWindow);\n\n            if (currNode) {\n                // Move to the lowest descendant node that still selects all of the contents\n                while (currNode.children.length === 1) {\n                    currNode = currNode.children[0];\n                }\n\n                this.selectElement(currNode);\n            }\n        },\n\n        selectElement: function (element) {\n            Selection.selectNode(element, this.options.ownerDocument);\n\n            var selElement = Selection.getSelectionElement(this.options.contentWindow);\n            if (selElement) {\n                this.events.focusElement(selElement);\n            }\n        },\n\n        getFocusedElement: function () {\n            var focused;\n            this.elements.some(function (element) {\n                // Find the element that has focus\n                if (!focused && element.getAttribute('data-medium-focused')) {\n                    focused = element;\n                }\n\n                // bail if we found the element that had focus\n                return !!focused;\n            }, this);\n\n            return focused;\n        },\n\n        // http://stackoverflow.com/questions/17678843/cant-restore-selection-after-html-modify-even-if-its-the-same-html\n        // Tim Down\n        // TODO: move to selection.js and clean up old methods there\n        exportSelection: function () {\n            var selectionState = null,\n                selection = this.options.contentWindow.getSelection(),\n                range,\n                preSelectionRange,\n                start,\n                editableElementIndex = -1;\n\n            if (selection.rangeCount > 0) {\n                range = selection.getRangeAt(0);\n                preSelectionRange = range.cloneRange();\n\n                // Find element current selection is inside\n                this.elements.some(function (el, index) {\n                    if (el === range.startContainer || Util.isDescendant(el, range.startContainer)) {\n                        editableElementIndex = index;\n                        return true;\n                    }\n                    return false;\n                });\n\n                if (editableElementIndex > -1) {\n                    preSelectionRange.selectNodeContents(this.elements[editableElementIndex]);\n                    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n                    start = preSelectionRange.toString().length;\n\n                    selectionState = {\n                        start: start,\n                        end: start + range.toString().length,\n                        editableElementIndex: editableElementIndex\n                    };\n                    // If start = 0 there may still be an empty paragraph before it, but we don't care.\n                    if (start !== 0) {\n                        var emptyBlocksIndex = Selection.getIndexRelativeToAdjacentEmptyBlocks(\n                                this.options.ownerDocument,\n                                this.elements[editableElementIndex],\n                                range.startContainer,\n                                range.startOffset);\n                        if (emptyBlocksIndex !== 0) {\n                            selectionState.emptyBlocksIndex = emptyBlocksIndex;\n                        }\n                    }\n                }\n            }\n\n            if (selectionState !== null && selectionState.editableElementIndex === 0) {\n                delete selectionState.editableElementIndex;\n            }\n\n            return selectionState;\n        },\n\n        saveSelection: function () {\n            this.selectionState = this.exportSelection();\n        },\n\n        // http://stackoverflow.com/questions/17678843/cant-restore-selection-after-html-modify-even-if-its-the-same-html\n        // Tim Down\n        // TODO: move to selection.js and clean up old methods there\n        //\n        // {object} inSelectionState - the selection to import\n        // {boolean} [favorLaterSelectionAnchor] - defaults to false. If true, import the cursor immediately\n        //      subsequent to an anchor tag if it would otherwise be placed right at the trailing edge inside the\n        //      anchor. This cursor positioning, even though visually equivalent to the user, can affect behavior\n        //      in MS IE.\n        importSelection: function (inSelectionState, favorLaterSelectionAnchor) {\n            if (!inSelectionState) {\n                return;\n            }\n\n            var editableElementIndex = inSelectionState.editableElementIndex === undefined ?\n                                                0 : inSelectionState.editableElementIndex,\n                selectionState = {\n                    editableElementIndex: editableElementIndex,\n                    start: inSelectionState.start,\n                    end: inSelectionState.end\n                },\n                editableElement = this.elements[selectionState.editableElementIndex],\n                charIndex = 0,\n                range = this.options.ownerDocument.createRange(),\n                nodeStack = [editableElement],\n                node,\n                foundStart = false,\n                stop = false,\n                i,\n                sel,\n                nextCharIndex;\n\n            range.setStart(editableElement, 0);\n            range.collapse(true);\n\n            node = nodeStack.pop();\n            while (!stop && node) {\n                if (node.nodeType === 3) {\n                    nextCharIndex = charIndex + node.length;\n                    if (!foundStart && selectionState.start >= charIndex && selectionState.start <= nextCharIndex) {\n                        range.setStart(node, selectionState.start - charIndex);\n                        foundStart = true;\n                    }\n                    if (foundStart && selectionState.end >= charIndex && selectionState.end <= nextCharIndex) {\n                        range.setEnd(node, selectionState.end - charIndex);\n                        stop = true;\n                    }\n                    charIndex = nextCharIndex;\n                } else {\n                    i = node.childNodes.length - 1;\n                    while (i >= 0) {\n                        nodeStack.push(node.childNodes[i]);\n                        i -= 1;\n                    }\n                }\n                if (!stop) {\n                    node = nodeStack.pop();\n                }\n            }\n\n            if (inSelectionState.emptyBlocksIndex) {\n                var targetNode = Util.getBlockContainer(range.startContainer),\n                    index = 0;\n                // Skip over empty blocks until we hit the block we want the selection to be in\n                while (index < inSelectionState.emptyBlocksIndex && targetNode.nextSibling) {\n                    targetNode = targetNode.nextSibling;\n                    index++;\n                    // If we find a non-empty block, ignore the emptyBlocksIndex and just put selection here\n                    if (targetNode.textContent.length > 0) {\n                        break;\n                    }\n                }\n\n                // We're selecting a high-level block node, so make sure the cursor gets moved into the deepest\n                // element at the beginning of the block\n                range.setStart(Util.getFirstSelectableLeafNode(targetNode), 0);\n            }\n\n            // If the selection is right at the ending edge of a link, put it outside the anchor tag instead of inside.\n            if (favorLaterSelectionAnchor) {\n                range = Selection.importSelectionMoveCursorPastAnchor(selectionState, range);\n            }\n            sel = this.options.contentWindow.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n        },\n\n        restoreSelection: function () {\n            this.importSelection(this.selectionState);\n        },\n\n        createLink: function (opts) {\n            var customEvent,\n                i;\n\n            if (opts.url && opts.url.trim().length > 0) {\n                this.options.ownerDocument.execCommand('createLink', false, opts.url);\n\n                if (this.options.targetBlank || opts.target === '_blank') {\n                    Util.setTargetBlank(Selection.getSelectionStart(this.options.ownerDocument), opts.url);\n                }\n\n                if (opts.buttonClass) {\n                    Util.addClassToAnchors(Selection.getSelectionStart(this.options.ownerDocument), opts.buttonClass);\n                }\n            }\n\n            if (this.options.targetBlank || opts.target === '_blank' || opts.buttonClass) {\n                customEvent = this.options.ownerDocument.createEvent('HTMLEvents');\n                customEvent.initEvent('input', true, true, this.options.contentWindow);\n                for (i = 0; i < this.elements.length; i += 1) {\n                    this.elements[i].dispatchEvent(customEvent);\n                }\n            }\n        },\n\n        // alias for setup - keeping for backwards compatability\n        activate: function () {\n            Util.deprecatedMethod.call(this, 'activate', 'setup', arguments, 'v5.0.0');\n        },\n\n        // alias for destroy - keeping for backwards compatability\n        deactivate: function () {\n            Util.deprecatedMethod.call(this, 'deactivate', 'destroy', arguments, 'v5.0.0');\n        },\n\n        cleanPaste: function (text) {\n            this.getExtensionByName('paste').cleanPaste(text);\n        },\n\n        pasteHTML: function (html, options) {\n            this.getExtensionByName('paste').pasteHTML(html, options);\n        }\n    };\n}());\n\nMediumEditor.version = (function (major, minor, revision) {\n    return {\n        major: parseInt(major, 10),\n        minor: parseInt(minor, 10),\n        revision: parseInt(revision, 10),\n        toString: function () {\n            return [major, minor, revision].join('.');\n        }\n    };\n}).apply(this, ({\n    // grunt-bump looks for this:\n    'version': '4.12.7'\n}).version.split('.'));\n\n    return MediumEditor;\n}()));\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/medium-editor/dist/js/medium-editor.js\n ** module id = 8\n ** module chunks = 0\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../node_modules/css-loader/index.js!./app.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../node_modules/css-loader/index.js!./app.css\", function() {\n\t\t\tvar newContent = require(\"!!./../node_modules/css-loader/index.js!./app.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./example/app.css\n ** module id = 9\n ** module chunks = 0\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../../css-loader/index.js!./medium-editor.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../../style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../../css-loader/index.js!./medium-editor.css\", function() {\n\t\t\tvar newContent = require(\"!!./../../../css-loader/index.js!./medium-editor.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/medium-editor/dist/css/medium-editor.css\n ** module id = 10\n ** module chunks = 0\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../../../css-loader/index.js!./default.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../../../style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../../../css-loader/index.js!./default.css\", function() {\n\t\t\tvar newContent = require(\"!!./../../../../css-loader/index.js!./default.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/medium-editor/dist/css/themes/default.css\n ** module id = 11\n ** module chunks = 0\n **/"],"sourceRoot":""}